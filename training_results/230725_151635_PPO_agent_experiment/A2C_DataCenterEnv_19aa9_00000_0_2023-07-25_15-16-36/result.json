{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0028, "entropy_coeff": 0.05000000000000001, "policy_entropy": -876.2407836914062, "policy_loss": 1.6282737316184566e+17, "vf_loss": 67171693909.333336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 5100720, "num_env_steps_trained": 5100720, "num_agent_steps_sampled": 5100720, "num_agent_steps_trained": 5100720}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 201186.16445966085, "episode_reward_mean": 201407.90142412053, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085], "episode_lengths": [360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422023675244852, "mean_inference_ms": 0.26654601510740833, "mean_action_processing_ms": 0.05973684216935465, "mean_env_wait_ms": 2.3185624421097852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002020597457885742, "StateBufferConnector_ms": 0.0016748905181884766, "ViewRequirementAgentConnector_ms": 0.04330277442932129}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 201186.16445966085, "episode_reward_mean": 201407.90142412053, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085], "episode_lengths": [360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.422023675244852, "mean_inference_ms": 0.26654601510740833, "mean_action_processing_ms": 0.05973684216935465, "mean_env_wait_ms": 2.3185624421097852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002020597457885742, "StateBufferConnector_ms": 0.0016748905181884766, "ViewRequirementAgentConnector_ms": 0.04330277442932129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5100720, "num_agent_steps_trained": 5100720, "num_env_steps_sampled": 5100720, "num_env_steps_trained": 5100720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 140.5812573259195, "num_env_steps_trained_throughput_per_sec": 140.5812573259195, "timesteps_total": 5100720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5100720, "timers": {"training_iteration_time_ms": 2560.785, "sample_time_ms": 2553.219, "load_time_ms": 0.254, "load_throughput": 1417460.164, "learn_time_ms": 6.68, "learn_throughput": 53892.602, "synch_weights_time_ms": 0.599}, "counters": {"num_env_steps_sampled": 5100720, "num_env_steps_trained": 5100720, "num_agent_steps_sampled": 5100720, "num_agent_steps_trained": 5100720}, "done": false, "episodes_total": 1213, "training_iteration": 581, "trial_id": "19aa9_00000", "date": "2023-07-25_15-16-50", "timestamp": 1690287410, "time_this_iter_s": 10.245573043823242, "time_total_s": 10189.877116680145, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10.245573043823242, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 28.446666666666662, "ram_util_percent": 77.38000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0018000000000000002, "entropy_coeff": 0.05000000000000001, "policy_entropy": -950.62841796875, "policy_loss": 9.467904531530143e+17, "vf_loss": 67218066090.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}}, "num_env_steps_sampled": 5102520, "num_env_steps_trained": 5102520, "num_agent_steps_sampled": 5102520, "num_agent_steps_trained": 5102520}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 201186.16445966085, "episode_reward_mean": 201407.31121054542, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4213771006136, "mean_inference_ms": 0.2649207967110728, "mean_action_processing_ms": 0.05935990978870301, "mean_env_wait_ms": 1.917447425739477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002341800265842014, "StateBufferConnector_ms": 0.001708666483561198, "ViewRequirementAgentConnector_ms": 0.043974982367621526}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 201186.16445966085, "episode_reward_mean": 201407.31121054542, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4213771006136, "mean_inference_ms": 0.2649207967110728, "mean_action_processing_ms": 0.05935990978870301, "mean_env_wait_ms": 1.917447425739477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002341800265842014, "StateBufferConnector_ms": 0.001708666483561198, "ViewRequirementAgentConnector_ms": 0.043974982367621526}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5102520, "num_agent_steps_trained": 5102520, "num_env_steps_sampled": 5102520, "num_env_steps_trained": 5102520, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 172.68294048593097, "num_env_steps_trained_throughput_per_sec": 172.68294048593097, "timesteps_total": 5102520, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5102520, "timers": {"training_iteration_time_ms": 2296.314, "sample_time_ms": 2290.297, "load_time_ms": 0.226, "load_throughput": 1591840.806, "learn_time_ms": 5.216, "learn_throughput": 69016.444, "synch_weights_time_ms": 0.543}, "counters": {"num_env_steps_sampled": 5102520, "num_env_steps_trained": 5102520, "num_agent_steps_sampled": 5102520, "num_agent_steps_trained": 5102520}, "done": false, "episodes_total": 1218, "training_iteration": 582, "trial_id": "19aa9_00000", "date": "2023-07-25_15-17-01", "timestamp": 1690287421, "time_this_iter_s": 10.425577878952026, "time_total_s": 10200.302694559097, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 20.67115092277527, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.206666666666667, "ram_util_percent": 77.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0009750000000000001, "entropy_coeff": 0.05000000000000001, "policy_entropy": -974.1642252604166, "policy_loss": 5.703028984910271e+18, "vf_loss": 65516528981.333336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 5104320, "num_env_steps_trained": 5104320, "num_agent_steps_sampled": 5104320, "num_agent_steps_trained": 5104320}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 198692.1379116401, "episode_reward_mean": 201066.61328084668, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.420591078755242, "mean_inference_ms": 0.264841081528191, "mean_action_processing_ms": 0.059295917620440265, "mean_env_wait_ms": 1.7242121184459993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024420874459402902, "StateBufferConnector_ms": 0.0017336436680385045, "ViewRequirementAgentConnector_ms": 0.04426581518990653}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 198692.1379116401, "episode_reward_mean": 201066.61328084668, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.420591078755242, "mean_inference_ms": 0.264841081528191, "mean_action_processing_ms": 0.059295917620440265, "mean_env_wait_ms": 1.7242121184459993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024420874459402902, "StateBufferConnector_ms": 0.0017336436680385045, "ViewRequirementAgentConnector_ms": 0.04426581518990653}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5104320, "num_agent_steps_trained": 5104320, "num_env_steps_sampled": 5104320, "num_env_steps_trained": 5104320, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 173.7508775000798, "num_env_steps_trained_throughput_per_sec": 173.7508775000798, "timesteps_total": 5104320, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5104320, "timers": {"training_iteration_time_ms": 2078.33, "sample_time_ms": 2073.537, "load_time_ms": 0.207, "load_throughput": 1739773.522, "learn_time_ms": 4.05, "learn_throughput": 88885.389, "synch_weights_time_ms": 0.504}, "counters": {"num_env_steps_sampled": 5104320, "num_env_steps_trained": 5104320, "num_agent_steps_sampled": 5104320, "num_agent_steps_trained": 5104320}, "done": false, "episodes_total": 1223, "training_iteration": 583, "trial_id": "19aa9_00000", "date": "2023-07-25_15-17-11", "timestamp": 1690287431, "time_this_iter_s": 10.361541271209717, "time_total_s": 10210.664235830307, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 31.032692193984985, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.853333333333335, "ram_util_percent": 77.20666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0008249999999999999, "entropy_coeff": 0.05000000000000001, "policy_entropy": -985.2634684244791, "policy_loss": 1.309467890260098e+19, "vf_loss": 63425368064.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 5106480, "num_env_steps_trained": 5106480, "num_agent_steps_sampled": 5106480, "num_agent_steps_trained": 5106480}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 195494.8637691065, "episode_reward_mean": 199663.42247559055, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.419905285678575, "mean_inference_ms": 0.26484456117278454, "mean_action_processing_ms": 0.05929014216417934, "mean_env_wait_ms": 1.5646726692271546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023698806762695312, "StateBufferConnector_ms": 0.001729726791381836, "ViewRequirementAgentConnector_ms": 0.044341087341308594}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 195494.8637691065, "episode_reward_mean": 199663.42247559055, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.419905285678575, "mean_inference_ms": 0.26484456117278454, "mean_action_processing_ms": 0.05929014216417934, "mean_env_wait_ms": 1.5646726692271546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023698806762695312, "StateBufferConnector_ms": 0.001729726791381836, "ViewRequirementAgentConnector_ms": 0.044341087341308594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5106480, "num_agent_steps_trained": 5106480, "num_env_steps_sampled": 5106480, "num_env_steps_trained": 5106480, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 180.39592257315005, "num_env_steps_trained_throughput_per_sec": 180.39592257315005, "timesteps_total": 5106480, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5106480, "timers": {"training_iteration_time_ms": 2025.594, "sample_time_ms": 2020.497, "load_time_ms": 0.214, "load_throughput": 1683520.392, "learn_time_ms": 4.119, "learn_throughput": 87400.047, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 5106480, "num_env_steps_trained": 5106480, "num_agent_steps_sampled": 5106480, "num_agent_steps_trained": 5106480}, "done": false, "episodes_total": 1229, "training_iteration": 584, "trial_id": "19aa9_00000", "date": "2023-07-25_15-17-23", "timestamp": 1690287443, "time_this_iter_s": 11.97557806968689, "time_total_s": 10222.639813899994, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 43.008270263671875, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.95882352941177, "ram_util_percent": 77.22941176470589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0006749999999999999, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1008.2917683919271, "policy_loss": 9.240807322017246e+16, "vf_loss": 62536239104.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 76.0}}, "num_env_steps_sampled": 5108640, "num_env_steps_trained": 5108640, "num_agent_steps_sampled": 5108640, "num_agent_steps_trained": 5108640}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 194106.65636613924, "episode_reward_mean": 198592.73348346402, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.419643542789706, "mean_inference_ms": 0.2646354666927168, "mean_action_processing_ms": 0.059269595911961, "mean_env_wait_ms": 1.4514136729657932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024126126216008114, "StateBufferConnector_ms": 0.001722115736741286, "ViewRequirementAgentConnector_ms": 0.04444214013906626}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 194106.65636613924, "episode_reward_mean": 198592.73348346402, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.419643542789706, "mean_inference_ms": 0.2646354666927168, "mean_action_processing_ms": 0.059269595911961, "mean_env_wait_ms": 1.4514136729657932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024126126216008114, "StateBufferConnector_ms": 0.001722115736741286, "ViewRequirementAgentConnector_ms": 0.04444214013906626}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5108640, "num_agent_steps_trained": 5108640, "num_env_steps_sampled": 5108640, "num_env_steps_trained": 5108640, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 183.08743032794885, "num_env_steps_trained_throughput_per_sec": 183.08743032794885, "timesteps_total": 5108640, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5108640, "timers": {"training_iteration_time_ms": 1975.913, "sample_time_ms": 1970.064, "load_time_ms": 0.24, "load_throughput": 1502736.306, "learn_time_ms": 4.698, "learn_throughput": 76632.009, "synch_weights_time_ms": 0.87}, "counters": {"num_env_steps_sampled": 5108640, "num_env_steps_trained": 5108640, "num_agent_steps_sampled": 5108640, "num_agent_steps_trained": 5108640}, "done": false, "episodes_total": 1235, "training_iteration": 585, "trial_id": "19aa9_00000", "date": "2023-07-25_15-17-35", "timestamp": 1690287455, "time_this_iter_s": 11.799580097198486, "time_total_s": 10234.439393997192, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 54.80785036087036, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 25.711764705882356, "ram_util_percent": 76.99411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.000525, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1025.9347127278645, "policy_loss": 3.9285458834357847e+18, "vf_loss": 62248950442.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}}, "num_env_steps_sampled": 5110800, "num_env_steps_trained": 5110800, "num_agent_steps_sampled": 5110800, "num_agent_steps_trained": 5110800}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 197675.56632971845, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4196152226167635, "mean_inference_ms": 0.2641632551421808, "mean_action_processing_ms": 0.059203134059449616, "mean_env_wait_ms": 1.3635892809952295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024244189262390137, "StateBufferConnector_ms": 0.0017076730728149414, "ViewRequirementAgentConnector_ms": 0.044580549001693726}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 197675.56632971845, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4196152226167635, "mean_inference_ms": 0.2641632551421808, "mean_action_processing_ms": 0.059203134059449616, "mean_env_wait_ms": 1.3635892809952295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024244189262390137, "StateBufferConnector_ms": 0.0017076730728149414, "ViewRequirementAgentConnector_ms": 0.044580549001693726}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5110800, "num_agent_steps_trained": 5110800, "num_env_steps_sampled": 5110800, "num_env_steps_trained": 5110800, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.68121043039744, "num_env_steps_trained_throughput_per_sec": 186.68121043039744, "timesteps_total": 5110800, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5110800, "timers": {"training_iteration_time_ms": 1940.516, "sample_time_ms": 1935.287, "load_time_ms": 0.228, "load_throughput": 1579940.818, "learn_time_ms": 4.377, "learn_throughput": 82241.703, "synch_weights_time_ms": 0.587}, "counters": {"num_env_steps_sampled": 5110800, "num_env_steps_trained": 5110800, "num_agent_steps_sampled": 5110800, "num_agent_steps_trained": 5110800}, "done": false, "episodes_total": 1241, "training_iteration": 586, "trial_id": "19aa9_00000", "date": "2023-07-25_15-17-46", "timestamp": 1690287466, "time_this_iter_s": 11.57246708869934, "time_total_s": 10246.011861085892, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 66.3803174495697, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 28.6625, "ram_util_percent": 77.08125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00037500000000000006, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1044.9778645833333, "policy_loss": 7.806559168437316e+17, "vf_loss": 62279342762.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 112.0}}, "num_env_steps_sampled": 5112960, "num_env_steps_trained": 5112960, "num_agent_steps_sampled": 5112960, "num_agent_steps_trained": 5112960}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 197065.18020159187, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418918266960176, "mean_inference_ms": 0.2636877570290682, "mean_action_processing_ms": 0.0591378973273965, "mean_env_wait_ms": 1.2937349493803894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023860680429559004, "StateBufferConnector_ms": 0.0017184960214715254, "ViewRequirementAgentConnector_ms": 0.0446244290000514}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 197065.18020159187, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.418918266960176, "mean_inference_ms": 0.2636877570290682, "mean_action_processing_ms": 0.0591378973273965, "mean_env_wait_ms": 1.2937349493803894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023860680429559004, "StateBufferConnector_ms": 0.0017184960214715254, "ViewRequirementAgentConnector_ms": 0.0446244290000514}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5112960, "num_agent_steps_trained": 5112960, "num_env_steps_sampled": 5112960, "num_env_steps_trained": 5112960, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 187.57856699420995, "num_env_steps_trained_throughput_per_sec": 187.57856699420995, "timesteps_total": 5112960, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5112960, "timers": {"training_iteration_time_ms": 1921.43, "sample_time_ms": 1916.595, "load_time_ms": 0.215, "load_throughput": 1674930.05, "learn_time_ms": 4.082, "learn_throughput": 88201.588, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 5112960, "num_env_steps_trained": 5112960, "num_agent_steps_sampled": 5112960, "num_agent_steps_trained": 5112960}, "done": false, "episodes_total": 1247, "training_iteration": 587, "trial_id": "19aa9_00000", "date": "2023-07-25_15-17-58", "timestamp": 1690287478, "time_this_iter_s": 11.517063856124878, "time_total_s": 10257.528924942017, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 77.89738130569458, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 24.75625, "ram_util_percent": 76.53125000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.000235, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1055.6918538411458, "policy_loss": 5.4172557848187155e+17, "vf_loss": 62551135573.333336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 131.0, "diff_num_grad_updates_vs_sampler_policy": 130.0}}, "num_env_steps_sampled": 5115120, "num_env_steps_trained": 5115120, "num_agent_steps_sampled": 5115120, "num_agent_steps_trained": 5115120}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 196648.24301074882, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417662776757448, "mean_inference_ms": 0.26334684172125017, "mean_action_processing_ms": 0.05908805674605417, "mean_env_wait_ms": 1.2373319947714165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025142322887073865, "StateBufferConnector_ms": 0.001708485863425515, "ViewRequirementAgentConnector_ms": 0.044836239381269974}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 196648.24301074882, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417662776757448, "mean_inference_ms": 0.26334684172125017, "mean_action_processing_ms": 0.05908805674605417, "mean_env_wait_ms": 1.2373319947714165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025142322887073865, "StateBufferConnector_ms": 0.001708485863425515, "ViewRequirementAgentConnector_ms": 0.044836239381269974}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5115120, "num_agent_steps_trained": 5115120, "num_env_steps_sampled": 5115120, "num_env_steps_trained": 5115120, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.95856842887966, "num_env_steps_trained_throughput_per_sec": 186.95856842887966, "timesteps_total": 5115120, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5115120, "timers": {"training_iteration_time_ms": 1922.833, "sample_time_ms": 1917.957, "load_time_ms": 0.215, "load_throughput": 1672703.49, "learn_time_ms": 4.093, "learn_throughput": 87962.661, "synch_weights_time_ms": 0.536}, "counters": {"num_env_steps_sampled": 5115120, "num_env_steps_trained": 5115120, "num_agent_steps_sampled": 5115120, "num_agent_steps_trained": 5115120}, "done": false, "episodes_total": 1253, "training_iteration": 588, "trial_id": "19aa9_00000", "date": "2023-07-25_15-18-09", "timestamp": 1690287489, "time_this_iter_s": 11.555356979370117, "time_total_s": 10269.084281921387, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 89.4527382850647, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 27.258823529411764, "ram_util_percent": 76.65294117647058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.000145, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1058.8682454427083, "policy_loss": 4.0513551370116685e+18, "vf_loss": 62687696213.333336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 149.0, "diff_num_grad_updates_vs_sampler_policy": 148.0}}, "num_env_steps_sampled": 5117280, "num_env_steps_trained": 5117280, "num_agent_steps_sampled": 5117280, "num_agent_steps_trained": 5117280}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 196365.95782088398, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416248448532013, "mean_inference_ms": 0.26307026870075634, "mean_action_processing_ms": 0.05904797327098352, "mean_env_wait_ms": 1.1908793091968004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002521514892578125, "StateBufferConnector_ms": 0.0017213821411132812, "ViewRequirementAgentConnector_ms": 0.044878482818603516}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 196365.95782088398, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.416248448532013, "mean_inference_ms": 0.26307026870075634, "mean_action_processing_ms": 0.05904797327098352, "mean_env_wait_ms": 1.1908793091968004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002521514892578125, "StateBufferConnector_ms": 0.0017213821411132812, "ViewRequirementAgentConnector_ms": 0.044878482818603516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5117280, "num_agent_steps_trained": 5117280, "num_env_steps_sampled": 5117280, "num_env_steps_trained": 5117280, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.54578589151456, "num_env_steps_trained_throughput_per_sec": 186.54578589151456, "timesteps_total": 5117280, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5117280, "timers": {"training_iteration_time_ms": 1927.999, "sample_time_ms": 1923.087, "load_time_ms": 0.212, "load_throughput": 1699436.624, "learn_time_ms": 4.116, "learn_throughput": 87454.718, "synch_weights_time_ms": 0.55}, "counters": {"num_env_steps_sampled": 5117280, "num_env_steps_trained": 5117280, "num_agent_steps_sampled": 5117280, "num_agent_steps_trained": 5117280}, "done": false, "episodes_total": 1259, "training_iteration": 589, "trial_id": "19aa9_00000", "date": "2023-07-25_15-18-21", "timestamp": 1690287501, "time_this_iter_s": 11.580806970596313, "time_total_s": 10280.665088891983, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 101.03354525566101, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 24.63125, "ram_util_percent": 76.6625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.249999999999999e-05, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1059.148193359375, "policy_loss": 5.234158663845052e+18, "vf_loss": 62756062549.333336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 167.0, "diff_num_grad_updates_vs_sampler_policy": 166.0}}, "num_env_steps_sampled": 5119440, "num_env_steps_trained": 5119440, "num_agent_steps_sampled": 5119440, "num_agent_steps_trained": 5119440}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 196149.8320833069, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41500522002269, "mean_inference_ms": 0.26284234866250883, "mean_action_processing_ms": 0.05901318902261625, "mean_env_wait_ms": 1.1520802806975163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024778502328055246, "StateBufferConnector_ms": 0.0017183167593819754, "ViewRequirementAgentConnector_ms": 0.04484057426452637}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 196149.8320833069, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41500522002269, "mean_inference_ms": 0.26284234866250883, "mean_action_processing_ms": 0.05901318902261625, "mean_env_wait_ms": 1.1520802806975163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024778502328055246, "StateBufferConnector_ms": 0.0017183167593819754, "ViewRequirementAgentConnector_ms": 0.04484057426452637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5119440, "num_agent_steps_trained": 5119440, "num_env_steps_sampled": 5119440, "num_env_steps_trained": 5119440, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.04995566311962, "num_env_steps_trained_throughput_per_sec": 185.04995566311962, "timesteps_total": 5119440, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5119440, "timers": {"training_iteration_time_ms": 1937.075, "sample_time_ms": 1931.808, "load_time_ms": 0.218, "load_throughput": 1652023.457, "learn_time_ms": 4.195, "learn_throughput": 85824.766, "synch_weights_time_ms": 0.819}, "counters": {"num_env_steps_sampled": 5119440, "num_env_steps_trained": 5119440, "num_agent_steps_sampled": 5119440, "num_agent_steps_trained": 5119440}, "done": false, "episodes_total": 1265, "training_iteration": 590, "trial_id": "19aa9_00000", "date": "2023-07-25_15-18-33", "timestamp": 1690287513, "time_this_iter_s": 11.674960136413574, "time_total_s": 10292.340049028397, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 112.70850539207458, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.49411764705882, "ram_util_percent": 76.76470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.749999999999999e-05, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1060.6453857421875, "policy_loss": 2.2855016203297315e+17, "vf_loss": 62595417429.333336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 185.0, "diff_num_grad_updates_vs_sampler_policy": 184.0}}, "num_env_steps_sampled": 5121600, "num_env_steps_trained": 5121600, "num_agent_steps_sampled": 5121600, "num_agent_steps_trained": 5121600}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 195953.11441725979, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414055443263921, "mean_inference_ms": 0.26263306243281326, "mean_action_processing_ms": 0.05898164702334629, "mean_env_wait_ms": 1.1188695937270896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002440714067028415, "StateBufferConnector_ms": 0.0017143064929592993, "ViewRequirementAgentConnector_ms": 0.04476962550993888}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 195953.11441725979, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414055443263921, "mean_inference_ms": 0.26263306243281326, "mean_action_processing_ms": 0.05898164702334629, "mean_env_wait_ms": 1.1188695937270896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002440714067028415, "StateBufferConnector_ms": 0.0017143064929592993, "ViewRequirementAgentConnector_ms": 0.04476962550993888}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5121600, "num_agent_steps_trained": 5121600, "num_env_steps_sampled": 5121600, "num_env_steps_trained": 5121600, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.7287909684076, "num_env_steps_trained_throughput_per_sec": 185.7287909684076, "timesteps_total": 5121600, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5121600, "timers": {"training_iteration_time_ms": 1943.177, "sample_time_ms": 1937.875, "load_time_ms": 0.23, "load_throughput": 1563256.486, "learn_time_ms": 4.229, "learn_throughput": 85132.323, "synch_weights_time_ms": 0.808}, "counters": {"num_env_steps_sampled": 5121600, "num_env_steps_trained": 5121600, "num_agent_steps_sampled": 5121600, "num_agent_steps_trained": 5121600}, "done": false, "episodes_total": 1271, "training_iteration": 591, "trial_id": "19aa9_00000", "date": "2023-07-25_15-18-44", "timestamp": 1690287524, "time_this_iter_s": 11.631830930709839, "time_total_s": 10303.971879959106, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 124.34033632278442, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.975, "ram_util_percent": 76.9625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.25e-05, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1060.9182942708333, "policy_loss": 6.291811505540532e+17, "vf_loss": 62402961408.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 202.0}}, "num_env_steps_sampled": 5123760, "num_env_steps_trained": 5123760, "num_agent_steps_sampled": 5123760, "num_agent_steps_trained": 5123760}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 195789.99136390653, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413171465039598, "mean_inference_ms": 0.2624264599476524, "mean_action_processing_ms": 0.05895082838443219, "mean_env_wait_ms": 1.0900693383652842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024578150580911074, "StateBufferConnector_ms": 0.0017180162317612592, "ViewRequirementAgentConnector_ms": 0.044967847711899704}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 195789.99136390653, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.413171465039598, "mean_inference_ms": 0.2624264599476524, "mean_action_processing_ms": 0.05895082838443219, "mean_env_wait_ms": 1.0900693383652842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024578150580911074, "StateBufferConnector_ms": 0.0017180162317612592, "ViewRequirementAgentConnector_ms": 0.044967847711899704}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5123760, "num_agent_steps_trained": 5123760, "num_env_steps_sampled": 5123760, "num_env_steps_trained": 5123760, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.4793506003488, "num_env_steps_trained_throughput_per_sec": 186.4793506003488, "timesteps_total": 5123760, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5123760, "timers": {"training_iteration_time_ms": 1930.997, "sample_time_ms": 1926.1, "load_time_ms": 0.22, "load_throughput": 1638222.242, "learn_time_ms": 4.117, "learn_throughput": 87441.044, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 5123760, "num_env_steps_trained": 5123760, "num_agent_steps_sampled": 5123760, "num_agent_steps_trained": 5123760}, "done": false, "episodes_total": 1277, "training_iteration": 592, "trial_id": "19aa9_00000", "date": "2023-07-25_15-18-56", "timestamp": 1690287536, "time_this_iter_s": 11.585000991821289, "time_total_s": 10315.556880950928, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 135.9253373146057, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.288235294117644, "ram_util_percent": 76.8529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.7499999999999996e-05, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1060.9586181640625, "policy_loss": 2.1128082026179244e+16, "vf_loss": 62365446826.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 221.0, "diff_num_grad_updates_vs_sampler_policy": 220.0}}, "num_env_steps_sampled": 5125920, "num_env_steps_trained": 5125920, "num_agent_steps_sampled": 5125920, "num_agent_steps_trained": 5125920}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 195637.8892988108, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412666264563373, "mean_inference_ms": 0.2622276230960719, "mean_action_processing_ms": 0.05891957284976038, "mean_env_wait_ms": 1.0647609193280325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002459899799243824, "StateBufferConnector_ms": 0.0017179025186074746, "ViewRequirementAgentConnector_ms": 0.04496896589124525}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 195637.8892988108, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412666264563373, "mean_inference_ms": 0.2622276230960719, "mean_action_processing_ms": 0.05891957284976038, "mean_env_wait_ms": 1.0647609193280325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002459899799243824, "StateBufferConnector_ms": 0.0017179025186074746, "ViewRequirementAgentConnector_ms": 0.04496896589124525}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5125920, "num_agent_steps_trained": 5125920, "num_env_steps_sampled": 5125920, "num_env_steps_trained": 5125920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.17620258954904, "num_env_steps_trained_throughput_per_sec": 185.17620258954904, "timesteps_total": 5125920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5125920, "timers": {"training_iteration_time_ms": 1939.442, "sample_time_ms": 1934.613, "load_time_ms": 0.219, "load_throughput": 1642499.119, "learn_time_ms": 4.028, "learn_throughput": 89381.556, "synch_weights_time_ms": 0.549}, "counters": {"num_env_steps_sampled": 5125920, "num_env_steps_trained": 5125920, "num_agent_steps_sampled": 5125920, "num_agent_steps_trained": 5125920}, "done": false, "episodes_total": 1283, "training_iteration": 593, "trial_id": "19aa9_00000", "date": "2023-07-25_15-19-08", "timestamp": 1690287548, "time_this_iter_s": 11.666620969772339, "time_total_s": 10327.2235019207, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 147.59195828437805, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 26.288235294117644, "ram_util_percent": 76.9470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.2500000000000004e-05, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.3815511067708, "policy_loss": 1.894025620631388e+17, "vf_loss": 62445435562.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 239.0, "diff_num_grad_updates_vs_sampler_policy": 238.0}}, "num_env_steps_sampled": 5128080, "num_env_steps_trained": 5128080, "num_agent_steps_sampled": 5128080, "num_agent_steps_trained": 5128080}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 195513.57226115823, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4121856992617, "mean_inference_ms": 0.2620264159315435, "mean_action_processing_ms": 0.05888749411734055, "mean_env_wait_ms": 1.042293631587024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002427995204925537, "StateBufferConnector_ms": 0.0017136335372924805, "ViewRequirementAgentConnector_ms": 0.04492670297622681}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 195513.57226115823, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4121856992617, "mean_inference_ms": 0.2620264159315435, "mean_action_processing_ms": 0.05888749411734055, "mean_env_wait_ms": 1.042293631587024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002427995204925537, "StateBufferConnector_ms": 0.0017136335372924805, "ViewRequirementAgentConnector_ms": 0.04492670297622681}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5128080, "num_agent_steps_trained": 5128080, "num_env_steps_sampled": 5128080, "num_env_steps_trained": 5128080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.8932923422324, "num_env_steps_trained_throughput_per_sec": 186.8932923422324, "timesteps_total": 5128080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5128080, "timers": {"training_iteration_time_ms": 1932.192, "sample_time_ms": 1927.382, "load_time_ms": 0.22, "load_throughput": 1633967.579, "learn_time_ms": 4.039, "learn_throughput": 89127.784, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 5128080, "num_env_steps_trained": 5128080, "num_agent_steps_sampled": 5128080, "num_agent_steps_trained": 5128080}, "done": false, "episodes_total": 1289, "training_iteration": 594, "trial_id": "19aa9_00000", "date": "2023-07-25_15-19-19", "timestamp": 1690287559, "time_this_iter_s": 11.5595121383667, "time_total_s": 10338.783014059067, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 159.15147042274475, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 28.150000000000002, "ram_util_percent": 77.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.05e-05, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.866455078125, "policy_loss": 8.576994166375493e+16, "vf_loss": 62475218261.333336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 257.0, "diff_num_grad_updates_vs_sampler_policy": 256.0}}, "num_env_steps_sampled": 5130240, "num_env_steps_trained": 5130240, "num_agent_steps_sampled": 5130240, "num_agent_steps_trained": 5130240}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 195401.98159585797, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411852821207535, "mean_inference_ms": 0.2618332862188098, "mean_action_processing_ms": 0.05885691754293677, "mean_env_wait_ms": 1.0221705082887664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002429374428682549, "StateBufferConnector_ms": 0.001710237458694813, "ViewRequirementAgentConnector_ms": 0.0449053076810615}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 195401.98159585797, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411852821207535, "mean_inference_ms": 0.2618332862188098, "mean_action_processing_ms": 0.05885691754293677, "mean_env_wait_ms": 1.0221705082887664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002429374428682549, "StateBufferConnector_ms": 0.001710237458694813, "ViewRequirementAgentConnector_ms": 0.0449053076810615}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5130240, "num_agent_steps_trained": 5130240, "num_env_steps_sampled": 5130240, "num_env_steps_trained": 5130240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.12091448088307, "num_env_steps_trained_throughput_per_sec": 186.12091448088307, "timesteps_total": 5130240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5130240, "timers": {"training_iteration_time_ms": 1930.805, "sample_time_ms": 1925.896, "load_time_ms": 0.223, "load_throughput": 1617860.752, "learn_time_ms": 4.14, "learn_throughput": 86946.1, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 5130240, "num_env_steps_trained": 5130240, "num_agent_steps_sampled": 5130240, "num_agent_steps_trained": 5130240}, "done": false, "episodes_total": 1295, "training_iteration": 595, "trial_id": "19aa9_00000", "date": "2023-07-25_15-19-31", "timestamp": 1690287571, "time_this_iter_s": 11.607409954071045, "time_total_s": 10350.390424013138, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 170.7588803768158, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 25.275, "ram_util_percent": 77.15625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.15e-05, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9129231770833, "policy_loss": 2.5865985273626624e+16, "vf_loss": 62262140928.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 275.0, "diff_num_grad_updates_vs_sampler_policy": 274.0}}, "num_env_steps_sampled": 5132400, "num_env_steps_trained": 5132400, "num_agent_steps_sampled": 5132400, "num_agent_steps_trained": 5132400}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 195301.2479680213, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41152549438483, "mean_inference_ms": 0.26165540702612583, "mean_action_processing_ms": 0.05882817049602405, "mean_env_wait_ms": 1.0040333762773346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002438089121942935, "StateBufferConnector_ms": 0.0017039153886877973, "ViewRequirementAgentConnector_ms": 0.044949676679528275}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 195301.2479680213, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.41152549438483, "mean_inference_ms": 0.26165540702612583, "mean_action_processing_ms": 0.05882817049602405, "mean_env_wait_ms": 1.0040333762773346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002438089121942935, "StateBufferConnector_ms": 0.0017039153886877973, "ViewRequirementAgentConnector_ms": 0.044949676679528275}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5132400, "num_agent_steps_trained": 5132400, "num_env_steps_sampled": 5132400, "num_env_steps_trained": 5132400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.91665150754875, "num_env_steps_trained_throughput_per_sec": 186.91665150754875, "timesteps_total": 5132400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5132400, "timers": {"training_iteration_time_ms": 1930.483, "sample_time_ms": 1925.548, "load_time_ms": 0.221, "load_throughput": 1626925.374, "learn_time_ms": 4.161, "learn_throughput": 86524.6, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 5132400, "num_env_steps_trained": 5132400, "num_agent_steps_sampled": 5132400, "num_agent_steps_trained": 5132400}, "done": false, "episodes_total": 1301, "training_iteration": 596, "trial_id": "19aa9_00000", "date": "2023-07-25_15-19-42", "timestamp": 1690287582, "time_this_iter_s": 11.558046340942383, "time_total_s": 10361.94847035408, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 182.31692671775818, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 25.88235294117647, "ram_util_percent": 77.27058823529411}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.750000000000001e-06, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9171142578125, "policy_loss": 2365884144746496.0, "vf_loss": 62321778688.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 292.0}}, "num_env_steps_sampled": 5134560, "num_env_steps_trained": 5134560, "num_agent_steps_sampled": 5134560, "num_agent_steps_trained": 5134560}, "sampler_results": {"episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 195219.6631110883, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4112506992088285, "mean_inference_ms": 0.2614920834584776, "mean_action_processing_ms": 0.0588024191203791, "mean_env_wait_ms": 0.9876712196535749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024206784306740276, "StateBufferConnector_ms": 0.0016947181857362085, "ViewRequirementAgentConnector_ms": 0.04489762442452567}}, "episode_reward_max": 201637.14119915626, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 195219.6631110883, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201290.1319227053, 201637.14119915626, 201518.1681149597, 201186.16445966085, 201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4112506992088285, "mean_inference_ms": 0.2614920834584776, "mean_action_processing_ms": 0.0588024191203791, "mean_env_wait_ms": 0.9876712196535749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024206784306740276, "StateBufferConnector_ms": 0.0016947181857362085, "ViewRequirementAgentConnector_ms": 0.04489762442452567}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5134560, "num_agent_steps_trained": 5134560, "num_env_steps_sampled": 5134560, "num_env_steps_trained": 5134560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.73738118252496, "num_env_steps_trained_throughput_per_sec": 185.73738118252496, "timesteps_total": 5134560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5134560, "timers": {"training_iteration_time_ms": 1933.562, "sample_time_ms": 1928.721, "load_time_ms": 0.219, "load_throughput": 1643571.83, "learn_time_ms": 4.073, "learn_throughput": 88391.596, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 5134560, "num_env_steps_trained": 5134560, "num_agent_steps_sampled": 5134560, "num_agent_steps_trained": 5134560}, "done": false, "episodes_total": 1307, "training_iteration": 597, "trial_id": "19aa9_00000", "date": "2023-07-25_15-19-54", "timestamp": 1690287594, "time_this_iter_s": 11.631508111953735, "time_total_s": 10373.579978466034, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 193.9484348297119, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 24.75, "ram_util_percent": 77.07499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.25e-06, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9171142578125, "policy_loss": 3574713789743104.0, "vf_loss": 62365406549.333336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 310.0}}, "num_env_steps_sampled": 5136720, "num_env_steps_trained": 5136720, "num_agent_steps_sampled": 5136720, "num_agent_steps_trained": 5136720}, "sampler_results": {"episode_reward_max": 201541.08563968993, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 194896.37984641193, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4106925626032565, "mean_inference_ms": 0.26114209817540224, "mean_action_processing_ms": 0.05874165398469879, "mean_env_wait_ms": 0.9189776918893077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024156570434570312, "StateBufferConnector_ms": 0.0016951560974121094, "ViewRequirementAgentConnector_ms": 0.04495835304260254}}, "episode_reward_max": 201541.08563968993, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 194896.37984641193, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201527.5634246159, 201373.7800733937, 201312.19721010255, 201541.08563968993, 201279.56885062458, 201085.39896742537, 201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4106925626032565, "mean_inference_ms": 0.26114209817540224, "mean_action_processing_ms": 0.05874165398469879, "mean_env_wait_ms": 0.9189776918893077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024156570434570312, "StateBufferConnector_ms": 0.0016951560974121094, "ViewRequirementAgentConnector_ms": 0.04495835304260254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5136720, "num_agent_steps_trained": 5136720, "num_env_steps_sampled": 5136720, "num_env_steps_trained": 5136720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 184.69496625350962, "num_env_steps_trained_throughput_per_sec": 184.69496625350962, "timesteps_total": 5136720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5136720, "timers": {"training_iteration_time_ms": 1944.57, "sample_time_ms": 1939.783, "load_time_ms": 0.215, "load_throughput": 1674187.205, "learn_time_ms": 4.042, "learn_throughput": 89056.293, "synch_weights_time_ms": 0.497}, "counters": {"num_env_steps_sampled": 5136720, "num_env_steps_trained": 5136720, "num_agent_steps_sampled": 5136720, "num_agent_steps_trained": 5136720}, "done": false, "episodes_total": 1313, "training_iteration": 598, "trial_id": "19aa9_00000", "date": "2023-07-25_15-20-06", "timestamp": 1690287606, "time_this_iter_s": 11.697011232376099, "time_total_s": 10385.27698969841, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 205.645446062088, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 26.294117647058822, "ram_util_percent": 76.89411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.750000000000001e-06, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9152425130208, "policy_loss": 7959773187495253.0, "vf_loss": 62387729749.333336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 329.0, "diff_num_grad_updates_vs_sampler_policy": 328.0}}, "num_env_steps_sampled": 5138880, "num_env_steps_trained": 5138880, "num_agent_steps_sampled": 5138880, "num_agent_steps_trained": 5138880}, "sampler_results": {"episode_reward_max": 201439.6605059317, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 194445.65137595133, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409971529467477, "mean_inference_ms": 0.26084502861347525, "mean_action_processing_ms": 0.05869970131694619, "mean_env_wait_ms": 0.8688002378921391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024056434631347656, "StateBufferConnector_ms": 0.0016870498657226562, "ViewRequirementAgentConnector_ms": 0.04489779472351074}}, "episode_reward_max": 201439.6605059317, "episode_reward_min": 193483.71259775542, "episode_reward_mean": 194445.65137595133, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [201439.6605059317, 201256.49121816852, 199793.0964337793, 198692.1379116401, 197529.68538527336, 196789.48403851874, 196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409971529467477, "mean_inference_ms": 0.26084502861347525, "mean_action_processing_ms": 0.05869970131694619, "mean_env_wait_ms": 0.8688002378921391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024056434631347656, "StateBufferConnector_ms": 0.0016870498657226562, "ViewRequirementAgentConnector_ms": 0.04489779472351074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5138880, "num_agent_steps_trained": 5138880, "num_env_steps_sampled": 5138880, "num_env_steps_trained": 5138880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.66791720502042, "num_env_steps_trained_throughput_per_sec": 186.66791720502042, "timesteps_total": 5138880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5138880, "timers": {"training_iteration_time_ms": 1939.925, "sample_time_ms": 1935.088, "load_time_ms": 0.22, "load_throughput": 1635914.886, "learn_time_ms": 4.07, "learn_throughput": 88442.334, "synch_weights_time_ms": 0.513}, "counters": {"num_env_steps_sampled": 5138880, "num_env_steps_trained": 5138880, "num_agent_steps_sampled": 5138880, "num_agent_steps_trained": 5138880}, "done": false, "episodes_total": 1319, "training_iteration": 599, "trial_id": "19aa9_00000", "date": "2023-07-25_15-20-17", "timestamp": 1690287617, "time_this_iter_s": 11.573353052139282, "time_total_s": 10396.85034275055, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 217.2187991142273, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 24.264705882352942, "ram_util_percent": 76.76470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.25e-06, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9144287109375, "policy_loss": 2749796093067264.0, "vf_loss": 62525325994.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 347.0, "diff_num_grad_updates_vs_sampler_policy": 346.0}}, "num_env_steps_sampled": 5141040, "num_env_steps_trained": 5141040, "num_agent_steps_sampled": 5141040, "num_agent_steps_trained": 5141040}, "sampler_results": {"episode_reward_max": 196360.22686401205, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 194124.88169986263, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4093783757725085, "mean_inference_ms": 0.26047632130895954, "mean_action_processing_ms": 0.05864695954910427, "mean_env_wait_ms": 0.8329503224960986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002403736114501953, "StateBufferConnector_ms": 0.0016865730285644531, "ViewRequirementAgentConnector_ms": 0.04482603073120117}}, "episode_reward_max": 196360.22686401205, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 194124.88169986263, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [196360.22686401205, 196198.46099806463, 195963.14252498135, 195494.8637691065, 195556.83855342912, 195359.7084353602, 195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4093783757725085, "mean_inference_ms": 0.26047632130895954, "mean_action_processing_ms": 0.05864695954910427, "mean_env_wait_ms": 0.8329503224960986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002403736114501953, "StateBufferConnector_ms": 0.0016865730285644531, "ViewRequirementAgentConnector_ms": 0.04482603073120117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5141040, "num_agent_steps_trained": 5141040, "num_env_steps_sampled": 5141040, "num_env_steps_trained": 5141040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.24819093192156, "num_env_steps_trained_throughput_per_sec": 186.24819093192156, "timesteps_total": 5141040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5141040, "timers": {"training_iteration_time_ms": 1930.293, "sample_time_ms": 1925.431, "load_time_ms": 0.22, "load_throughput": 1633614.021, "learn_time_ms": 4.092, "learn_throughput": 87982.65, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 5141040, "num_env_steps_trained": 5141040, "num_agent_steps_sampled": 5141040, "num_agent_steps_trained": 5141040}, "done": false, "episodes_total": 1325, "training_iteration": 600, "trial_id": "19aa9_00000", "date": "2023-07-25_15-20-29", "timestamp": 1690287629, "time_this_iter_s": 11.599470138549805, "time_total_s": 10408.4498128891, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 228.8182692527771, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 25.2375, "ram_util_percent": 76.81875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.7500000000000004e-06, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9144287109375, "policy_loss": 1919932508715690.8, "vf_loss": 62444522837.333336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 365.0, "diff_num_grad_updates_vs_sampler_policy": 364.0}}, "num_env_steps_sampled": 5143200, "num_env_steps_trained": 5143200, "num_agent_steps_sampled": 5143200, "num_agent_steps_trained": 5143200}, "sampler_results": {"episode_reward_max": 195240.58578972062, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 194009.3970250719, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408836995174445, "mean_inference_ms": 0.26010780464662775, "mean_action_processing_ms": 0.05858957372542257, "mean_env_wait_ms": 0.8064958513846117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024061203002929688, "StateBufferConnector_ms": 0.001683950424194336, "ViewRequirementAgentConnector_ms": 0.04487442970275879}}, "episode_reward_max": 195240.58578972062, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 194009.3970250719, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [195146.36929534687, 195240.58578972062, 194732.46261825768, 194106.65636613924, 193957.51487931533, 193772.8893518876, 193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408836995174445, "mean_inference_ms": 0.26010780464662775, "mean_action_processing_ms": 0.05858957372542257, "mean_env_wait_ms": 0.8064958513846117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024061203002929688, "StateBufferConnector_ms": 0.001683950424194336, "ViewRequirementAgentConnector_ms": 0.04487442970275879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5143200, "num_agent_steps_trained": 5143200, "num_env_steps_sampled": 5143200, "num_env_steps_trained": 5143200, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.28176467458036, "num_env_steps_trained_throughput_per_sec": 186.28176467458036, "timesteps_total": 5143200, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5143200, "timers": {"training_iteration_time_ms": 1934.603, "sample_time_ms": 1929.66, "load_time_ms": 0.219, "load_throughput": 1641606.262, "learn_time_ms": 4.17, "learn_throughput": 86340.55, "synch_weights_time_ms": 0.521}, "counters": {"num_env_steps_sampled": 5143200, "num_env_steps_trained": 5143200, "num_agent_steps_sampled": 5143200, "num_agent_steps_trained": 5143200}, "done": false, "episodes_total": 1331, "training_iteration": 601, "trial_id": "19aa9_00000", "date": "2023-07-25_15-20-41", "timestamp": 1690287641, "time_this_iter_s": 11.59741997718811, "time_total_s": 10420.047232866287, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 240.4156892299652, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 27.329411764705885, "ram_util_percent": 76.86470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7500000000000002e-06, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9144287109375, "policy_loss": 237391346008064.0, "vf_loss": 62480523264.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 382.0}}, "num_env_steps_sampled": 5145360, "num_env_steps_trained": 5145360, "num_agent_steps_sampled": 5145360, "num_agent_steps_trained": 5145360}, "sampler_results": {"episode_reward_max": 194461.0771983978, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193971.85792910843, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408322972253988, "mean_inference_ms": 0.259806679262047, "mean_action_processing_ms": 0.05853957732769885, "mean_env_wait_ms": 0.7863102712462012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024085044860839844, "StateBufferConnector_ms": 0.0016818046569824219, "ViewRequirementAgentConnector_ms": 0.04483532905578613}}, "episode_reward_max": 194461.0771983978, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193971.85792910843, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193789.32362938576, 193483.71259775542, 193573.43349996046, 193630.1780226211, 193716.33854146762, 193839.03342717787, 193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408322972253988, "mean_inference_ms": 0.259806679262047, "mean_action_processing_ms": 0.05853957732769885, "mean_env_wait_ms": 0.7863102712462012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024085044860839844, "StateBufferConnector_ms": 0.0016818046569824219, "ViewRequirementAgentConnector_ms": 0.04483532905578613}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5145360, "num_agent_steps_trained": 5145360, "num_env_steps_sampled": 5145360, "num_env_steps_trained": 5145360, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.5936226420985, "num_env_steps_trained_throughput_per_sec": 185.5936226420985, "timesteps_total": 5145360, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5145360, "timers": {"training_iteration_time_ms": 1935.075, "sample_time_ms": 1930.039, "load_time_ms": 0.227, "load_throughput": 1586247.967, "learn_time_ms": 4.239, "learn_throughput": 84930.25, "synch_weights_time_ms": 0.535}, "counters": {"num_env_steps_sampled": 5145360, "num_env_steps_trained": 5145360, "num_agent_steps_sampled": 5145360, "num_agent_steps_trained": 5145360}, "done": false, "episodes_total": 1337, "training_iteration": 602, "trial_id": "19aa9_00000", "date": "2023-07-25_15-20-52", "timestamp": 1690287652, "time_this_iter_s": 11.640451908111572, "time_total_s": 10431.687684774399, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 252.05614113807678, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 30.5625, "ram_util_percent": 76.53125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.499999999999999e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9144287109375, "policy_loss": 10617847633237.334, "vf_loss": 62607608490.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 401.0, "diff_num_grad_updates_vs_sampler_policy": 400.0}}, "num_env_steps_sampled": 5147520, "num_env_steps_trained": 5147520, "num_agent_steps_sampled": 5147520, "num_agent_steps_trained": 5147520}, "sampler_results": {"episode_reward_max": 194461.0771983978, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193992.6809448174, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407860137857819, "mean_inference_ms": 0.2595980050279302, "mean_action_processing_ms": 0.05850356083259157, "mean_env_wait_ms": 0.770752640683886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024127960205078125, "StateBufferConnector_ms": 0.0016846656799316406, "ViewRequirementAgentConnector_ms": 0.045046329498291016}}, "episode_reward_max": 194461.0771983978, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193992.6809448174, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193675.91705385948, 193935.0022446446, 193899.1862379675, 193793.24760438275, 193985.58966288008, 193753.1962161454, 193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407860137857819, "mean_inference_ms": 0.2595980050279302, "mean_action_processing_ms": 0.05850356083259157, "mean_env_wait_ms": 0.770752640683886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024127960205078125, "StateBufferConnector_ms": 0.0016846656799316406, "ViewRequirementAgentConnector_ms": 0.045046329498291016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5147520, "num_agent_steps_trained": 5147520, "num_env_steps_sampled": 5147520, "num_env_steps_trained": 5147520, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.04710168030184, "num_env_steps_trained_throughput_per_sec": 186.04710168030184, "timesteps_total": 5147520, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5147520, "timers": {"training_iteration_time_ms": 1935.83, "sample_time_ms": 1930.856, "load_time_ms": 0.224, "load_throughput": 1605816.697, "learn_time_ms": 4.196, "learn_throughput": 85792.094, "synch_weights_time_ms": 0.519}, "counters": {"num_env_steps_sampled": 5147520, "num_env_steps_trained": 5147520, "num_agent_steps_sampled": 5147520, "num_agent_steps_trained": 5147520}, "done": false, "episodes_total": 1343, "training_iteration": 603, "trial_id": "19aa9_00000", "date": "2023-07-25_15-21-04", "timestamp": 1690287664, "time_this_iter_s": 11.61224913597107, "time_total_s": 10443.29993391037, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 263.66839027404785, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 27.076470588235292, "ram_util_percent": 76.51176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.5e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9144287109375, "policy_loss": 4244454247082.6665, "vf_loss": 62343849301.333336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 419.0, "diff_num_grad_updates_vs_sampler_policy": 418.0}}, "num_env_steps_sampled": 5149680, "num_env_steps_trained": 5149680, "num_agent_steps_sampled": 5149680, "num_agent_steps_trained": 5149680}, "sampler_results": {"episode_reward_max": 194461.0771983978, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 194003.5066184186, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407653734569448, "mean_inference_ms": 0.2594197327130268, "mean_action_processing_ms": 0.05847140739540313, "mean_env_wait_ms": 0.7582782421378471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023949146270751953, "StateBufferConnector_ms": 0.0016825199127197266, "ViewRequirementAgentConnector_ms": 0.0448756217956543}}, "episode_reward_max": 194461.0771983978, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 194003.5066184186, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193803.74651597755, 194047.7208746011, 194258.69191113018, 194196.89963172557, 194205.27797108045, 194289.88949338676, 194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407653734569448, "mean_inference_ms": 0.2594197327130268, "mean_action_processing_ms": 0.05847140739540313, "mean_env_wait_ms": 0.7582782421378471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023949146270751953, "StateBufferConnector_ms": 0.0016825199127197266, "ViewRequirementAgentConnector_ms": 0.0448756217956543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5149680, "num_agent_steps_trained": 5149680, "num_env_steps_sampled": 5149680, "num_env_steps_trained": 5149680, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.1906799442741, "num_env_steps_trained_throughput_per_sec": 186.1906799442741, "timesteps_total": 5149680, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5149680, "timers": {"training_iteration_time_ms": 1934.985, "sample_time_ms": 1929.687, "load_time_ms": 0.229, "load_throughput": 1572700.177, "learn_time_ms": 4.464, "learn_throughput": 80649.353, "synch_weights_time_ms": 0.57}, "counters": {"num_env_steps_sampled": 5149680, "num_env_steps_trained": 5149680, "num_agent_steps_sampled": 5149680, "num_agent_steps_trained": 5149680}, "done": false, "episodes_total": 1349, "training_iteration": 604, "trial_id": "19aa9_00000", "date": "2023-07-25_15-21-16", "timestamp": 1690287676, "time_this_iter_s": 11.603168964385986, "time_total_s": 10454.903102874756, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 275.27155923843384, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 26.768749999999997, "ram_util_percent": 76.79375000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.7999999999999996e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9112548828125, "policy_loss": 44875149301077.336, "vf_loss": 62414893056.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 437.0, "diff_num_grad_updates_vs_sampler_policy": 436.0}}, "num_env_steps_sampled": 5151840, "num_env_steps_trained": 5151840, "num_agent_steps_sampled": 5151840, "num_agent_steps_trained": 5151840}, "sampler_results": {"episode_reward_max": 194461.0771983978, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193995.66810334008, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407706736556911, "mean_inference_ms": 0.25923385153414946, "mean_action_processing_ms": 0.05843851664402603, "mean_env_wait_ms": 0.747852568153769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023908615112304688, "StateBufferConnector_ms": 0.001683950424194336, "ViewRequirementAgentConnector_ms": 0.04491376876831055}}, "episode_reward_max": 194461.0771983978, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193995.66810334008, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [194439.06564880873, 194155.83888229748, 194370.46131527162, 194314.66526040368, 194196.1125003033, 194260.92314126887, 194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.407706736556911, "mean_inference_ms": 0.25923385153414946, "mean_action_processing_ms": 0.05843851664402603, "mean_env_wait_ms": 0.747852568153769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023908615112304688, "StateBufferConnector_ms": 0.001683950424194336, "ViewRequirementAgentConnector_ms": 0.04491376876831055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5151840, "num_agent_steps_trained": 5151840, "num_env_steps_sampled": 5151840, "num_env_steps_trained": 5151840, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.47195817569732, "num_env_steps_trained_throughput_per_sec": 186.47195817569732, "timesteps_total": 5151840, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5151840, "timers": {"training_iteration_time_ms": 1932.658, "sample_time_ms": 1927.708, "load_time_ms": 0.225, "load_throughput": 1597830.095, "learn_time_ms": 4.17, "learn_throughput": 86326.235, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 5151840, "num_env_steps_trained": 5151840, "num_agent_steps_sampled": 5151840, "num_agent_steps_trained": 5151840}, "done": false, "episodes_total": 1355, "training_iteration": 605, "trial_id": "19aa9_00000", "date": "2023-07-25_15-21-27", "timestamp": 1690287687, "time_this_iter_s": 11.585581064224243, "time_total_s": 10466.48868393898, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 286.8571403026581, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 24.258823529411764, "ram_util_percent": 76.96470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3999999999999998e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9071451822917, "policy_loss": 385349682018.6667, "vf_loss": 62451192490.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 455.0, "diff_num_grad_updates_vs_sampler_policy": 454.0}}, "num_env_steps_sampled": 5154000, "num_env_steps_trained": 5154000, "num_agent_steps_sampled": 5154000, "num_agent_steps_trained": 5154000}, "sampler_results": {"episode_reward_max": 194461.0771983978, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193978.8382511506, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4079419941003515, "mean_inference_ms": 0.2590538075244029, "mean_action_processing_ms": 0.05840673486087772, "mean_env_wait_ms": 0.738860012087713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024003982543945312, "StateBufferConnector_ms": 0.001688241958618164, "ViewRequirementAgentConnector_ms": 0.04503512382507324}}, "episode_reward_max": 194461.0771983978, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193978.8382511506, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [194434.70912106638, 194417.51467358292, 194322.36898636754, 194461.0771983978, 194067.16712295916, 194274.51722692, 194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4079419941003515, "mean_inference_ms": 0.2590538075244029, "mean_action_processing_ms": 0.05840673486087772, "mean_env_wait_ms": 0.738860012087713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024003982543945312, "StateBufferConnector_ms": 0.001688241958618164, "ViewRequirementAgentConnector_ms": 0.04503512382507324}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5154000, "num_agent_steps_trained": 5154000, "num_env_steps_sampled": 5154000, "num_env_steps_trained": 5154000, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.92013034709885, "num_env_steps_trained_throughput_per_sec": 185.92013034709885, "timesteps_total": 5154000, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5154000, "timers": {"training_iteration_time_ms": 1935.131, "sample_time_ms": 1930.026, "load_time_ms": 0.223, "load_throughput": 1617687.422, "learn_time_ms": 4.298, "learn_throughput": 83764.157, "synch_weights_time_ms": 0.547}, "counters": {"num_env_steps_sampled": 5154000, "num_env_steps_trained": 5154000, "num_agent_steps_sampled": 5154000, "num_agent_steps_trained": 5154000}, "done": false, "episodes_total": 1361, "training_iteration": 606, "trial_id": "19aa9_00000", "date": "2023-07-25_15-21-39", "timestamp": 1690287699, "time_this_iter_s": 11.619924068450928, "time_total_s": 10478.108608007431, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 298.477064371109, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 27.16875, "ram_util_percent": 77.19375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.91015625, "policy_loss": 770556340906.6666, "vf_loss": 62414355114.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 5156160, "num_env_steps_trained": 5156160, "num_agent_steps_sampled": 5156160, "num_agent_steps_trained": 5156160}, "sampler_results": {"episode_reward_max": 194272.99678839752, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193957.62520283984, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408216208103296, "mean_inference_ms": 0.2588774067417867, "mean_action_processing_ms": 0.05837609437612296, "mean_env_wait_ms": 0.7309524953053542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002415180206298828, "StateBufferConnector_ms": 0.0016872882843017578, "ViewRequirementAgentConnector_ms": 0.04513096809387207}}, "episode_reward_max": 194272.99678839752, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193957.62520283984, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [194153.6270594485, 194072.66303215656, 193861.52597503844, 194272.99678839752, 194237.33860731425, 194030.71775702602, 194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408216208103296, "mean_inference_ms": 0.2588774067417867, "mean_action_processing_ms": 0.05837609437612296, "mean_env_wait_ms": 0.7309524953053542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002415180206298828, "StateBufferConnector_ms": 0.0016872882843017578, "ViewRequirementAgentConnector_ms": 0.04513096809387207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5156160, "num_agent_steps_trained": 5156160, "num_env_steps_sampled": 5156160, "num_env_steps_trained": 5156160, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.06508318609704, "num_env_steps_trained_throughput_per_sec": 186.06508318609704, "timesteps_total": 5156160, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5156160, "timers": {"training_iteration_time_ms": 1934.139, "sample_time_ms": 1929.11, "load_time_ms": 0.221, "load_throughput": 1628328.955, "learn_time_ms": 4.219, "learn_throughput": 85324.268, "synch_weights_time_ms": 0.555}, "counters": {"num_env_steps_sampled": 5156160, "num_env_steps_trained": 5156160, "num_agent_steps_sampled": 5156160, "num_agent_steps_trained": 5156160}, "done": false, "episodes_total": 1367, "training_iteration": 607, "trial_id": "19aa9_00000", "date": "2023-07-25_15-21-50", "timestamp": 1690287710, "time_this_iter_s": 11.61084508895874, "time_total_s": 10489.71945309639, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 310.08790946006775, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 28.53529411764706, "ram_util_percent": 77.0529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9108479817708, "policy_loss": 1491581934524.0, "vf_loss": 62328694784.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 491.0, "diff_num_grad_updates_vs_sampler_policy": 490.0}}, "num_env_steps_sampled": 5158320, "num_env_steps_trained": 5158320, "num_agent_steps_sampled": 5158320, "num_agent_steps_trained": 5158320}, "sampler_results": {"episode_reward_max": 194261.36537415753, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193946.62148606594, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408485722080911, "mean_inference_ms": 0.25871609694918335, "mean_action_processing_ms": 0.05834723633404915, "mean_env_wait_ms": 0.7239918138823589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002420663833618164, "StateBufferConnector_ms": 0.0016856193542480469, "ViewRequirementAgentConnector_ms": 0.04514122009277344}}, "episode_reward_max": 194261.36537415753, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193946.62148606594, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [194087.48985172252, 194240.8719986853, 194128.16453419407, 193901.73612659707, 193878.43673074516, 194235.95589546725, 193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408485722080911, "mean_inference_ms": 0.25871609694918335, "mean_action_processing_ms": 0.05834723633404915, "mean_env_wait_ms": 0.7239918138823589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002420663833618164, "StateBufferConnector_ms": 0.0016856193542480469, "ViewRequirementAgentConnector_ms": 0.04514122009277344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5158320, "num_agent_steps_trained": 5158320, "num_env_steps_sampled": 5158320, "num_env_steps_trained": 5158320, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.42050763386675, "num_env_steps_trained_throughput_per_sec": 186.42050763386675, "timesteps_total": 5158320, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5158320, "timers": {"training_iteration_time_ms": 1934.837, "sample_time_ms": 1930.072, "load_time_ms": 0.217, "load_throughput": 1661841.779, "learn_time_ms": 4.013, "learn_throughput": 89718.266, "synch_weights_time_ms": 0.504}, "counters": {"num_env_steps_sampled": 5158320, "num_env_steps_trained": 5158320, "num_agent_steps_sampled": 5158320, "num_agent_steps_trained": 5158320}, "done": false, "episodes_total": 1373, "training_iteration": 608, "trial_id": "19aa9_00000", "date": "2023-07-25_15-22-02", "timestamp": 1690287722, "time_this_iter_s": 11.588937044143677, "time_total_s": 10501.308390140533, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 321.6768465042114, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 24.975, "ram_util_percent": 77.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9230143229167, "policy_loss": 413208756224.0, "vf_loss": 62316085248.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 509.0, "diff_num_grad_updates_vs_sampler_policy": 508.0}}, "num_env_steps_sampled": 5160480, "num_env_steps_trained": 5160480, "num_agent_steps_sampled": 5160480, "num_agent_steps_trained": 5160480}, "sampler_results": {"episode_reward_max": 194261.36537415753, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193937.04035169282, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408792742372932, "mean_inference_ms": 0.25857103236016693, "mean_action_processing_ms": 0.05832066126531967, "mean_env_wait_ms": 0.7178226478164461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024116039276123047, "StateBufferConnector_ms": 0.00168609619140625, "ViewRequirementAgentConnector_ms": 0.044992685317993164}}, "episode_reward_max": 194261.36537415753, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193937.04035169282, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193609.94359560648, 193723.76102105886, 194085.7966548225, 193950.50146865417, 193936.34483142864, 193851.34085548602, 193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408792742372932, "mean_inference_ms": 0.25857103236016693, "mean_action_processing_ms": 0.05832066126531967, "mean_env_wait_ms": 0.7178226478164461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024116039276123047, "StateBufferConnector_ms": 0.00168609619140625, "ViewRequirementAgentConnector_ms": 0.044992685317993164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5160480, "num_agent_steps_trained": 5160480, "num_env_steps_sampled": 5160480, "num_env_steps_trained": 5160480, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.45438377667696, "num_env_steps_trained_throughput_per_sec": 185.45438377667696, "timesteps_total": 5160480, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5160480, "timers": {"training_iteration_time_ms": 1939.837, "sample_time_ms": 1934.978, "load_time_ms": 0.222, "load_throughput": 1624474.922, "learn_time_ms": 4.108, "learn_throughput": 87624.735, "synch_weights_time_ms": 0.496}, "counters": {"num_env_steps_sampled": 5160480, "num_env_steps_trained": 5160480, "num_agent_steps_sampled": 5160480, "num_agent_steps_trained": 5160480}, "done": false, "episodes_total": 1379, "training_iteration": 609, "trial_id": "19aa9_00000", "date": "2023-07-25_15-22-14", "timestamp": 1690287734, "time_this_iter_s": 11.649189233779907, "time_total_s": 10512.957579374313, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 333.32603573799133, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 25.011764705882353, "ram_util_percent": 77.13529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9268798828125, "policy_loss": 440902767957.3333, "vf_loss": 62344467114.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 527.0, "diff_num_grad_updates_vs_sampler_policy": 526.0}}, "num_env_steps_sampled": 5162640, "num_env_steps_trained": 5162640, "num_agent_steps_sampled": 5162640, "num_agent_steps_trained": 5162640}, "sampler_results": {"episode_reward_max": 194261.36537415753, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193941.26597901515, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408956306633378, "mean_inference_ms": 0.25844466223182727, "mean_action_processing_ms": 0.058297749214485585, "mean_env_wait_ms": 0.7123344498278277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002413034439086914, "StateBufferConnector_ms": 0.0016798973083496094, "ViewRequirementAgentConnector_ms": 0.044945716857910156}}, "episode_reward_max": 194261.36537415753, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193941.26597901515, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193899.67300941076, 194031.89478633628, 194160.3324259411, 194002.38687205737, 193801.96654180766, 193976.4454340222, 193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.408956306633378, "mean_inference_ms": 0.25844466223182727, "mean_action_processing_ms": 0.058297749214485585, "mean_env_wait_ms": 0.7123344498278277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002413034439086914, "StateBufferConnector_ms": 0.0016798973083496094, "ViewRequirementAgentConnector_ms": 0.044945716857910156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5162640, "num_agent_steps_trained": 5162640, "num_env_steps_sampled": 5162640, "num_env_steps_trained": 5162640, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 187.03718390689744, "num_env_steps_trained_throughput_per_sec": 187.03718390689744, "timesteps_total": 5162640, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5162640, "timers": {"training_iteration_time_ms": 1925.869, "sample_time_ms": 1920.993, "load_time_ms": 0.216, "load_throughput": 1667346.996, "learn_time_ms": 4.126, "learn_throughput": 87261.652, "synch_weights_time_ms": 0.502}, "counters": {"num_env_steps_sampled": 5162640, "num_env_steps_trained": 5162640, "num_agent_steps_sampled": 5162640, "num_agent_steps_trained": 5162640}, "done": false, "episodes_total": 1385, "training_iteration": 610, "trial_id": "19aa9_00000", "date": "2023-07-25_15-22-25", "timestamp": 1690287745, "time_this_iter_s": 11.550559997558594, "time_total_s": 10524.508139371872, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 344.8765957355499, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 23.83125, "ram_util_percent": 77.25000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.92724609375, "policy_loss": 670672920234.6666, "vf_loss": 62329188352.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 545.0, "diff_num_grad_updates_vs_sampler_policy": 544.0}}, "num_env_steps_sampled": 5164800, "num_env_steps_trained": 5164800, "num_agent_steps_sampled": 5164800, "num_agent_steps_trained": 5164800}, "sampler_results": {"episode_reward_max": 194261.36537415753, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193940.24938730334, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409167222357343, "mean_inference_ms": 0.25833753542510407, "mean_action_processing_ms": 0.058277733871443596, "mean_env_wait_ms": 0.7074608141155164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024161338806152344, "StateBufferConnector_ms": 0.0016810894012451172, "ViewRequirementAgentConnector_ms": 0.045049190521240234}}, "episode_reward_max": 194261.36537415753, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193940.24938730334, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193822.48520767177, 193890.0023729726, 193968.2312678232, 194025.50552683006, 193935.91394893176, 193964.53964820105, 193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409167222357343, "mean_inference_ms": 0.25833753542510407, "mean_action_processing_ms": 0.058277733871443596, "mean_env_wait_ms": 0.7074608141155164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024161338806152344, "StateBufferConnector_ms": 0.0016810894012451172, "ViewRequirementAgentConnector_ms": 0.045049190521240234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5164800, "num_agent_steps_trained": 5164800, "num_env_steps_sampled": 5164800, "num_env_steps_trained": 5164800, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.23686444172023, "num_env_steps_trained_throughput_per_sec": 185.23686444172023, "timesteps_total": 5164800, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5164800, "timers": {"training_iteration_time_ms": 1936.612, "sample_time_ms": 1931.85, "load_time_ms": 0.216, "load_throughput": 1666610.861, "learn_time_ms": 4.019, "learn_throughput": 89567.124, "synch_weights_time_ms": 0.494}, "counters": {"num_env_steps_sampled": 5164800, "num_env_steps_trained": 5164800, "num_agent_steps_sampled": 5164800, "num_agent_steps_trained": 5164800}, "done": false, "episodes_total": 1391, "training_iteration": 611, "trial_id": "19aa9_00000", "date": "2023-07-25_15-22-37", "timestamp": 1690287757, "time_this_iter_s": 11.662847995758057, "time_total_s": 10536.17098736763, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 356.539443731308, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 25.2, "ram_util_percent": 77.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9273681640625, "policy_loss": 1086982908586.6666, "vf_loss": 62575831722.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 562.0}}, "num_env_steps_sampled": 5166960, "num_env_steps_trained": 5166960, "num_agent_steps_sampled": 5166960, "num_agent_steps_trained": 5166960}, "sampler_results": {"episode_reward_max": 194261.36537415753, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193944.8910719096, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4092972048832815, "mean_inference_ms": 0.2582475075344682, "mean_action_processing_ms": 0.058260432117065136, "mean_env_wait_ms": 0.7031318515476473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024106502532958984, "StateBufferConnector_ms": 0.001672983169555664, "ViewRequirementAgentConnector_ms": 0.044979095458984375}}, "episode_reward_max": 194261.36537415753, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193944.8910719096, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193819.85407031456, 193840.16893280152, 193901.9350552897, 193681.98415863214, 194178.81753457763, 194070.01458821088, 193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4092972048832815, "mean_inference_ms": 0.2582475075344682, "mean_action_processing_ms": 0.058260432117065136, "mean_env_wait_ms": 0.7031318515476473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024106502532958984, "StateBufferConnector_ms": 0.001672983169555664, "ViewRequirementAgentConnector_ms": 0.044979095458984375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5166960, "num_agent_steps_trained": 5166960, "num_env_steps_sampled": 5166960, "num_env_steps_trained": 5166960, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.17962582930542, "num_env_steps_trained_throughput_per_sec": 186.17962582930542, "timesteps_total": 5166960, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5166960, "timers": {"training_iteration_time_ms": 1938.247, "sample_time_ms": 1932.631, "load_time_ms": 0.219, "load_throughput": 1647157.674, "learn_time_ms": 4.395, "learn_throughput": 81902.67, "synch_weights_time_ms": 0.925}, "counters": {"num_env_steps_sampled": 5166960, "num_env_steps_trained": 5166960, "num_agent_steps_sampled": 5166960, "num_agent_steps_trained": 5166960}, "done": false, "episodes_total": 1397, "training_iteration": 612, "trial_id": "19aa9_00000", "date": "2023-07-25_15-22-49", "timestamp": 1690287769, "time_this_iter_s": 11.603814840316772, "time_total_s": 10547.774802207947, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 368.14325857162476, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 24.8, "ram_util_percent": 76.77058823529413}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9273681640625, "policy_loss": 227471993514.66666, "vf_loss": 62444014250.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 581.0, "diff_num_grad_updates_vs_sampler_policy": 580.0}}, "num_env_steps_sampled": 5169120, "num_env_steps_trained": 5169120, "num_agent_steps_sampled": 5169120, "num_agent_steps_trained": 5169120}, "sampler_results": {"episode_reward_max": 194261.36537415753, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193947.12441352478, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409406653175283, "mean_inference_ms": 0.258161497381403, "mean_action_processing_ms": 0.0582438445053807, "mean_env_wait_ms": 0.6992181787355003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024247169494628906, "StateBufferConnector_ms": 0.0016782283782958984, "ViewRequirementAgentConnector_ms": 0.04504132270812988}}, "episode_reward_max": 194261.36537415753, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193947.12441352478, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193850.57241312024, 194174.72342218753, 193727.49933692985, 193810.54453366832, 193916.10659816978, 193982.4228452542, 193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409406653175283, "mean_inference_ms": 0.258161497381403, "mean_action_processing_ms": 0.0582438445053807, "mean_env_wait_ms": 0.6992181787355003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024247169494628906, "StateBufferConnector_ms": 0.0016782283782958984, "ViewRequirementAgentConnector_ms": 0.04504132270812988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5169120, "num_agent_steps_trained": 5169120, "num_env_steps_sampled": 5169120, "num_env_steps_trained": 5169120, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 187.03109085180486, "num_env_steps_trained_throughput_per_sec": 187.03109085180486, "timesteps_total": 5169120, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5169120, "timers": {"training_iteration_time_ms": 1927.207, "sample_time_ms": 1922.393, "load_time_ms": 0.222, "load_throughput": 1618554.443, "learn_time_ms": 4.045, "learn_throughput": 88988.587, "synch_weights_time_ms": 0.514}, "counters": {"num_env_steps_sampled": 5169120, "num_env_steps_trained": 5169120, "num_agent_steps_sampled": 5169120, "num_agent_steps_trained": 5169120}, "done": false, "episodes_total": 1403, "training_iteration": 613, "trial_id": "19aa9_00000", "date": "2023-07-25_15-23-00", "timestamp": 1690287780, "time_this_iter_s": 11.551209926605225, "time_total_s": 10559.326012134552, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 379.69446849823, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 25.5125, "ram_util_percent": 76.6375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9273681640625, "policy_loss": 671330644992.0, "vf_loss": 62329272320.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 599.0, "diff_num_grad_updates_vs_sampler_policy": 598.0}}, "num_env_steps_sampled": 5171280, "num_env_steps_trained": 5171280, "num_agent_steps_sampled": 5171280, "num_agent_steps_trained": 5171280}, "sampler_results": {"episode_reward_max": 194261.36537415753, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193945.60687335502, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409497396115788, "mean_inference_ms": 0.2580720008692136, "mean_action_processing_ms": 0.05822621660836118, "mean_env_wait_ms": 0.6955975986371173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024213790893554688, "StateBufferConnector_ms": 0.0016813278198242188, "ViewRequirementAgentConnector_ms": 0.04506993293762207}}, "episode_reward_max": 194261.36537415753, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193945.60687335502, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193938.1570841798, 194118.36508111973, 193948.50299796733, 193839.05084433366, 193817.80595250236, 193879.59305914002, 193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409497396115788, "mean_inference_ms": 0.2580720008692136, "mean_action_processing_ms": 0.05822621660836118, "mean_env_wait_ms": 0.6955975986371173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024213790893554688, "StateBufferConnector_ms": 0.0016813278198242188, "ViewRequirementAgentConnector_ms": 0.04506993293762207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5171280, "num_agent_steps_trained": 5171280, "num_env_steps_sampled": 5171280, "num_env_steps_trained": 5171280, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.12734606121316, "num_env_steps_trained_throughput_per_sec": 186.12734606121316, "timesteps_total": 5171280, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5171280, "timers": {"training_iteration_time_ms": 1931.317, "sample_time_ms": 1926.478, "load_time_ms": 0.226, "load_throughput": 1591766.224, "learn_time_ms": 4.067, "learn_throughput": 88519.07, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 5171280, "num_env_steps_trained": 5171280, "num_agent_steps_sampled": 5171280, "num_agent_steps_trained": 5171280}, "done": false, "episodes_total": 1409, "training_iteration": 614, "trial_id": "19aa9_00000", "date": "2023-07-25_15-23-12", "timestamp": 1690287792, "time_this_iter_s": 11.60707688331604, "time_total_s": 10570.933089017868, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 391.301545381546, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 25.81764705882353, "ram_util_percent": 76.97058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9273681640625, "policy_loss": 493137293312.0, "vf_loss": 62425223168.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 617.0, "diff_num_grad_updates_vs_sampler_policy": 616.0}}, "num_env_steps_sampled": 5173440, "num_env_steps_trained": 5173440, "num_agent_steps_sampled": 5173440, "num_agent_steps_trained": 5173440}, "sampler_results": {"episode_reward_max": 194261.36537415753, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193950.74813959538, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409532178515997, "mean_inference_ms": 0.25798747450636816, "mean_action_processing_ms": 0.0582096050471295, "mean_env_wait_ms": 0.6922938544122758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024352073669433594, "StateBufferConnector_ms": 0.0016872882843017578, "ViewRequirementAgentConnector_ms": 0.045066118240356445}}, "episode_reward_max": 194261.36537415753, "episode_reward_min": 193375.35300576338, "episode_reward_mean": 193950.74813959538, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193769.8396434718, 193783.23762332517, 193879.77859308003, 193916.4922482702, 193375.35300576338, 193851.71177667705, 194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409532178515997, "mean_inference_ms": 0.25798747450636816, "mean_action_processing_ms": 0.0582096050471295, "mean_env_wait_ms": 0.6922938544122758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024352073669433594, "StateBufferConnector_ms": 0.0016872882843017578, "ViewRequirementAgentConnector_ms": 0.045066118240356445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5173440, "num_agent_steps_trained": 5173440, "num_env_steps_sampled": 5173440, "num_env_steps_trained": 5173440, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.28958490205, "num_env_steps_trained_throughput_per_sec": 185.28958490205, "timesteps_total": 5173440, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5173440, "timers": {"training_iteration_time_ms": 1935.434, "sample_time_ms": 1930.507, "load_time_ms": 0.222, "load_throughput": 1623950.785, "learn_time_ms": 4.133, "learn_throughput": 87098.565, "synch_weights_time_ms": 0.538}, "counters": {"num_env_steps_sampled": 5173440, "num_env_steps_trained": 5173440, "num_agent_steps_sampled": 5173440, "num_agent_steps_trained": 5173440}, "done": false, "episodes_total": 1415, "training_iteration": 615, "trial_id": "19aa9_00000", "date": "2023-07-25_15-23-23", "timestamp": 1690287803, "time_this_iter_s": 11.659661054611206, "time_total_s": 10582.59275007248, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 402.9612064361572, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 23.68125, "ram_util_percent": 77.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9273681640625, "policy_loss": 378308576597.3333, "vf_loss": 62460803754.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 635.0, "diff_num_grad_updates_vs_sampler_policy": 634.0}}, "num_env_steps_sampled": 5175600, "num_env_steps_trained": 5175600, "num_agent_steps_sampled": 5175600, "num_agent_steps_trained": 5175600}, "sampler_results": {"episode_reward_max": 194261.36537415753, "episode_reward_min": 193404.27002919707, "episode_reward_mean": 193964.10687747886, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409615323160151, "mean_inference_ms": 0.25791148400606667, "mean_action_processing_ms": 0.05819474595327616, "mean_env_wait_ms": 0.6892580036955104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002440929412841797, "StateBufferConnector_ms": 0.0016925334930419922, "ViewRequirementAgentConnector_ms": 0.045098066329956055}}, "episode_reward_max": 194261.36537415753, "episode_reward_min": 193404.27002919707, "episode_reward_mean": 193964.10687747886, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [194146.81226755338, 193910.84607576503, 193941.65028285014, 194197.2144758345, 193404.27002919707, 193996.67901124872, 194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409615323160151, "mean_inference_ms": 0.25791148400606667, "mean_action_processing_ms": 0.05819474595327616, "mean_env_wait_ms": 0.6892580036955104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002440929412841797, "StateBufferConnector_ms": 0.0016925334930419922, "ViewRequirementAgentConnector_ms": 0.045098066329956055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5175600, "num_agent_steps_trained": 5175600, "num_env_steps_sampled": 5175600, "num_env_steps_trained": 5175600, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.7598200111607, "num_env_steps_trained_throughput_per_sec": 185.7598200111607, "timesteps_total": 5175600, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5175600, "timers": {"training_iteration_time_ms": 1939.652, "sample_time_ms": 1934.842, "load_time_ms": 0.218, "load_throughput": 1652385.03, "learn_time_ms": 4.056, "learn_throughput": 88762.077, "synch_weights_time_ms": 0.503}, "counters": {"num_env_steps_sampled": 5175600, "num_env_steps_trained": 5175600, "num_agent_steps_sampled": 5175600, "num_agent_steps_trained": 5175600}, "done": false, "episodes_total": 1421, "training_iteration": 616, "trial_id": "19aa9_00000", "date": "2023-07-25_15-23-35", "timestamp": 1690287815, "time_this_iter_s": 11.630048036575317, "time_total_s": 10594.222798109055, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 414.59125447273254, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 25.011764705882353, "ram_util_percent": 77.24117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9273681640625, "policy_loss": 402848592554.6667, "vf_loss": 62395060906.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 653.0, "diff_num_grad_updates_vs_sampler_policy": 652.0}}, "num_env_steps_sampled": 5177760, "num_env_steps_trained": 5177760, "num_agent_steps_sampled": 5177760, "num_agent_steps_trained": 5177760}, "sampler_results": {"episode_reward_max": 194261.36537415753, "episode_reward_min": 193592.87382144344, "episode_reward_mean": 193967.46069514044, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409636365948765, "mean_inference_ms": 0.2578543076766393, "mean_action_processing_ms": 0.05818332572085267, "mean_env_wait_ms": 0.6865011935527195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024755001068115234, "StateBufferConnector_ms": 0.0017015933990478516, "ViewRequirementAgentConnector_ms": 0.045440673828125}}, "episode_reward_max": 194261.36537415753, "episode_reward_min": 193592.87382144344, "episode_reward_mean": 193967.46069514044, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [194108.65013373978, 193966.00355062302, 193825.65394792802, 194083.5169931477, 193700.76537544472, 193825.78545570013, 193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409636365948765, "mean_inference_ms": 0.2578543076766393, "mean_action_processing_ms": 0.05818332572085267, "mean_env_wait_ms": 0.6865011935527195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024755001068115234, "StateBufferConnector_ms": 0.0017015933990478516, "ViewRequirementAgentConnector_ms": 0.045440673828125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5177760, "num_agent_steps_trained": 5177760, "num_env_steps_sampled": 5177760, "num_env_steps_trained": 5177760, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.86103726568825, "num_env_steps_trained_throughput_per_sec": 185.86103726568825, "timesteps_total": 5177760, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5177760, "timers": {"training_iteration_time_ms": 1935.503, "sample_time_ms": 1930.378, "load_time_ms": 0.218, "load_throughput": 1648056.582, "learn_time_ms": 4.132, "learn_throughput": 87116.153, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 5177760, "num_env_steps_trained": 5177760, "num_agent_steps_sampled": 5177760, "num_agent_steps_trained": 5177760}, "done": false, "episodes_total": 1427, "training_iteration": 617, "trial_id": "19aa9_00000", "date": "2023-07-25_15-23-47", "timestamp": 1690287827, "time_this_iter_s": 11.623975038528442, "time_total_s": 10605.846773147583, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 426.215229511261, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 24.125, "ram_util_percent": 77.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9273681640625, "policy_loss": 153825242729.33334, "vf_loss": 62346115754.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 671.0, "diff_num_grad_updates_vs_sampler_policy": 670.0}}, "num_env_steps_sampled": 5179920, "num_env_steps_trained": 5179920, "num_agent_steps_sampled": 5179920, "num_agent_steps_trained": 5179920}, "sampler_results": {"episode_reward_max": 194261.36537415753, "episode_reward_min": 193592.87382144344, "episode_reward_mean": 193967.18516782022, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409597161788788, "mean_inference_ms": 0.257803075136732, "mean_action_processing_ms": 0.058172911058055526, "mean_env_wait_ms": 0.6839540243232538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024666786193847656, "StateBufferConnector_ms": 0.0017070770263671875, "ViewRequirementAgentConnector_ms": 0.04539918899536133}}, "episode_reward_max": 194261.36537415753, "episode_reward_min": 193592.87382144344, "episode_reward_mean": 193967.18516782022, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193869.8804954661, 193738.85154455478, 193998.9379140351, 194068.34791911786, 194044.3765712318, 194035.6399808536, 193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409597161788788, "mean_inference_ms": 0.257803075136732, "mean_action_processing_ms": 0.058172911058055526, "mean_env_wait_ms": 0.6839540243232538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024666786193847656, "StateBufferConnector_ms": 0.0017070770263671875, "ViewRequirementAgentConnector_ms": 0.04539918899536133}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5179920, "num_agent_steps_trained": 5179920, "num_env_steps_sampled": 5179920, "num_env_steps_trained": 5179920, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 187.17913153040737, "num_env_steps_trained_throughput_per_sec": 187.17913153040737, "timesteps_total": 5179920, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5179920, "timers": {"training_iteration_time_ms": 1928.448, "sample_time_ms": 1923.554, "load_time_ms": 0.221, "load_throughput": 1632201.319, "learn_time_ms": 4.132, "learn_throughput": 87132.743, "synch_weights_time_ms": 0.509}, "counters": {"num_env_steps_sampled": 5179920, "num_env_steps_trained": 5179920, "num_agent_steps_sampled": 5179920, "num_agent_steps_trained": 5179920}, "done": false, "episodes_total": 1433, "training_iteration": 618, "trial_id": "19aa9_00000", "date": "2023-07-25_15-23-58", "timestamp": 1690287838, "time_this_iter_s": 11.541908979415894, "time_total_s": 10617.388682126999, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 437.7571384906769, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 26.5, "ram_util_percent": 77.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9338785807292, "policy_loss": 213637447338.66666, "vf_loss": 62585254570.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 689.0, "diff_num_grad_updates_vs_sampler_policy": 688.0}}, "num_env_steps_sampled": 5182080, "num_env_steps_trained": 5182080, "num_agent_steps_sampled": 5182080, "num_agent_steps_trained": 5182080}, "sampler_results": {"episode_reward_max": 194261.36537415753, "episode_reward_min": 193592.87382144344, "episode_reward_mean": 193962.84726105022, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409561556678867, "mean_inference_ms": 0.2577541028614148, "mean_action_processing_ms": 0.058162950471037235, "mean_env_wait_ms": 0.681583118367711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024628639221191406, "StateBufferConnector_ms": 0.0017123222351074219, "ViewRequirementAgentConnector_ms": 0.04530978202819824}}, "episode_reward_max": 194261.36537415753, "episode_reward_min": 193592.87382144344, "episode_reward_mean": 193962.84726105022, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193817.35095839947, 193948.59489735938, 194006.99350726, 194261.36537415753, 194064.66819886587, 194131.34052484983, 194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409561556678867, "mean_inference_ms": 0.2577541028614148, "mean_action_processing_ms": 0.058162950471037235, "mean_env_wait_ms": 0.681583118367711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024628639221191406, "StateBufferConnector_ms": 0.0017123222351074219, "ViewRequirementAgentConnector_ms": 0.04530978202819824}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5182080, "num_agent_steps_trained": 5182080, "num_env_steps_sampled": 5182080, "num_env_steps_trained": 5182080, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.5743142784122, "num_env_steps_trained_throughput_per_sec": 185.5743142784122, "timesteps_total": 5182080, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5182080, "timers": {"training_iteration_time_ms": 1933.892, "sample_time_ms": 1929.072, "load_time_ms": 0.219, "load_throughput": 1642320.47, "learn_time_ms": 4.077, "learn_throughput": 88300.104, "synch_weights_time_ms": 0.491}, "counters": {"num_env_steps_sampled": 5182080, "num_env_steps_trained": 5182080, "num_agent_steps_sampled": 5182080, "num_agent_steps_trained": 5182080}, "done": false, "episodes_total": 1439, "training_iteration": 619, "trial_id": "19aa9_00000", "date": "2023-07-25_15-24-10", "timestamp": 1690287850, "time_this_iter_s": 11.64155888557434, "time_total_s": 10629.030241012573, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 449.3986973762512, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 23.811764705882354, "ram_util_percent": 77.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9435628255208, "policy_loss": 135899266389.33333, "vf_loss": 62361735850.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 707.0, "diff_num_grad_updates_vs_sampler_policy": 706.0}}, "num_env_steps_sampled": 5184240, "num_env_steps_trained": 5184240, "num_agent_steps_sampled": 5184240, "num_agent_steps_trained": 5184240}, "sampler_results": {"episode_reward_max": 194240.4346871201, "episode_reward_min": 193592.87382144344, "episode_reward_mean": 193960.2029678054, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40951622518426, "mean_inference_ms": 0.2577066934462958, "mean_action_processing_ms": 0.05815308123162545, "mean_env_wait_ms": 0.6793706731896865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024628639221191406, "StateBufferConnector_ms": 0.0017061233520507812, "ViewRequirementAgentConnector_ms": 0.04503321647644043}}, "episode_reward_max": 194240.4346871201, "episode_reward_min": 193592.87382144344, "episode_reward_mean": 193960.2029678054, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [194011.5982037194, 193899.43548294835, 194195.45319411161, 193822.21077551006, 193951.84987140392, 194031.87983357187, 193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.40951622518426, "mean_inference_ms": 0.2577066934462958, "mean_action_processing_ms": 0.05815308123162545, "mean_env_wait_ms": 0.6793706731896865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024628639221191406, "StateBufferConnector_ms": 0.0017061233520507812, "ViewRequirementAgentConnector_ms": 0.04503321647644043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5184240, "num_agent_steps_trained": 5184240, "num_env_steps_sampled": 5184240, "num_env_steps_trained": 5184240, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.5322162218788, "num_env_steps_trained_throughput_per_sec": 186.5322162218788, "timesteps_total": 5184240, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5184240, "timers": {"training_iteration_time_ms": 1934.276, "sample_time_ms": 1929.478, "load_time_ms": 0.214, "load_throughput": 1681832.747, "learn_time_ms": 4.032, "learn_throughput": 89293.284, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 5184240, "num_env_steps_trained": 5184240, "num_agent_steps_sampled": 5184240, "num_agent_steps_trained": 5184240}, "done": false, "episodes_total": 1445, "training_iteration": 620, "trial_id": "19aa9_00000", "date": "2023-07-25_15-24-22", "timestamp": 1690287862, "time_this_iter_s": 11.581767320632935, "time_total_s": 10640.612008333206, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 460.98046469688416, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 26.549999999999997, "ram_util_percent": 77.20625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9449462890625, "policy_loss": 118328812757.33333, "vf_loss": 62473216000.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 725.0, "diff_num_grad_updates_vs_sampler_policy": 724.0}}, "num_env_steps_sampled": 5186400, "num_env_steps_trained": 5186400, "num_agent_steps_sampled": 5186400, "num_agent_steps_trained": 5186400}, "sampler_results": {"episode_reward_max": 194287.70630922655, "episode_reward_min": 193592.87382144344, "episode_reward_mean": 193958.2471525539, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409480376693829, "mean_inference_ms": 0.2576722317023888, "mean_action_processing_ms": 0.05814530261267881, "mean_env_wait_ms": 0.6773050284928227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002466440200805664, "StateBufferConnector_ms": 0.0017118453979492188, "ViewRequirementAgentConnector_ms": 0.04502153396606445}}, "episode_reward_max": 194287.70630922655, "episode_reward_min": 193592.87382144344, "episode_reward_mean": 193958.2471525539, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193826.27726056924, 194054.32347095266, 194240.4346871201, 193913.6097664276, 194072.47126555457, 193965.8732714423, 193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409480376693829, "mean_inference_ms": 0.2576722317023888, "mean_action_processing_ms": 0.05814530261267881, "mean_env_wait_ms": 0.6773050284928227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002466440200805664, "StateBufferConnector_ms": 0.0017118453979492188, "ViewRequirementAgentConnector_ms": 0.04502153396606445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5186400, "num_agent_steps_trained": 5186400, "num_env_steps_sampled": 5186400, "num_env_steps_trained": 5186400, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.0653124670049, "num_env_steps_trained_throughput_per_sec": 186.0653124670049, "timesteps_total": 5186400, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5186400, "timers": {"training_iteration_time_ms": 1933.387, "sample_time_ms": 1928.557, "load_time_ms": 0.215, "load_throughput": 1673259.574, "learn_time_ms": 4.055, "learn_throughput": 88778.255, "synch_weights_time_ms": 0.526}, "counters": {"num_env_steps_sampled": 5186400, "num_env_steps_trained": 5186400, "num_agent_steps_sampled": 5186400, "num_agent_steps_trained": 5186400}, "done": false, "episodes_total": 1451, "training_iteration": 621, "trial_id": "19aa9_00000", "date": "2023-07-25_15-24-33", "timestamp": 1690287873, "time_this_iter_s": 11.61135721206665, "time_total_s": 10652.223365545273, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 472.5918219089508, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 24.97647058823529, "ram_util_percent": 77.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9512532552083, "policy_loss": 2527693179562.6665, "vf_loss": 62416052906.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 742.0}}, "num_env_steps_sampled": 5188560, "num_env_steps_trained": 5188560, "num_agent_steps_sampled": 5188560, "num_agent_steps_trained": 5188560}, "sampler_results": {"episode_reward_max": 194287.70630922655, "episode_reward_min": 193470.3310373645, "episode_reward_mean": 193945.7380399279, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198, 193768.3340524413, 193904.98602889763, 193470.3310373645, 193803.98201018228, 193866.40309942234, 194008.04223115585], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409477103541248, "mean_inference_ms": 0.2576479439628006, "mean_action_processing_ms": 0.058139916051441955, "mean_env_wait_ms": 0.6753514212040282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002454042434692383, "StateBufferConnector_ms": 0.0017075538635253906, "ViewRequirementAgentConnector_ms": 0.044974565505981445}}, "episode_reward_max": 194287.70630922655, "episode_reward_min": 193470.3310373645, "episode_reward_mean": 193945.7380399279, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193900.98758355808, 193976.11471181057, 194119.10717882976, 194019.52751821053, 193898.02449036177, 194130.7702458401, 194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198, 193768.3340524413, 193904.98602889763, 193470.3310373645, 193803.98201018228, 193866.40309942234, 194008.04223115585], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409477103541248, "mean_inference_ms": 0.2576479439628006, "mean_action_processing_ms": 0.058139916051441955, "mean_env_wait_ms": 0.6753514212040282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002454042434692383, "StateBufferConnector_ms": 0.0017075538635253906, "ViewRequirementAgentConnector_ms": 0.044974565505981445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5188560, "num_agent_steps_trained": 5188560, "num_env_steps_sampled": 5188560, "num_env_steps_trained": 5188560, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.9885845991861, "num_env_steps_trained_throughput_per_sec": 185.9885845991861, "timesteps_total": 5188560, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5188560, "timers": {"training_iteration_time_ms": 1933.083, "sample_time_ms": 1928.295, "load_time_ms": 0.218, "load_throughput": 1652204.224, "learn_time_ms": 4.033, "learn_throughput": 89263.723, "synch_weights_time_ms": 0.504}, "counters": {"num_env_steps_sampled": 5188560, "num_env_steps_trained": 5188560, "num_agent_steps_sampled": 5188560, "num_agent_steps_trained": 5188560}, "done": false, "episodes_total": 1457, "training_iteration": 622, "trial_id": "19aa9_00000", "date": "2023-07-25_15-24-45", "timestamp": 1690287885, "time_this_iter_s": 11.615756034851074, "time_total_s": 10663.839121580124, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 484.2075779438019, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 24.1625, "ram_util_percent": 77.0875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.955078125, "policy_loss": 102408077994.66667, "vf_loss": 62453625514.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 761.0, "diff_num_grad_updates_vs_sampler_policy": 760.0}}, "num_env_steps_sampled": 5190720, "num_env_steps_trained": 5190720, "num_agent_steps_sampled": 5190720, "num_agent_steps_trained": 5190720}, "sampler_results": {"episode_reward_max": 194287.70630922655, "episode_reward_min": 193470.3310373645, "episode_reward_mean": 193946.30468675445, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198, 193768.3340524413, 193904.98602889763, 193470.3310373645, 193803.98201018228, 193866.40309942234, 194008.04223115585, 194202.39057758555, 193829.7678641955, 193942.83504115563, 193993.77518525533, 194086.99903876535, 194045.4287043145], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409457994402545, "mean_inference_ms": 0.25762408909103224, "mean_action_processing_ms": 0.05813439470376389, "mean_env_wait_ms": 0.6735224266223544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024499893188476562, "StateBufferConnector_ms": 0.001706838607788086, "ViewRequirementAgentConnector_ms": 0.04479408264160156}}, "episode_reward_max": 194287.70630922655, "episode_reward_min": 193470.3310373645, "episode_reward_mean": 193946.30468675445, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [194130.92566719692, 193934.02020623945, 193832.28138610368, 193930.02750248252, 193886.75421046175, 193811.83911240537, 193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198, 193768.3340524413, 193904.98602889763, 193470.3310373645, 193803.98201018228, 193866.40309942234, 194008.04223115585, 194202.39057758555, 193829.7678641955, 193942.83504115563, 193993.77518525533, 194086.99903876535, 194045.4287043145], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409457994402545, "mean_inference_ms": 0.25762408909103224, "mean_action_processing_ms": 0.05813439470376389, "mean_env_wait_ms": 0.6735224266223544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024499893188476562, "StateBufferConnector_ms": 0.001706838607788086, "ViewRequirementAgentConnector_ms": 0.04479408264160156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5190720, "num_agent_steps_trained": 5190720, "num_env_steps_sampled": 5190720, "num_env_steps_trained": 5190720, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.31807485276985, "num_env_steps_trained_throughput_per_sec": 186.31807485276985, "timesteps_total": 5190720, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5190720, "timers": {"training_iteration_time_ms": 1934.547, "sample_time_ms": 1929.742, "load_time_ms": 0.217, "load_throughput": 1656736.274, "learn_time_ms": 4.02, "learn_throughput": 89549.063, "synch_weights_time_ms": 0.534}, "counters": {"num_env_steps_sampled": 5190720, "num_env_steps_trained": 5190720, "num_agent_steps_sampled": 5190720, "num_agent_steps_trained": 5190720}, "done": false, "episodes_total": 1463, "training_iteration": 623, "trial_id": "19aa9_00000", "date": "2023-07-25_15-24-56", "timestamp": 1690287896, "time_this_iter_s": 11.595243692398071, "time_total_s": 10675.434365272522, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 495.80282163619995, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 24.299999999999997, "ram_util_percent": 77.0529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9552001953125, "policy_loss": 91125436416.0, "vf_loss": 62469043541.333336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 779.0, "diff_num_grad_updates_vs_sampler_policy": 778.0}}, "num_env_steps_sampled": 5192880, "num_env_steps_trained": 5192880, "num_agent_steps_sampled": 5192880, "num_agent_steps_trained": 5192880}, "sampler_results": {"episode_reward_max": 194287.70630922655, "episode_reward_min": 193470.3310373645, "episode_reward_mean": 193943.6396022512, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198, 193768.3340524413, 193904.98602889763, 193470.3310373645, 193803.98201018228, 193866.40309942234, 194008.04223115585, 194202.39057758555, 193829.7678641955, 193942.83504115563, 193993.77518525533, 194086.99903876535, 194045.4287043145, 194050.11577782515, 193924.01221995777, 193830.69187126288, 193817.87765738412, 193637.67337018184, 193998.96873795017], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409440026543981, "mean_inference_ms": 0.25759927757890694, "mean_action_processing_ms": 0.05812852081547702, "mean_env_wait_ms": 0.6717825097017233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002450704574584961, "StateBufferConnector_ms": 0.001714468002319336, "ViewRequirementAgentConnector_ms": 0.04486656188964844}}, "episode_reward_max": 194287.70630922655, "episode_reward_min": 193470.3310373645, "episode_reward_mean": 193943.6396022512, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193876.9074618597, 194116.96861601132, 193963.84812108972, 193872.18002015556, 194099.87833049733, 193954.39105769712, 193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198, 193768.3340524413, 193904.98602889763, 193470.3310373645, 193803.98201018228, 193866.40309942234, 194008.04223115585, 194202.39057758555, 193829.7678641955, 193942.83504115563, 193993.77518525533, 194086.99903876535, 194045.4287043145, 194050.11577782515, 193924.01221995777, 193830.69187126288, 193817.87765738412, 193637.67337018184, 193998.96873795017], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409440026543981, "mean_inference_ms": 0.25759927757890694, "mean_action_processing_ms": 0.05812852081547702, "mean_env_wait_ms": 0.6717825097017233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002450704574584961, "StateBufferConnector_ms": 0.001714468002319336, "ViewRequirementAgentConnector_ms": 0.04486656188964844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5192880, "num_agent_steps_trained": 5192880, "num_env_steps_sampled": 5192880, "num_env_steps_trained": 5192880, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.75680932251947, "num_env_steps_trained_throughput_per_sec": 186.75680932251947, "timesteps_total": 5192880, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5192880, "timers": {"training_iteration_time_ms": 1931.446, "sample_time_ms": 1926.54, "load_time_ms": 0.215, "load_throughput": 1674187.205, "learn_time_ms": 4.119, "learn_throughput": 87406.119, "synch_weights_time_ms": 0.539}, "counters": {"num_env_steps_sampled": 5192880, "num_env_steps_trained": 5192880, "num_agent_steps_sampled": 5192880, "num_agent_steps_trained": 5192880}, "done": false, "episodes_total": 1469, "training_iteration": 624, "trial_id": "19aa9_00000", "date": "2023-07-25_15-25-08", "timestamp": 1690287908, "time_this_iter_s": 11.567923784255981, "time_total_s": 10687.002289056778, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 507.37074542045593, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 24.4, "ram_util_percent": 76.94375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9552001953125, "policy_loss": 86547873792.0, "vf_loss": 62434556586.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 797.0, "diff_num_grad_updates_vs_sampler_policy": 796.0}}, "num_env_steps_sampled": 5195040, "num_env_steps_trained": 5195040, "num_agent_steps_sampled": 5195040, "num_agent_steps_trained": 5195040}, "sampler_results": {"episode_reward_max": 194287.70630922655, "episode_reward_min": 193470.3310373645, "episode_reward_mean": 193947.33118707436, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198, 193768.3340524413, 193904.98602889763, 193470.3310373645, 193803.98201018228, 193866.40309942234, 194008.04223115585, 194202.39057758555, 193829.7678641955, 193942.83504115563, 193993.77518525533, 194086.99903876535, 194045.4287043145, 194050.11577782515, 193924.01221995777, 193830.69187126288, 193817.87765738412, 193637.67337018184, 193998.96873795017, 194149.03527940056, 193904.1912211856, 194180.70930022292, 193981.73651027196, 194040.3490657069, 193997.3107128406], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409377192812524, "mean_inference_ms": 0.2575785277354417, "mean_action_processing_ms": 0.058123393283461285, "mean_env_wait_ms": 0.6701643234432254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024573802947998047, "StateBufferConnector_ms": 0.0017137527465820312, "ViewRequirementAgentConnector_ms": 0.0450587272644043}}, "episode_reward_max": 194287.70630922655, "episode_reward_min": 193470.3310373645, "episode_reward_mean": 193947.33118707436, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193859.25341437425, 193915.1611202558, 193830.1138952774, 193855.74388199512, 193915.5364037693, 193928.39979402054, 194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198, 193768.3340524413, 193904.98602889763, 193470.3310373645, 193803.98201018228, 193866.40309942234, 194008.04223115585, 194202.39057758555, 193829.7678641955, 193942.83504115563, 193993.77518525533, 194086.99903876535, 194045.4287043145, 194050.11577782515, 193924.01221995777, 193830.69187126288, 193817.87765738412, 193637.67337018184, 193998.96873795017, 194149.03527940056, 193904.1912211856, 194180.70930022292, 193981.73651027196, 194040.3490657069, 193997.3107128406], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409377192812524, "mean_inference_ms": 0.2575785277354417, "mean_action_processing_ms": 0.058123393283461285, "mean_env_wait_ms": 0.6701643234432254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024573802947998047, "StateBufferConnector_ms": 0.0017137527465820312, "ViewRequirementAgentConnector_ms": 0.0450587272644043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5195040, "num_agent_steps_trained": 5195040, "num_env_steps_sampled": 5195040, "num_env_steps_trained": 5195040, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.59837020020638, "num_env_steps_trained_throughput_per_sec": 186.59837020020638, "timesteps_total": 5195040, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5195040, "timers": {"training_iteration_time_ms": 1928.11, "sample_time_ms": 1923.233, "load_time_ms": 0.215, "load_throughput": 1671777.502, "learn_time_ms": 4.105, "learn_throughput": 87701.077, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 5195040, "num_env_steps_trained": 5195040, "num_agent_steps_sampled": 5195040, "num_agent_steps_trained": 5195040}, "done": false, "episodes_total": 1475, "training_iteration": 625, "trial_id": "19aa9_00000", "date": "2023-07-25_15-25-20", "timestamp": 1690287920, "time_this_iter_s": 11.577727794647217, "time_total_s": 10698.580016851425, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 518.9484732151031, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 23.329411764705885, "ram_util_percent": 77.02941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9552001953125, "policy_loss": 102253794645.33333, "vf_loss": 62255564117.333336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 815.0, "diff_num_grad_updates_vs_sampler_policy": 814.0}}, "num_env_steps_sampled": 5197200, "num_env_steps_trained": 5197200, "num_agent_steps_sampled": 5197200, "num_agent_steps_trained": 5197200}, "sampler_results": {"episode_reward_max": 194287.70630922655, "episode_reward_min": 193470.3310373645, "episode_reward_mean": 193947.67754159792, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198, 193768.3340524413, 193904.98602889763, 193470.3310373645, 193803.98201018228, 193866.40309942234, 194008.04223115585, 194202.39057758555, 193829.7678641955, 193942.83504115563, 193993.77518525533, 194086.99903876535, 194045.4287043145, 194050.11577782515, 193924.01221995777, 193830.69187126288, 193817.87765738412, 193637.67337018184, 193998.96873795017, 194149.03527940056, 193904.1912211856, 194180.70930022292, 193981.73651027196, 194040.3490657069, 193997.3107128406, 194056.6647678281, 193875.0681875887, 193956.31588366564, 193814.1281895913, 193928.86490701957, 193707.80202635718], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409302683432371, "mean_inference_ms": 0.2575695382441706, "mean_action_processing_ms": 0.05812048184423533, "mean_env_wait_ms": 0.6686409944507407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024895668029785156, "StateBufferConnector_ms": 0.0017266273498535156, "ViewRequirementAgentConnector_ms": 0.04535055160522461}}, "episode_reward_max": 194287.70630922655, "episode_reward_min": 193470.3310373645, "episode_reward_mean": 193947.67754159792, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [194050.84678438155, 193897.49659448018, 193923.85843737944, 193864.1131452607, 193891.07302435927, 194113.22502554534, 194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198, 193768.3340524413, 193904.98602889763, 193470.3310373645, 193803.98201018228, 193866.40309942234, 194008.04223115585, 194202.39057758555, 193829.7678641955, 193942.83504115563, 193993.77518525533, 194086.99903876535, 194045.4287043145, 194050.11577782515, 193924.01221995777, 193830.69187126288, 193817.87765738412, 193637.67337018184, 193998.96873795017, 194149.03527940056, 193904.1912211856, 194180.70930022292, 193981.73651027196, 194040.3490657069, 193997.3107128406, 194056.6647678281, 193875.0681875887, 193956.31588366564, 193814.1281895913, 193928.86490701957, 193707.80202635718], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409302683432371, "mean_inference_ms": 0.2575695382441706, "mean_action_processing_ms": 0.05812048184423533, "mean_env_wait_ms": 0.6686409944507407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024895668029785156, "StateBufferConnector_ms": 0.0017266273498535156, "ViewRequirementAgentConnector_ms": 0.04535055160522461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5197200, "num_agent_steps_trained": 5197200, "num_env_steps_sampled": 5197200, "num_env_steps_trained": 5197200, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 185.72264199017536, "num_env_steps_trained_throughput_per_sec": 185.72264199017536, "timesteps_total": 5197200, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5197200, "timers": {"training_iteration_time_ms": 1935.56, "sample_time_ms": 1930.501, "load_time_ms": 0.242, "load_throughput": 1488074.741, "learn_time_ms": 4.241, "learn_throughput": 84889.664, "synch_weights_time_ms": 0.54}, "counters": {"num_env_steps_sampled": 5197200, "num_env_steps_trained": 5197200, "num_agent_steps_sampled": 5197200, "num_agent_steps_trained": 5197200}, "done": false, "episodes_total": 1481, "training_iteration": 626, "trial_id": "19aa9_00000", "date": "2023-07-25_15-25-31", "timestamp": 1690287931, "time_this_iter_s": 11.632346153259277, "time_total_s": 10710.212363004684, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 530.5808193683624, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 26.2125, "ram_util_percent": 77.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9552001953125, "policy_loss": 102288063829.33333, "vf_loss": 62286113450.666664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 833.0, "diff_num_grad_updates_vs_sampler_policy": 832.0}}, "num_env_steps_sampled": 5199360, "num_env_steps_trained": 5199360, "num_agent_steps_sampled": 5199360, "num_agent_steps_trained": 5199360}, "sampler_results": {"episode_reward_max": 194287.70630922655, "episode_reward_min": 193470.3310373645, "episode_reward_mean": 193943.3032866565, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198, 193768.3340524413, 193904.98602889763, 193470.3310373645, 193803.98201018228, 193866.40309942234, 194008.04223115585, 194202.39057758555, 193829.7678641955, 193942.83504115563, 193993.77518525533, 194086.99903876535, 194045.4287043145, 194050.11577782515, 193924.01221995777, 193830.69187126288, 193817.87765738412, 193637.67337018184, 193998.96873795017, 194149.03527940056, 193904.1912211856, 194180.70930022292, 193981.73651027196, 194040.3490657069, 193997.3107128406, 194056.6647678281, 193875.0681875887, 193956.31588366564, 193814.1281895913, 193928.86490701957, 193707.80202635718, 194128.6737528132, 193758.4150559003, 193946.96901982016, 193764.85607587668, 193831.63964308117, 193872.63396977264], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409240896674723, "mean_inference_ms": 0.25756344649643276, "mean_action_processing_ms": 0.05811835620848527, "mean_env_wait_ms": 0.6671914106324337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024924278259277344, "StateBufferConnector_ms": 0.0017402172088623047, "ViewRequirementAgentConnector_ms": 0.0454714298248291}}, "episode_reward_max": 194287.70630922655, "episode_reward_min": 193470.3310373645, "episode_reward_mean": 193943.3032866565, "episode_len_mean": 360.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [194040.78471859504, 193934.17009073737, 193993.1354268627, 193798.65161229103, 194094.7610805115, 193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198, 193768.3340524413, 193904.98602889763, 193470.3310373645, 193803.98201018228, 193866.40309942234, 194008.04223115585, 194202.39057758555, 193829.7678641955, 193942.83504115563, 193993.77518525533, 194086.99903876535, 194045.4287043145, 194050.11577782515, 193924.01221995777, 193830.69187126288, 193817.87765738412, 193637.67337018184, 193998.96873795017, 194149.03527940056, 193904.1912211856, 194180.70930022292, 193981.73651027196, 194040.3490657069, 193997.3107128406, 194056.6647678281, 193875.0681875887, 193956.31588366564, 193814.1281895913, 193928.86490701957, 193707.80202635718, 194128.6737528132, 193758.4150559003, 193946.96901982016, 193764.85607587668, 193831.63964308117, 193872.63396977264], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409240896674723, "mean_inference_ms": 0.25756344649643276, "mean_action_processing_ms": 0.05811835620848527, "mean_env_wait_ms": 0.6671914106324337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024924278259277344, "StateBufferConnector_ms": 0.0017402172088623047, "ViewRequirementAgentConnector_ms": 0.0454714298248291}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5199360, "num_agent_steps_trained": 5199360, "num_env_steps_sampled": 5199360, "num_env_steps_trained": 5199360, "num_env_steps_sampled_this_iter": 2160, "num_env_steps_trained_this_iter": 2160, "num_env_steps_sampled_throughput_per_sec": 186.50532468916026, "num_env_steps_trained_throughput_per_sec": 186.50532468916026, "timesteps_total": 5199360, "num_steps_trained_this_iter": 2160, "agent_timesteps_total": 5199360, "timers": {"training_iteration_time_ms": 1932.359, "sample_time_ms": 1927.247, "load_time_ms": 0.248, "load_throughput": 1453271.838, "learn_time_ms": 4.308, "learn_throughput": 83561.12, "synch_weights_time_ms": 0.522}, "counters": {"num_env_steps_sampled": 5199360, "num_env_steps_trained": 5199360, "num_agent_steps_sampled": 5199360, "num_agent_steps_trained": 5199360}, "done": false, "episodes_total": 1487, "training_iteration": 627, "trial_id": "19aa9_00000", "date": "2023-07-25_15-25-43", "timestamp": 1690287943, "time_this_iter_s": 11.583706855773926, "time_total_s": 10721.796069860458, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 542.1645262241364, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 26.875, "ram_util_percent": 77.08125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9552001953125, "policy_loss": 164403958442.66666, "vf_loss": 62392944640.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 848.0, "diff_num_grad_updates_vs_sampler_policy": 847.0}}, "num_env_steps_sampled": 5201160, "num_env_steps_trained": 5201160, "num_agent_steps_sampled": 5201160, "num_agent_steps_trained": 5201160}, "sampler_results": {"episode_reward_max": 194287.70630922655, "episode_reward_min": 193470.3310373645, "episode_reward_mean": 193943.64548140817, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198, 193768.3340524413, 193904.98602889763, 193470.3310373645, 193803.98201018228, 193866.40309942234, 194008.04223115585, 194202.39057758555, 193829.7678641955, 193942.83504115563, 193993.77518525533, 194086.99903876535, 194045.4287043145, 194050.11577782515, 193924.01221995777, 193830.69187126288, 193817.87765738412, 193637.67337018184, 193998.96873795017, 194149.03527940056, 193904.1912211856, 194180.70930022292, 193981.73651027196, 194040.3490657069, 193997.3107128406, 194056.6647678281, 193875.0681875887, 193956.31588366564, 193814.1281895913, 193928.86490701957, 193707.80202635718, 194128.6737528132, 193758.4150559003, 193946.96901982016, 193764.85607587668, 193831.63964308117, 193872.63396977264, 193929.994684888, 193993.4907269539, 194017.73493049928, 194031.8686490373, 193922.63341277972], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409366500332312, "mean_inference_ms": 0.25757391793464907, "mean_action_processing_ms": 0.058119298473164015, "mean_env_wait_ms": 0.666054658138442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002501249313354492, "StateBufferConnector_ms": 0.0017483234405517578, "ViewRequirementAgentConnector_ms": 0.0454716682434082}}, "episode_reward_max": 194287.70630922655, "episode_reward_min": 193470.3310373645, "episode_reward_mean": 193943.64548140817, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193948.85497460508, 193740.01575875212, 193979.0544523526, 194112.6476026307, 194195.51256420757, 193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198, 193768.3340524413, 193904.98602889763, 193470.3310373645, 193803.98201018228, 193866.40309942234, 194008.04223115585, 194202.39057758555, 193829.7678641955, 193942.83504115563, 193993.77518525533, 194086.99903876535, 194045.4287043145, 194050.11577782515, 193924.01221995777, 193830.69187126288, 193817.87765738412, 193637.67337018184, 193998.96873795017, 194149.03527940056, 193904.1912211856, 194180.70930022292, 193981.73651027196, 194040.3490657069, 193997.3107128406, 194056.6647678281, 193875.0681875887, 193956.31588366564, 193814.1281895913, 193928.86490701957, 193707.80202635718, 194128.6737528132, 193758.4150559003, 193946.96901982016, 193764.85607587668, 193831.63964308117, 193872.63396977264, 193929.994684888, 193993.4907269539, 194017.73493049928, 194031.8686490373, 193922.63341277972], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409366500332312, "mean_inference_ms": 0.25757391793464907, "mean_action_processing_ms": 0.058119298473164015, "mean_env_wait_ms": 0.666054658138442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002501249313354492, "StateBufferConnector_ms": 0.0017483234405517578, "ViewRequirementAgentConnector_ms": 0.0454716682434082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5201160, "num_agent_steps_trained": 5201160, "num_env_steps_sampled": 5201160, "num_env_steps_trained": 5201160, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 177.39357767692817, "num_env_steps_trained_throughput_per_sec": 177.39357767692817, "timesteps_total": 5201160, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5201160, "timers": {"training_iteration_time_ms": 1978.214, "sample_time_ms": 1973.409, "load_time_ms": 0.219, "load_throughput": 1647517.119, "learn_time_ms": 4.03, "learn_throughput": 89336.606, "synch_weights_time_ms": 0.523}, "counters": {"num_env_steps_sampled": 5201160, "num_env_steps_trained": 5201160, "num_agent_steps_sampled": 5201160, "num_agent_steps_trained": 5201160}, "done": false, "episodes_total": 1492, "training_iteration": 628, "trial_id": "19aa9_00000", "date": "2023-07-25_15-25-53", "timestamp": 1690287953, "time_this_iter_s": 10.149049043655396, "time_total_s": 10731.945118904114, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 552.3135752677917, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 33.04666666666667, "ram_util_percent": 77.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-07, "entropy_coeff": 0.05000000000000001, "policy_entropy": -1062.9552001953125, "policy_loss": 86593952426.66667, "vf_loss": 62489751552.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 863.0, "diff_num_grad_updates_vs_sampler_policy": 862.0}}, "num_env_steps_sampled": 5202960, "num_env_steps_trained": 5202960, "num_agent_steps_sampled": 5202960, "num_agent_steps_trained": 5202960}, "sampler_results": {"episode_reward_max": 194287.70630922655, "episode_reward_min": 193470.3310373645, "episode_reward_mean": 193939.27218919576, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198, 193768.3340524413, 193904.98602889763, 193470.3310373645, 193803.98201018228, 193866.40309942234, 194008.04223115585, 194202.39057758555, 193829.7678641955, 193942.83504115563, 193993.77518525533, 194086.99903876535, 194045.4287043145, 194050.11577782515, 193924.01221995777, 193830.69187126288, 193817.87765738412, 193637.67337018184, 193998.96873795017, 194149.03527940056, 193904.1912211856, 194180.70930022292, 193981.73651027196, 194040.3490657069, 193997.3107128406, 194056.6647678281, 193875.0681875887, 193956.31588366564, 193814.1281895913, 193928.86490701957, 193707.80202635718, 194128.6737528132, 193758.4150559003, 193946.96901982016, 193764.85607587668, 193831.63964308117, 193872.63396977264, 193929.994684888, 193993.4907269539, 194017.73493049928, 194031.8686490373, 193922.63341277972, 194017.9482178489, 193895.36542217302, 193825.00539605302, 193744.95354807746, 194055.483547155], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409713669326141, "mean_inference_ms": 0.25758304919295716, "mean_action_processing_ms": 0.058119802198233705, "mean_env_wait_ms": 0.664953115827306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002490520477294922, "StateBufferConnector_ms": 0.001748800277709961, "ViewRequirementAgentConnector_ms": 0.04534292221069336}}, "episode_reward_max": 194287.70630922655, "episode_reward_min": 193470.3310373645, "episode_reward_mean": 193939.27218919576, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [193980.76439049438, 193737.79884237648, 194037.36788250765, 193981.8044822612, 193984.84738186706, 193993.525521839, 194082.0875119505, 194094.81268166844, 193854.81827928557, 193592.87382144344, 193858.76134924282, 193826.76148876315, 193907.2842455329, 193895.4625411328, 194118.570918346, 194106.93787098886, 194074.98171150766, 193952.36435577396, 193835.55530055758, 193973.56522755433, 193930.888918023, 194047.14576125026, 194087.619007277, 194037.5124642677, 193959.43402064452, 193991.90524909316, 193929.67236766705, 194094.3750716793, 194003.8428868705, 193953.62431265743, 193940.76123890848, 194058.87170814737, 193936.1431821737, 194068.25299683178, 193603.81978961933, 193874.9738088792, 193721.43033088747, 194182.32557239127, 193717.27667172012, 193670.5777638646, 193799.38656365924, 194231.2468457395, 194008.26636663696, 193887.0446915519, 193836.0816277794, 194131.77700669033, 194219.5998069832, 193883.11463676815, 193751.54372746797, 194098.35173430823, 193852.32176421006, 193774.56352847777, 194287.70630922655, 193952.35877242198, 193768.3340524413, 193904.98602889763, 193470.3310373645, 193803.98201018228, 193866.40309942234, 194008.04223115585, 194202.39057758555, 193829.7678641955, 193942.83504115563, 193993.77518525533, 194086.99903876535, 194045.4287043145, 194050.11577782515, 193924.01221995777, 193830.69187126288, 193817.87765738412, 193637.67337018184, 193998.96873795017, 194149.03527940056, 193904.1912211856, 194180.70930022292, 193981.73651027196, 194040.3490657069, 193997.3107128406, 194056.6647678281, 193875.0681875887, 193956.31588366564, 193814.1281895913, 193928.86490701957, 193707.80202635718, 194128.6737528132, 193758.4150559003, 193946.96901982016, 193764.85607587668, 193831.63964308117, 193872.63396977264, 193929.994684888, 193993.4907269539, 194017.73493049928, 194031.8686490373, 193922.63341277972, 194017.9482178489, 193895.36542217302, 193825.00539605302, 193744.95354807746, 194055.483547155], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409713669326141, "mean_inference_ms": 0.25758304919295716, "mean_action_processing_ms": 0.058119802198233705, "mean_env_wait_ms": 0.664953115827306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002490520477294922, "StateBufferConnector_ms": 0.001748800277709961, "ViewRequirementAgentConnector_ms": 0.04534292221069336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5202960, "num_agent_steps_trained": 5202960, "num_env_steps_sampled": 5202960, "num_env_steps_trained": 5202960, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 178.47046915736732, "num_env_steps_trained_throughput_per_sec": 178.47046915736732, "timesteps_total": 5202960, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5202960, "timers": {"training_iteration_time_ms": 2023.248, "sample_time_ms": 2018.049, "load_time_ms": 0.252, "load_throughput": 1426364.481, "learn_time_ms": 4.29, "learn_throughput": 83917.316, "synch_weights_time_ms": 0.607}, "counters": {"num_env_steps_sampled": 5202960, "num_env_steps_trained": 5202960, "num_agent_steps_sampled": 5202960, "num_agent_steps_trained": 5202960}, "done": false, "episodes_total": 1497, "training_iteration": 629, "trial_id": "19aa9_00000", "date": "2023-07-25_15-26-03", "timestamp": 1690287963, "time_this_iter_s": 10.092167139053345, "time_total_s": 10742.037286043167, "pid": 65317, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f6eb310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 562.4057424068451, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 34.357142857142854, "ram_util_percent": 76.67142857142858}}
