{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0028, "entropy_coeff": 0.3, "policy_entropy": -879.4565836588541, "policy_loss": -6.21216617066188e+18, "vf_loss": 952235968.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 5100720, "num_env_steps_trained": 5100720, "num_agent_steps_sampled": 5100720, "num_agent_steps_trained": 5100720}, "sampler_results": {"episode_reward_max": -22714.44482511282, "episode_reward_min": -22946.200150683522, "episode_reward_mean": -22827.78189991042, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717], "episode_lengths": [360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.501112627536369, "mean_inference_ms": 0.24885026056844275, "mean_action_processing_ms": 0.059224597949439, "mean_env_wait_ms": 2.2593262624111876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022172927856445312, "StateBufferConnector_ms": 0.0017046928405761719, "ViewRequirementAgentConnector_ms": 0.04494786262512207}}, "episode_reward_max": -22714.44482511282, "episode_reward_min": -22946.200150683522, "episode_reward_mean": -22827.78189991042, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717], "episode_lengths": [360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.501112627536369, "mean_inference_ms": 0.24885026056844275, "mean_action_processing_ms": 0.059224597949439, "mean_env_wait_ms": 2.2593262624111876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0022172927856445312, "StateBufferConnector_ms": 0.0017046928405761719, "ViewRequirementAgentConnector_ms": 0.04494786262512207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5100720, "num_agent_steps_trained": 5100720, "num_env_steps_sampled": 5100720, "num_env_steps_trained": 5100720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 140.5131217826594, "num_env_steps_trained_throughput_per_sec": 140.5131217826594, "timesteps_total": 5100720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5100720, "timers": {"training_iteration_time_ms": 2562.027, "sample_time_ms": 2553.872, "load_time_ms": 0.289, "load_throughput": 1247376.654, "learn_time_ms": 7.291, "learn_throughput": 49376.622, "synch_weights_time_ms": 0.546}, "counters": {"num_env_steps_sampled": 5100720, "num_env_steps_trained": 5100720, "num_agent_steps_sampled": 5100720, "num_agent_steps_trained": 5100720}, "done": false, "episodes_total": 1213, "training_iteration": 581, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-38-52", "timestamp": 1690288732, "time_this_iter_s": 10.250081062316895, "time_total_s": 10189.881624698639, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10.250081062316895, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 26.966666666666665, "ram_util_percent": 78.11333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0018000000000000002, "entropy_coeff": 0.3, "policy_entropy": -926.6387939453125, "policy_loss": -1.2298410083156562e+17, "vf_loss": 1054742997.3333334}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 25.0}}, "num_env_steps_sampled": 5102520, "num_env_steps_trained": 5102520, "num_agent_steps_sampled": 5102520, "num_agent_steps_trained": 5102520}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -24103.0360134691, "episode_reward_mean": -22963.216577334537, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.486471596034459, "mean_inference_ms": 0.25196400778588013, "mean_action_processing_ms": 0.05966251430898917, "mean_env_wait_ms": 1.887644819501563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026517444186740452, "StateBufferConnector_ms": 0.0017325083414713542, "ViewRequirementAgentConnector_ms": 0.04817644755045573}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -24103.0360134691, "episode_reward_mean": -22963.216577334537, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.486471596034459, "mean_inference_ms": 0.25196400778588013, "mean_action_processing_ms": 0.05966251430898917, "mean_env_wait_ms": 1.887644819501563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026517444186740452, "StateBufferConnector_ms": 0.0017325083414713542, "ViewRequirementAgentConnector_ms": 0.04817644755045573}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5102520, "num_agent_steps_trained": 5102520, "num_env_steps_sampled": 5102520, "num_env_steps_trained": 5102520, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 170.60579718024596, "num_env_steps_trained_throughput_per_sec": 170.60579718024596, "timesteps_total": 5102520, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5102520, "timers": {"training_iteration_time_ms": 2310.967, "sample_time_ms": 2304.655, "load_time_ms": 0.242, "load_throughput": 1488286.602, "learn_time_ms": 5.522, "learn_throughput": 65188.617, "synch_weights_time_ms": 0.518}, "counters": {"num_env_steps_sampled": 5102520, "num_env_steps_trained": 5102520, "num_agent_steps_sampled": 5102520, "num_agent_steps_trained": 5102520}, "done": false, "episodes_total": 1218, "training_iteration": 582, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-39-02", "timestamp": 1690288742, "time_this_iter_s": 10.552368879318237, "time_total_s": 10200.433993577957, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 20.802449941635132, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.266666666666666, "ram_util_percent": 78.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0009750000000000001, "entropy_coeff": 0.3, "policy_entropy": -890.1622924804688, "policy_loss": -2.1695885618642836e+16, "vf_loss": 1214344192.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 40.0}}, "num_env_steps_sampled": 5104320, "num_env_steps_trained": 5104320, "num_agent_steps_sampled": 5104320, "num_agent_steps_trained": 5104320}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -24047.283666174328, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4679626290202865, "mean_inference_ms": 0.2524927827894282, "mean_action_processing_ms": 0.059750931209332614, "mean_env_wait_ms": 1.6944768413118465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002677100045340402, "StateBufferConnector_ms": 0.0017574855259486607, "ViewRequirementAgentConnector_ms": 0.04726137433733259}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -24047.283666174328, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4679626290202865, "mean_inference_ms": 0.2524927827894282, "mean_action_processing_ms": 0.059750931209332614, "mean_env_wait_ms": 1.6944768413118465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002677100045340402, "StateBufferConnector_ms": 0.0017574855259486607, "ViewRequirementAgentConnector_ms": 0.04726137433733259}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5104320, "num_agent_steps_trained": 5104320, "num_env_steps_sampled": 5104320, "num_env_steps_trained": 5104320, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 178.08057573797586, "num_env_steps_trained_throughput_per_sec": 178.08057573797586, "timesteps_total": 5104320, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5104320, "timers": {"training_iteration_time_ms": 2065.833, "sample_time_ms": 2061.001, "load_time_ms": 0.208, "load_throughput": 1729411.797, "learn_time_ms": 4.109, "learn_throughput": 87612.025, "synch_weights_time_ms": 0.486}, "counters": {"num_env_steps_sampled": 5104320, "num_env_steps_trained": 5104320, "num_agent_steps_sampled": 5104320, "num_agent_steps_trained": 5104320}, "done": false, "episodes_total": 1223, "training_iteration": 583, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-39-13", "timestamp": 1690288753, "time_this_iter_s": 10.109551906585693, "time_total_s": 10210.543545484543, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 30.912001848220825, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 28.18, "ram_util_percent": 76.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0008500000000000001, "entropy_coeff": 0.3, "policy_entropy": -891.8568115234375, "policy_loss": -1.8236418737097933e+17, "vf_loss": 1191973888.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 55.0}}, "num_env_steps_sampled": 5106120, "num_env_steps_trained": 5106120, "num_agent_steps_sampled": 5106120, "num_agent_steps_trained": 5106120}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -24451.430615908223, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.456338013125222, "mean_inference_ms": 0.2523755589757626, "mean_action_processing_ms": 0.0597251372055881, "mean_env_wait_ms": 1.572985325218047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002513433757581209, "StateBufferConnector_ms": 0.001750494304456209, "ViewRequirementAgentConnector_ms": 0.04672000282689145}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -24451.430615908223, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.456338013125222, "mean_inference_ms": 0.2523755589757626, "mean_action_processing_ms": 0.0597251372055881, "mean_env_wait_ms": 1.572985325218047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002513433757581209, "StateBufferConnector_ms": 0.001750494304456209, "ViewRequirementAgentConnector_ms": 0.04672000282689145}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5106120, "num_agent_steps_trained": 5106120, "num_env_steps_sampled": 5106120, "num_env_steps_trained": 5106120, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 177.0684877640757, "num_env_steps_trained_throughput_per_sec": 177.0684877640757, "timesteps_total": 5106120, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5106120, "timers": {"training_iteration_time_ms": 2027.325, "sample_time_ms": 2022.472, "load_time_ms": 0.211, "load_throughput": 1704231.874, "learn_time_ms": 4.125, "learn_throughput": 87266.19, "synch_weights_time_ms": 0.487}, "counters": {"num_env_steps_sampled": 5106120, "num_env_steps_trained": 5106120, "num_agent_steps_sampled": 5106120, "num_agent_steps_trained": 5106120}, "done": false, "episodes_total": 1228, "training_iteration": 584, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-39-23", "timestamp": 1690288763, "time_this_iter_s": 10.167475938796997, "time_total_s": 10220.71102142334, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 41.07947778701782, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 30.72142857142857, "ram_util_percent": 76.92857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0007250000000000001, "entropy_coeff": 0.3, "policy_entropy": -903.6123250325521, "policy_loss": -9938884325120220.0, "vf_loss": 1198187648.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 5107920, "num_env_steps_trained": 5107920, "num_agent_steps_sampled": 5107920, "num_agent_steps_trained": 5107920}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -24692.46376694056, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.445966974316452, "mean_inference_ms": 0.2521051413586913, "mean_action_processing_ms": 0.05966522902593594, "mean_env_wait_ms": 1.4884376550520226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002574920654296875, "StateBufferConnector_ms": 0.001781185468037923, "ViewRequirementAgentConnector_ms": 0.04689196745554606}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -24692.46376694056, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.445966974316452, "mean_inference_ms": 0.2521051413586913, "mean_action_processing_ms": 0.05966522902593594, "mean_env_wait_ms": 1.4884376550520226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002574920654296875, "StateBufferConnector_ms": 0.001781185468037923, "ViewRequirementAgentConnector_ms": 0.04689196745554606}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5107920, "num_agent_steps_trained": 5107920, "num_env_steps_sampled": 5107920, "num_env_steps_trained": 5107920, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 178.6319462677935, "num_env_steps_trained_throughput_per_sec": 178.6319462677935, "timesteps_total": 5107920, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5107920, "timers": {"training_iteration_time_ms": 2024.205, "sample_time_ms": 2019.308, "load_time_ms": 0.214, "load_throughput": 1679027.51, "learn_time_ms": 4.147, "learn_throughput": 86815.126, "synch_weights_time_ms": 0.505}, "counters": {"num_env_steps_sampled": 5107920, "num_env_steps_trained": 5107920, "num_agent_steps_sampled": 5107920, "num_agent_steps_trained": 5107920}, "done": false, "episodes_total": 1233, "training_iteration": 585, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-39-33", "timestamp": 1690288773, "time_this_iter_s": 10.07859992980957, "time_total_s": 10230.78962135315, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 51.15807771682739, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.86428571428571, "ram_util_percent": 77.17142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.0006000000000000001, "entropy_coeff": 0.3, "policy_entropy": -913.6453247070312, "policy_loss": -1.1007090566050611e+17, "vf_loss": 1198092757.3333333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 85.0}}, "num_env_steps_sampled": 5109720, "num_env_steps_trained": 5109720, "num_agent_steps_sampled": 5109720, "num_agent_steps_trained": 5109720}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -24829.226140049, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4400150229521795, "mean_inference_ms": 0.2518089187445108, "mean_action_processing_ms": 0.05961041300642372, "mean_env_wait_ms": 1.4254432116613638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025954739800814926, "StateBufferConnector_ms": 0.0017971828066069505, "ViewRequirementAgentConnector_ms": 0.046518753314840386}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -24829.226140049, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4400150229521795, "mean_inference_ms": 0.2518089187445108, "mean_action_processing_ms": 0.05961041300642372, "mean_env_wait_ms": 1.4254432116613638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025954739800814926, "StateBufferConnector_ms": 0.0017971828066069505, "ViewRequirementAgentConnector_ms": 0.046518753314840386}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5109720, "num_agent_steps_trained": 5109720, "num_env_steps_sampled": 5109720, "num_env_steps_trained": 5109720, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 175.8859877704591, "num_env_steps_trained_throughput_per_sec": 175.8859877704591, "timesteps_total": 5109720, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5109720, "timers": {"training_iteration_time_ms": 2031.039, "sample_time_ms": 2026.149, "load_time_ms": 0.219, "load_throughput": 1645542.11, "learn_time_ms": 4.129, "learn_throughput": 87194.632, "synch_weights_time_ms": 0.512}, "counters": {"num_env_steps_sampled": 5109720, "num_env_steps_trained": 5109720, "num_agent_steps_sampled": 5109720, "num_agent_steps_trained": 5109720}, "done": false, "episodes_total": 1238, "training_iteration": 586, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-39-43", "timestamp": 1690288783, "time_this_iter_s": 10.23595404624939, "time_total_s": 10241.025575399399, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 61.39403176307678, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 30.126666666666665, "ram_util_percent": 77.48666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.000475, "entropy_coeff": 0.3, "policy_entropy": -920.2526245117188, "policy_loss": -1.0759198233508714e+16, "vf_loss": 1183511146.6666667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 101.0, "diff_num_grad_updates_vs_sampler_policy": 100.0}}, "num_env_steps_sampled": 5111520, "num_env_steps_trained": 5111520, "num_agent_steps_sampled": 5111520, "num_agent_steps_trained": 5111520}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -24922.12149782873, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.435459310725457, "mean_inference_ms": 0.2515395162393925, "mean_action_processing_ms": 0.059558019295010436, "mean_env_wait_ms": 1.3763853130429895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025328467873965994, "StateBufferConnector_ms": 0.0017832307254566865, "ViewRequirementAgentConnector_ms": 0.04633805331061868}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -24922.12149782873, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.435459310725457, "mean_inference_ms": 0.2515395162393925, "mean_action_processing_ms": 0.059558019295010436, "mean_env_wait_ms": 1.3763853130429895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025328467873965994, "StateBufferConnector_ms": 0.0017832307254566865, "ViewRequirementAgentConnector_ms": 0.04633805331061868}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5111520, "num_agent_steps_trained": 5111520, "num_env_steps_sampled": 5111520, "num_env_steps_trained": 5111520, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 177.10904584361938, "num_env_steps_trained_throughput_per_sec": 177.10904584361938, "timesteps_total": 5111520, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5111520, "timers": {"training_iteration_time_ms": 2039.704, "sample_time_ms": 2034.775, "load_time_ms": 0.232, "load_throughput": 1555045.767, "learn_time_ms": 4.136, "learn_throughput": 87039.321, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 5111520, "num_env_steps_trained": 5111520, "num_agent_steps_sampled": 5111520, "num_agent_steps_trained": 5111520}, "done": false, "episodes_total": 1243, "training_iteration": 587, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-39-53", "timestamp": 1690288793, "time_this_iter_s": 10.165310859680176, "time_total_s": 10251.190886259079, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 71.55934262275696, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 27.70714285714286, "ram_util_percent": 75.25714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00035000000000000005, "entropy_coeff": 0.3, "policy_entropy": -922.9535319010416, "policy_loss": -5741257103413717.0, "vf_loss": 1186487082.6666667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 116.0, "diff_num_grad_updates_vs_sampler_policy": 115.0}}, "num_env_steps_sampled": 5113320, "num_env_steps_trained": 5113320, "num_agent_steps_sampled": 5113320, "num_agent_steps_trained": 5113320}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25005.353466494726, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.431926537288971, "mean_inference_ms": 0.2513523552474074, "mean_action_processing_ms": 0.059523235802846665, "mean_env_wait_ms": 1.3374637658333772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024887231680063102, "StateBufferConnector_ms": 0.0017624634962815505, "ViewRequirementAgentConnector_ms": 0.04632717523819361}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25005.353466494726, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.431926537288971, "mean_inference_ms": 0.2513523552474074, "mean_action_processing_ms": 0.059523235802846665, "mean_env_wait_ms": 1.3374637658333772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024887231680063102, "StateBufferConnector_ms": 0.0017624634962815505, "ViewRequirementAgentConnector_ms": 0.04632717523819361}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5113320, "num_agent_steps_trained": 5113320, "num_env_steps_sampled": 5113320, "num_env_steps_trained": 5113320, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 175.78066457840006, "num_env_steps_trained_throughput_per_sec": 175.78066457840006, "timesteps_total": 5113320, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5113320, "timers": {"training_iteration_time_ms": 2040.317, "sample_time_ms": 2035.227, "load_time_ms": 0.284, "load_throughput": 1265462.152, "learn_time_ms": 4.238, "learn_throughput": 84953.664, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 5113320, "num_env_steps_trained": 5113320, "num_agent_steps_sampled": 5113320, "num_agent_steps_trained": 5113320}, "done": false, "episodes_total": 1248, "training_iteration": 588, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-40-04", "timestamp": 1690288804, "time_this_iter_s": 10.241997241973877, "time_total_s": 10261.432883501053, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 81.80133986473083, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 25.946666666666665, "ram_util_percent": 76.91999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.000235, "entropy_coeff": 0.3, "policy_entropy": -924.3449300130209, "policy_loss": -1.2524967997448458e+16, "vf_loss": 1191455040.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 131.0, "diff_num_grad_updates_vs_sampler_policy": 130.0}}, "num_env_steps_sampled": 5115120, "num_env_steps_trained": 5115120, "num_agent_steps_sampled": 5115120, "num_agent_steps_trained": 5115120}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25057.146119814704, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.429153446603031, "mean_inference_ms": 0.25118905217870563, "mean_action_processing_ms": 0.05949330533118098, "mean_env_wait_ms": 1.3051363965998364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002567876469005238, "StateBufferConnector_ms": 0.0017464160919189453, "ViewRequirementAgentConnector_ms": 0.04620822993191806}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25057.146119814704, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.429153446603031, "mean_inference_ms": 0.25118905217870563, "mean_action_processing_ms": 0.05949330533118098, "mean_env_wait_ms": 1.3051363965998364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002567876469005238, "StateBufferConnector_ms": 0.0017464160919189453, "ViewRequirementAgentConnector_ms": 0.04620822993191806}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5115120, "num_agent_steps_trained": 5115120, "num_env_steps_sampled": 5115120, "num_env_steps_trained": 5115120, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 177.14394464533294, "num_env_steps_trained_throughput_per_sec": 177.14394464533294, "timesteps_total": 5115120, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5115120, "timers": {"training_iteration_time_ms": 2040.116, "sample_time_ms": 2034.968, "load_time_ms": 0.284, "load_throughput": 1266736.107, "learn_time_ms": 4.301, "learn_throughput": 83693.121, "synch_weights_time_ms": 0.524}, "counters": {"num_env_steps_sampled": 5115120, "num_env_steps_trained": 5115120, "num_agent_steps_sampled": 5115120, "num_agent_steps_trained": 5115120}, "done": false, "episodes_total": 1253, "training_iteration": 589, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-40-14", "timestamp": 1690288814, "time_this_iter_s": 10.163357019424438, "time_total_s": 10271.596240520477, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 91.96469688415527, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 28.107142857142858, "ram_util_percent": 76.62857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00015999999999999999, "entropy_coeff": 0.3, "policy_entropy": -925.0920003255209, "policy_loss": -1.069279068428777e+16, "vf_loss": 1167970048.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 146.0, "diff_num_grad_updates_vs_sampler_policy": 145.0}}, "num_env_steps_sampled": 5116920, "num_env_steps_trained": 5116920, "num_agent_steps_sampled": 5116920, "num_agent_steps_trained": 5116920}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25090.082063034482, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.42745324144313, "mean_inference_ms": 0.25103789456932624, "mean_action_processing_ms": 0.05946484543929964, "mean_env_wait_ms": 1.2783175400918008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025963296695631377, "StateBufferConnector_ms": 0.001747267586844308, "ViewRequirementAgentConnector_ms": 0.046379225594656806}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25090.082063034482, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.42745324144313, "mean_inference_ms": 0.25103789456932624, "mean_action_processing_ms": 0.05946484543929964, "mean_env_wait_ms": 1.2783175400918008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025963296695631377, "StateBufferConnector_ms": 0.001747267586844308, "ViewRequirementAgentConnector_ms": 0.046379225594656806}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5116920, "num_agent_steps_trained": 5116920, "num_env_steps_sampled": 5116920, "num_env_steps_trained": 5116920, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 174.0498960818166, "num_env_steps_trained_throughput_per_sec": 174.0498960818166, "timesteps_total": 5116920, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5116920, "timers": {"training_iteration_time_ms": 2050.299, "sample_time_ms": 2045.266, "load_time_ms": 0.234, "load_throughput": 1541079.241, "learn_time_ms": 4.235, "learn_throughput": 84999.574, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 5116920, "num_env_steps_trained": 5116920, "num_agent_steps_sampled": 5116920, "num_agent_steps_trained": 5116920}, "done": false, "episodes_total": 1258, "training_iteration": 590, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-40-24", "timestamp": 1690288824, "time_this_iter_s": 10.343906879425049, "time_total_s": 10281.940147399902, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 102.30860376358032, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 27.893333333333327, "ram_util_percent": 78.15333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.75e-05, "entropy_coeff": 0.3, "policy_entropy": -925.7703247070312, "policy_loss": -8907213667257589.0, "vf_loss": 1154223381.3333333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 161.0, "diff_num_grad_updates_vs_sampler_policy": 160.0}}, "num_env_steps_sampled": 5118720, "num_env_steps_trained": 5118720, "num_agent_steps_sampled": 5118720, "num_agent_steps_trained": 5118720}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25128.906724873792, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425932934046578, "mean_inference_ms": 0.2508963857197678, "mean_action_processing_ms": 0.059439569094818435, "mean_env_wait_ms": 1.2553457851125518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025506372804994936, "StateBufferConnector_ms": 0.0017523765563964844, "ViewRequirementAgentConnector_ms": 0.04629956351386176}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25128.906724873792, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425932934046578, "mean_inference_ms": 0.2508963857197678, "mean_action_processing_ms": 0.059439569094818435, "mean_env_wait_ms": 1.2553457851125518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025506372804994936, "StateBufferConnector_ms": 0.0017523765563964844, "ViewRequirementAgentConnector_ms": 0.04629956351386176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5118720, "num_agent_steps_trained": 5118720, "num_env_steps_sampled": 5118720, "num_env_steps_trained": 5118720, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 177.03585208602468, "num_env_steps_trained_throughput_per_sec": 177.03585208602468, "timesteps_total": 5118720, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5118720, "timers": {"training_iteration_time_ms": 2050.92, "sample_time_ms": 2046.017, "load_time_ms": 0.219, "load_throughput": 1641427.807, "learn_time_ms": 4.136, "learn_throughput": 87037.816, "synch_weights_time_ms": 0.517}, "counters": {"num_env_steps_sampled": 5118720, "num_env_steps_trained": 5118720, "num_agent_steps_sampled": 5118720, "num_agent_steps_trained": 5118720}, "done": false, "episodes_total": 1263, "training_iteration": 591, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-40-34", "timestamp": 1690288834, "time_this_iter_s": 10.169596910476685, "time_total_s": 10292.109744310379, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 112.478200674057, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 26.1, "ram_util_percent": 73.23333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.5e-05, "entropy_coeff": 0.3, "policy_entropy": -926.3316650390625, "policy_loss": -1.5392715821460138e+16, "vf_loss": 1176185664.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 176.0, "diff_num_grad_updates_vs_sampler_policy": 175.0}}, "num_env_steps_sampled": 5120520, "num_env_steps_trained": 5120520, "num_agent_steps_sampled": 5120520, "num_agent_steps_trained": 5120520}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25152.238193092962, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.426191875425163, "mean_inference_ms": 0.2508531126945503, "mean_action_processing_ms": 0.05942764814905751, "mean_env_wait_ms": 1.235780464664016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002519963151317532, "StateBufferConnector_ms": 0.0017396474288681805, "ViewRequirementAgentConnector_ms": 0.046168343495514436}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25152.238193092962, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.426191875425163, "mean_inference_ms": 0.2508531126945503, "mean_action_processing_ms": 0.05942764814905751, "mean_env_wait_ms": 1.235780464664016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002519963151317532, "StateBufferConnector_ms": 0.0017396474288681805, "ViewRequirementAgentConnector_ms": 0.046168343495514436}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120520, "num_agent_steps_trained": 5120520, "num_env_steps_sampled": 5120520, "num_env_steps_trained": 5120520, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 168.33985436130547, "num_env_steps_trained_throughput_per_sec": 168.33985436130547, "timesteps_total": 5120520, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5120520, "timers": {"training_iteration_time_ms": 2085.999, "sample_time_ms": 2080.988, "load_time_ms": 0.223, "load_throughput": 1610784.553, "learn_time_ms": 4.222, "learn_throughput": 85276.562, "synch_weights_time_ms": 0.535}, "counters": {"num_env_steps_sampled": 5120520, "num_env_steps_trained": 5120520, "num_agent_steps_sampled": 5120520, "num_agent_steps_trained": 5120520}, "done": false, "episodes_total": 1268, "training_iteration": 592, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-40-45", "timestamp": 1690288845, "time_this_iter_s": 10.694674968719482, "time_total_s": 10302.804419279099, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 123.17287564277649, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 34.04666666666667, "ram_util_percent": 76.12000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.25e-05, "entropy_coeff": 0.3, "policy_entropy": -926.7488403320312, "policy_loss": -1.6847431996427638e+16, "vf_loss": 1170540778.6666667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 191.0, "diff_num_grad_updates_vs_sampler_policy": 190.0}}, "num_env_steps_sampled": 5122320, "num_env_steps_trained": 5122320, "num_agent_steps_sampled": 5122320, "num_agent_steps_trained": 5122320}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25172.329054632923, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.426106459239172, "mean_inference_ms": 0.2508130584718226, "mean_action_processing_ms": 0.05941720931976907, "mean_env_wait_ms": 1.2187684897704525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002537667751312256, "StateBufferConnector_ms": 0.001743808388710022, "ViewRequirementAgentConnector_ms": 0.04610829055309296}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25172.329054632923, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.426106459239172, "mean_inference_ms": 0.2508130584718226, "mean_action_processing_ms": 0.05941720931976907, "mean_env_wait_ms": 1.2187684897704525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002537667751312256, "StateBufferConnector_ms": 0.001743808388710022, "ViewRequirementAgentConnector_ms": 0.04610829055309296}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5122320, "num_agent_steps_trained": 5122320, "num_env_steps_sampled": 5122320, "num_env_steps_trained": 5122320, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 176.52513529701793, "num_env_steps_trained_throughput_per_sec": 176.52513529701793, "timesteps_total": 5122320, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5122320, "timers": {"training_iteration_time_ms": 2088.939, "sample_time_ms": 2083.781, "load_time_ms": 0.248, "load_throughput": 1449365.944, "learn_time_ms": 4.312, "learn_throughput": 83488.582, "synch_weights_time_ms": 0.561}, "counters": {"num_env_steps_sampled": 5122320, "num_env_steps_trained": 5122320, "num_agent_steps_sampled": 5122320, "num_agent_steps_trained": 5122320}, "done": false, "episodes_total": 1273, "training_iteration": 593, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-40-55", "timestamp": 1690288855, "time_this_iter_s": 10.19911241531372, "time_total_s": 10313.003531694412, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 133.3719880580902, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 24.407142857142855, "ram_util_percent": 77.76428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6e-05, "entropy_coeff": 0.3, "policy_entropy": -926.9978434244791, "policy_loss": -7201203610707669.0, "vf_loss": 1179826112.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 206.0, "diff_num_grad_updates_vs_sampler_policy": 205.0}}, "num_env_steps_sampled": 5124120, "num_env_steps_trained": 5124120, "num_agent_steps_sampled": 5124120, "num_agent_steps_trained": 5124120}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25193.671309801117, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425952175308563, "mean_inference_ms": 0.25075009314039864, "mean_action_processing_ms": 0.05940336488506646, "mean_env_wait_ms": 1.2036895070113653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025517698647319407, "StateBufferConnector_ms": 0.0017446020375127378, "ViewRequirementAgentConnector_ms": 0.04632058350936226}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25193.671309801117, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425952175308563, "mean_inference_ms": 0.25075009314039864, "mean_action_processing_ms": 0.05940336488506646, "mean_env_wait_ms": 1.2036895070113653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025517698647319407, "StateBufferConnector_ms": 0.0017446020375127378, "ViewRequirementAgentConnector_ms": 0.04632058350936226}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5124120, "num_agent_steps_trained": 5124120, "num_env_steps_sampled": 5124120, "num_env_steps_trained": 5124120, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 176.59879541085996, "num_env_steps_trained_throughput_per_sec": 176.59879541085996, "timesteps_total": 5124120, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5124120, "timers": {"training_iteration_time_ms": 2038.933, "sample_time_ms": 2033.957, "load_time_ms": 0.239, "load_throughput": 1508893.215, "learn_time_ms": 4.173, "learn_throughput": 86271.98, "synch_weights_time_ms": 0.529}, "counters": {"num_env_steps_sampled": 5124120, "num_env_steps_trained": 5124120, "num_agent_steps_sampled": 5124120, "num_agent_steps_trained": 5124120}, "done": false, "episodes_total": 1278, "training_iteration": 594, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-41-05", "timestamp": 1690288865, "time_this_iter_s": 10.194598913192749, "time_total_s": 10323.198130607605, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 143.56658697128296, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 26.1, "ram_util_percent": 74.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.7499999999999996e-05, "entropy_coeff": 0.3, "policy_entropy": -926.1912638346354, "policy_loss": -3085770701900290.5, "vf_loss": 1179995968.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 221.0, "diff_num_grad_updates_vs_sampler_policy": 220.0}}, "num_env_steps_sampled": 5125920, "num_env_steps_trained": 5125920, "num_agent_steps_sampled": 5125920, "num_agent_steps_trained": 5125920}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25208.102377544183, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425510932930015, "mean_inference_ms": 0.25068397650376933, "mean_action_processing_ms": 0.059389427002913844, "mean_env_wait_ms": 1.1902608093488602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025195044440192147, "StateBufferConnector_ms": 0.001745610623746305, "ViewRequirementAgentConnector_ms": 0.046202943131730366}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25208.102377544183, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.425510932930015, "mean_inference_ms": 0.25068397650376933, "mean_action_processing_ms": 0.059389427002913844, "mean_env_wait_ms": 1.1902608093488602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025195044440192147, "StateBufferConnector_ms": 0.001745610623746305, "ViewRequirementAgentConnector_ms": 0.046202943131730366}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5125920, "num_agent_steps_trained": 5125920, "num_env_steps_sampled": 5125920, "num_env_steps_trained": 5125920, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 177.86670416049571, "num_env_steps_trained_throughput_per_sec": 177.86670416049571, "timesteps_total": 5125920, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5125920, "timers": {"training_iteration_time_ms": 2031.244, "sample_time_ms": 2026.353, "load_time_ms": 0.216, "load_throughput": 1669559.31, "learn_time_ms": 4.137, "learn_throughput": 87009.228, "synch_weights_time_ms": 0.507}, "counters": {"num_env_steps_sampled": 5125920, "num_env_steps_trained": 5125920, "num_agent_steps_sampled": 5125920, "num_agent_steps_trained": 5125920}, "done": false, "episodes_total": 1283, "training_iteration": 595, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-41-16", "timestamp": 1690288876, "time_this_iter_s": 10.12208366394043, "time_total_s": 10333.320214271545, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 153.6886706352234, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.985714285714288, "ram_util_percent": 74.98571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.5000000000000004e-05, "entropy_coeff": 0.3, "policy_entropy": -924.9184977213541, "policy_loss": -2911987989477824.0, "vf_loss": 1167709098.6666667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 236.0, "diff_num_grad_updates_vs_sampler_policy": 235.0}}, "num_env_steps_sampled": 5127720, "num_env_steps_trained": 5127720, "num_agent_steps_sampled": 5127720, "num_agent_steps_trained": 5127720}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25220.635392582302, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424872236488881, "mean_inference_ms": 0.25062890353730033, "mean_action_processing_ms": 0.05937847794129623, "mean_env_wait_ms": 1.1782471817248947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024898142754277096, "StateBufferConnector_ms": 0.0017410592187809039, "ViewRequirementAgentConnector_ms": 0.04611407654194892}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25220.635392582302, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424872236488881, "mean_inference_ms": 0.25062890353730033, "mean_action_processing_ms": 0.05937847794129623, "mean_env_wait_ms": 1.1782471817248947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024898142754277096, "StateBufferConnector_ms": 0.0017410592187809039, "ViewRequirementAgentConnector_ms": 0.04611407654194892}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5127720, "num_agent_steps_trained": 5127720, "num_env_steps_sampled": 5127720, "num_env_steps_trained": 5127720, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 177.51701575204723, "num_env_steps_trained_throughput_per_sec": 177.51701575204723, "timesteps_total": 5127720, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5127720, "timers": {"training_iteration_time_ms": 2025.971, "sample_time_ms": 2021.026, "load_time_ms": 0.218, "load_throughput": 1654739.112, "learn_time_ms": 4.155, "learn_throughput": 86651.714, "synch_weights_time_ms": 0.536}, "counters": {"num_env_steps_sampled": 5127720, "num_env_steps_trained": 5127720, "num_agent_steps_sampled": 5127720, "num_agent_steps_trained": 5127720}, "done": false, "episodes_total": 1288, "training_iteration": 596, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-41-26", "timestamp": 1690288886, "time_this_iter_s": 10.1426260471344, "time_total_s": 10343.46284031868, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 163.8312966823578, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 25.6, "ram_util_percent": 74.51333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3500000000000002e-05, "entropy_coeff": 0.3, "policy_entropy": -924.8171590169271, "policy_loss": -4087093589878762.5, "vf_loss": 1194329024.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 251.0, "diff_num_grad_updates_vs_sampler_policy": 250.0}}, "num_env_steps_sampled": 5129520, "num_env_steps_trained": 5129520, "num_agent_steps_sampled": 5129520, "num_agent_steps_trained": 5129520}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25225.40055202196, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805, -25312.966029271483, -25397.289550438523, -24978.81774803996, -25133.160378575325, -25681.216649517417], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424122619991191, "mean_inference_ms": 0.2505885429108346, "mean_action_processing_ms": 0.05937026220175866, "mean_env_wait_ms": 1.1674294140375832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002490622656685965, "StateBufferConnector_ms": 0.0017441454387846448, "ViewRequirementAgentConnector_ms": 0.046083473023914155}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25225.40055202196, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805, -25312.966029271483, -25397.289550438523, -24978.81774803996, -25133.160378575325, -25681.216649517417], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.424122619991191, "mean_inference_ms": 0.2505885429108346, "mean_action_processing_ms": 0.05937026220175866, "mean_env_wait_ms": 1.1674294140375832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002490622656685965, "StateBufferConnector_ms": 0.0017441454387846448, "ViewRequirementAgentConnector_ms": 0.046083473023914155}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5129520, "num_agent_steps_trained": 5129520, "num_env_steps_sampled": 5129520, "num_env_steps_trained": 5129520, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 177.188512758669, "num_env_steps_trained_throughput_per_sec": 177.188512758669, "timesteps_total": 5129520, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5129520, "timers": {"training_iteration_time_ms": 2029.844, "sample_time_ms": 2024.819, "load_time_ms": 0.219, "load_throughput": 1643392.947, "learn_time_ms": 4.215, "learn_throughput": 85405.829, "synch_weights_time_ms": 0.554}, "counters": {"num_env_steps_sampled": 5129520, "num_env_steps_trained": 5129520, "num_agent_steps_sampled": 5129520, "num_agent_steps_trained": 5129520}, "done": false, "episodes_total": 1293, "training_iteration": 597, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-41-36", "timestamp": 1690288896, "time_this_iter_s": 10.160650968551636, "time_total_s": 10353.623491287231, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 173.99194765090942, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 24.36428571428571, "ram_util_percent": 74.55714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.6000000000000003e-05, "entropy_coeff": 0.3, "policy_entropy": -924.8715006510416, "policy_loss": -877834373431296.0, "vf_loss": 1136400576.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 266.0, "diff_num_grad_updates_vs_sampler_policy": 265.0}}, "num_env_steps_sampled": 5131320, "num_env_steps_trained": 5131320, "num_agent_steps_sampled": 5131320, "num_agent_steps_trained": 5131320}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25228.28559610231, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805, -25312.966029271483, -25397.289550438523, -24978.81774803996, -25133.160378575325, -25681.216649517417, -25397.775069728494, -25411.654362261295, -25362.310156032443, -25185.6589794755, -25026.37311576307], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423334189179059, "mean_inference_ms": 0.25055559340484235, "mean_action_processing_ms": 0.059365596332041276, "mean_env_wait_ms": 1.157684722770218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024854467156228055, "StateBufferConnector_ms": 0.0017511710691987799, "ViewRequirementAgentConnector_ms": 0.0459799605808901}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25228.28559610231, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805, -25312.966029271483, -25397.289550438523, -24978.81774803996, -25133.160378575325, -25681.216649517417, -25397.775069728494, -25411.654362261295, -25362.310156032443, -25185.6589794755, -25026.37311576307], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.423334189179059, "mean_inference_ms": 0.25055559340484235, "mean_action_processing_ms": 0.059365596332041276, "mean_env_wait_ms": 1.157684722770218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024854467156228055, "StateBufferConnector_ms": 0.0017511710691987799, "ViewRequirementAgentConnector_ms": 0.0459799605808901}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5131320, "num_agent_steps_trained": 5131320, "num_env_steps_sampled": 5131320, "num_env_steps_trained": 5131320, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 176.39306531951124, "num_env_steps_trained_throughput_per_sec": 176.39306531951124, "timesteps_total": 5131320, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5131320, "timers": {"training_iteration_time_ms": 2036.306, "sample_time_ms": 2031.316, "load_time_ms": 0.22, "load_throughput": 1639645.39, "learn_time_ms": 4.208, "learn_throughput": 85552.452, "synch_weights_time_ms": 0.531}, "counters": {"num_env_steps_sampled": 5131320, "num_env_steps_trained": 5131320, "num_agent_steps_sampled": 5131320, "num_agent_steps_trained": 5131320}, "done": false, "episodes_total": 1298, "training_iteration": 598, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-41-46", "timestamp": 1690288906, "time_this_iter_s": 10.206488132476807, "time_total_s": 10363.829979419708, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 184.19843578338623, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 23.200000000000003, "ram_util_percent": 75.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.750000000000002e-06, "entropy_coeff": 0.3, "policy_entropy": -924.9119466145834, "policy_loss": -916670015777450.6, "vf_loss": 1176670378.6666667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 281.0, "diff_num_grad_updates_vs_sampler_policy": 280.0}}, "num_env_steps_sampled": 5133120, "num_env_steps_trained": 5133120, "num_agent_steps_sampled": 5133120, "num_agent_steps_trained": 5133120}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25234.053065957225, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805, -25312.966029271483, -25397.289550438523, -24978.81774803996, -25133.160378575325, -25681.216649517417, -25397.775069728494, -25411.654362261295, -25362.310156032443, -25185.6589794755, -25026.37311576307, -25276.638649240136, -25388.129903122783, -25302.974439024925, -25161.56651417911, -25554.26064130664], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4224413952967305, "mean_inference_ms": 0.2505150475571536, "mean_action_processing_ms": 0.05935979089044082, "mean_env_wait_ms": 1.1487571608984668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024668713833423373, "StateBufferConnector_ms": 0.001754912924259267, "ViewRequirementAgentConnector_ms": 0.04594706474466527}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25234.053065957225, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805, -25312.966029271483, -25397.289550438523, -24978.81774803996, -25133.160378575325, -25681.216649517417, -25397.775069728494, -25411.654362261295, -25362.310156032443, -25185.6589794755, -25026.37311576307, -25276.638649240136, -25388.129903122783, -25302.974439024925, -25161.56651417911, -25554.26064130664], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.4224413952967305, "mean_inference_ms": 0.2505150475571536, "mean_action_processing_ms": 0.05935979089044082, "mean_env_wait_ms": 1.1487571608984668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024668713833423373, "StateBufferConnector_ms": 0.001754912924259267, "ViewRequirementAgentConnector_ms": 0.04594706474466527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5133120, "num_agent_steps_trained": 5133120, "num_env_steps_sampled": 5133120, "num_env_steps_trained": 5133120, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 178.58648440615758, "num_env_steps_trained_throughput_per_sec": 178.58648440615758, "timesteps_total": 5133120, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5133120, "timers": {"training_iteration_time_ms": 2028.354, "sample_time_ms": 2023.367, "load_time_ms": 0.218, "load_throughput": 1650037.635, "learn_time_ms": 4.218, "learn_throughput": 85354.654, "synch_weights_time_ms": 0.52}, "counters": {"num_env_steps_sampled": 5133120, "num_env_steps_trained": 5133120, "num_agent_steps_sampled": 5133120, "num_agent_steps_trained": 5133120}, "done": false, "episodes_total": 1303, "training_iteration": 599, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-41-56", "timestamp": 1690288916, "time_this_iter_s": 10.081963062286377, "time_total_s": 10373.911942481995, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 194.2803988456726, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 21.507142857142856, "ram_util_percent": 76.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.5e-06, "entropy_coeff": 0.3, "policy_entropy": -924.9434407552084, "policy_loss": -285115627120698.7, "vf_loss": 1173462208.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 296.0, "diff_num_grad_updates_vs_sampler_policy": 295.0}}, "num_env_steps_sampled": 5134920, "num_env_steps_trained": 5134920, "num_agent_steps_sampled": 5134920, "num_agent_steps_trained": 5134920}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25247.1168082668, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805, -25312.966029271483, -25397.289550438523, -24978.81774803996, -25133.160378575325, -25681.216649517417, -25397.775069728494, -25411.654362261295, -25362.310156032443, -25185.6589794755, -25026.37311576307, -25276.638649240136, -25388.129903122783, -25302.974439024925, -25161.56651417911, -25554.26064130664, -25473.460461631417, -25445.893747359514, -25551.559502780437, -25553.00134691596, -25439.66075974703], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.421625967597552, "mean_inference_ms": 0.25047727574437756, "mean_action_processing_ms": 0.05935392850530057, "mean_env_wait_ms": 1.1405690709923877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002458842113764599, "StateBufferConnector_ms": 0.0017621300437233665, "ViewRequirementAgentConnector_ms": 0.04611737800366951}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25247.1168082668, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22884.46408493817, -22946.200150683522, -22714.44482511282, -22766.01853890717, -22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805, -25312.966029271483, -25397.289550438523, -24978.81774803996, -25133.160378575325, -25681.216649517417, -25397.775069728494, -25411.654362261295, -25362.310156032443, -25185.6589794755, -25026.37311576307, -25276.638649240136, -25388.129903122783, -25302.974439024925, -25161.56651417911, -25554.26064130664, -25473.460461631417, -25445.893747359514, -25551.559502780437, -25553.00134691596, -25439.66075974703], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.421625967597552, "mean_inference_ms": 0.25047727574437756, "mean_action_processing_ms": 0.05935392850530057, "mean_env_wait_ms": 1.1405690709923877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002458842113764599, "StateBufferConnector_ms": 0.0017621300437233665, "ViewRequirementAgentConnector_ms": 0.04611737800366951}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5134920, "num_agent_steps_trained": 5134920, "num_env_steps_sampled": 5134920, "num_env_steps_trained": 5134920, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 176.37251496238, "num_env_steps_trained_throughput_per_sec": 176.37251496238, "timesteps_total": 5134920, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5134920, "timers": {"training_iteration_time_ms": 2028.473, "sample_time_ms": 2023.457, "load_time_ms": 0.216, "load_throughput": 1663856.132, "learn_time_ms": 4.252, "learn_throughput": 84662.15, "synch_weights_time_ms": 0.516}, "counters": {"num_env_steps_sampled": 5134920, "num_env_steps_trained": 5134920, "num_agent_steps_sampled": 5134920, "num_agent_steps_trained": 5134920}, "done": false, "episodes_total": 1308, "training_iteration": 600, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-42-06", "timestamp": 1690288926, "time_this_iter_s": 10.207945108413696, "time_total_s": 10384.119887590408, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 204.4883439540863, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 25.471428571428568, "ram_util_percent": 76.39285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.25e-06, "entropy_coeff": 0.3, "policy_entropy": -924.9616088867188, "policy_loss": -331594309635126.7, "vf_loss": 1154967701.3333333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 310.0}}, "num_env_steps_sampled": 5136720, "num_env_steps_trained": 5136720, "num_agent_steps_sampled": 5136720, "num_agent_steps_trained": 5136720}, "sampler_results": {"episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25350.5726924032, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805, -25312.966029271483, -25397.289550438523, -24978.81774803996, -25133.160378575325, -25681.216649517417, -25397.775069728494, -25411.654362261295, -25362.310156032443, -25185.6589794755, -25026.37311576307, -25276.638649240136, -25388.129903122783, -25302.974439024925, -25161.56651417911, -25554.26064130664, -25473.460461631417, -25445.893747359514, -25551.559502780437, -25553.00134691596, -25439.66075974703, -25355.057938620448, -25333.008188843727, -25568.274744182825, -25441.14853988588, -25206.343410015106], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417783062031122, "mean_inference_ms": 0.2505014748049894, "mean_action_processing_ms": 0.05935228151331681, "mean_env_wait_ms": 1.0879545204861716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002454996109008789, "StateBufferConnector_ms": 0.001756906509399414, "ViewRequirementAgentConnector_ms": 0.04610633850097656}}, "episode_reward_max": -22665.862880542874, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25350.5726924032, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-22665.862880542874, -22756.313285931945, -23052.900468930602, -22779.708947494626, -24103.0360134691, -25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805, -25312.966029271483, -25397.289550438523, -24978.81774803996, -25133.160378575325, -25681.216649517417, -25397.775069728494, -25411.654362261295, -25362.310156032443, -25185.6589794755, -25026.37311576307, -25276.638649240136, -25388.129903122783, -25302.974439024925, -25161.56651417911, -25554.26064130664, -25473.460461631417, -25445.893747359514, -25551.559502780437, -25553.00134691596, -25439.66075974703, -25355.057938620448, -25333.008188843727, -25568.274744182825, -25441.14853988588, -25206.343410015106], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.417783062031122, "mean_inference_ms": 0.2505014748049894, "mean_action_processing_ms": 0.05935228151331681, "mean_env_wait_ms": 1.0879545204861716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002454996109008789, "StateBufferConnector_ms": 0.001756906509399414, "ViewRequirementAgentConnector_ms": 0.04610633850097656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5136720, "num_agent_steps_trained": 5136720, "num_env_steps_sampled": 5136720, "num_env_steps_trained": 5136720, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 175.1803013712552, "num_env_steps_trained_throughput_per_sec": 175.1803013712552, "timesteps_total": 5136720, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5136720, "timers": {"training_iteration_time_ms": 2048.071, "sample_time_ms": 2042.838, "load_time_ms": 0.227, "load_throughput": 1589253.173, "learn_time_ms": 4.433, "learn_throughput": 81213.261, "synch_weights_time_ms": 0.542}, "counters": {"num_env_steps_sampled": 5136720, "num_env_steps_trained": 5136720, "num_agent_steps_sampled": 5136720, "num_agent_steps_trained": 5136720}, "done": false, "episodes_total": 1313, "training_iteration": 601, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-42-17", "timestamp": 1690288937, "time_this_iter_s": 10.27726411819458, "time_total_s": 10394.397151708603, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 214.76560807228088, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 31.433333333333337, "ram_util_percent": 76.22000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6e-06, "entropy_coeff": 0.3, "policy_entropy": -924.7442423502604, "policy_loss": -317657660500818.7, "vf_loss": 1181977088.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 326.0, "diff_num_grad_updates_vs_sampler_policy": 325.0}}, "num_env_steps_sampled": 5138520, "num_env_steps_trained": 5138520, "num_agent_steps_sampled": 5138520, "num_agent_steps_trained": 5138520}, "sampler_results": {"episode_reward_max": -24978.81774803996, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25462.977104503214, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805, -25312.966029271483, -25397.289550438523, -24978.81774803996, -25133.160378575325, -25681.216649517417, -25397.775069728494, -25411.654362261295, -25362.310156032443, -25185.6589794755, -25026.37311576307, -25276.638649240136, -25388.129903122783, -25302.974439024925, -25161.56651417911, -25554.26064130664, -25473.460461631417, -25445.893747359514, -25551.559502780437, -25553.00134691596, -25439.66075974703, -25355.057938620448, -25333.008188843727, -25568.274744182825, -25441.14853988588, -25206.343410015106, -25050.651336863637, -25067.361235037446, -25421.14469435811, -25495.88674812019, -25563.218791991472], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414373379241017, "mean_inference_ms": 0.2502506919751329, "mean_action_processing_ms": 0.059310551872733236, "mean_env_wait_ms": 1.057449027066227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024394989013671875, "StateBufferConnector_ms": 0.0017635822296142578, "ViewRequirementAgentConnector_ms": 0.04590892791748047}}, "episode_reward_max": -24978.81774803996, "episode_reward_min": -26388.35151064396, "episode_reward_mean": -25462.977104503214, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25764.096579268575, -25754.364233121276, -26388.35151064396, -26208.970539331436, -25877.2392680645, -25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805, -25312.966029271483, -25397.289550438523, -24978.81774803996, -25133.160378575325, -25681.216649517417, -25397.775069728494, -25411.654362261295, -25362.310156032443, -25185.6589794755, -25026.37311576307, -25276.638649240136, -25388.129903122783, -25302.974439024925, -25161.56651417911, -25554.26064130664, -25473.460461631417, -25445.893747359514, -25551.559502780437, -25553.00134691596, -25439.66075974703, -25355.057938620448, -25333.008188843727, -25568.274744182825, -25441.14853988588, -25206.343410015106, -25050.651336863637, -25067.361235037446, -25421.14469435811, -25495.88674812019, -25563.218791991472], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.414373379241017, "mean_inference_ms": 0.2502506919751329, "mean_action_processing_ms": 0.059310551872733236, "mean_env_wait_ms": 1.057449027066227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024394989013671875, "StateBufferConnector_ms": 0.0017635822296142578, "ViewRequirementAgentConnector_ms": 0.04590892791748047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5138520, "num_agent_steps_trained": 5138520, "num_env_steps_sampled": 5138520, "num_env_steps_trained": 5138520, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 177.87869374235964, "num_env_steps_trained_throughput_per_sec": 177.87869374235964, "timesteps_total": 5138520, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5138520, "timers": {"training_iteration_time_ms": 2039.429, "sample_time_ms": 2034.164, "load_time_ms": 0.227, "load_throughput": 1588417.252, "learn_time_ms": 4.447, "learn_throughput": 80953.321, "synch_weights_time_ms": 0.558}, "counters": {"num_env_steps_sampled": 5138520, "num_env_steps_trained": 5138520, "num_agent_steps_sampled": 5138520, "num_agent_steps_trained": 5138520}, "done": false, "episodes_total": 1318, "training_iteration": 602, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-42-27", "timestamp": 1690288947, "time_this_iter_s": 10.121296167373657, "time_total_s": 10404.518447875977, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 224.88690423965454, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 24.693333333333328, "ram_util_percent": 74.83999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.75e-06, "entropy_coeff": 0.3, "policy_entropy": -924.6994018554688, "policy_loss": -56720853009201.336, "vf_loss": 1180016981.3333333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 341.0, "diff_num_grad_updates_vs_sampler_policy": 340.0}}, "num_env_steps_sampled": 5140320, "num_env_steps_trained": 5140320, "num_agent_steps_sampled": 5140320, "num_agent_steps_trained": 5140320}, "sampler_results": {"episode_reward_max": -24978.81774803996, "episode_reward_min": -25929.56270158291, "episode_reward_mean": -25443.793834780157, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805, -25312.966029271483, -25397.289550438523, -24978.81774803996, -25133.160378575325, -25681.216649517417, -25397.775069728494, -25411.654362261295, -25362.310156032443, -25185.6589794755, -25026.37311576307, -25276.638649240136, -25388.129903122783, -25302.974439024925, -25161.56651417911, -25554.26064130664, -25473.460461631417, -25445.893747359514, -25551.559502780437, -25553.00134691596, -25439.66075974703, -25355.057938620448, -25333.008188843727, -25568.274744182825, -25441.14853988588, -25206.343410015106, -25050.651336863637, -25067.361235037446, -25421.14469435811, -25495.88674812019, -25563.218791991472, -25662.52534136176, -25842.454625621438, -25466.192176118493, -25544.37073327601, -25559.15228174627], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412876095583593, "mean_inference_ms": 0.25004708002471215, "mean_action_processing_ms": 0.0592735135366667, "mean_env_wait_ms": 1.0389611100732634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024318695068359375, "StateBufferConnector_ms": 0.0017631053924560547, "ViewRequirementAgentConnector_ms": 0.04588890075683594}}, "episode_reward_max": -24978.81774803996, "episode_reward_min": -25929.56270158291, "episode_reward_mean": -25443.793834780157, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25765.501776874065, -25586.220947742462, -25244.4606282562, -25672.146704524755, -25646.880318418145, -25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805, -25312.966029271483, -25397.289550438523, -24978.81774803996, -25133.160378575325, -25681.216649517417, -25397.775069728494, -25411.654362261295, -25362.310156032443, -25185.6589794755, -25026.37311576307, -25276.638649240136, -25388.129903122783, -25302.974439024925, -25161.56651417911, -25554.26064130664, -25473.460461631417, -25445.893747359514, -25551.559502780437, -25553.00134691596, -25439.66075974703, -25355.057938620448, -25333.008188843727, -25568.274744182825, -25441.14853988588, -25206.343410015106, -25050.651336863637, -25067.361235037446, -25421.14469435811, -25495.88674812019, -25563.218791991472, -25662.52534136176, -25842.454625621438, -25466.192176118493, -25544.37073327601, -25559.15228174627], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.412876095583593, "mean_inference_ms": 0.25004708002471215, "mean_action_processing_ms": 0.0592735135366667, "mean_env_wait_ms": 1.0389611100732634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024318695068359375, "StateBufferConnector_ms": 0.0017631053924560547, "ViewRequirementAgentConnector_ms": 0.04588890075683594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5140320, "num_agent_steps_trained": 5140320, "num_env_steps_sampled": 5140320, "num_env_steps_trained": 5140320, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 178.1519413690116, "num_env_steps_trained_throughput_per_sec": 178.1519413690116, "timesteps_total": 5140320, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5140320, "timers": {"training_iteration_time_ms": 2022.289, "sample_time_ms": 2017.333, "load_time_ms": 0.219, "load_throughput": 1643750.751, "learn_time_ms": 4.174, "learn_throughput": 86248.818, "synch_weights_time_ms": 0.532}, "counters": {"num_env_steps_sampled": 5140320, "num_env_steps_trained": 5140320, "num_agent_steps_sampled": 5140320, "num_agent_steps_trained": 5140320}, "done": false, "episodes_total": 1323, "training_iteration": 603, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-42-37", "timestamp": 1690288957, "time_this_iter_s": 10.105840921401978, "time_total_s": 10414.624288797379, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 234.99274516105652, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 25.68571428571428, "ram_util_percent": 74.41428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.5000000000000004e-06, "entropy_coeff": 0.3, "policy_entropy": -924.6954752604166, "policy_loss": -105800852141525.33, "vf_loss": 1160650154.6666667}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 356.0, "diff_num_grad_updates_vs_sampler_policy": 355.0}}, "num_env_steps_sampled": 5142120, "num_env_steps_trained": 5142120, "num_agent_steps_sampled": 5142120, "num_agent_steps_trained": 5142120}, "sampler_results": {"episode_reward_max": -24978.81774803996, "episode_reward_min": -25929.56270158291, "episode_reward_mean": -25438.39047505036, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805, -25312.966029271483, -25397.289550438523, -24978.81774803996, -25133.160378575325, -25681.216649517417, -25397.775069728494, -25411.654362261295, -25362.310156032443, -25185.6589794755, -25026.37311576307, -25276.638649240136, -25388.129903122783, -25302.974439024925, -25161.56651417911, -25554.26064130664, -25473.460461631417, -25445.893747359514, -25551.559502780437, -25553.00134691596, -25439.66075974703, -25355.057938620448, -25333.008188843727, -25568.274744182825, -25441.14853988588, -25206.343410015106, -25050.651336863637, -25067.361235037446, -25421.14469435811, -25495.88674812019, -25563.218791991472, -25662.52534136176, -25842.454625621438, -25466.192176118493, -25544.37073327601, -25559.15228174627, -25631.80293881893, -25371.84664492309, -25507.38263709843, -25477.61330999434, -25386.22887200117], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411846316454004, "mean_inference_ms": 0.24990883975980746, "mean_action_processing_ms": 0.059248888820317, "mean_env_wait_ms": 1.0260082495607032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00243377685546875, "StateBufferConnector_ms": 0.0017595291137695312, "ViewRequirementAgentConnector_ms": 0.04586529731750488}}, "episode_reward_max": -24978.81774803996, "episode_reward_min": -25929.56270158291, "episode_reward_mean": -25438.39047505036, "episode_len_mean": 360.0, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-25736.453466057777, -25195.392916709185, -25461.343143194914, -25904.80562837422, -25743.953549981117, -25929.56270158291, -25556.090169474483, -24980.008008420467, -25278.04175029695, -25684.725025072694, -25514.60654371977, -25403.043693721294, -25445.744906798005, -25413.51804727316, -25527.65967324376, -25683.872076556087, -25510.64200307429, -25796.003214523196, -25281.06732648611, -25585.0696464777, -25566.115595027804, -25329.06588999927, -25371.095772445202, -25512.427907168865, -25526.93891391158, -25355.9476159662, -25458.30466261506, -25241.43618299067, -25437.767778247595, -25406.13557702303, -25739.41008411348, -25501.541855067015, -25494.96929258108, -25593.35725285113, -25217.663569882512, -25391.687042593956, -25316.213216915727, -25412.23129312694, -25414.204220309854, -25486.754476353526, -25254.074074953794, -25295.65509557724, -25560.735824495554, -25547.63988761604, -25388.901221379638, -25121.809757187963, -25461.569399252534, -25385.853113621473, -25863.25849430263, -25501.77011540532, -25468.672089904547, -25454.575585395098, -25478.16468809545, -25179.898124828935, -25454.945073768497, -25624.58176575601, -25502.345321521163, -25375.705885902047, -25189.930610135198, -25338.05649241805, -25312.966029271483, -25397.289550438523, -24978.81774803996, -25133.160378575325, -25681.216649517417, -25397.775069728494, -25411.654362261295, -25362.310156032443, -25185.6589794755, -25026.37311576307, -25276.638649240136, -25388.129903122783, -25302.974439024925, -25161.56651417911, -25554.26064130664, -25473.460461631417, -25445.893747359514, -25551.559502780437, -25553.00134691596, -25439.66075974703, -25355.057938620448, -25333.008188843727, -25568.274744182825, -25441.14853988588, -25206.343410015106, -25050.651336863637, -25067.361235037446, -25421.14469435811, -25495.88674812019, -25563.218791991472, -25662.52534136176, -25842.454625621438, -25466.192176118493, -25544.37073327601, -25559.15228174627, -25631.80293881893, -25371.84664492309, -25507.38263709843, -25477.61330999434, -25386.22887200117], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.411846316454004, "mean_inference_ms": 0.24990883975980746, "mean_action_processing_ms": 0.059248888820317, "mean_env_wait_ms": 1.0260082495607032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00243377685546875, "StateBufferConnector_ms": 0.0017595291137695312, "ViewRequirementAgentConnector_ms": 0.04586529731750488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5142120, "num_agent_steps_trained": 5142120, "num_env_steps_sampled": 5142120, "num_env_steps_trained": 5142120, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 178.29212435354543, "num_env_steps_trained_throughput_per_sec": 178.29212435354543, "timesteps_total": 5142120, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 5142120, "timers": {"training_iteration_time_ms": 2019.943, "sample_time_ms": 2014.913, "load_time_ms": 0.222, "load_throughput": 1620117.425, "learn_time_ms": 4.25, "learn_throughput": 84706.795, "synch_weights_time_ms": 0.527}, "counters": {"num_env_steps_sampled": 5142120, "num_env_steps_trained": 5142120, "num_agent_steps_sampled": 5142120, "num_agent_steps_trained": 5142120}, "done": false, "episodes_total": 1328, "training_iteration": 604, "trial_id": "2d7f8_00000", "date": "2023-07-25_15-42-47", "timestamp": 1690288967, "time_this_iter_s": 10.097872734069824, "time_total_s": 10424.722161531448, "pid": 66784, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5100000, 0.003], [5103600, 0.001], [5107200, 0.00075], [5110800, 0.0005], [5114400, 0.00025], [5118000, 0.0001], [5121600, 7.5e-05], [5125200, 5e-05], [5128800, 2.5e-05], [5132400, 1e-05], [5136000, 7.5e-06], [5139600, 5e-06], [5143200, 2.5e-06], [5146800, 1e-06], [5150400, 5e-07], [5154000, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.3, "entropy_coeff_schedule": null, "microbatch_size": null, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17fb32310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 245.09061789512634, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 23.057142857142857, "ram_util_percent": 76.30714285714286}}
