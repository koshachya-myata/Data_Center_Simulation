{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.793830214521495, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 0.0025573180571933983, "total_loss": 10.422396125684404, "policy_loss": 0.04059480563886937, "vf_loss": 10.0, "vf_explained_var": -3.246227465909253e-08, "kl": 0.6703781632799725, "entropy": 14.021397524530457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24705.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 4848768, "num_env_steps_trained": 4848768, "num_agent_steps_sampled": 4848768, "num_agent_steps_trained": 4848768}, "sampler_results": {"episode_reward_max": -105794838.10887831, "episode_reward_min": -105794838.10887831, "episode_reward_mean": -105794838.10887831, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831], "episode_lengths": [105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1723923909486486, "mean_inference_ms": 0.2681484885946289, "mean_action_processing_ms": 0.05668951854834826, "mean_env_wait_ms": 0.7716600216533491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004220008850097656, "StateBufferConnector_ms": 0.00152587890625, "ViewRequirementAgentConnector_ms": 0.04417896270751953}}, "episode_reward_max": -105794838.10887831, "episode_reward_min": -105794838.10887831, "episode_reward_mean": -105794838.10887831, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831], "episode_lengths": [105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1723923909486486, "mean_inference_ms": 0.2681484885946289, "mean_action_processing_ms": 0.05668951854834826, "mean_env_wait_ms": 0.7716600216533491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004220008850097656, "StateBufferConnector_ms": 0.00152587890625, "ViewRequirementAgentConnector_ms": 0.04417896270751953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4848768, "num_agent_steps_trained": 4848768, "num_env_steps_sampled": 4848768, "num_env_steps_trained": 4848768, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 486.5184635448406, "num_env_steps_trained_throughput_per_sec": 486.5184635448406, "timesteps_total": 4848768, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 4848768, "timers": {"training_iteration_time_ms": 216657.741, "sample_time_ms": 135085.602, "load_time_ms": 0.526, "load_throughput": 200413960.123, "learn_time_ms": 81555.845, "learn_throughput": 1292.464, "synch_weights_time_ms": 0.827}, "counters": {"num_env_steps_sampled": 4848768, "num_env_steps_trained": 4848768, "num_agent_steps_sampled": 4848768, "num_agent_steps_trained": 4848768}, "done": false, "episodes_total": 6, "training_iteration": 6, "trial_id": "1db46_00000", "date": "2023-07-19_14-15-55", "timestamp": 1689765355, "time_this_iter_s": 216.6600799560547, "time_total_s": 2108.4618039131165, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 216.6600799560547, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.401623376623377, "ram_util_percent": 71.40454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.91025110452197, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.09361860715916, "policy_loss": 0.020370843082056653, "vf_loss": 10.0, "vf_explained_var": 6.61550034301239e-08, "kl": 0.08574041407716047, "entropy": 14.678598300533917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 74115.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 4954176, "num_env_steps_trained": 4954176, "num_agent_steps_sampled": 4954176, "num_agent_steps_trained": 4954176}, "sampler_results": {"episode_reward_max": -105794838.10887831, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -112915906.36530107, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385], "episode_lengths": [105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17224395402622586, "mean_inference_ms": 0.2680749091993175, "mean_action_processing_ms": 0.0566763182433116, "mean_env_wait_ms": 0.7658215013722902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031948089599609375, "StateBufferConnector_ms": 0.001430511474609375, "ViewRequirementAgentConnector_ms": 0.0443577766418457}}, "episode_reward_max": -105794838.10887831, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -112915906.36530107, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385], "episode_lengths": [105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17224395402622586, "mean_inference_ms": 0.2680749091993175, "mean_action_processing_ms": 0.0566763182433116, "mean_env_wait_ms": 0.7658215013722902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031948089599609375, "StateBufferConnector_ms": 0.001430511474609375, "ViewRequirementAgentConnector_ms": 0.0443577766418457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4954176, "num_agent_steps_trained": 4954176, "num_env_steps_sampled": 4954176, "num_env_steps_trained": 4954176, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 492.20290925430857, "num_env_steps_trained_throughput_per_sec": 492.20290925430857, "timesteps_total": 4954176, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 4954176, "timers": {"training_iteration_time_ms": 215406.651, "sample_time_ms": 133822.421, "load_time_ms": 28.68, "load_throughput": 3675302.769, "learn_time_ms": 81539.647, "learn_throughput": 1292.721, "synch_weights_time_ms": 0.797}, "counters": {"num_env_steps_sampled": 4954176, "num_env_steps_trained": 4954176, "num_agent_steps_sampled": 4954176, "num_agent_steps_trained": 4954176}, "done": false, "episodes_total": 7, "training_iteration": 7, "trial_id": "1db46_00000", "date": "2023-07-19_14-19-29", "timestamp": 1689765569, "time_this_iter_s": 214.15762305259705, "time_total_s": 2322.6194269657135, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 430.81770300865173, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 15.65148514851485, "ram_util_percent": 71.97260726072608}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.677546933591305, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.074435626271041, "policy_loss": 0.018197627416329413, "vf_loss": 10.0, "vf_explained_var": 6.637214239105429e-08, "kl": 0.06582957655476578, "entropy": 14.738639872422997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 123525.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 5059584, "num_env_steps_trained": 5059584, "num_agent_steps_sampled": 5059584, "num_agent_steps_trained": 5059584}, "sampler_results": {"episode_reward_max": -105794838.10887831, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -114460964.91093855, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351], "episode_lengths": [105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17216323803013245, "mean_inference_ms": 0.26816225180502107, "mean_action_processing_ms": 0.05667094248487354, "mean_env_wait_ms": 0.7622467954873066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028212865193684897, "StateBufferConnector_ms": 0.0014781951904296875, "ViewRequirementAgentConnector_ms": 0.04452069600423177}}, "episode_reward_max": -105794838.10887831, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -114460964.91093855, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351], "episode_lengths": [105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17216323803013245, "mean_inference_ms": 0.26816225180502107, "mean_action_processing_ms": 0.05667094248487354, "mean_env_wait_ms": 0.7622467954873066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028212865193684897, "StateBufferConnector_ms": 0.0014781951904296875, "ViewRequirementAgentConnector_ms": 0.04452069600423177}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5059584, "num_agent_steps_trained": 5059584, "num_env_steps_sampled": 5059584, "num_env_steps_trained": 5059584, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 492.60380256166496, "num_env_steps_trained_throughput_per_sec": 492.60380256166496, "timesteps_total": 5059584, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 5059584, "timers": {"training_iteration_time_ms": 214931.527, "sample_time_ms": 133333.257, "load_time_ms": 31.121, "load_throughput": 3387035.999, "learn_time_ms": 81551.028, "learn_throughput": 1292.54, "synch_weights_time_ms": 1.067}, "counters": {"num_env_steps_sampled": 5059584, "num_env_steps_trained": 5059584, "num_agent_steps_sampled": 5059584, "num_agent_steps_trained": 5059584}, "done": false, "episodes_total": 8, "training_iteration": 8, "trial_id": "1db46_00000", "date": "2023-07-19_14-23-03", "timestamp": 1689765783, "time_this_iter_s": 213.98297500610352, "time_total_s": 2536.602401971817, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 644.8006780147552, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 16.140594059405938, "ram_util_percent": 71.94257425742573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.719254191000557, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.093299301093804, "policy_loss": 0.020718186321318728, "vf_loss": 10.0, "vf_explained_var": 1.0133151510084623e-08, "kl": 0.08496006012410248, "entropy": 14.912116252765605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 5164992, "num_env_steps_trained": 5164992, "num_agent_steps_sampled": 5164992, "num_agent_steps_trained": 5164992}, "sampler_results": {"episode_reward_max": -105794838.10887831, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -114581093.00592329, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754], "episode_lengths": [105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1721734854205195, "mean_inference_ms": 0.2683144995634492, "mean_action_processing_ms": 0.05668876710399697, "mean_env_wait_ms": 0.7590794040777029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002676248550415039, "StateBufferConnector_ms": 0.001519918441772461, "ViewRequirementAgentConnector_ms": 0.04436373710632324}}, "episode_reward_max": -105794838.10887831, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -114581093.00592329, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754], "episode_lengths": [105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1721734854205195, "mean_inference_ms": 0.2683144995634492, "mean_action_processing_ms": 0.05668876710399697, "mean_env_wait_ms": 0.7590794040777029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002676248550415039, "StateBufferConnector_ms": 0.001519918441772461, "ViewRequirementAgentConnector_ms": 0.04436373710632324}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5164992, "num_agent_steps_trained": 5164992, "num_env_steps_sampled": 5164992, "num_env_steps_trained": 5164992, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 493.345171499467, "num_env_steps_trained_throughput_per_sec": 493.345171499467, "timesteps_total": 5164992, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 5164992, "timers": {"training_iteration_time_ms": 214613.575, "sample_time_ms": 132829.891, "load_time_ms": 31.97, "load_throughput": 3297063.948, "learn_time_ms": 81735.64, "learn_throughput": 1289.621, "synch_weights_time_ms": 1.0}, "counters": {"num_env_steps_sampled": 5164992, "num_env_steps_trained": 5164992, "num_agent_steps_sampled": 5164992, "num_agent_steps_trained": 5164992}, "done": false, "episodes_total": 9, "training_iteration": 9, "trial_id": "1db46_00000", "date": "2023-07-19_14-26-37", "timestamp": 1689765997, "time_this_iter_s": 213.66155695915222, "time_total_s": 2750.2639589309692, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 858.4622349739075, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 16.219141914191418, "ram_util_percent": 71.61650165016502}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.840988301326693, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.077892068908467, "policy_loss": 0.02003721499337836, "vf_loss": 10.0, "vf_explained_var": 3.709457249227407e-08, "kl": 0.0677221872025146, "entropy": 14.858491981639911, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 222345.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 5270400, "num_env_steps_trained": 5270400, "num_agent_steps_sampled": 5270400, "num_agent_steps_trained": 5270400}, "sampler_results": {"episode_reward_max": -105794838.10887831, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -114606101.70814356, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465], "episode_lengths": [105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17221890540326298, "mean_inference_ms": 0.26856663142707404, "mean_action_processing_ms": 0.05672337918889594, "mean_env_wait_ms": 0.757114822816731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002574920654296875, "StateBufferConnector_ms": 0.001544952392578125, "ViewRequirementAgentConnector_ms": 0.04445075988769531}}, "episode_reward_max": -105794838.10887831, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -114606101.70814356, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465], "episode_lengths": [105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17221890540326298, "mean_inference_ms": 0.26856663142707404, "mean_action_processing_ms": 0.05672337918889594, "mean_env_wait_ms": 0.757114822816731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002574920654296875, "StateBufferConnector_ms": 0.001544952392578125, "ViewRequirementAgentConnector_ms": 0.04445075988769531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5270400, "num_agent_steps_trained": 5270400, "num_env_steps_sampled": 5270400, "num_env_steps_trained": 5270400, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 490.5706736978411, "num_env_steps_trained_throughput_per_sec": 490.5706736978411, "timesteps_total": 5270400, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 5270400, "timers": {"training_iteration_time_ms": 214664.481, "sample_time_ms": 132916.446, "load_time_ms": 37.529, "load_throughput": 2808694.279, "learn_time_ms": 81694.456, "learn_throughput": 1290.271, "synch_weights_time_ms": 0.955}, "counters": {"num_env_steps_sampled": 5270400, "num_env_steps_trained": 5270400, "num_agent_steps_sampled": 5270400, "num_agent_steps_trained": 5270400}, "done": false, "episodes_total": 10, "training_iteration": 10, "trial_id": "1db46_00000", "date": "2023-07-19_14-30-12", "timestamp": 1689766212, "time_this_iter_s": 214.87003898620605, "time_total_s": 2965.1339979171753, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1073.3322739601135, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 16.972131147540985, "ram_util_percent": 72.61540983606557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.555310184909516, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.08125518416374, "policy_loss": 0.019175126487442927, "vf_loss": 10.0, "vf_explained_var": -1.4548310382335782e-08, "kl": 0.07266801247017594, "entropy": 14.461155773642284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 271755.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 5375808, "num_env_steps_trained": 5375808, "num_agent_steps_sampled": 5375808, "num_agent_steps_trained": 5375808}, "sampler_results": {"episode_reward_max": -105794838.10887831, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -113445595.70591073, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17225648656594486, "mean_inference_ms": 0.26870832354459523, "mean_action_processing_ms": 0.05673859530992333, "mean_env_wait_ms": 0.7549429502124063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024875005086263022, "StateBufferConnector_ms": 0.0015457471211751301, "ViewRequirementAgentConnector_ms": 0.04427035649617513}}, "episode_reward_max": -105794838.10887831, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -113445595.70591073, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17225648656594486, "mean_inference_ms": 0.26870832354459523, "mean_action_processing_ms": 0.05673859530992333, "mean_env_wait_ms": 0.7549429502124063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024875005086263022, "StateBufferConnector_ms": 0.0015457471211751301, "ViewRequirementAgentConnector_ms": 0.04427035649617513}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5375808, "num_agent_steps_trained": 5375808, "num_env_steps_sampled": 5375808, "num_env_steps_trained": 5375808, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 497.63977997950036, "num_env_steps_trained_throughput_per_sec": 497.63977997950036, "timesteps_total": 5375808, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 5375808, "timers": {"training_iteration_time_ms": 214189.709, "sample_time_ms": 132355.169, "load_time_ms": 36.68, "load_throughput": 2873747.988, "learn_time_ms": 81781.699, "learn_throughput": 1288.895, "synch_weights_time_ms": 1.067}, "counters": {"num_env_steps_sampled": 5375808, "num_env_steps_trained": 5375808, "num_agent_steps_sampled": 5375808, "num_agent_steps_trained": 5375808}, "done": false, "episodes_total": 11, "training_iteration": 11, "trial_id": "1db46_00000", "date": "2023-07-19_14-33-44", "timestamp": 1689766424, "time_this_iter_s": 211.81745100021362, "time_total_s": 3176.951448917389, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1285.1497249603271, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 16.059136212624587, "ram_util_percent": 72.59202657807309}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.77821799291185, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.071615170660445, "policy_loss": 0.02005827066874165, "vf_loss": 10.0, "vf_explained_var": 2.0628201288386554e-08, "kl": 0.06035009773003385, "entropy": 14.613302745599057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 321165.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 5481216, "num_env_steps_trained": 5481216, "num_agent_steps_sampled": 5481216, "num_agent_steps_trained": 5481216}, "sampler_results": {"episode_reward_max": -105794838.10887831, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -113175267.91981108, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17228811009913358, "mean_inference_ms": 0.2688141694077308, "mean_action_processing_ms": 0.0567509329334833, "mean_env_wait_ms": 0.753323723299111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024386814662388395, "StateBufferConnector_ms": 0.001559938703264509, "ViewRequirementAgentConnector_ms": 0.04412106105259487}}, "episode_reward_max": -105794838.10887831, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -113175267.91981108, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17228811009913358, "mean_inference_ms": 0.2688141694077308, "mean_action_processing_ms": 0.0567509329334833, "mean_env_wait_ms": 0.753323723299111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024386814662388395, "StateBufferConnector_ms": 0.001559938703264509, "ViewRequirementAgentConnector_ms": 0.04412106105259487}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5481216, "num_agent_steps_trained": 5481216, "num_env_steps_sampled": 5481216, "num_env_steps_trained": 5481216, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 490.4051399260582, "num_env_steps_trained_throughput_per_sec": 490.4051399260582, "timesteps_total": 5481216, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 5481216, "timers": {"training_iteration_time_ms": 214296.983, "sample_time_ms": 132315.989, "load_time_ms": 36.349, "load_throughput": 2899879.848, "learn_time_ms": 81928.549, "learn_throughput": 1286.584, "synch_weights_time_ms": 1.034}, "counters": {"num_env_steps_sampled": 5481216, "num_env_steps_trained": 5481216, "num_agent_steps_sampled": 5481216, "num_agent_steps_trained": 5481216}, "done": false, "episodes_total": 12, "training_iteration": 12, "trial_id": "1db46_00000", "date": "2023-07-19_14-37-19", "timestamp": 1689766639, "time_this_iter_s": 214.94257879257202, "time_total_s": 3391.894027709961, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1500.0923037528992, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 16.03421052631579, "ram_util_percent": 72.25032894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.519894223520145, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.094074246111825, "policy_loss": 0.01892444920237101, "vf_loss": 10.0, "vf_explained_var": 4.2884944783750995e-08, "kl": 0.0879668398751159, "entropy": 14.599812128437215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 370575.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 5586624, "num_env_steps_trained": 5586624, "num_agent_steps_sampled": 5586624, "num_agent_steps_trained": 5586624}, "sampler_results": {"episode_reward_max": -105794838.10887831, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -112479649.75120278, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1723132939624917, "mean_inference_ms": 0.26889289066643085, "mean_action_processing_ms": 0.05675787576233543, "mean_env_wait_ms": 0.7508505338836838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002378225326538086, "StateBufferConnector_ms": 0.0015676021575927734, "ViewRequirementAgentConnector_ms": 0.04419684410095215}}, "episode_reward_max": -105794838.10887831, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -112479649.75120278, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1723132939624917, "mean_inference_ms": 0.26889289066643085, "mean_action_processing_ms": 0.05675787576233543, "mean_env_wait_ms": 0.7508505338836838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002378225326538086, "StateBufferConnector_ms": 0.0015676021575927734, "ViewRequirementAgentConnector_ms": 0.04419684410095215}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5586624, "num_agent_steps_trained": 5586624, "num_env_steps_sampled": 5586624, "num_env_steps_trained": 5586624, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 509.75332452930337, "num_env_steps_trained_throughput_per_sec": 509.75332452930337, "timesteps_total": 5586624, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 5586624, "timers": {"training_iteration_time_ms": 213357.655, "sample_time_ms": 131254.809, "load_time_ms": 35.501, "load_throughput": 2969128.108, "learn_time_ms": 82051.273, "learn_throughput": 1284.66, "synch_weights_time_ms": 1.014}, "counters": {"num_env_steps_sampled": 5586624, "num_env_steps_trained": 5586624, "num_agent_steps_sampled": 5586624, "num_agent_steps_trained": 5586624}, "done": false, "episodes_total": 13, "training_iteration": 13, "trial_id": "1db46_00000", "date": "2023-07-19_14-40-45", "timestamp": 1689766845, "time_this_iter_s": 206.78457713127136, "time_total_s": 3598.6786048412323, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1706.8768808841705, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 15.959183673469388, "ram_util_percent": 72.1795918367347}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.683694352794788, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.075407169594309, "policy_loss": 0.019832153421878683, "vf_loss": 10.0, "vf_explained_var": 9.84725187819295e-08, "kl": 0.06505351742704917, "entropy": 14.565426294033017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 419985.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 5692032, "num_env_steps_trained": 5692032, "num_agent_steps_sampled": 5692032, "num_agent_steps_trained": 5692032}, "sampler_results": {"episode_reward_max": -105644048.85354552, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -111720138.54035197, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17234572619145064, "mean_inference_ms": 0.26896005519012683, "mean_action_processing_ms": 0.056767815674845484, "mean_env_wait_ms": 0.7483994715191096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023762385050455728, "StateBufferConnector_ms": 0.001568264431423611, "ViewRequirementAgentConnector_ms": 0.0446266598171658}}, "episode_reward_max": -105644048.85354552, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -111720138.54035197, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17234572619145064, "mean_inference_ms": 0.26896005519012683, "mean_action_processing_ms": 0.056767815674845484, "mean_env_wait_ms": 0.7483994715191096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023762385050455728, "StateBufferConnector_ms": 0.001568264431423611, "ViewRequirementAgentConnector_ms": 0.0446266598171658}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5692032, "num_agent_steps_trained": 5692032, "num_env_steps_sampled": 5692032, "num_env_steps_trained": 5692032, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 502.9366918002525, "num_env_steps_trained_throughput_per_sec": 502.9366918002525, "timesteps_total": 5692032, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 5692032, "timers": {"training_iteration_time_ms": 212938.472, "sample_time_ms": 130776.951, "load_time_ms": 35.345, "load_throughput": 2982300.974, "learn_time_ms": 82110.131, "learn_throughput": 1283.739, "synch_weights_time_ms": 0.991}, "counters": {"num_env_steps_sampled": 5692032, "num_env_steps_trained": 5692032, "num_agent_steps_sampled": 5692032, "num_agent_steps_trained": 5692032}, "done": false, "episodes_total": 14, "training_iteration": 14, "trial_id": "1db46_00000", "date": "2023-07-19_14-44-15", "timestamp": 1689767055, "time_this_iter_s": 209.58705306053162, "time_total_s": 3808.265657901764, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1916.4639339447021, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 16.49023569023569, "ram_util_percent": 72.05589225589226}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.543283328312631, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.084166999689314, "policy_loss": 0.01822849252936301, "vf_loss": 10.0, "vf_explained_var": -3.2027996737231755e-08, "kl": 0.07718453221484482, "entropy": 14.706748729938198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 469395.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 5797440, "num_env_steps_trained": 5797440, "num_agent_steps_sampled": 5797440, "num_agent_steps_trained": 5797440}, "sampler_results": {"episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -111057876.03473201, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1723685695015123, "mean_inference_ms": 0.2689992835194207, "mean_action_processing_ms": 0.056776372744514414, "mean_env_wait_ms": 0.7461736881414203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023651123046875, "StateBufferConnector_ms": 0.0015878677368164062, "ViewRequirementAgentConnector_ms": 0.04469156265258789}}, "episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -111057876.03473201, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1723685695015123, "mean_inference_ms": 0.2689992835194207, "mean_action_processing_ms": 0.056776372744514414, "mean_env_wait_ms": 0.7461736881414203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023651123046875, "StateBufferConnector_ms": 0.0015878677368164062, "ViewRequirementAgentConnector_ms": 0.04469156265258789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5797440, "num_agent_steps_trained": 5797440, "num_env_steps_sampled": 5797440, "num_env_steps_trained": 5797440, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 433.04940104796435, "num_env_steps_trained_throughput_per_sec": 433.04940104796435, "timesteps_total": 5797440, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 5797440, "timers": {"training_iteration_time_ms": 215985.494, "sample_time_ms": 130479.783, "load_time_ms": 34.969, "load_throughput": 3014331.426, "learn_time_ms": 85454.233, "learn_throughput": 1233.502, "synch_weights_time_ms": 0.999}, "counters": {"num_env_steps_sampled": 5797440, "num_env_steps_trained": 5797440, "num_agent_steps_sampled": 5797440, "num_agent_steps_trained": 5797440}, "done": false, "episodes_total": 15, "training_iteration": 15, "trial_id": "1db46_00000", "date": "2023-07-19_14-48-18", "timestamp": 1689767298, "time_this_iter_s": 243.413094997406, "time_total_s": 4051.67875289917, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2159.877028942108, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 16.39536231884058, "ram_util_percent": 72.03942028985507}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.645312797559692, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.076931094534602, "policy_loss": 0.01931821946860162, "vf_loss": 10.0, "vf_explained_var": -4.071355517444715e-08, "kl": 0.06743894103099164, "entropy": 14.657733802837873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 518805.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 5902848, "num_env_steps_trained": 5902848, "num_agent_steps_sampled": 5902848, "num_agent_steps_trained": 5902848}, "sampler_results": {"episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -110528452.62777601, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17341548677580365, "mean_inference_ms": 0.2702891948172491, "mean_action_processing_ms": 0.057067137902391624, "mean_env_wait_ms": 0.7482754573414433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024643811312588778, "StateBufferConnector_ms": 0.001707944003018466, "ViewRequirementAgentConnector_ms": 0.0469749624078924}}, "episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -110528452.62777601, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17341548677580365, "mean_inference_ms": 0.2702891948172491, "mean_action_processing_ms": 0.057067137902391624, "mean_env_wait_ms": 0.7482754573414433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024643811312588778, "StateBufferConnector_ms": 0.001707944003018466, "ViewRequirementAgentConnector_ms": 0.0469749624078924}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5902848, "num_agent_steps_trained": 5902848, "num_env_steps_sampled": 5902848, "num_env_steps_trained": 5902848, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 307.19637854337543, "num_env_steps_trained_throughput_per_sec": 307.19637854337543, "timesteps_total": 5902848, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 5902848, "timers": {"training_iteration_time_ms": 228632.623, "sample_time_ms": 138379.128, "load_time_ms": 42.177, "load_throughput": 2499201.229, "learn_time_ms": 90194.299, "learn_throughput": 1168.677, "synch_weights_time_ms": 1.019}, "counters": {"num_env_steps_sampled": 5902848, "num_env_steps_trained": 5902848, "num_agent_steps_sampled": 5902848, "num_agent_steps_trained": 5902848}, "done": false, "episodes_total": 16, "training_iteration": 16, "trial_id": "1db46_00000", "date": "2023-07-19_14-54-02", "timestamp": 1689767642, "time_this_iter_s": 343.1313591003418, "time_total_s": 4394.810111999512, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2503.00838804245, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 16.27310061601643, "ram_util_percent": 72.35359342915811}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.803583999795878, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.124116323279408, "policy_loss": 0.021768231372141424, "vf_loss": 10.0, "vf_explained_var": -9.409354973650007e-09, "kl": 0.11980390061985229, "entropy": 14.854009546767456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 568215.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 6008256, "num_env_steps_trained": 6008256, "num_agent_steps_sampled": 6008256, "num_agent_steps_trained": 6008256}, "sampler_results": {"episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -110204029.83972983, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17504718688001916, "mean_inference_ms": 0.2723008335116688, "mean_action_processing_ms": 0.05752154176689963, "mean_env_wait_ms": 0.7528871363962227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002787510553995768, "StateBufferConnector_ms": 0.0017821788787841797, "ViewRequirementAgentConnector_ms": 0.04893740018208822}}, "episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -110204029.83972983, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17504718688001916, "mean_inference_ms": 0.2723008335116688, "mean_action_processing_ms": 0.05752154176689963, "mean_env_wait_ms": 0.7528871363962227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002787510553995768, "StateBufferConnector_ms": 0.0017821788787841797, "ViewRequirementAgentConnector_ms": 0.04893740018208822}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6008256, "num_agent_steps_trained": 6008256, "num_env_steps_sampled": 6008256, "num_env_steps_trained": 6008256, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 309.8389346638326, "num_env_steps_trained_throughput_per_sec": 309.8389346638326, "timesteps_total": 6008256, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 6008256, "timers": {"training_iteration_time_ms": 241237.32, "sample_time_ms": 146238.355, "load_time_ms": 41.594, "load_throughput": 2534237.53, "learn_time_ms": 94939.872, "learn_throughput": 1110.261, "synch_weights_time_ms": 1.057}, "counters": {"num_env_steps_sampled": 6008256, "num_env_steps_trained": 6008256, "num_agent_steps_sampled": 6008256, "num_agent_steps_trained": 6008256}, "done": false, "episodes_total": 17, "training_iteration": 17, "trial_id": "1db46_00000", "date": "2023-07-19_14-59-42", "timestamp": 1689767982, "time_this_iter_s": 340.2055039405823, "time_total_s": 4735.015615940094, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2843.213891983032, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 16.20393374741201, "ram_util_percent": 71.85465838509317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.555878826653734, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.074179799174084, "policy_loss": 0.018151577228654826, "vf_loss": 10.0, "vf_explained_var": -2.3595767087768482e-08, "kl": 0.06558402226933012, "entropy": 15.293164423356002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 617625.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 6113664, "num_env_steps_trained": 6113664, "num_agent_steps_sampled": 6113664, "num_agent_steps_trained": 6113664}, "sampler_results": {"episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -110147707.45403002, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1770460239248649, "mean_inference_ms": 0.27474265913064516, "mean_action_processing_ms": 0.05807355169876649, "mean_env_wait_ms": 0.7588562637210006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028445170475886418, "StateBufferConnector_ms": 0.0018541629497821515, "ViewRequirementAgentConnector_ms": 0.05060709439791166}}, "episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -110147707.45403002, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1770460239248649, "mean_inference_ms": 0.27474265913064516, "mean_action_processing_ms": 0.05807355169876649, "mean_env_wait_ms": 0.7588562637210006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028445170475886418, "StateBufferConnector_ms": 0.0018541629497821515, "ViewRequirementAgentConnector_ms": 0.05060709439791166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6113664, "num_agent_steps_trained": 6113664, "num_env_steps_sampled": 6113664, "num_env_steps_trained": 6113664, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 313.43371474428795, "num_env_steps_trained_throughput_per_sec": 313.43371474428795, "timesteps_total": 6113664, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 6113664, "timers": {"training_iteration_time_ms": 253469.267, "sample_time_ms": 153882.519, "load_time_ms": 42.282, "load_throughput": 2492976.602, "learn_time_ms": 99526.508, "learn_throughput": 1059.095, "synch_weights_time_ms": 0.999}, "counters": {"num_env_steps_sampled": 6113664, "num_env_steps_trained": 6113664, "num_agent_steps_sampled": 6113664, "num_agent_steps_trained": 6113664}, "done": false, "episodes_total": 18, "training_iteration": 18, "trial_id": "1db46_00000", "date": "2023-07-19_15-05-18", "timestamp": 1689768318, "time_this_iter_s": 336.3034281730652, "time_total_s": 5071.319044113159, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3179.5173201560974, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 15.804210526315789, "ram_util_percent": 71.75178947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.92788008522997, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.129436335368718, "policy_loss": 0.02206479638490206, "vf_loss": 10.0, "vf_explained_var": -1.1182656487914816e-08, "kl": 0.12568411409920138, "entropy": 15.201382255052367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 667035.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 6219072, "num_env_steps_trained": 6219072, "num_agent_steps_sampled": 6219072, "num_agent_steps_trained": 6219072}, "sampler_results": {"episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -110040137.41694461, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233, -108641726.93483421], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17924767548101012, "mean_inference_ms": 0.2774143903615947, "mean_action_processing_ms": 0.05867817411149534, "mean_env_wait_ms": 0.7656348019680731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028780528477260043, "StateBufferConnector_ms": 0.0018954277038574219, "ViewRequirementAgentConnector_ms": 0.05174194063459124}}, "episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -110040137.41694461, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233, -108641726.93483421], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17924767548101012, "mean_inference_ms": 0.2774143903615947, "mean_action_processing_ms": 0.05867817411149534, "mean_env_wait_ms": 0.7656348019680731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028780528477260043, "StateBufferConnector_ms": 0.0018954277038574219, "ViewRequirementAgentConnector_ms": 0.05174194063459124}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6219072, "num_agent_steps_trained": 6219072, "num_env_steps_sampled": 6219072, "num_env_steps_trained": 6219072, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 313.5422789515981, "num_env_steps_trained_throughput_per_sec": 313.5422789515981, "timesteps_total": 6219072, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 6219072, "timers": {"training_iteration_time_ms": 265721.726, "sample_time_ms": 161633.759, "load_time_ms": 43.625, "load_throughput": 2416253.154, "learn_time_ms": 104025.917, "learn_throughput": 1013.286, "synch_weights_time_ms": 1.029}, "counters": {"num_env_steps_sampled": 6219072, "num_env_steps_trained": 6219072, "num_agent_steps_sampled": 6219072, "num_agent_steps_trained": 6219072}, "done": false, "episodes_total": 19, "training_iteration": 19, "trial_id": "1db46_00000", "date": "2023-07-19_15-10-54", "timestamp": 1689768654, "time_this_iter_s": 336.18723583221436, "time_total_s": 5407.5062799453735, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3515.7045559883118, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 15.736210526315789, "ram_util_percent": 71.89747368421051}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.71556872113396, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.130584258961788, "policy_loss": 0.0209583557500656, "vf_loss": 10.0, "vf_explained_var": -5.797610256841274e-08, "kl": 0.12832296508045804, "entropy": 15.183956835236634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 716445.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 6324480, "num_env_steps_trained": 6324480, "num_agent_steps_sampled": 6324480, "num_agent_steps_trained": 6324480}, "sampler_results": {"episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -109868931.0480269, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233, -108641726.93483421, -107472041.88317928], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1815530205361876, "mean_inference_ms": 0.28019847708714873, "mean_action_processing_ms": 0.059309880956408954, "mean_env_wait_ms": 0.7729003531205445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029007593790690103, "StateBufferConnector_ms": 0.0019311904907226562, "ViewRequirementAgentConnector_ms": 0.052749315897623696}}, "episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -109868931.0480269, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233, -108641726.93483421, -107472041.88317928], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1815530205361876, "mean_inference_ms": 0.28019847708714873, "mean_action_processing_ms": 0.059309880956408954, "mean_env_wait_ms": 0.7729003531205445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029007593790690103, "StateBufferConnector_ms": 0.0019311904907226562, "ViewRequirementAgentConnector_ms": 0.052749315897623696}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6324480, "num_agent_steps_trained": 6324480, "num_env_steps_sampled": 6324480, "num_env_steps_trained": 6324480, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 312.30494377779917, "num_env_steps_trained_throughput_per_sec": 312.30494377779917, "timesteps_total": 6324480, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 6324480, "timers": {"training_iteration_time_ms": 277986.539, "sample_time_ms": 169308.055, "load_time_ms": 42.129, "load_throughput": 2502000.216, "learn_time_ms": 108617.479, "learn_throughput": 970.452, "synch_weights_time_ms": 1.067}, "counters": {"num_env_steps_sampled": 6324480, "num_env_steps_trained": 6324480, "num_agent_steps_sampled": 6324480, "num_agent_steps_trained": 6324480}, "done": false, "episodes_total": 20, "training_iteration": 20, "trial_id": "1db46_00000", "date": "2023-07-19_15-16-32", "timestamp": 1689768992, "time_this_iter_s": 337.5189456939697, "time_total_s": 5745.025225639343, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3853.2235016822815, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 15.962761506276149, "ram_util_percent": 72.0439330543933}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.520805937179041, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.08917040581212, "policy_loss": 0.01873759338401509, "vf_loss": 10.0, "vf_explained_var": -1.4468692763327974e-07, "kl": 0.08244535150619954, "entropy": 15.190762399898514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 765855.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 6429888, "num_env_steps_trained": 6429888, "num_agent_steps_sampled": 6429888, "num_agent_steps_trained": 6429888}, "sampler_results": {"episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -109666164.30663756, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233, -108641726.93483421, -107472041.88317928, -106624663.18579726], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18390573561569307, "mean_inference_ms": 0.2830395591100001, "mean_action_processing_ms": 0.05995365728514862, "mean_env_wait_ms": 0.7805082612793114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00292360782623291, "StateBufferConnector_ms": 0.0019803643226623535, "ViewRequirementAgentConnector_ms": 0.053657591342926025}}, "episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -109666164.30663756, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233, -108641726.93483421, -107472041.88317928, -106624663.18579726], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18390573561569307, "mean_inference_ms": 0.2830395591100001, "mean_action_processing_ms": 0.05995365728514862, "mean_env_wait_ms": 0.7805082612793114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00292360782623291, "StateBufferConnector_ms": 0.0019803643226623535, "ViewRequirementAgentConnector_ms": 0.053657591342926025}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6429888, "num_agent_steps_trained": 6429888, "num_env_steps_sampled": 6429888, "num_env_steps_trained": 6429888, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 307.6483681909499, "num_env_steps_trained_throughput_per_sec": 307.6483681909499, "timesteps_total": 6429888, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 6429888, "timers": {"training_iteration_time_ms": 291067.445, "sample_time_ms": 177747.769, "load_time_ms": 44.711, "load_throughput": 2357523.379, "learn_time_ms": 113255.611, "learn_throughput": 930.709, "synch_weights_time_ms": 1.018}, "counters": {"num_env_steps_sampled": 6429888, "num_env_steps_trained": 6429888, "num_agent_steps_sampled": 6429888, "num_agent_steps_trained": 6429888}, "done": false, "episodes_total": 21, "training_iteration": 21, "trial_id": "1db46_00000", "date": "2023-07-19_15-22-15", "timestamp": 1689769335, "time_this_iter_s": 342.62759232521057, "time_total_s": 6087.652817964554, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4195.851094007492, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 16.400205761316872, "ram_util_percent": 72.6656378600823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.758862836686399, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.074334586547275, "policy_loss": 0.018773499756307297, "vf_loss": 10.0, "vf_explained_var": 1.129122596838001e-08, "kl": 0.06503721278422955, "entropy": 15.0688798236596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 815265.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 6535296, "num_env_steps_trained": 6535296, "num_agent_steps_sampled": 6535296, "num_agent_steps_trained": 6535296}, "sampler_results": {"episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -109409958.38800378, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233, -108641726.93483421, -107472041.88317928, -106624663.18579726, -105310663.68986334], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18625044067121288, "mean_inference_ms": 0.2858754142906838, "mean_action_processing_ms": 0.06059600988515557, "mean_env_wait_ms": 0.7882985164221425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029465731452493105, "StateBufferConnector_ms": 0.0020167406867532167, "ViewRequirementAgentConnector_ms": 0.054454803466796875}}, "episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -109409958.38800378, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233, -108641726.93483421, -107472041.88317928, -106624663.18579726, -105310663.68986334], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18625044067121288, "mean_inference_ms": 0.2858754142906838, "mean_action_processing_ms": 0.06059600988515557, "mean_env_wait_ms": 0.7882985164221425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029465731452493105, "StateBufferConnector_ms": 0.0020167406867532167, "ViewRequirementAgentConnector_ms": 0.054454803466796875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6535296, "num_agent_steps_trained": 6535296, "num_env_steps_sampled": 6535296, "num_env_steps_trained": 6535296, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 304.7862502152674, "num_env_steps_trained_throughput_per_sec": 304.7862502152674, "timesteps_total": 6535296, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 6535296, "timers": {"training_iteration_time_ms": 304157.617, "sample_time_ms": 185991.178, "load_time_ms": 48.845, "load_throughput": 2158026.663, "learn_time_ms": 118097.76, "learn_throughput": 892.549, "synch_weights_time_ms": 1.042}, "counters": {"num_env_steps_sampled": 6535296, "num_env_steps_trained": 6535296, "num_agent_steps_sampled": 6535296, "num_agent_steps_trained": 6535296}, "done": false, "episodes_total": 22, "training_iteration": 22, "trial_id": "1db46_00000", "date": "2023-07-19_15-28-00", "timestamp": 1689769680, "time_this_iter_s": 345.8454489707947, "time_total_s": 6433.4982669353485, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4541.696542978287, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 16.321792260692465, "ram_util_percent": 72.4928716904277}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.570705356520817, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.074435773732521, "policy_loss": 0.018160656123945382, "vf_loss": 10.0, "vf_explained_var": -2.6961420982189446e-08, "kl": 0.06587302461876245, "entropy": 15.179314980973022, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 864675.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 6640704, "num_env_steps_trained": 6640704, "num_agent_steps_sampled": 6640704, "num_agent_steps_trained": 6640704}, "sampler_results": {"episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -109354954.385792, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233, -108641726.93483421, -107472041.88317928, -106624663.18579726, -105310663.68986334, -108419886.34819166], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18856044222377485, "mean_inference_ms": 0.2886626300504859, "mean_action_processing_ms": 0.06122919282870641, "mean_env_wait_ms": 0.7961952244497524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029537412855360243, "StateBufferConnector_ms": 0.0020490752326117623, "ViewRequirementAgentConnector_ms": 0.05517933103773329}}, "episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -109354954.385792, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233, -108641726.93483421, -107472041.88317928, -106624663.18579726, -105310663.68986334, -108419886.34819166], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18856044222377485, "mean_inference_ms": 0.2886626300504859, "mean_action_processing_ms": 0.06122919282870641, "mean_env_wait_ms": 0.7961952244497524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029537412855360243, "StateBufferConnector_ms": 0.0020490752326117623, "ViewRequirementAgentConnector_ms": 0.05517933103773329}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6640704, "num_agent_steps_trained": 6640704, "num_env_steps_sampled": 6640704, "num_env_steps_trained": 6640704, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 306.4273032209799, "num_env_steps_trained_throughput_per_sec": 306.4273032209799, "timesteps_total": 6640704, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 6640704, "timers": {"training_iteration_time_ms": 317878.403, "sample_time_ms": 195257.912, "load_time_ms": 51.663, "load_throughput": 2040298.01, "learn_time_ms": 122548.46, "learn_throughput": 860.133, "synch_weights_time_ms": 1.063}, "counters": {"num_env_steps_sampled": 6640704, "num_env_steps_trained": 6640704, "num_agent_steps_sampled": 6640704, "num_agent_steps_trained": 6640704}, "done": false, "episodes_total": 23, "training_iteration": 23, "trial_id": "1db46_00000", "date": "2023-07-19_15-33-44", "timestamp": 1689770024, "time_this_iter_s": 343.9926075935364, "time_total_s": 6777.490874528885, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4885.689150571823, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 15.975308641975309, "ram_util_percent": 72.23168724279834}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.780819324662607, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.071033608993039, "policy_loss": 0.019796504678115688, "vf_loss": 10.0, "vf_explained_var": -3.850597573832157e-08, "kl": 0.05997575719254005, "entropy": 15.565929157081053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 914085.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 6746112, "num_env_steps_trained": 6746112, "num_agent_steps_sampled": 6746112, "num_agent_steps_trained": 6746112}, "sampler_results": {"episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -109452749.01434237, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233, -108641726.93483421, -107472041.88317928, -106624663.18579726, -105310663.68986334, -108419886.34819166, -111213052.32824907], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908059653010674, "mean_inference_ms": 0.29143726904947276, "mean_action_processing_ms": 0.06185691505930839, "mean_env_wait_ms": 0.803950081848354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029877612465306334, "StateBufferConnector_ms": 0.002083025480571546, "ViewRequirementAgentConnector_ms": 0.055934253491853415}}, "episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -109452749.01434237, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233, -108641726.93483421, -107472041.88317928, -106624663.18579726, -105310663.68986334, -108419886.34819166, -111213052.32824907], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1908059653010674, "mean_inference_ms": 0.29143726904947276, "mean_action_processing_ms": 0.06185691505930839, "mean_env_wait_ms": 0.803950081848354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029877612465306334, "StateBufferConnector_ms": 0.002083025480571546, "ViewRequirementAgentConnector_ms": 0.055934253491853415}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6746112, "num_agent_steps_trained": 6746112, "num_env_steps_sampled": 6746112, "num_env_steps_trained": 6746112, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 306.1977079353996, "num_env_steps_trained_throughput_per_sec": 306.1977079353996, "timesteps_total": 6746112, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 6746112, "timers": {"training_iteration_time_ms": 331344.717, "sample_time_ms": 203917.335, "load_time_ms": 57.559, "load_throughput": 1831318.278, "learn_time_ms": 127348.902, "learn_throughput": 827.71, "synch_weights_time_ms": 1.103}, "counters": {"num_env_steps_sampled": 6746112, "num_env_steps_trained": 6746112, "num_agent_steps_sampled": 6746112, "num_agent_steps_trained": 6746112}, "done": false, "episodes_total": 24, "training_iteration": 24, "trial_id": "1db46_00000", "date": "2023-07-19_15-39-29", "timestamp": 1689770369, "time_this_iter_s": 344.2517247200012, "time_total_s": 7121.742599248886, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5229.940875291824, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 21.784221311475413, "ram_util_percent": 74.35532786885244}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.747878045316856, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.081155942765548, "policy_loss": 0.019314095608395636, "vf_loss": 10.0, "vf_explained_var": 4.7191534175536964e-08, "kl": 0.07238916866309046, "entropy": 15.747974096640622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 963495.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 6851520, "num_env_steps_trained": 6851520, "num_agent_steps_sampled": 6851520, "num_agent_steps_trained": 6851520}, "sampler_results": {"episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -109541758.47817238, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233, -108641726.93483421, -107472041.88317928, -106624663.18579726, -105310663.68986334, -108419886.34819166, -111213052.32824907, -111232938.29094231], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19298141811405695, "mean_inference_ms": 0.29412932829371174, "mean_action_processing_ms": 0.06246622422569844, "mean_env_wait_ms": 0.8114973163300249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003020763397216797, "StateBufferConnector_ms": 0.002129077911376953, "ViewRequirementAgentConnector_ms": 0.05682826042175293}}, "episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -109541758.47817238, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233, -108641726.93483421, -107472041.88317928, -106624663.18579726, -105310663.68986334, -108419886.34819166, -111213052.32824907, -111232938.29094231], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19298141811405695, "mean_inference_ms": 0.29412932829371174, "mean_action_processing_ms": 0.06246622422569844, "mean_env_wait_ms": 0.8114973163300249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003020763397216797, "StateBufferConnector_ms": 0.002129077911376953, "ViewRequirementAgentConnector_ms": 0.05682826042175293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6851520, "num_agent_steps_trained": 6851520, "num_env_steps_sampled": 6851520, "num_env_steps_trained": 6851520, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 311.765221351432, "num_env_steps_trained_throughput_per_sec": 311.765221351432, "timesteps_total": 6851520, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 6851520, "timers": {"training_iteration_time_ms": 340813.902, "sample_time_ms": 212180.98, "load_time_ms": 64.285, "load_throughput": 1639706.931, "learn_time_ms": 128547.658, "learn_throughput": 819.992, "synch_weights_time_ms": 1.1}, "counters": {"num_env_steps_sampled": 6851520, "num_env_steps_trained": 6851520, "num_agent_steps_sampled": 6851520, "num_agent_steps_trained": 6851520}, "done": false, "episodes_total": 25, "training_iteration": 25, "trial_id": "1db46_00000", "date": "2023-07-19_15-45-07", "timestamp": 1689770707, "time_this_iter_s": 338.104040145874, "time_total_s": 7459.84663939476, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5568.044915437698, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.563541666666666, "ram_util_percent": 74.70083333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.746288824558222, "cur_kl_coeff": 0.8542968749999995, "cur_lr": 0.0025573180571933983, "total_loss": 10.464027778910761, "policy_loss": 0.031100621398814626, "vf_loss": 10.0, "vf_explained_var": 6.22826919601987e-08, "kl": 0.5067643092815691, "entropy": 16.425204307187112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1012905.5, "diff_num_grad_updates_vs_sampler_policy": 24704.5}}, "num_env_steps_sampled": 6956928, "num_env_steps_trained": 6956928, "num_agent_steps_sampled": 6956928, "num_agent_steps_trained": 6956928}, "sampler_results": {"episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -109743767.36410692, "episode_len_mean": 105408.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233, -108641726.93483421, -107472041.88317928, -106624663.18579726, -105310663.68986334, -108419886.34819166, -111213052.32824907, -111232938.29094231, -113783945.08279817], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19509149513232765, "mean_inference_ms": 0.296732926404074, "mean_action_processing_ms": 0.06305515504036284, "mean_env_wait_ms": 0.8188856874536747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030415398733956473, "StateBufferConnector_ms": 0.002148037865048363, "ViewRequirementAgentConnector_ms": 0.05732831500825428}}, "episode_reward_max": -105097513.4841524, "episode_reward_min": -120036974.62172385, "episode_reward_mean": -109743767.36410692, "episode_len_mean": 105408.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-105794838.10887831, -120036974.62172385, -117551082.00221351, -114941477.29087754, -114706136.51702465, -107643065.69474646, -111553301.20321326, -107610322.57094465, -105644048.85354552, -105097513.4841524, -105234218.55821615, -106635379.17122172, -109471838.82563233, -108641726.93483421, -107472041.88317928, -106624663.18579726, -105310663.68986334, -108419886.34819166, -111213052.32824907, -111232938.29094231, -113783945.08279817], "episode_lengths": [105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408, 105408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19509149513232765, "mean_inference_ms": 0.296732926404074, "mean_action_processing_ms": 0.06305515504036284, "mean_env_wait_ms": 0.8188856874536747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030415398733956473, "StateBufferConnector_ms": 0.002148037865048363, "ViewRequirementAgentConnector_ms": 0.05732831500825428}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6956928, "num_agent_steps_trained": 6956928, "num_env_steps_sampled": 6956928, "num_env_steps_trained": 6956928, "num_env_steps_sampled_this_iter": 105408, "num_env_steps_trained_this_iter": 105408, "num_env_steps_sampled_throughput_per_sec": 308.87451075180655, "num_env_steps_trained_throughput_per_sec": 308.87451075180655, "timesteps_total": 6956928, "num_steps_trained_this_iter": 105408, "agent_timesteps_total": 6956928, "timers": {"training_iteration_time_ms": 340627.478, "sample_time_ms": 212159.352, "load_time_ms": 64.034, "load_throughput": 1646136.91, "learn_time_ms": 128383.147, "learn_throughput": 821.042, "synch_weights_time_ms": 1.099}, "counters": {"num_env_steps_sampled": 6956928, "num_env_steps_trained": 6956928, "num_agent_steps_sampled": 6956928, "num_agent_steps_trained": 6956928}, "done": false, "episodes_total": 26, "training_iteration": 26, "trial_id": "1db46_00000", "date": "2023-07-19_15-50-48", "timestamp": 1689771048, "time_this_iter_s": 341.2675199508667, "time_total_s": 7801.114159345627, "pid": 93557, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 12, "verbose": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 288, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0025573180571933974, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 288, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 288, "replay_sequence_length": null, "horizon": 288, "soft_horizon": true, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "kl_target": 0.1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x16eb52e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5909.312435388565, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.554752066115704, "ram_util_percent": 74.44834710743801}}
