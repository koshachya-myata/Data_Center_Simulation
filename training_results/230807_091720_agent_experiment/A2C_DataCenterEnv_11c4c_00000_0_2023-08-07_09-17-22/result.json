{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.6692075145488, "policy_loss": -10981677.004803093, "vf_loss": 6813872.021045919}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.5, "diff_num_grad_updates_vs_sampler_policy": 342.5}}, "num_env_steps_sampled": 35658480, "num_env_steps_trained": 35658480, "num_agent_steps_sampled": 35658480, "num_agent_steps_trained": 35658480}, "sampler_results": {"episode_reward_max": -189608.46149446574, "episode_reward_min": -189608.46149446574, "episode_reward_mean": -189608.46149446574, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21540215615732652, "mean_inference_ms": 0.3710011581924997, "mean_action_processing_ms": 0.09049461859637946, "mean_env_wait_ms": 0.8364328255986356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033617019653320312, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.06442070007324219}}, "episode_reward_max": -189608.46149446574, "episode_reward_min": -189608.46149446574, "episode_reward_mean": -189608.46149446574, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21540215615732652, "mean_inference_ms": 0.3710011581924997, "mean_action_processing_ms": 0.09049461859637946, "mean_env_wait_ms": 0.8364328255986356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033617019653320312, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.06442070007324219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35658480, "num_agent_steps_trained": 35658480, "num_env_steps_sampled": 35658480, "num_env_steps_trained": 35658480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 641.763083040834, "num_env_steps_trained_throughput_per_sec": 641.763083040834, "timesteps_total": 35658480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 35658480, "timers": {"training_iteration_time_ms": 68436.445, "sample_time_ms": 67297.2, "load_time_ms": 0.619, "load_throughput": 70933319.861, "learn_time_ms": 1137.509, "learn_throughput": 38610.68, "synch_weights_time_ms": 0.953}, "counters": {"num_env_steps_sampled": 35658480, "num_env_steps_trained": 35658480, "num_agent_steps_sampled": 35658480, "num_agent_steps_trained": 35658480}, "done": false, "episodes_total": 8985, "training_iteration": 2722, "trial_id": "11c4c_00000", "date": "2023-08-07_09-18-36", "timestamp": 1691389116, "time_this_iter_s": 68.43891787528992, "time_total_s": 63838.8502061367, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 68.43891787528992, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.867346938775512, "ram_util_percent": 68.79081632653062}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7950466589747, "policy_loss": -11141695.12929061, "vf_loss": 6747333.717565598}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1029.5, "diff_num_grad_updates_vs_sampler_policy": 1028.5}}, "num_env_steps_sampled": 35702400, "num_env_steps_trained": 35702400, "num_agent_steps_sampled": 35702400, "num_agent_steps_trained": 35702400}, "sampler_results": {"episode_reward_max": -188491.8924627381, "episode_reward_min": -189608.46149446574, "episode_reward_mean": -189050.1769786019, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21552141085842963, "mean_inference_ms": 0.3691918644511669, "mean_action_processing_ms": 0.09032173121515927, "mean_env_wait_ms": 0.8196923829769455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003325939178466797, "StateBufferConnector_ms": 0.0025987625122070312, "ViewRequirementAgentConnector_ms": 0.06524324417114258}}, "episode_reward_max": -188491.8924627381, "episode_reward_min": -189608.46149446574, "episode_reward_mean": -189050.1769786019, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21552141085842963, "mean_inference_ms": 0.3691918644511669, "mean_action_processing_ms": 0.09032173121515927, "mean_env_wait_ms": 0.8196923829769455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003325939178466797, "StateBufferConnector_ms": 0.0025987625122070312, "ViewRequirementAgentConnector_ms": 0.06524324417114258}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35702400, "num_agent_steps_trained": 35702400, "num_env_steps_sampled": 35702400, "num_env_steps_trained": 35702400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 673.6508248980994, "num_env_steps_trained_throughput_per_sec": 673.6508248980994, "timesteps_total": 35702400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 35702400, "timers": {"training_iteration_time_ms": 66816.702, "sample_time_ms": 65673.73, "load_time_ms": 16.651, "load_throughput": 2637655.093, "learn_time_ms": 1125.159, "learn_throughput": 39034.499, "synch_weights_time_ms": 0.99}, "counters": {"num_env_steps_sampled": 35702400, "num_env_steps_trained": 35702400, "num_agent_steps_sampled": 35702400, "num_agent_steps_trained": 35702400}, "done": false, "episodes_total": 8986, "training_iteration": 2723, "trial_id": "11c4c_00000", "date": "2023-08-07_09-19-41", "timestamp": 1691389181, "time_this_iter_s": 65.19951915740967, "time_total_s": 63904.04972529411, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 133.63843703269958, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 23.729032258064517, "ram_util_percent": 68.75698924731185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.77560629441507, "policy_loss": -11432188.677429734, "vf_loss": 6730959.457908163}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1715.5, "diff_num_grad_updates_vs_sampler_policy": 1714.5}}, "num_env_steps_sampled": 35746320, "num_env_steps_trained": 35746320, "num_agent_steps_sampled": 35746320, "num_agent_steps_trained": 35746320}, "sampler_results": {"episode_reward_max": -188289.94439385986, "episode_reward_min": -189608.46149446574, "episode_reward_mean": -188796.7661170212, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21538718822927252, "mean_inference_ms": 0.3680287953172458, "mean_action_processing_ms": 0.09017194542718605, "mean_env_wait_ms": 0.8110437796512833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032981236775716147, "StateBufferConnector_ms": 0.0026384989420572915, "ViewRequirementAgentConnector_ms": 0.06485780080159505}}, "episode_reward_max": -188289.94439385986, "episode_reward_min": -189608.46149446574, "episode_reward_mean": -188796.7661170212, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21538718822927252, "mean_inference_ms": 0.3680287953172458, "mean_action_processing_ms": 0.09017194542718605, "mean_env_wait_ms": 0.8110437796512833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032981236775716147, "StateBufferConnector_ms": 0.0026384989420572915, "ViewRequirementAgentConnector_ms": 0.06485780080159505}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35746320, "num_agent_steps_trained": 35746320, "num_env_steps_sampled": 35746320, "num_env_steps_trained": 35746320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 672.8549197066575, "num_env_steps_trained_throughput_per_sec": 672.8549197066575, "timesteps_total": 35746320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 35746320, "timers": {"training_iteration_time_ms": 66302.495, "sample_time_ms": 65159.692, "load_time_ms": 18.016, "load_throughput": 2437819.515, "learn_time_ms": 1123.614, "learn_throughput": 39088.168, "synch_weights_time_ms": 0.98}, "counters": {"num_env_steps_sampled": 35746320, "num_env_steps_trained": 35746320, "num_agent_steps_sampled": 35746320, "num_agent_steps_trained": 35746320}, "done": false, "episodes_total": 8987, "training_iteration": 2724, "trial_id": "11c4c_00000", "date": "2023-08-07_09-20-47", "timestamp": 1691389247, "time_this_iter_s": 65.2772569656372, "time_total_s": 63969.32698225975, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 198.9156939983368, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.641304347826086, "ram_util_percent": 68.87282608695652}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.68649652330936, "policy_loss": -11328889.666960869, "vf_loss": 6732803.798469388}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2401.5, "diff_num_grad_updates_vs_sampler_policy": 2400.5}}, "num_env_steps_sampled": 35790240, "num_env_steps_trained": 35790240, "num_agent_steps_sampled": 35790240, "num_agent_steps_trained": 35790240}, "sampler_results": {"episode_reward_max": -188289.94439385986, "episode_reward_min": -189608.46149446574, "episode_reward_mean": -188696.35187179362, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21538241582933518, "mean_inference_ms": 0.367475138957402, "mean_action_processing_ms": 0.09008876657481205, "mean_env_wait_ms": 0.8056626321764913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032663345336914062, "StateBufferConnector_ms": 0.002664327621459961, "ViewRequirementAgentConnector_ms": 0.06573796272277832}}, "episode_reward_max": -188289.94439385986, "episode_reward_min": -189608.46149446574, "episode_reward_mean": -188696.35187179362, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21538241582933518, "mean_inference_ms": 0.367475138957402, "mean_action_processing_ms": 0.09008876657481205, "mean_env_wait_ms": 0.8056626321764913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032663345336914062, "StateBufferConnector_ms": 0.002664327621459961, "ViewRequirementAgentConnector_ms": 0.06573796272277832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35790240, "num_agent_steps_trained": 35790240, "num_env_steps_sampled": 35790240, "num_env_steps_trained": 35790240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 668.6376457951646, "num_env_steps_trained_throughput_per_sec": 668.6376457951646, "timesteps_total": 35790240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 35790240, "timers": {"training_iteration_time_ms": 66148.317, "sample_time_ms": 64992.374, "load_time_ms": 18.935, "load_throughput": 2319562.208, "learn_time_ms": 1135.854, "learn_throughput": 38666.951, "synch_weights_time_ms": 0.966}, "counters": {"num_env_steps_sampled": 35790240, "num_env_steps_trained": 35790240, "num_agent_steps_sampled": 35790240, "num_agent_steps_trained": 35790240}, "done": false, "episodes_total": 8988, "training_iteration": 2725, "trial_id": "11c4c_00000", "date": "2023-08-07_09-21-52", "timestamp": 1691389312, "time_this_iter_s": 65.68823003768921, "time_total_s": 64035.01521229744, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 264.603924036026, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 23.072340425531923, "ram_util_percent": 69.13191489361702}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8074775895989, "policy_loss": -11321773.413467452, "vf_loss": 6859147.7303206995}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3087.5, "diff_num_grad_updates_vs_sampler_policy": 3086.5}}, "num_env_steps_sampled": 35834160, "num_env_steps_trained": 35834160, "num_agent_steps_sampled": 35834160, "num_agent_steps_trained": 35834160}, "sampler_results": {"episode_reward_max": -188289.94439385986, "episode_reward_min": -190104.72640469635, "episode_reward_mean": -188978.02677837416, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21538716857536197, "mean_inference_ms": 0.36704995234894916, "mean_action_processing_ms": 0.09004186840554114, "mean_env_wait_ms": 0.8019996648965005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037908554077148438, "StateBufferConnector_ms": 0.0026559829711914062, "ViewRequirementAgentConnector_ms": 0.06601810455322266}}, "episode_reward_max": -188289.94439385986, "episode_reward_min": -190104.72640469635, "episode_reward_mean": -188978.02677837416, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21538716857536197, "mean_inference_ms": 0.36704995234894916, "mean_action_processing_ms": 0.09004186840554114, "mean_env_wait_ms": 0.8019996648965005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037908554077148438, "StateBufferConnector_ms": 0.0026559829711914062, "ViewRequirementAgentConnector_ms": 0.06601810455322266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35834160, "num_agent_steps_trained": 35834160, "num_env_steps_sampled": 35834160, "num_env_steps_trained": 35834160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 669.3904002125319, "num_env_steps_trained_throughput_per_sec": 669.3904002125319, "timesteps_total": 35834160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 35834160, "timers": {"training_iteration_time_ms": 66041.037, "sample_time_ms": 64880.528, "load_time_ms": 19.371, "load_throughput": 2267314.132, "learn_time_ms": 1139.999, "learn_throughput": 38526.351, "synch_weights_time_ms": 0.95}, "counters": {"num_env_steps_sampled": 35834160, "num_env_steps_trained": 35834160, "num_agent_steps_sampled": 35834160, "num_agent_steps_trained": 35834160}, "done": false, "episodes_total": 8989, "training_iteration": 2726, "trial_id": "11c4c_00000", "date": "2023-08-07_09-22-58", "timestamp": 1691389378, "time_this_iter_s": 65.61459994316101, "time_total_s": 64100.6298122406, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 330.218523979187, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 23.11720430107527, "ram_util_percent": 69.37849462365591}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.76574124261174, "policy_loss": -11317461.173224535, "vf_loss": 6652843.86643586}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3773.5, "diff_num_grad_updates_vs_sampler_policy": 3772.5}}, "num_env_steps_sampled": 35878080, "num_env_steps_trained": 35878080, "num_agent_steps_sampled": 35878080, "num_agent_steps_trained": 35878080}, "sampler_results": {"episode_reward_max": -187766.29191046522, "episode_reward_min": -190104.72640469635, "episode_reward_mean": -188776.070967056, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21538437622308684, "mean_inference_ms": 0.3668902815751431, "mean_action_processing_ms": 0.09002874915957133, "mean_env_wait_ms": 0.7991978685620453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036875406901041665, "StateBufferConnector_ms": 0.0026305516560872397, "ViewRequirementAgentConnector_ms": 0.06594657897949219}}, "episode_reward_max": -187766.29191046522, "episode_reward_min": -190104.72640469635, "episode_reward_mean": -188776.070967056, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21538437622308684, "mean_inference_ms": 0.3668902815751431, "mean_action_processing_ms": 0.09002874915957133, "mean_env_wait_ms": 0.7991978685620453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036875406901041665, "StateBufferConnector_ms": 0.0026305516560872397, "ViewRequirementAgentConnector_ms": 0.06594657897949219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35878080, "num_agent_steps_trained": 35878080, "num_env_steps_sampled": 35878080, "num_env_steps_trained": 35878080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 668.76403327443, "num_env_steps_trained_throughput_per_sec": 668.76403327443, "timesteps_total": 35878080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 35878080, "timers": {"training_iteration_time_ms": 65979.759, "sample_time_ms": 64821.709, "load_time_ms": 19.17, "load_throughput": 2291064.834, "learn_time_ms": 1137.758, "learn_throughput": 38602.224, "synch_weights_time_ms": 0.939}, "counters": {"num_env_steps_sampled": 35878080, "num_env_steps_trained": 35878080, "num_agent_steps_sampled": 35878080, "num_agent_steps_trained": 35878080}, "done": false, "episodes_total": 8990, "training_iteration": 2727, "trial_id": "11c4c_00000", "date": "2023-08-07_09-24-04", "timestamp": 1691389444, "time_this_iter_s": 65.67586421966553, "time_total_s": 64166.305676460266, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 395.89438819885254, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 23.605376344086025, "ram_util_percent": 69.5236559139785}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7134455021894, "policy_loss": -10539987.799198251, "vf_loss": 6741011.8715379005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4459.5, "diff_num_grad_updates_vs_sampler_policy": 4458.5}}, "num_env_steps_sampled": 35922000, "num_env_steps_trained": 35922000, "num_agent_steps_sampled": 35922000, "num_agent_steps_trained": 35922000}, "sampler_results": {"episode_reward_max": -187766.29191046522, "episode_reward_min": -190104.72640469635, "episode_reward_mean": -188774.02262779526, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2153321163646383, "mean_inference_ms": 0.3666455880466676, "mean_action_processing_ms": 0.08999494466438433, "mean_env_wait_ms": 0.7968609599124249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036205564226422992, "StateBufferConnector_ms": 0.0026668821062360492, "ViewRequirementAgentConnector_ms": 0.06570134844098773}}, "episode_reward_max": -187766.29191046522, "episode_reward_min": -190104.72640469635, "episode_reward_mean": -188774.02262779526, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2153321163646383, "mean_inference_ms": 0.3666455880466676, "mean_action_processing_ms": 0.08999494466438433, "mean_env_wait_ms": 0.7968609599124249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036205564226422992, "StateBufferConnector_ms": 0.0026668821062360492, "ViewRequirementAgentConnector_ms": 0.06570134844098773}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35922000, "num_agent_steps_trained": 35922000, "num_env_steps_sampled": 35922000, "num_env_steps_trained": 35922000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 677.9868886076947, "num_env_steps_trained_throughput_per_sec": 677.9868886076947, "timesteps_total": 35922000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 35922000, "timers": {"training_iteration_time_ms": 65808.364, "sample_time_ms": 64653.606, "load_time_ms": 19.07, "load_throughput": 2303063.594, "learn_time_ms": 1134.576, "learn_throughput": 38710.493, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 35922000, "num_env_steps_trained": 35922000, "num_agent_steps_sampled": 35922000, "num_agent_steps_trained": 35922000}, "done": false, "episodes_total": 8991, "training_iteration": 2728, "trial_id": "11c4c_00000", "date": "2023-08-07_09-25-09", "timestamp": 1691389509, "time_this_iter_s": 64.78247904777527, "time_total_s": 64231.08815550804, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 460.6768672466278, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 23.461956521739125, "ram_util_percent": 69.37717391304345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7107053261804, "policy_loss": -10944667.608685996, "vf_loss": 6645987.619169096}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5145.5, "diff_num_grad_updates_vs_sampler_policy": 5144.5}}, "num_env_steps_sampled": 35965920, "num_env_steps_trained": 35965920, "num_agent_steps_sampled": 35965920, "num_agent_steps_trained": 35965920}, "sampler_results": {"episode_reward_max": -187429.08669829488, "episode_reward_min": -190104.72640469635, "episode_reward_mean": -188605.90563660773, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2152747579072219, "mean_inference_ms": 0.36639542109877404, "mean_action_processing_ms": 0.08995518594049343, "mean_env_wait_ms": 0.7949267469229355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035315752029418945, "StateBufferConnector_ms": 0.0026911497116088867, "ViewRequirementAgentConnector_ms": 0.06564855575561523}}, "episode_reward_max": -187429.08669829488, "episode_reward_min": -190104.72640469635, "episode_reward_mean": -188605.90563660773, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2152747579072219, "mean_inference_ms": 0.36639542109877404, "mean_action_processing_ms": 0.08995518594049343, "mean_env_wait_ms": 0.7949267469229355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035315752029418945, "StateBufferConnector_ms": 0.0026911497116088867, "ViewRequirementAgentConnector_ms": 0.06564855575561523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35965920, "num_agent_steps_trained": 35965920, "num_env_steps_sampled": 35965920, "num_env_steps_trained": 35965920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 674.7761898622534, "num_env_steps_trained_throughput_per_sec": 674.7761898622534, "timesteps_total": 35965920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 35965920, "timers": {"training_iteration_time_ms": 65718.347, "sample_time_ms": 64555.061, "load_time_ms": 19.115, "load_throughput": 2297650.376, "learn_time_ms": 1143.053, "learn_throughput": 38423.412, "synch_weights_time_ms": 0.939}, "counters": {"num_env_steps_sampled": 35965920, "num_env_steps_trained": 35965920, "num_agent_steps_sampled": 35965920, "num_agent_steps_trained": 35965920}, "done": false, "episodes_total": 8992, "training_iteration": 2729, "trial_id": "11c4c_00000", "date": "2023-08-07_09-26-14", "timestamp": 1691389574, "time_this_iter_s": 65.09067392349243, "time_total_s": 64296.178829431534, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 525.7675411701202, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 22.995698924731183, "ram_util_percent": 69.36236559139785}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.72642414771434, "policy_loss": -10524869.310276398, "vf_loss": 6643396.383928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5831.5, "diff_num_grad_updates_vs_sampler_policy": 5830.5}}, "num_env_steps_sampled": 36009840, "num_env_steps_trained": 36009840, "num_agent_steps_sampled": 36009840, "num_agent_steps_trained": 36009840}, "sampler_results": {"episode_reward_max": -186914.0450234686, "episode_reward_min": -190104.72640469635, "episode_reward_mean": -188417.92112403671, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21522970395936614, "mean_inference_ms": 0.36620088400456624, "mean_action_processing_ms": 0.08991928052025351, "mean_env_wait_ms": 0.7932712761826259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034968058268229165, "StateBufferConnector_ms": 0.002680884467230903, "ViewRequirementAgentConnector_ms": 0.06549623277452257}}, "episode_reward_max": -186914.0450234686, "episode_reward_min": -190104.72640469635, "episode_reward_mean": -188417.92112403671, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21522970395936614, "mean_inference_ms": 0.36620088400456624, "mean_action_processing_ms": 0.08991928052025351, "mean_env_wait_ms": 0.7932712761826259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034968058268229165, "StateBufferConnector_ms": 0.002680884467230903, "ViewRequirementAgentConnector_ms": 0.06549623277452257}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36009840, "num_agent_steps_trained": 36009840, "num_env_steps_sampled": 36009840, "num_env_steps_trained": 36009840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 672.7565345693234, "num_env_steps_trained_throughput_per_sec": 672.7565345693234, "timesteps_total": 36009840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36009840, "timers": {"training_iteration_time_ms": 65670.045, "sample_time_ms": 64493.256, "load_time_ms": 19.226, "load_throughput": 2284413.452, "learn_time_ms": 1156.448, "learn_throughput": 37978.369, "synch_weights_time_ms": 0.933}, "counters": {"num_env_steps_sampled": 36009840, "num_env_steps_trained": 36009840, "num_agent_steps_sampled": 36009840, "num_agent_steps_trained": 36009840}, "done": false, "episodes_total": 8993, "training_iteration": 2730, "trial_id": "11c4c_00000", "date": "2023-08-07_09-27-19", "timestamp": 1691389639, "time_this_iter_s": 65.28618597984314, "time_total_s": 64361.46501541138, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 591.0537271499634, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 23.388172043010755, "ram_util_percent": 69.26021505376345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.6635229260859, "policy_loss": -10175634.121230412, "vf_loss": 6421811.30010933}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6517.5, "diff_num_grad_updates_vs_sampler_policy": 6516.5}}, "num_env_steps_sampled": 36053760, "num_env_steps_trained": 36053760, "num_agent_steps_sampled": 36053760, "num_agent_steps_trained": 36053760}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190104.72640469635, "episode_reward_mean": -188048.45293155735, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21518230402637434, "mean_inference_ms": 0.36601048852715146, "mean_action_processing_ms": 0.08988616846673061, "mean_env_wait_ms": 0.7917845555554947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039005279541015625, "StateBufferConnector_ms": 0.002701282501220703, "ViewRequirementAgentConnector_ms": 0.06635427474975586}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190104.72640469635, "episode_reward_mean": -188048.45293155735, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21518230402637434, "mean_inference_ms": 0.36601048852715146, "mean_action_processing_ms": 0.08988616846673061, "mean_env_wait_ms": 0.7917845555554947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039005279541015625, "StateBufferConnector_ms": 0.002701282501220703, "ViewRequirementAgentConnector_ms": 0.06635427474975586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36053760, "num_agent_steps_trained": 36053760, "num_env_steps_sampled": 36053760, "num_env_steps_trained": 36053760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 678.1852145562785, "num_env_steps_trained_throughput_per_sec": 678.1852145562785, "timesteps_total": 36053760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36053760, "timers": {"training_iteration_time_ms": 65579.145, "sample_time_ms": 64406.057, "load_time_ms": 19.169, "load_throughput": 2291242.46, "learn_time_ms": 1152.8, "learn_throughput": 38098.537, "synch_weights_time_ms": 0.938}, "counters": {"num_env_steps_sampled": 36053760, "num_env_steps_trained": 36053760, "num_agent_steps_sampled": 36053760, "num_agent_steps_trained": 36053760}, "done": false, "episodes_total": 8994, "training_iteration": 2731, "trial_id": "11c4c_00000", "date": "2023-08-07_09-28-24", "timestamp": 1691389704, "time_this_iter_s": 64.76361966133118, "time_total_s": 64426.22863507271, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 655.8173468112946, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.63804347826087, "ram_util_percent": 68.65326086956522}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.62783875757333, "policy_loss": -11337437.393503439, "vf_loss": 6862847.017128279}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7203.5, "diff_num_grad_updates_vs_sampler_policy": 7202.5}}, "num_env_steps_sampled": 36097680, "num_env_steps_trained": 36097680, "num_agent_steps_sampled": 36097680, "num_agent_steps_trained": 36097680}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188237.01621027396, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21512780846823779, "mean_inference_ms": 0.36584355383242156, "mean_action_processing_ms": 0.08985789696070477, "mean_env_wait_ms": 0.7904975800273865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038580460981889205, "StateBufferConnector_ms": 0.002687627618963068, "ViewRequirementAgentConnector_ms": 0.06623918359929865}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188237.01621027396, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21512780846823779, "mean_inference_ms": 0.36584355383242156, "mean_action_processing_ms": 0.08985789696070477, "mean_env_wait_ms": 0.7904975800273865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038580460981889205, "StateBufferConnector_ms": 0.002687627618963068, "ViewRequirementAgentConnector_ms": 0.06623918359929865}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36097680, "num_agent_steps_trained": 36097680, "num_env_steps_sampled": 36097680, "num_env_steps_trained": 36097680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 675.5506607276849, "num_env_steps_trained_throughput_per_sec": 675.5506607276849, "timesteps_total": 36097680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36097680, "timers": {"training_iteration_time_ms": 65236.862, "sample_time_ms": 64064.589, "load_time_ms": 21.127, "load_throughput": 2078843.786, "learn_time_ms": 1150.028, "learn_throughput": 38190.382, "synch_weights_time_ms": 0.933}, "counters": {"num_env_steps_sampled": 36097680, "num_env_steps_trained": 36097680, "num_agent_steps_sampled": 36097680, "num_agent_steps_trained": 36097680}, "done": false, "episodes_total": 8995, "training_iteration": 2732, "trial_id": "11c4c_00000", "date": "2023-08-07_09-29-29", "timestamp": 1691389769, "time_this_iter_s": 65.01612687110901, "time_total_s": 64491.24476194382, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 720.8334736824036, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 23.87717391304348, "ram_util_percent": 68.9141304347826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7510553476762, "policy_loss": -10608771.264027765, "vf_loss": 6550864.119897959}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7889.5, "diff_num_grad_updates_vs_sampler_policy": 7888.5}}, "num_env_steps_sampled": 36141600, "num_env_steps_trained": 36141600, "num_agent_steps_sampled": 36141600, "num_agent_steps_trained": 36141600}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188054.14836897035, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2150627217122794, "mean_inference_ms": 0.3656682013873224, "mean_action_processing_ms": 0.08982708579371738, "mean_env_wait_ms": 0.7893562545998171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003814697265625, "StateBufferConnector_ms": 0.002664327621459961, "ViewRequirementAgentConnector_ms": 0.06606380144755046}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188054.14836897035, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2150627217122794, "mean_inference_ms": 0.3656682013873224, "mean_action_processing_ms": 0.08982708579371738, "mean_env_wait_ms": 0.7893562545998171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003814697265625, "StateBufferConnector_ms": 0.002664327621459961, "ViewRequirementAgentConnector_ms": 0.06606380144755046}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36141600, "num_agent_steps_trained": 36141600, "num_env_steps_sampled": 36141600, "num_env_steps_trained": 36141600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 679.3471652683737, "num_env_steps_trained_throughput_per_sec": 679.3471652683737, "timesteps_total": 36141600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36141600, "timers": {"training_iteration_time_ms": 65182.194, "sample_time_ms": 64011.04, "load_time_ms": 19.878, "load_throughput": 2209487.75, "learn_time_ms": 1150.18, "learn_throughput": 38185.333, "synch_weights_time_ms": 0.915}, "counters": {"num_env_steps_sampled": 36141600, "num_env_steps_trained": 36141600, "num_agent_steps_sampled": 36141600, "num_agent_steps_trained": 36141600}, "done": false, "episodes_total": 8996, "training_iteration": 2733, "trial_id": "11c4c_00000", "date": "2023-08-07_09-30-33", "timestamp": 1691389833, "time_this_iter_s": 64.65279412269592, "time_total_s": 64555.89755606651, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 785.4862678050995, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 21.603260869565215, "ram_util_percent": 68.73804347826088}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.84355902046224, "policy_loss": -10989444.688137755, "vf_loss": 6784401.674927114}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8575.5, "diff_num_grad_updates_vs_sampler_policy": 8574.5}}, "num_env_steps_sampled": 36185520, "num_env_steps_trained": 36185520, "num_agent_steps_sampled": 36185520, "num_agent_steps_trained": 36185520}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188104.06690485688, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21501150879831965, "mean_inference_ms": 0.36550144781518445, "mean_action_processing_ms": 0.08979905688476421, "mean_env_wait_ms": 0.788262654458265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037651795607346753, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.0660107685969426}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188104.06690485688, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21501150879831965, "mean_inference_ms": 0.36550144781518445, "mean_action_processing_ms": 0.08979905688476421, "mean_env_wait_ms": 0.788262654458265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037651795607346753, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.0660107685969426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36185520, "num_agent_steps_trained": 36185520, "num_env_steps_sampled": 36185520, "num_env_steps_trained": 36185520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 682.1719737957203, "num_env_steps_trained_throughput_per_sec": 682.1719737957203, "timesteps_total": 36185520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36185520, "timers": {"training_iteration_time_ms": 65093.043, "sample_time_ms": 63919.737, "load_time_ms": 19.598, "load_throughput": 2241022.371, "learn_time_ms": 1152.624, "learn_throughput": 38104.346, "synch_weights_time_ms": 0.909}, "counters": {"num_env_steps_sampled": 36185520, "num_env_steps_trained": 36185520, "num_agent_steps_sampled": 36185520, "num_agent_steps_trained": 36185520}, "done": false, "episodes_total": 8997, "training_iteration": 2734, "trial_id": "11c4c_00000", "date": "2023-08-07_09-31-38", "timestamp": 1691389898, "time_this_iter_s": 64.38507294654846, "time_total_s": 64620.28262901306, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 849.871340751648, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 24.84130434782608, "ram_util_percent": 68.85217391304346}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7013605857382, "policy_loss": -10673824.427691668, "vf_loss": 6659075.080174927}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9261.5, "diff_num_grad_updates_vs_sampler_policy": 9260.5}}, "num_env_steps_sampled": 36229440, "num_env_steps_trained": 36229440, "num_agent_steps_sampled": 36229440, "num_agent_steps_trained": 36229440}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188075.15330963305, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2149668722656295, "mean_inference_ms": 0.36535686406141726, "mean_action_processing_ms": 0.08977666547551812, "mean_env_wait_ms": 0.7872826947244506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003741468702043806, "StateBufferConnector_ms": 0.0027077538626534598, "ViewRequirementAgentConnector_ms": 0.06609303610665458}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188075.15330963305, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2149668722656295, "mean_inference_ms": 0.36535686406141726, "mean_action_processing_ms": 0.08977666547551812, "mean_env_wait_ms": 0.7872826947244506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003741468702043806, "StateBufferConnector_ms": 0.0027077538626534598, "ViewRequirementAgentConnector_ms": 0.06609303610665458}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36229440, "num_agent_steps_trained": 36229440, "num_env_steps_sampled": 36229440, "num_env_steps_trained": 36229440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 676.0914532135783, "num_env_steps_trained_throughput_per_sec": 676.0914532135783, "timesteps_total": 36229440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36229440, "timers": {"training_iteration_time_ms": 65020.626, "sample_time_ms": 63854.088, "load_time_ms": 19.29, "load_throughput": 2276864.635, "learn_time_ms": 1146.166, "learn_throughput": 38319.041, "synch_weights_time_ms": 0.908}, "counters": {"num_env_steps_sampled": 36229440, "num_env_steps_trained": 36229440, "num_agent_steps_sampled": 36229440, "num_agent_steps_trained": 36229440}, "done": false, "episodes_total": 8998, "training_iteration": 2735, "trial_id": "11c4c_00000", "date": "2023-08-07_09-32-43", "timestamp": 1691389963, "time_this_iter_s": 64.96413683891296, "time_total_s": 64685.246765851974, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 914.8354775905609, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 23.68369565217391, "ram_util_percent": 68.92826086956521}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.74764427429733, "policy_loss": -11404426.744917888, "vf_loss": 6840803.1575255105}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9947.5, "diff_num_grad_updates_vs_sampler_policy": 9946.5}}, "num_env_steps_sampled": 36273360, "num_env_steps_trained": 36273360, "num_agent_steps_sampled": 36273360, "num_agent_steps_trained": 36273360}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188170.1404145483, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21492417424576865, "mean_inference_ms": 0.3652279140822588, "mean_action_processing_ms": 0.08975577310353264, "mean_env_wait_ms": 0.7863719246067701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003703435262044271, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.06614049275716145}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188170.1404145483, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21492417424576865, "mean_inference_ms": 0.3652279140822588, "mean_action_processing_ms": 0.08975577310353264, "mean_env_wait_ms": 0.7863719246067701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003703435262044271, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.06614049275716145}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36273360, "num_agent_steps_trained": 36273360, "num_env_steps_sampled": 36273360, "num_env_steps_trained": 36273360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 679.8574789137109, "num_env_steps_trained_throughput_per_sec": 679.8574789137109, "timesteps_total": 36273360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36273360, "timers": {"training_iteration_time_ms": 64919.61, "sample_time_ms": 63758.457, "load_time_ms": 18.996, "load_throughput": 2312106.29, "learn_time_ms": 1141.074, "learn_throughput": 38490.058, "synch_weights_time_ms": 0.91}, "counters": {"num_env_steps_sampled": 36273360, "num_env_steps_trained": 36273360, "num_agent_steps_sampled": 36273360, "num_agent_steps_trained": 36273360}, "done": false, "episodes_total": 8999, "training_iteration": 2736, "trial_id": "11c4c_00000", "date": "2023-08-07_09-33-48", "timestamp": 1691390028, "time_this_iter_s": 64.6046679019928, "time_total_s": 64749.85143375397, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 979.4401454925537, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.275, "ram_util_percent": 68.91630434782608}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.72413470654726, "policy_loss": -10714286.996344296, "vf_loss": 6837949.796373907}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10633.5, "diff_num_grad_updates_vs_sampler_policy": 10632.5}}, "num_env_steps_sampled": 36317280, "num_env_steps_trained": 36317280, "num_agent_steps_sampled": 36317280, "num_agent_steps_trained": 36317280}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188237.04274766156, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21488718414643893, "mean_inference_ms": 0.36511742435766276, "mean_action_processing_ms": 0.08973780720152136, "mean_env_wait_ms": 0.7855245425019236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003668665885925293, "StateBufferConnector_ms": 0.0026926398277282715, "ViewRequirementAgentConnector_ms": 0.06620734930038452}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188237.04274766156, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21488718414643893, "mean_inference_ms": 0.36511742435766276, "mean_action_processing_ms": 0.08973780720152136, "mean_env_wait_ms": 0.7855245425019236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003668665885925293, "StateBufferConnector_ms": 0.0026926398277282715, "ViewRequirementAgentConnector_ms": 0.06620734930038452}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36317280, "num_agent_steps_trained": 36317280, "num_env_steps_sampled": 36317280, "num_env_steps_trained": 36317280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 678.3818528670855, "num_env_steps_trained_throughput_per_sec": 678.3818528670855, "timesteps_total": 36317280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36317280, "timers": {"training_iteration_time_ms": 64826.501, "sample_time_ms": 63665.558, "load_time_ms": 19.028, "load_throughput": 2308134.519, "learn_time_ms": 1140.816, "learn_throughput": 38498.76, "synch_weights_time_ms": 0.924}, "counters": {"num_env_steps_sampled": 36317280, "num_env_steps_trained": 36317280, "num_agent_steps_sampled": 36317280, "num_agent_steps_trained": 36317280}, "done": false, "episodes_total": 9000, "training_iteration": 2737, "trial_id": "11c4c_00000", "date": "2023-08-07_09-34-52", "timestamp": 1691390092, "time_this_iter_s": 64.74476599693298, "time_total_s": 64814.5961997509, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1044.1849114894867, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 23.85978260869565, "ram_util_percent": 68.94347826086955}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.80657006978294, "policy_loss": -10259737.597790064, "vf_loss": 6780055.614067055}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11319.5, "diff_num_grad_updates_vs_sampler_policy": 11318.5}}, "num_env_steps_sampled": 36361200, "num_env_steps_trained": 36361200, "num_agent_steps_sampled": 36361200, "num_agent_steps_trained": 36361200}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188268.09285945375, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21485970408312616, "mean_inference_ms": 0.3650280345801913, "mean_action_processing_ms": 0.0897247595778138, "mean_env_wait_ms": 0.7847633428098617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036351821001838237, "StateBufferConnector_ms": 0.0027025447172277116, "ViewRequirementAgentConnector_ms": 0.06617097293629366}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188268.09285945375, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21485970408312616, "mean_inference_ms": 0.3650280345801913, "mean_action_processing_ms": 0.0897247595778138, "mean_env_wait_ms": 0.7847633428098617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036351821001838237, "StateBufferConnector_ms": 0.0027025447172277116, "ViewRequirementAgentConnector_ms": 0.06617097293629366}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36361200, "num_agent_steps_trained": 36361200, "num_env_steps_sampled": 36361200, "num_env_steps_trained": 36361200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 672.7254140171602, "num_env_steps_trained_throughput_per_sec": 672.7254140171602, "timesteps_total": 36361200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36361200, "timers": {"training_iteration_time_ms": 64877.166, "sample_time_ms": 63715.762, "load_time_ms": 19.151, "load_throughput": 2293370.412, "learn_time_ms": 1141.147, "learn_throughput": 38487.579, "synch_weights_time_ms": 0.932}, "counters": {"num_env_steps_sampled": 36361200, "num_env_steps_trained": 36361200, "num_agent_steps_sampled": 36361200, "num_agent_steps_trained": 36361200}, "done": false, "episodes_total": 9001, "training_iteration": 2738, "trial_id": "11c4c_00000", "date": "2023-08-07_09-35-58", "timestamp": 1691390158, "time_this_iter_s": 65.2891480922699, "time_total_s": 64879.88534784317, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1109.4740595817566, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 23.894623655913982, "ram_util_percent": 69.05806451612904}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.74412434302684, "policy_loss": -10590120.485792866, "vf_loss": 6860445.379008747}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12005.5, "diff_num_grad_updates_vs_sampler_policy": 12004.5}}, "num_env_steps_sampled": 36405120, "num_env_steps_trained": 36405120, "num_agent_steps_sampled": 36405120, "num_agent_steps_trained": 36405120}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188352.801749056, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2148420703992446, "mean_inference_ms": 0.3649718509736804, "mean_action_processing_ms": 0.08971785217196035, "mean_env_wait_ms": 0.7840846565501793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036054187350802952, "StateBufferConnector_ms": 0.0026875072055392796, "ViewRequirementAgentConnector_ms": 0.06612406836615668}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188352.801749056, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2148420703992446, "mean_inference_ms": 0.3649718509736804, "mean_action_processing_ms": 0.08971785217196035, "mean_env_wait_ms": 0.7840846565501793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036054187350802952, "StateBufferConnector_ms": 0.0026875072055392796, "ViewRequirementAgentConnector_ms": 0.06612406836615668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36405120, "num_agent_steps_trained": 36405120, "num_env_steps_sampled": 36405120, "num_env_steps_trained": 36405120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 667.7218961967886, "num_env_steps_trained_throughput_per_sec": 667.7218961967886, "timesteps_total": 36405120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36405120, "timers": {"training_iteration_time_ms": 64945.93, "sample_time_ms": 63786.954, "load_time_ms": 18.976, "load_throughput": 2314514.531, "learn_time_ms": 1138.905, "learn_throughput": 38563.351, "synch_weights_time_ms": 0.922}, "counters": {"num_env_steps_sampled": 36405120, "num_env_steps_trained": 36405120, "num_agent_steps_sampled": 36405120, "num_agent_steps_trained": 36405120}, "done": false, "episodes_total": 9002, "training_iteration": 2739, "trial_id": "11c4c_00000", "date": "2023-08-07_09-37-03", "timestamp": 1691390223, "time_this_iter_s": 65.77837991714478, "time_total_s": 64945.663727760315, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1175.2524394989014, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 22.190322580645166, "ram_util_percent": 69.12795698924731}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7764259538567, "policy_loss": -10901323.653249135, "vf_loss": 6710587.158892129}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12691.5, "diff_num_grad_updates_vs_sampler_policy": 12690.5}}, "num_env_steps_sampled": 36449040, "num_env_steps_trained": 36449040, "num_agent_steps_sampled": 36449040, "num_agent_steps_trained": 36449040}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188339.00879063085, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21482332391590775, "mean_inference_ms": 0.3649214925520097, "mean_action_processing_ms": 0.08971061254573993, "mean_env_wait_ms": 0.7834441529062437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00358631736353824, "StateBufferConnector_ms": 0.0026903654399671054, "ViewRequirementAgentConnector_ms": 0.0661887620624743}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190122.64899743997, "episode_reward_mean": -188339.00879063085, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21482332391590775, "mean_inference_ms": 0.3649214925520097, "mean_action_processing_ms": 0.08971061254573993, "mean_env_wait_ms": 0.7834441529062437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00358631736353824, "StateBufferConnector_ms": 0.0026903654399671054, "ViewRequirementAgentConnector_ms": 0.0661887620624743}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36449040, "num_agent_steps_trained": 36449040, "num_env_steps_sampled": 36449040, "num_env_steps_trained": 36449040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 679.2521321513601, "num_env_steps_trained_throughput_per_sec": 679.2521321513601, "timesteps_total": 36449040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36449040, "timers": {"training_iteration_time_ms": 64883.5, "sample_time_ms": 63739.988, "load_time_ms": 18.575, "load_throughput": 2364516.834, "learn_time_ms": 1123.846, "learn_throughput": 39080.078, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 36449040, "num_env_steps_trained": 36449040, "num_agent_steps_sampled": 36449040, "num_agent_steps_trained": 36449040}, "done": false, "episodes_total": 9003, "training_iteration": 2740, "trial_id": "11c4c_00000", "date": "2023-08-07_09-38-08", "timestamp": 1691390288, "time_this_iter_s": 64.66182398796082, "time_total_s": 65010.325551748276, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1239.9142634868622, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 24.01304347826086, "ram_util_percent": 69.05978260869566}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7997829337162, "policy_loss": -10858078.478939846, "vf_loss": 6896500.73669825}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13377.5, "diff_num_grad_updates_vs_sampler_policy": 13376.5}}, "num_env_steps_sampled": 36492960, "num_env_steps_trained": 36492960, "num_agent_steps_sampled": 36492960, "num_agent_steps_trained": 36492960}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188430.03936549457, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2148045114562346, "mean_inference_ms": 0.36486919515830535, "mean_action_processing_ms": 0.08970226597974074, "mean_env_wait_ms": 0.7828414079695712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003560781478881836, "StateBufferConnector_ms": 0.0026738643646240234, "ViewRequirementAgentConnector_ms": 0.06617426872253418}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188430.03936549457, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2148045114562346, "mean_inference_ms": 0.36486919515830535, "mean_action_processing_ms": 0.08970226597974074, "mean_env_wait_ms": 0.7828414079695712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003560781478881836, "StateBufferConnector_ms": 0.0026738643646240234, "ViewRequirementAgentConnector_ms": 0.06617426872253418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36492960, "num_agent_steps_trained": 36492960, "num_env_steps_sampled": 36492960, "num_env_steps_trained": 36492960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 679.4041457845796, "num_env_steps_trained_throughput_per_sec": 679.4041457845796, "timesteps_total": 36492960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36492960, "timers": {"training_iteration_time_ms": 64871.881, "sample_time_ms": 63722.924, "load_time_ms": 18.767, "load_throughput": 2340248.511, "learn_time_ms": 1129.109, "learn_throughput": 38897.936, "synch_weights_time_ms": 0.915}, "counters": {"num_env_steps_sampled": 36492960, "num_env_steps_trained": 36492960, "num_agent_steps_sampled": 36492960, "num_agent_steps_trained": 36492960}, "done": false, "episodes_total": 9004, "training_iteration": 2741, "trial_id": "11c4c_00000", "date": "2023-08-07_09-39-13", "timestamp": 1691390353, "time_this_iter_s": 64.64753317832947, "time_total_s": 65074.973084926605, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1304.5617966651917, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 24.045652173913037, "ram_util_percent": 69.09239130434784}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.76396455014066, "policy_loss": -9992523.282835847, "vf_loss": 6738965.659438776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14063.5, "diff_num_grad_updates_vs_sampler_policy": 14062.5}}, "num_env_steps_sampled": 36536880, "num_env_steps_trained": 36536880, "num_agent_steps_sampled": 36536880, "num_agent_steps_trained": 36536880}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188437.0069099528, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2147890436280781, "mean_inference_ms": 0.3648315904002911, "mean_action_processing_ms": 0.0896968797343119, "mean_env_wait_ms": 0.7822725333863371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035365422566731772, "StateBufferConnector_ms": 0.0026623407999674478, "ViewRequirementAgentConnector_ms": 0.06612482525053479}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188437.0069099528, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2147890436280781, "mean_inference_ms": 0.3648315904002911, "mean_action_processing_ms": 0.0896968797343119, "mean_env_wait_ms": 0.7822725333863371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035365422566731772, "StateBufferConnector_ms": 0.0026623407999674478, "ViewRequirementAgentConnector_ms": 0.06612482525053479}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36536880, "num_agent_steps_trained": 36536880, "num_env_steps_sampled": 36536880, "num_env_steps_trained": 36536880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 675.3920585848426, "num_env_steps_trained_throughput_per_sec": 675.3920585848426, "timesteps_total": 36536880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36536880, "timers": {"training_iteration_time_ms": 64873.408, "sample_time_ms": 63722.23, "load_time_ms": 18.525, "load_throughput": 2370867.949, "learn_time_ms": 1131.567, "learn_throughput": 38813.438, "synch_weights_time_ms": 0.919}, "counters": {"num_env_steps_sampled": 36536880, "num_env_steps_trained": 36536880, "num_agent_steps_sampled": 36536880, "num_agent_steps_trained": 36536880}, "done": false, "episodes_total": 9005, "training_iteration": 2742, "trial_id": "11c4c_00000", "date": "2023-08-07_09-40-18", "timestamp": 1691390418, "time_this_iter_s": 65.03168511390686, "time_total_s": 65140.00477004051, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1369.5934817790985, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 23.24021739130435, "ram_util_percent": 69.27065217391305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.729337019406, "policy_loss": -10807806.198840084, "vf_loss": 6891320.011479592}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14749.5, "diff_num_grad_updates_vs_sampler_policy": 14748.5}}, "num_env_steps_sampled": 36580800, "num_env_steps_trained": 36580800, "num_agent_steps_sampled": 36580800, "num_agent_steps_trained": 36580800}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188508.50370142702, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21477147545624076, "mean_inference_ms": 0.36478822425835344, "mean_action_processing_ms": 0.08969106386910101, "mean_env_wait_ms": 0.7817188277635886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528594970703125, "StateBufferConnector_ms": 0.00266486948186701, "ViewRequirementAgentConnector_ms": 0.06611238826404918}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188508.50370142702, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21477147545624076, "mean_inference_ms": 0.36478822425835344, "mean_action_processing_ms": 0.08969106386910101, "mean_env_wait_ms": 0.7817188277635886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528594970703125, "StateBufferConnector_ms": 0.00266486948186701, "ViewRequirementAgentConnector_ms": 0.06611238826404918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36580800, "num_agent_steps_trained": 36580800, "num_env_steps_sampled": 36580800, "num_env_steps_trained": 36580800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 684.959804672163, "num_env_steps_trained_throughput_per_sec": 684.959804672163, "timesteps_total": 36580800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36580800, "timers": {"training_iteration_time_ms": 64820.432, "sample_time_ms": 63669.851, "load_time_ms": 18.239, "load_throughput": 2408033.387, "learn_time_ms": 1131.242, "learn_throughput": 38824.57, "synch_weights_time_ms": 0.929}, "counters": {"num_env_steps_sampled": 36580800, "num_env_steps_trained": 36580800, "num_agent_steps_sampled": 36580800, "num_agent_steps_trained": 36580800}, "done": false, "episodes_total": 9006, "training_iteration": 2743, "trial_id": "11c4c_00000", "date": "2023-08-07_09-41-22", "timestamp": 1691390482, "time_this_iter_s": 64.12309694290161, "time_total_s": 65204.127866983414, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1433.7165787220001, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 24.12608695652174, "ram_util_percent": 69.2108695652174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.82970599738917, "policy_loss": -10908165.705434015, "vf_loss": 6829564.453717201}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15435.5, "diff_num_grad_updates_vs_sampler_policy": 15434.5}}, "num_env_steps_sampled": 36624720, "num_env_steps_trained": 36624720, "num_agent_steps_sampled": 36624720, "num_agent_steps_trained": 36624720}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188550.15716053566, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2147984279806937, "mean_inference_ms": 0.36488203828897625, "mean_action_processing_ms": 0.08970987298268888, "mean_env_wait_ms": 0.7813324577530693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035524368286132812, "StateBufferConnector_ms": 0.0026796175085979958, "ViewRequirementAgentConnector_ms": 0.06655299145242442}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188550.15716053566, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2147984279806937, "mean_inference_ms": 0.36488203828897625, "mean_action_processing_ms": 0.08970987298268888, "mean_env_wait_ms": 0.7813324577530693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035524368286132812, "StateBufferConnector_ms": 0.0026796175085979958, "ViewRequirementAgentConnector_ms": 0.06655299145242442}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36624720, "num_agent_steps_trained": 36624720, "num_env_steps_sampled": 36624720, "num_env_steps_trained": 36624720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 601.0889794642895, "num_env_steps_trained_throughput_per_sec": 601.0889794642895, "timesteps_total": 36624720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36624720, "timers": {"training_iteration_time_ms": 65688.911, "sample_time_ms": 64500.893, "load_time_ms": 18.507, "load_throughput": 2373173.961, "learn_time_ms": 1168.383, "learn_throughput": 37590.41, "synch_weights_time_ms": 0.95}, "counters": {"num_env_steps_sampled": 36624720, "num_env_steps_trained": 36624720, "num_agent_steps_sampled": 36624720, "num_agent_steps_trained": 36624720}, "done": false, "episodes_total": 9007, "training_iteration": 2744, "trial_id": "11c4c_00000", "date": "2023-08-07_09-42-35", "timestamp": 1691390555, "time_this_iter_s": 73.0708909034729, "time_total_s": 65277.19875788689, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1506.787469625473, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 32.49519230769231, "ram_util_percent": 69.83653846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.83031875121003, "policy_loss": -10555463.836899826, "vf_loss": 6667127.41053207}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16121.5, "diff_num_grad_updates_vs_sampler_policy": 16120.5}}, "num_env_steps_sampled": 36668640, "num_env_steps_trained": 36668640, "num_agent_steps_sampled": 36668640, "num_agent_steps_trained": 36668640}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188505.10050294138, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21485735696108357, "mean_inference_ms": 0.3650676218194217, "mean_action_processing_ms": 0.08974506526696935, "mean_env_wait_ms": 0.7810512858088949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696481386820475, "StateBufferConnector_ms": 0.0026931365331014, "ViewRequirementAgentConnector_ms": 0.0669946273167928}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188505.10050294138, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21485735696108357, "mean_inference_ms": 0.3650676218194217, "mean_action_processing_ms": 0.08974506526696935, "mean_env_wait_ms": 0.7810512858088949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696481386820475, "StateBufferConnector_ms": 0.0026931365331014, "ViewRequirementAgentConnector_ms": 0.0669946273167928}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36668640, "num_agent_steps_trained": 36668640, "num_env_steps_sampled": 36668640, "num_env_steps_trained": 36668640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 615.766542953125, "num_env_steps_trained_throughput_per_sec": 615.766542953125, "timesteps_total": 36668640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36668640, "timers": {"training_iteration_time_ms": 66325.322, "sample_time_ms": 65127.284, "load_time_ms": 18.402, "load_throughput": 2386702.732, "learn_time_ms": 1178.491, "learn_throughput": 37267.988, "synch_weights_time_ms": 0.961}, "counters": {"num_env_steps_sampled": 36668640, "num_env_steps_trained": 36668640, "num_agent_steps_sampled": 36668640, "num_agent_steps_trained": 36668640}, "done": false, "episodes_total": 9008, "training_iteration": 2745, "trial_id": "11c4c_00000", "date": "2023-08-07_09-43-46", "timestamp": 1691390626, "time_this_iter_s": 71.32867789268494, "time_total_s": 65348.52743577957, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1578.116147518158, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 31.1990099009901, "ram_util_percent": 69.99009900990099}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.6447346856921, "policy_loss": -10697249.551026102, "vf_loss": 6788583.229409621}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16807.5, "diff_num_grad_updates_vs_sampler_policy": 16806.5}}, "num_env_steps_sampled": 36712560, "num_env_steps_trained": 36712560, "num_agent_steps_sampled": 36712560, "num_agent_steps_trained": 36712560}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188523.73056720247, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21502211422920325, "mean_inference_ms": 0.36545482215804065, "mean_action_processing_ms": 0.08981980602654246, "mean_env_wait_ms": 0.7810435926398168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704071044921875, "StateBufferConnector_ms": 0.002716064453125, "ViewRequirementAgentConnector_ms": 0.06738090515136719}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188523.73056720247, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21502211422920325, "mean_inference_ms": 0.36545482215804065, "mean_action_processing_ms": 0.08981980602654246, "mean_env_wait_ms": 0.7810435926398168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704071044921875, "StateBufferConnector_ms": 0.002716064453125, "ViewRequirementAgentConnector_ms": 0.06738090515136719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36712560, "num_agent_steps_trained": 36712560, "num_env_steps_sampled": 36712560, "num_env_steps_trained": 36712560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 527.7939754302904, "num_env_steps_trained_throughput_per_sec": 527.7939754302904, "timesteps_total": 36712560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36712560, "timers": {"training_iteration_time_ms": 68186.573, "sample_time_ms": 66955.039, "load_time_ms": 18.389, "load_throughput": 2388404.682, "learn_time_ms": 1211.981, "learn_throughput": 36238.199, "synch_weights_time_ms": 0.978}, "counters": {"num_env_steps_sampled": 36712560, "num_env_steps_trained": 36712560, "num_agent_steps_sampled": 36712560, "num_agent_steps_trained": 36712560}, "done": false, "episodes_total": 9009, "training_iteration": 2746, "trial_id": "11c4c_00000", "date": "2023-08-07_09-45-10", "timestamp": 1691390710, "time_this_iter_s": 83.21739888191223, "time_total_s": 65431.744834661484, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1661.3335464000702, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 39.229661016949144, "ram_util_percent": 70.73813559322035}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7523384205454, "policy_loss": -10091117.508968432, "vf_loss": 6666507.001822158}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17493.5, "diff_num_grad_updates_vs_sampler_policy": 17492.5}}, "num_env_steps_sampled": 36756480, "num_env_steps_trained": 36756480, "num_agent_steps_sampled": 36756480, "num_agent_steps_trained": 36756480}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188494.2123100365, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21522186993016149, "mean_inference_ms": 0.36598076735868185, "mean_action_processing_ms": 0.08992145004159391, "mean_env_wait_ms": 0.7812050435101815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003689069014329177, "StateBufferConnector_ms": 0.0027014659001277043, "ViewRequirementAgentConnector_ms": 0.06729272695688102}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188494.2123100365, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21522186993016149, "mean_inference_ms": 0.36598076735868185, "mean_action_processing_ms": 0.08992145004159391, "mean_env_wait_ms": 0.7812050435101815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003689069014329177, "StateBufferConnector_ms": 0.0027014659001277043, "ViewRequirementAgentConnector_ms": 0.06729272695688102}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36756480, "num_agent_steps_trained": 36756480, "num_env_steps_sampled": 36756480, "num_env_steps_trained": 36756480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 556.5552371048508, "num_env_steps_trained_throughput_per_sec": 556.5552371048508, "timesteps_total": 36756480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36756480, "timers": {"training_iteration_time_ms": 69603.743, "sample_time_ms": 68370.846, "load_time_ms": 18.161, "load_throughput": 2418431.101, "learn_time_ms": 1213.571, "learn_throughput": 36190.705, "synch_weights_time_ms": 0.978}, "counters": {"num_env_steps_sampled": 36756480, "num_env_steps_trained": 36756480, "num_agent_steps_sampled": 36756480, "num_agent_steps_trained": 36756480}, "done": false, "episodes_total": 9010, "training_iteration": 2747, "trial_id": "11c4c_00000", "date": "2023-08-07_09-46-29", "timestamp": 1691390789, "time_this_iter_s": 78.91678190231323, "time_total_s": 65510.6616165638, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1740.2503283023834, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 36.841964285714276, "ram_util_percent": 70.82857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.65747755400986, "policy_loss": -10211303.237307535, "vf_loss": 6525285.129555394}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18179.5, "diff_num_grad_updates_vs_sampler_policy": 18178.5}}, "num_env_steps_sampled": 36800400, "num_env_steps_trained": 36800400, "num_agent_steps_sampled": 36800400, "num_agent_steps_trained": 36800400}, "sampler_results": {"episode_reward_max": -184723.23919924293, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188382.96971228247, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2154042999874509, "mean_inference_ms": 0.3664634878615731, "mean_action_processing_ms": 0.09001463829465504, "mean_env_wait_ms": 0.7813295503774182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036822424994574655, "StateBufferConnector_ms": 0.00270825845223886, "ViewRequirementAgentConnector_ms": 0.06737444135877821}}, "episode_reward_max": -184723.23919924293, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188382.96971228247, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2154042999874509, "mean_inference_ms": 0.3664634878615731, "mean_action_processing_ms": 0.09001463829465504, "mean_env_wait_ms": 0.7813295503774182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036822424994574655, "StateBufferConnector_ms": 0.00270825845223886, "ViewRequirementAgentConnector_ms": 0.06737444135877821}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36800400, "num_agent_steps_trained": 36800400, "num_env_steps_sampled": 36800400, "num_env_steps_trained": 36800400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 667.0888240151269, "num_env_steps_trained_throughput_per_sec": 667.0888240151269, "timesteps_total": 36800400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36800400, "timers": {"training_iteration_time_ms": 69658.907, "sample_time_ms": 68425.769, "load_time_ms": 18.032, "load_throughput": 2435692.133, "learn_time_ms": 1213.94, "learn_throughput": 36179.725, "synch_weights_time_ms": 0.981}, "counters": {"num_env_steps_sampled": 36800400, "num_env_steps_trained": 36800400, "num_agent_steps_sampled": 36800400, "num_agent_steps_trained": 36800400}, "done": false, "episodes_total": 9011, "training_iteration": 2748, "trial_id": "11c4c_00000", "date": "2023-08-07_09-47-34", "timestamp": 1691390854, "time_this_iter_s": 65.8411169052124, "time_total_s": 65576.50273346901, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1806.0914452075958, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 23.985106382978728, "ram_util_percent": 71.2159574468085}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.6687912565626, "policy_loss": -9789535.813926408, "vf_loss": 6472197.566508747}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18865.5, "diff_num_grad_updates_vs_sampler_policy": 18864.5}}, "num_env_steps_sampled": 36844320, "num_env_steps_trained": 36844320, "num_agent_steps_sampled": 36844320, "num_agent_steps_trained": 36844320}, "sampler_results": {"episode_reward_max": -184487.05452948884, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188243.82988432556, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2155708517125532, "mean_inference_ms": 0.36690396356817107, "mean_action_processing_ms": 0.09009933004727777, "mean_env_wait_ms": 0.7814233264215564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036622796739850727, "StateBufferConnector_ms": 0.0027120113372802734, "ViewRequirementAgentConnector_ms": 0.06737027849469866}}, "episode_reward_max": -184487.05452948884, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188243.82988432556, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2155708517125532, "mean_inference_ms": 0.36690396356817107, "mean_action_processing_ms": 0.09009933004727777, "mean_env_wait_ms": 0.7814233264215564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036622796739850727, "StateBufferConnector_ms": 0.0027120113372802734, "ViewRequirementAgentConnector_ms": 0.06737027849469866}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36844320, "num_agent_steps_trained": 36844320, "num_env_steps_sampled": 36844320, "num_env_steps_trained": 36844320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 668.4685282901148, "num_env_steps_trained_throughput_per_sec": 668.4685282901148, "timesteps_total": 36844320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36844320, "timers": {"training_iteration_time_ms": 69651.561, "sample_time_ms": 68420.425, "load_time_ms": 18.13, "load_throughput": 2422447.799, "learn_time_ms": 1211.833, "learn_throughput": 36242.61, "synch_weights_time_ms": 0.981}, "counters": {"num_env_steps_sampled": 36844320, "num_env_steps_trained": 36844320, "num_agent_steps_sampled": 36844320, "num_agent_steps_trained": 36844320}, "done": false, "episodes_total": 9012, "training_iteration": 2749, "trial_id": "11c4c_00000", "date": "2023-08-07_09-48-40", "timestamp": 1691390920, "time_this_iter_s": 65.70510196685791, "time_total_s": 65642.20783543587, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1871.7965471744537, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 22.110752688172045, "ram_util_percent": 71.1215053763441}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8387769693536, "policy_loss": -9704614.004555393, "vf_loss": 6550177.02569242}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19551.5, "diff_num_grad_updates_vs_sampler_policy": 19550.5}}, "num_env_steps_sampled": 36888240, "num_env_steps_trained": 36888240, "num_agent_steps_sampled": 36888240, "num_agent_steps_trained": 36888240}, "sampler_results": {"episode_reward_max": -184487.05452948884, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188138.94439619122, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21572246814132257, "mean_inference_ms": 0.36730533928070525, "mean_action_processing_ms": 0.0901756745892948, "mean_env_wait_ms": 0.7814673011181127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037374167606748386, "StateBufferConnector_ms": 0.002754967788170124, "ViewRequirementAgentConnector_ms": 0.06728254515549233}}, "episode_reward_max": -184487.05452948884, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188138.94439619122, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21572246814132257, "mean_inference_ms": 0.36730533928070525, "mean_action_processing_ms": 0.0901756745892948, "mean_env_wait_ms": 0.7814673011181127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037374167606748386, "StateBufferConnector_ms": 0.002754967788170124, "ViewRequirementAgentConnector_ms": 0.06728254515549233}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36888240, "num_agent_steps_trained": 36888240, "num_env_steps_sampled": 36888240, "num_env_steps_trained": 36888240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 679.2593580226603, "num_env_steps_trained_throughput_per_sec": 679.2593580226603, "timesteps_total": 36888240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36888240, "timers": {"training_iteration_time_ms": 69651.492, "sample_time_ms": 68419.129, "load_time_ms": 18.42, "load_throughput": 2384413.574, "learn_time_ms": 1212.771, "learn_throughput": 36214.582, "synch_weights_time_ms": 0.981}, "counters": {"num_env_steps_sampled": 36888240, "num_env_steps_trained": 36888240, "num_agent_steps_sampled": 36888240, "num_agent_steps_trained": 36888240}, "done": false, "episodes_total": 9013, "training_iteration": 2750, "trial_id": "11c4c_00000", "date": "2023-08-07_09-49-45", "timestamp": 1691390985, "time_this_iter_s": 64.661288022995, "time_total_s": 65706.86912345886, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1936.4578351974487, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 24.78478260869565, "ram_util_percent": 70.89021739130435}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8015666105309, "policy_loss": -10451564.03452419, "vf_loss": 6484085.378279883}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20237.5, "diff_num_grad_updates_vs_sampler_policy": 20236.5}}, "num_env_steps_sampled": 36932160, "num_env_steps_trained": 36932160, "num_agent_steps_sampled": 36932160, "num_agent_steps_trained": 36932160}, "sampler_results": {"episode_reward_max": -184487.05452948884, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188039.10435654467, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21586036547002896, "mean_inference_ms": 0.36767053098056107, "mean_action_processing_ms": 0.09024512904229962, "mean_env_wait_ms": 0.7815073781068869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037256876627604165, "StateBufferConnector_ms": 0.0027441978454589844, "ViewRequirementAgentConnector_ms": 0.06721814473470052}}, "episode_reward_max": -184487.05452948884, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -188039.10435654467, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21586036547002896, "mean_inference_ms": 0.36767053098056107, "mean_action_processing_ms": 0.09024512904229962, "mean_env_wait_ms": 0.7815073781068869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037256876627604165, "StateBufferConnector_ms": 0.0027441978454589844, "ViewRequirementAgentConnector_ms": 0.06721814473470052}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36932160, "num_agent_steps_trained": 36932160, "num_env_steps_sampled": 36932160, "num_env_steps_trained": 36932160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 664.4744276576893, "num_env_steps_trained_throughput_per_sec": 664.4744276576893, "timesteps_total": 36932160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36932160, "timers": {"training_iteration_time_ms": 69796.739, "sample_time_ms": 68569.416, "load_time_ms": 18.35, "load_throughput": 2393459.819, "learn_time_ms": 1207.801, "learn_throughput": 36363.617, "synch_weights_time_ms": 0.982}, "counters": {"num_env_steps_sampled": 36932160, "num_env_steps_trained": 36932160, "num_agent_steps_sampled": 36932160, "num_agent_steps_trained": 36932160}, "done": false, "episodes_total": 9014, "training_iteration": 2751, "trial_id": "11c4c_00000", "date": "2023-08-07_09-50-51", "timestamp": 1691391051, "time_this_iter_s": 66.09993195533752, "time_total_s": 65772.9690554142, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2002.5577671527863, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 23.576595744680855, "ram_util_percent": 71.36808510638298}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.94508361816406, "policy_loss": -9736471.51564493, "vf_loss": 6508337.86898688}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20923.5, "diff_num_grad_updates_vs_sampler_policy": 20922.5}}, "num_env_steps_sampled": 36976080, "num_env_steps_trained": 36976080, "num_agent_steps_sampled": 36976080, "num_agent_steps_trained": 36976080}, "sampler_results": {"episode_reward_max": -184487.05452948884, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187937.09922366895, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21598423891206434, "mean_inference_ms": 0.3679947044132476, "mean_action_processing_ms": 0.0903066859105424, "mean_env_wait_ms": 0.7815318622538894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037062552667433218, "StateBufferConnector_ms": 0.002743351844049269, "ViewRequirementAgentConnector_ms": 0.06714097915157195}}, "episode_reward_max": -184487.05452948884, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187937.09922366895, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21598423891206434, "mean_inference_ms": 0.3679947044132476, "mean_action_processing_ms": 0.0903066859105424, "mean_env_wait_ms": 0.7815318622538894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037062552667433218, "StateBufferConnector_ms": 0.002743351844049269, "ViewRequirementAgentConnector_ms": 0.06714097915157195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36976080, "num_agent_steps_trained": 36976080, "num_env_steps_sampled": 36976080, "num_env_steps_trained": 36976080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 675.3096277713275, "num_env_steps_trained_throughput_per_sec": 675.3096277713275, "timesteps_total": 36976080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36976080, "timers": {"training_iteration_time_ms": 69797.533, "sample_time_ms": 68572.079, "load_time_ms": 18.43, "load_throughput": 2383037.869, "learn_time_ms": 1205.861, "learn_throughput": 36422.123, "synch_weights_time_ms": 0.979}, "counters": {"num_env_steps_sampled": 36976080, "num_env_steps_trained": 36976080, "num_agent_steps_sampled": 36976080, "num_agent_steps_trained": 36976080}, "done": false, "episodes_total": 9015, "training_iteration": 2752, "trial_id": "11c4c_00000", "date": "2023-08-07_09-51-56", "timestamp": 1691391116, "time_this_iter_s": 65.03957223892212, "time_total_s": 65838.00862765312, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2067.5973393917084, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 19.81290322580645, "ram_util_percent": 71.89032258064516}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.6950789026199, "policy_loss": -10236708.50467782, "vf_loss": 6600557.378644315}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21609.5, "diff_num_grad_updates_vs_sampler_policy": 21608.5}}, "num_env_steps_sampled": 37020000, "num_env_steps_trained": 37020000, "num_agent_steps_sampled": 37020000, "num_agent_steps_trained": 37020000}, "sampler_results": {"episode_reward_max": -184487.05452948884, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187884.6143128881, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21609632149318075, "mean_inference_ms": 0.3682946015158944, "mean_action_processing_ms": 0.09036310466258934, "mean_env_wait_ms": 0.7815487045617548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036932528018951416, "StateBufferConnector_ms": 0.00273287296295166, "ViewRequirementAgentConnector_ms": 0.06706416606903076}}, "episode_reward_max": -184487.05452948884, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187884.6143128881, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21609632149318075, "mean_inference_ms": 0.3682946015158944, "mean_action_processing_ms": 0.09036310466258934, "mean_env_wait_ms": 0.7815487045617548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036932528018951416, "StateBufferConnector_ms": 0.00273287296295166, "ViewRequirementAgentConnector_ms": 0.06706416606903076}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37020000, "num_agent_steps_trained": 37020000, "num_env_steps_sampled": 37020000, "num_env_steps_trained": 37020000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 665.9956872750319, "num_env_steps_trained_throughput_per_sec": 665.9956872750319, "timesteps_total": 37020000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37020000, "timers": {"training_iteration_time_ms": 69980.115, "sample_time_ms": 68753.458, "load_time_ms": 18.46, "load_throughput": 2379138.404, "learn_time_ms": 1207.034, "learn_throughput": 36386.728, "synch_weights_time_ms": 0.978}, "counters": {"num_env_steps_sampled": 37020000, "num_env_steps_trained": 37020000, "num_agent_steps_sampled": 37020000, "num_agent_steps_trained": 37020000}, "done": false, "episodes_total": 9016, "training_iteration": 2753, "trial_id": "11c4c_00000", "date": "2023-08-07_09-53-02", "timestamp": 1691391182, "time_this_iter_s": 65.9491639137268, "time_total_s": 65903.95779156685, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2133.546503305435, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 23.315957446808504, "ram_util_percent": 71.95425531914893}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7447980430314, "policy_loss": -9441361.228359032, "vf_loss": 6422787.348943149}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22295.5, "diff_num_grad_updates_vs_sampler_policy": 22294.5}}, "num_env_steps_sampled": 37063920, "num_env_steps_trained": 37063920, "num_agent_steps_sampled": 37063920, "num_agent_steps_trained": 37063920}, "sampler_results": {"episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187766.4489443254, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21619575855486198, "mean_inference_ms": 0.3685656446285825, "mean_action_processing_ms": 0.09041398502739866, "mean_env_wait_ms": 0.7815269582048112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036795934041341147, "StateBufferConnector_ms": 0.0027331438931551847, "ViewRequirementAgentConnector_ms": 0.06700140057188092}}, "episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187766.4489443254, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21619575855486198, "mean_inference_ms": 0.3685656446285825, "mean_action_processing_ms": 0.09041398502739866, "mean_env_wait_ms": 0.7815269582048112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036795934041341147, "StateBufferConnector_ms": 0.0027331438931551847, "ViewRequirementAgentConnector_ms": 0.06700140057188092}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37063920, "num_agent_steps_trained": 37063920, "num_env_steps_sampled": 37063920, "num_env_steps_trained": 37063920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 686.9009241069505, "num_env_steps_trained_throughput_per_sec": 686.9009241069505, "timesteps_total": 37063920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37063920, "timers": {"training_iteration_time_ms": 69067.312, "sample_time_ms": 67879.196, "load_time_ms": 18.19, "load_throughput": 2414573.276, "learn_time_ms": 1168.782, "learn_throughput": 37577.571, "synch_weights_time_ms": 0.967}, "counters": {"num_env_steps_sampled": 37063920, "num_env_steps_trained": 37063920, "num_agent_steps_sampled": 37063920, "num_agent_steps_trained": 37063920}, "done": false, "episodes_total": 9017, "training_iteration": 2754, "trial_id": "11c4c_00000", "date": "2023-08-07_09-54-06", "timestamp": 1691391246, "time_this_iter_s": 63.941890001297, "time_total_s": 65967.89968156815, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2197.488393306732, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 25.75, "ram_util_percent": 71.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.375e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8390319646274, "policy_loss": -9552010.857564231, "vf_loss": 6566440.097303207}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22981.5, "diff_num_grad_updates_vs_sampler_policy": 22980.5}}, "num_env_steps_sampled": 37107840, "num_env_steps_trained": 37107840, "num_agent_steps_sampled": 37107840, "num_agent_steps_trained": 37107840}, "sampler_results": {"episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187697.86596739836, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21628464742647827, "mean_inference_ms": 0.3688075578604142, "mean_action_processing_ms": 0.09045957228729373, "mean_env_wait_ms": 0.7814857444449805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003669542424819049, "StateBufferConnector_ms": 0.002725685344022863, "ViewRequirementAgentConnector_ms": 0.0669240951538086}}, "episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187697.86596739836, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21628464742647827, "mean_inference_ms": 0.3688075578604142, "mean_action_processing_ms": 0.09045957228729373, "mean_env_wait_ms": 0.7814857444449805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003669542424819049, "StateBufferConnector_ms": 0.002725685344022863, "ViewRequirementAgentConnector_ms": 0.0669240951538086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37107840, "num_agent_steps_trained": 37107840, "num_env_steps_sampled": 37107840, "num_env_steps_trained": 37107840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 681.3614559285891, "num_env_steps_trained_throughput_per_sec": 681.3614559285891, "timesteps_total": 37107840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37107840, "timers": {"training_iteration_time_ms": 68380.656, "sample_time_ms": 67200.845, "load_time_ms": 18.141, "load_throughput": 2420999.234, "learn_time_ms": 1160.549, "learn_throughput": 37844.168, "synch_weights_time_ms": 0.951}, "counters": {"num_env_steps_sampled": 37107840, "num_env_steps_trained": 37107840, "num_agent_steps_sampled": 37107840, "num_agent_steps_trained": 37107840}, "done": false, "episodes_total": 9018, "training_iteration": 2755, "trial_id": "11c4c_00000", "date": "2023-08-07_09-55-10", "timestamp": 1691391310, "time_this_iter_s": 64.46187806129456, "time_total_s": 66032.36155962944, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2261.9502713680267, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 22.006521739130427, "ram_util_percent": 71.86847826086957}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.749999999999999e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8478547922029, "policy_loss": -9408586.11057079, "vf_loss": 6535381.787536443}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23667.5, "diff_num_grad_updates_vs_sampler_policy": 23666.5}}, "num_env_steps_sampled": 37151760, "num_env_steps_trained": 37151760, "num_agent_steps_sampled": 37151760, "num_agent_steps_trained": 37151760}, "sampler_results": {"episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187622.2146967132, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21636766821444614, "mean_inference_ms": 0.3690342465100702, "mean_action_processing_ms": 0.09050165090470028, "mean_env_wait_ms": 0.7814290215576005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036655153547014508, "StateBufferConnector_ms": 0.0027350017002650668, "ViewRequirementAgentConnector_ms": 0.06718294961111886}}, "episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187622.2146967132, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21636766821444614, "mean_inference_ms": 0.3690342465100702, "mean_action_processing_ms": 0.09050165090470028, "mean_env_wait_ms": 0.7814290215576005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036655153547014508, "StateBufferConnector_ms": 0.0027350017002650668, "ViewRequirementAgentConnector_ms": 0.06718294961111886}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37151760, "num_agent_steps_trained": 37151760, "num_env_steps_sampled": 37151760, "num_env_steps_trained": 37151760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 671.9468544391198, "num_env_steps_trained_throughput_per_sec": 671.9468544391198, "timesteps_total": 37151760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37151760, "timers": {"training_iteration_time_ms": 66595.459, "sample_time_ms": 65447.128, "load_time_ms": 18.023, "load_throughput": 2436861.733, "learn_time_ms": 1129.21, "learn_throughput": 38894.433, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 37151760, "num_env_steps_trained": 37151760, "num_agent_steps_sampled": 37151760, "num_agent_steps_trained": 37151760}, "done": false, "episodes_total": 9019, "training_iteration": 2756, "trial_id": "11c4c_00000", "date": "2023-08-07_09-56-16", "timestamp": 1691391376, "time_this_iter_s": 65.36489391326904, "time_total_s": 66097.72645354271, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2327.315165281296, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 23.783870967741933, "ram_util_percent": 72.20645161290321}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.125e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.757326398577, "policy_loss": -10650222.737839947, "vf_loss": 6709273.273870262}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24353.5, "diff_num_grad_updates_vs_sampler_policy": 24352.5}}, "num_env_steps_sampled": 37195680, "num_env_steps_trained": 37195680, "num_agent_steps_sampled": 37195680, "num_agent_steps_trained": 37195680}, "sampler_results": {"episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187613.72847018746, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21644364712786734, "mean_inference_ms": 0.369238508157883, "mean_action_processing_ms": 0.09053989286107329, "mean_env_wait_ms": 0.7813584295608251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036550892723931205, "StateBufferConnector_ms": 0.0027226077185736764, "ViewRequirementAgentConnector_ms": 0.06711085637410481}}, "episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187613.72847018746, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21644364712786734, "mean_inference_ms": 0.369238508157883, "mean_action_processing_ms": 0.09053989286107329, "mean_env_wait_ms": 0.7813584295608251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036550892723931205, "StateBufferConnector_ms": 0.0027226077185736764, "ViewRequirementAgentConnector_ms": 0.06711085637410481}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37195680, "num_agent_steps_trained": 37195680, "num_env_steps_sampled": 37195680, "num_env_steps_trained": 37195680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 678.7860190542817, "num_env_steps_trained_throughput_per_sec": 678.7860190542817, "timesteps_total": 37195680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37195680, "timers": {"training_iteration_time_ms": 65174.434, "sample_time_ms": 64026.12, "load_time_ms": 18.119, "load_throughput": 2423923.615, "learn_time_ms": 1129.109, "learn_throughput": 38897.936, "synch_weights_time_ms": 0.92}, "counters": {"num_env_steps_sampled": 37195680, "num_env_steps_trained": 37195680, "num_agent_steps_sampled": 37195680, "num_agent_steps_trained": 37195680}, "done": false, "episodes_total": 9020, "training_iteration": 2757, "trial_id": "11c4c_00000", "date": "2023-08-07_09-57-21", "timestamp": 1691391441, "time_this_iter_s": 64.70604705810547, "time_total_s": 66162.43250060081, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2392.0212123394012, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 25.70543478260869, "ram_util_percent": 71.87065217391304}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8045761953637, "policy_loss": -10305954.17055963, "vf_loss": 6624540.607142857}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25039.5, "diff_num_grad_updates_vs_sampler_policy": 25038.5}}, "num_env_steps_sampled": 37239600, "num_env_steps_trained": 37239600, "num_agent_steps_sampled": 37239600, "num_agent_steps_trained": 37239600}, "sampler_results": {"episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187586.9695383459, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21651209862725537, "mean_inference_ms": 0.3694234047553222, "mean_action_processing_ms": 0.09057395863463061, "mean_env_wait_ms": 0.781273861241774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003649093009330131, "StateBufferConnector_ms": 0.0027257042962151603, "ViewRequirementAgentConnector_ms": 0.06708003379203178}}, "episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187586.9695383459, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21651209862725537, "mean_inference_ms": 0.3694234047553222, "mean_action_processing_ms": 0.09057395863463061, "mean_env_wait_ms": 0.781273861241774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003649093009330131, "StateBufferConnector_ms": 0.0027257042962151603, "ViewRequirementAgentConnector_ms": 0.06708003379203178}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37239600, "num_agent_steps_trained": 37239600, "num_env_steps_sampled": 37239600, "num_env_steps_trained": 37239600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 680.9239401194466, "num_env_steps_trained_throughput_per_sec": 680.9239401194466, "timesteps_total": 37239600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37239600, "timers": {"training_iteration_time_ms": 65040.663, "sample_time_ms": 63891.509, "load_time_ms": 18.0, "load_throughput": 2440054.039, "learn_time_ms": 1130.064, "learn_throughput": 38865.047, "synch_weights_time_ms": 0.925}, "counters": {"num_env_steps_sampled": 37239600, "num_env_steps_trained": 37239600, "num_agent_steps_sampled": 37239600, "num_agent_steps_trained": 37239600}, "done": false, "episodes_total": 9021, "training_iteration": 2758, "trial_id": "11c4c_00000", "date": "2023-08-07_09-58-25", "timestamp": 1691391505, "time_this_iter_s": 64.50344610214233, "time_total_s": 66226.93594670296, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2456.5246584415436, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 25.45217391304348, "ram_util_percent": 71.42608695652173}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.874999999999998e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7345861763023, "policy_loss": -10113540.717104364, "vf_loss": 6742079.568968659}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25725.5, "diff_num_grad_updates_vs_sampler_policy": 25724.5}}, "num_env_steps_sampled": 37283520, "num_env_steps_trained": 37283520, "num_agent_steps_sampled": 37283520, "num_agent_steps_trained": 37283520}, "sampler_results": {"episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187587.40522110494, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21657379973406163, "mean_inference_ms": 0.3695880582031245, "mean_action_processing_ms": 0.09060446110747879, "mean_env_wait_ms": 0.7811700541117792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003645922008313631, "StateBufferConnector_ms": 0.0027229911402652136, "ViewRequirementAgentConnector_ms": 0.06711420259977642}}, "episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187587.40522110494, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21657379973406163, "mean_inference_ms": 0.3695880582031245, "mean_action_processing_ms": 0.09060446110747879, "mean_env_wait_ms": 0.7811700541117792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003645922008313631, "StateBufferConnector_ms": 0.0027229911402652136, "ViewRequirementAgentConnector_ms": 0.06711420259977642}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37283520, "num_agent_steps_trained": 37283520, "num_env_steps_sampled": 37283520, "num_env_steps_trained": 37283520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 687.5518678437318, "num_env_steps_trained_throughput_per_sec": 687.5518678437318, "timesteps_total": 37283520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37283520, "timers": {"training_iteration_time_ms": 64858.302, "sample_time_ms": 63710.717, "load_time_ms": 17.88, "load_throughput": 2456358.005, "learn_time_ms": 1128.595, "learn_throughput": 38915.657, "synch_weights_time_ms": 0.949}, "counters": {"num_env_steps_sampled": 37283520, "num_env_steps_trained": 37283520, "num_agent_steps_sampled": 37283520, "num_agent_steps_trained": 37283520}, "done": false, "episodes_total": 9022, "training_iteration": 2759, "trial_id": "11c4c_00000", "date": "2023-08-07_09-59-29", "timestamp": 1691391569, "time_this_iter_s": 63.881370067596436, "time_total_s": 66290.81731677055, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2520.40602850914, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 25.708791208791204, "ram_util_percent": 71.45604395604394}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.249999999999999e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9072035186145, "policy_loss": -9358596.121836849, "vf_loss": 6542369.365889213}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26411.5, "diff_num_grad_updates_vs_sampler_policy": 26410.5}}, "num_env_steps_sampled": 37327440, "num_env_steps_trained": 37327440, "num_agent_steps_sampled": 37327440, "num_agent_steps_trained": 37327440}, "sampler_results": {"episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187534.18077957077, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2166299599649841, "mean_inference_ms": 0.3697367554313456, "mean_action_processing_ms": 0.09063169333313144, "mean_env_wait_ms": 0.7810479706643811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036802047338241185, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.06827146579057743}}, "episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187534.18077957077, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2166299599649841, "mean_inference_ms": 0.3697367554313456, "mean_action_processing_ms": 0.09063169333313144, "mean_env_wait_ms": 0.7810479706643811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036802047338241185, "StateBufferConnector_ms": 0.002747315626878005, "ViewRequirementAgentConnector_ms": 0.06827146579057743}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37327440, "num_agent_steps_trained": 37327440, "num_env_steps_sampled": 37327440, "num_env_steps_trained": 37327440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 686.6726392760446, "num_env_steps_trained_throughput_per_sec": 686.6726392760446, "timesteps_total": 37327440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37327440, "timers": {"training_iteration_time_ms": 64788.497, "sample_time_ms": 63637.989, "load_time_ms": 17.761, "load_throughput": 2472804.969, "learn_time_ms": 1131.591, "learn_throughput": 38812.604, "synch_weights_time_ms": 0.988}, "counters": {"num_env_steps_sampled": 37327440, "num_env_steps_trained": 37327440, "num_agent_steps_sampled": 37327440, "num_agent_steps_trained": 37327440}, "done": false, "episodes_total": 9023, "training_iteration": 2760, "trial_id": "11c4c_00000", "date": "2023-08-07_10-00-33", "timestamp": 1691391633, "time_this_iter_s": 63.96398401260376, "time_total_s": 66354.78130078316, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2584.370012521744, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 25.52777777777778, "ram_util_percent": 71.39444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.6250000000000006e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.70537373623415, "policy_loss": -9701115.680740934, "vf_loss": 6421786.542456268}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27097.5, "diff_num_grad_updates_vs_sampler_policy": 27096.5}}, "num_env_steps_sampled": 37371360, "num_env_steps_trained": 37371360, "num_agent_steps_sampled": 37371360, "num_agent_steps_trained": 37371360}, "sampler_results": {"episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187451.37555660383, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21668589799695592, "mean_inference_ms": 0.3698825977661535, "mean_action_processing_ms": 0.09065863697129568, "mean_env_wait_ms": 0.7809305003073523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003668069839477539, "StateBufferConnector_ms": 0.0027441978454589844, "ViewRequirementAgentConnector_ms": 0.06820619106292725}}, "episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187451.37555660383, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21668589799695592, "mean_inference_ms": 0.3698825977661535, "mean_action_processing_ms": 0.09065863697129568, "mean_env_wait_ms": 0.7809305003073523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003668069839477539, "StateBufferConnector_ms": 0.0027441978454589844, "ViewRequirementAgentConnector_ms": 0.06820619106292725}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37371360, "num_agent_steps_trained": 37371360, "num_env_steps_sampled": 37371360, "num_env_steps_trained": 37371360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 656.5224283048121, "num_env_steps_trained_throughput_per_sec": 656.5224283048121, "timesteps_total": 37371360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37371360, "timers": {"training_iteration_time_ms": 64868.556, "sample_time_ms": 63699.474, "load_time_ms": 18.118, "load_throughput": 2424143.707, "learn_time_ms": 1149.796, "learn_throughput": 38198.064, "synch_weights_time_ms": 0.994}, "counters": {"num_env_steps_sampled": 37371360, "num_env_steps_trained": 37371360, "num_agent_steps_sampled": 37371360, "num_agent_steps_trained": 37371360}, "done": false, "episodes_total": 9024, "training_iteration": 2761, "trial_id": "11c4c_00000", "date": "2023-08-07_10-01-40", "timestamp": 1691391700, "time_this_iter_s": 66.90077590942383, "time_total_s": 66421.68207669258, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2651.2707884311676, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 25.198958333333337, "ram_util_percent": 72.390625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.785063585109, "policy_loss": -9894806.82650214, "vf_loss": 6601227.352405248}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27783.5, "diff_num_grad_updates_vs_sampler_policy": 27782.5}}, "num_env_steps_sampled": 37415280, "num_env_steps_trained": 37415280, "num_agent_steps_sampled": 37415280, "num_agent_steps_trained": 37415280}, "sampler_results": {"episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187427.5248112387, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21674926315034201, "mean_inference_ms": 0.3700278746905292, "mean_action_processing_ms": 0.09068577811277698, "mean_env_wait_ms": 0.7808127756281098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036582714173851944, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.06815921969530059}}, "episode_reward_max": -183985.15715032018, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187427.5248112387, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21674926315034201, "mean_inference_ms": 0.3700278746905292, "mean_action_processing_ms": 0.09068577811277698, "mean_env_wait_ms": 0.7808127756281098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036582714173851944, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.06815921969530059}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37415280, "num_agent_steps_trained": 37415280, "num_env_steps_sampled": 37415280, "num_env_steps_trained": 37415280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 654.0154766360396, "num_env_steps_trained_throughput_per_sec": 654.0154766360396, "timesteps_total": 37415280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37415280, "timers": {"training_iteration_time_ms": 65080.31, "sample_time_ms": 63910.871, "load_time_ms": 18.283, "load_throughput": 2402261.656, "learn_time_ms": 1149.987, "learn_throughput": 38191.741, "synch_weights_time_ms": 0.994}, "counters": {"num_env_steps_sampled": 37415280, "num_env_steps_trained": 37415280, "num_agent_steps_sampled": 37415280, "num_agent_steps_trained": 37415280}, "done": false, "episodes_total": 9025, "training_iteration": 2762, "trial_id": "11c4c_00000", "date": "2023-08-07_10-02-47", "timestamp": 1691391767, "time_this_iter_s": 67.15710783004761, "time_total_s": 66488.83918452263, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2718.427896261215, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 27.407368421052634, "ram_util_percent": 72.63578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.90522570373713, "policy_loss": -9403521.695682626, "vf_loss": 6437996.472120991}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28469.5, "diff_num_grad_updates_vs_sampler_policy": 28468.5}}, "num_env_steps_sampled": 37459200, "num_env_steps_trained": 37459200, "num_agent_steps_sampled": 37459200, "num_agent_steps_trained": 37459200}, "sampler_results": {"episode_reward_max": -183542.6236804452, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187335.0271652674, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21680948049434054, "mean_inference_ms": 0.37016969113019443, "mean_action_processing_ms": 0.09071198126176204, "mean_env_wait_ms": 0.7806939338148514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003651210239955357, "StateBufferConnector_ms": 0.0027452196393694195, "ViewRequirementAgentConnector_ms": 0.06812924430483863}}, "episode_reward_max": -183542.6236804452, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187335.0271652674, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21680948049434054, "mean_inference_ms": 0.37016969113019443, "mean_action_processing_ms": 0.09071198126176204, "mean_env_wait_ms": 0.7806939338148514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003651210239955357, "StateBufferConnector_ms": 0.0027452196393694195, "ViewRequirementAgentConnector_ms": 0.06812924430483863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37459200, "num_agent_steps_trained": 37459200, "num_env_steps_sampled": 37459200, "num_env_steps_trained": 37459200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 665.3000352625882, "num_env_steps_trained_throughput_per_sec": 665.3000352625882, "timesteps_total": 37459200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37459200, "timers": {"training_iteration_time_ms": 65087.205, "sample_time_ms": 63918.442, "load_time_ms": 18.248, "load_throughput": 2406828.395, "learn_time_ms": 1149.355, "learn_throughput": 38212.735, "synch_weights_time_ms": 0.987}, "counters": {"num_env_steps_sampled": 37459200, "num_env_steps_trained": 37459200, "num_agent_steps_sampled": 37459200, "num_agent_steps_trained": 37459200}, "done": false, "episodes_total": 9026, "training_iteration": 2763, "trial_id": "11c4c_00000", "date": "2023-08-07_10-03-53", "timestamp": 1691391833, "time_this_iter_s": 66.01813197135925, "time_total_s": 66554.85731649399, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2784.4460282325745, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 26.38936170212766, "ram_util_percent": 72.62127659574466}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.86256684506253, "policy_loss": -8799543.425832499, "vf_loss": 6210066.037354227}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29155.5, "diff_num_grad_updates_vs_sampler_policy": 29154.5}}, "num_env_steps_sampled": 37503120, "num_env_steps_trained": 37503120, "num_agent_steps_sampled": 37503120, "num_agent_steps_trained": 37503120}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187188.58214603388, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21686565888010315, "mean_inference_ms": 0.3703022300919389, "mean_action_processing_ms": 0.09073649793348819, "mean_env_wait_ms": 0.7805655067334578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037115673686182776, "StateBufferConnector_ms": 0.002736823503361192, "ViewRequirementAgentConnector_ms": 0.06806961325711983}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187188.58214603388, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21686565888010315, "mean_inference_ms": 0.3703022300919389, "mean_action_processing_ms": 0.09073649793348819, "mean_env_wait_ms": 0.7805655067334578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037115673686182776, "StateBufferConnector_ms": 0.002736823503361192, "ViewRequirementAgentConnector_ms": 0.06806961325711983}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37503120, "num_agent_steps_trained": 37503120, "num_env_steps_sampled": 37503120, "num_env_steps_trained": 37503120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 678.8539401706086, "num_env_steps_trained_throughput_per_sec": 678.8539401706086, "timesteps_total": 37503120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37503120, "timers": {"training_iteration_time_ms": 65162.997, "sample_time_ms": 63994.899, "load_time_ms": 18.161, "load_throughput": 2418367.602, "learn_time_ms": 1148.772, "learn_throughput": 38232.141, "synch_weights_time_ms": 0.989}, "counters": {"num_env_steps_sampled": 37503120, "num_env_steps_trained": 37503120, "num_agent_steps_sampled": 37503120, "num_agent_steps_trained": 37503120}, "done": false, "episodes_total": 9027, "training_iteration": 2764, "trial_id": "11c4c_00000", "date": "2023-08-07_10-04-58", "timestamp": 1691391898, "time_this_iter_s": 64.70003008842468, "time_total_s": 66619.55734658241, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2849.146058320999, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 24.167391304347827, "ram_util_percent": 72.77934782608695}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7120565964946, "policy_loss": -9140119.247819105, "vf_loss": 6248713.440779883}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29841.5, "diff_num_grad_updates_vs_sampler_policy": 29840.5}}, "num_env_steps_sampled": 37547040, "num_env_steps_trained": 37547040, "num_agent_steps_sampled": 37547040, "num_agent_steps_trained": 37547040}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187070.0738395865, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21691724930454967, "mean_inference_ms": 0.3704244275017091, "mean_action_processing_ms": 0.0907588375037443, "mean_env_wait_ms": 0.7804317899349938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701448440551758, "StateBufferConnector_ms": 0.0027315183119340377, "ViewRequirementAgentConnector_ms": 0.06800727410749956}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -187070.0738395865, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21691724930454967, "mean_inference_ms": 0.3704244275017091, "mean_action_processing_ms": 0.0907588375037443, "mean_env_wait_ms": 0.7804317899349938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701448440551758, "StateBufferConnector_ms": 0.0027315183119340377, "ViewRequirementAgentConnector_ms": 0.06800727410749956}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37547040, "num_agent_steps_trained": 37547040, "num_env_steps_sampled": 37547040, "num_env_steps_trained": 37547040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 679.6446606354024, "num_env_steps_trained_throughput_per_sec": 679.6446606354024, "timesteps_total": 37547040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37547040, "timers": {"training_iteration_time_ms": 65179.28, "sample_time_ms": 64012.234, "load_time_ms": 18.162, "load_throughput": 2418275.535, "learn_time_ms": 1147.71, "learn_throughput": 38267.495, "synch_weights_time_ms": 0.995}, "counters": {"num_env_steps_sampled": 37547040, "num_env_steps_trained": 37547040, "num_agent_steps_sampled": 37547040, "num_agent_steps_trained": 37547040}, "done": false, "episodes_total": 9028, "training_iteration": 2765, "trial_id": "11c4c_00000", "date": "2023-08-07_10-06-02", "timestamp": 1691391962, "time_this_iter_s": 64.62468886375427, "time_total_s": 66684.18203544617, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2913.7707471847534, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 23.25978260869565, "ram_util_percent": 72.84130434782608}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9053863881281, "policy_loss": -9336053.997870354, "vf_loss": 6422422.582908163}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30527.5, "diff_num_grad_updates_vs_sampler_policy": 30526.5}}, "num_env_steps_sampled": 37590960, "num_env_steps_trained": 37590960, "num_agent_steps_sampled": 37590960, "num_agent_steps_trained": 37590960}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186998.9555662054, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21696948085380205, "mean_inference_ms": 0.37055194002710223, "mean_action_processing_ms": 0.09078226928592008, "mean_env_wait_ms": 0.7803029033556339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036997265285915798, "StateBufferConnector_ms": 0.0027301576402452257, "ViewRequirementAgentConnector_ms": 0.06813526153564453}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186998.9555662054, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21696948085380205, "mean_inference_ms": 0.37055194002710223, "mean_action_processing_ms": 0.09078226928592008, "mean_env_wait_ms": 0.7803029033556339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036997265285915798, "StateBufferConnector_ms": 0.0027301576402452257, "ViewRequirementAgentConnector_ms": 0.06813526153564453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37590960, "num_agent_steps_trained": 37590960, "num_env_steps_sampled": 37590960, "num_env_steps_trained": 37590960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 648.9383367353596, "num_env_steps_trained_throughput_per_sec": 648.9383367353596, "timesteps_total": 37590960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37590960, "timers": {"training_iteration_time_ms": 65411.026, "sample_time_ms": 64229.949, "load_time_ms": 18.373, "load_throughput": 2390428.515, "learn_time_ms": 1161.518, "learn_throughput": 37812.601, "synch_weights_time_ms": 1.003}, "counters": {"num_env_steps_sampled": 37590960, "num_env_steps_trained": 37590960, "num_agent_steps_sampled": 37590960, "num_agent_steps_trained": 37590960}, "done": false, "episodes_total": 9029, "training_iteration": 2766, "trial_id": "11c4c_00000", "date": "2023-08-07_10-07-10", "timestamp": 1691392030, "time_this_iter_s": 67.68286490440369, "time_total_s": 66751.86490035057, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2981.453612089157, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 28.119791666666668, "ram_util_percent": 72.859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7358070128861, "policy_loss": -10340059.933482712, "vf_loss": 6569738.614431486}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31213.5, "diff_num_grad_updates_vs_sampler_policy": 31212.5}}, "num_env_steps_sampled": 37634880, "num_env_steps_trained": 37634880, "num_agent_steps_sampled": 37634880, "num_agent_steps_trained": 37634880}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186983.46414159, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21701882408661408, "mean_inference_ms": 0.3706772187611186, "mean_action_processing_ms": 0.0908050043350629, "mean_env_wait_ms": 0.7801754697884892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036856402521548066, "StateBufferConnector_ms": 0.0027330025382663894, "ViewRequirementAgentConnector_ms": 0.0680685043334961}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186983.46414159, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21701882408661408, "mean_inference_ms": 0.3706772187611186, "mean_action_processing_ms": 0.0908050043350629, "mean_env_wait_ms": 0.7801754697884892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036856402521548066, "StateBufferConnector_ms": 0.0027330025382663894, "ViewRequirementAgentConnector_ms": 0.0680685043334961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37634880, "num_agent_steps_trained": 37634880, "num_env_steps_sampled": 37634880, "num_env_steps_trained": 37634880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 664.4318174366756, "num_env_steps_trained_throughput_per_sec": 664.4318174366756, "timesteps_total": 37634880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37634880, "timers": {"training_iteration_time_ms": 65550.81, "sample_time_ms": 64372.063, "load_time_ms": 18.462, "load_throughput": 2378966.347, "learn_time_ms": 1159.108, "learn_throughput": 37891.221, "synch_weights_time_ms": 0.994}, "counters": {"num_env_steps_sampled": 37634880, "num_env_steps_trained": 37634880, "num_agent_steps_sampled": 37634880, "num_agent_steps_trained": 37634880}, "done": false, "episodes_total": 9030, "training_iteration": 2767, "trial_id": "11c4c_00000", "date": "2023-08-07_10-08-16", "timestamp": 1691392096, "time_this_iter_s": 66.10427904129028, "time_total_s": 66817.96917939186, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3047.5578911304474, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 26.62234042553191, "ram_util_percent": 72.53617021276594}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.84119244011083, "policy_loss": -9148349.360103862, "vf_loss": 6480145.706814868}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31899.5, "diff_num_grad_updates_vs_sampler_policy": 31898.5}}, "num_env_steps_sampled": 37678800, "num_env_steps_trained": 37678800, "num_agent_steps_sampled": 37678800, "num_agent_steps_trained": 37678800}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186932.158900917, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21706290068067485, "mean_inference_ms": 0.37079032259039857, "mean_action_processing_ms": 0.09082540487036132, "mean_env_wait_ms": 0.7800323938634606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003674182486026845, "StateBufferConnector_ms": 0.002730146367499169, "ViewRequirementAgentConnector_ms": 0.06800509513692653}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186932.158900917, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21706290068067485, "mean_inference_ms": 0.37079032259039857, "mean_action_processing_ms": 0.09082540487036132, "mean_env_wait_ms": 0.7800323938634606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003674182486026845, "StateBufferConnector_ms": 0.002730146367499169, "ViewRequirementAgentConnector_ms": 0.06800509513692653}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37678800, "num_agent_steps_trained": 37678800, "num_env_steps_sampled": 37678800, "num_env_steps_trained": 37678800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 696.608942881936, "num_env_steps_trained_throughput_per_sec": 696.608942881936, "timesteps_total": 37678800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37678800, "timers": {"training_iteration_time_ms": 65405.58, "sample_time_ms": 64227.686, "load_time_ms": 18.559, "load_throughput": 2366549.012, "learn_time_ms": 1158.164, "learn_throughput": 37922.08, "synch_weights_time_ms": 0.985}, "counters": {"num_env_steps_sampled": 37678800, "num_env_steps_trained": 37678800, "num_agent_steps_sampled": 37678800, "num_agent_steps_trained": 37678800}, "done": false, "episodes_total": 9031, "training_iteration": 2768, "trial_id": "11c4c_00000", "date": "2023-08-07_10-09-19", "timestamp": 1691392159, "time_this_iter_s": 63.050981283187866, "time_total_s": 66881.02016067505, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3110.6088724136353, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 24.785555555555554, "ram_util_percent": 72.43888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.86003811227334, "policy_loss": -9808710.583104614, "vf_loss": 6533639.9271137025}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32585.5, "diff_num_grad_updates_vs_sampler_policy": 32584.5}}, "num_env_steps_sampled": 37722720, "num_env_steps_trained": 37722720, "num_agent_steps_sampled": 37722720, "num_agent_steps_trained": 37722720}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186898.8693188172, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21710390786850783, "mean_inference_ms": 0.3708932268374136, "mean_action_processing_ms": 0.09084401099274149, "mean_env_wait_ms": 0.7798819385587711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003727773825327555, "StateBufferConnector_ms": 0.0027259190877278647, "ViewRequirementAgentConnector_ms": 0.06802181402842204}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186898.8693188172, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21710390786850783, "mean_inference_ms": 0.3708932268374136, "mean_action_processing_ms": 0.09084401099274149, "mean_env_wait_ms": 0.7798819385587711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003727773825327555, "StateBufferConnector_ms": 0.0027259190877278647, "ViewRequirementAgentConnector_ms": 0.06802181402842204}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37722720, "num_agent_steps_trained": 37722720, "num_env_steps_sampled": 37722720, "num_env_steps_trained": 37722720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 686.2128665741538, "num_env_steps_trained_throughput_per_sec": 686.2128665741538, "timesteps_total": 37722720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37722720, "timers": {"training_iteration_time_ms": 65418.044, "sample_time_ms": 64242.931, "load_time_ms": 18.432, "load_throughput": 2382846.754, "learn_time_ms": 1155.538, "learn_throughput": 38008.269, "synch_weights_time_ms": 0.957}, "counters": {"num_env_steps_sampled": 37722720, "num_env_steps_trained": 37722720, "num_agent_steps_sampled": 37722720, "num_agent_steps_trained": 37722720}, "done": false, "episodes_total": 9032, "training_iteration": 2769, "trial_id": "11c4c_00000", "date": "2023-08-07_10-10-23", "timestamp": 1691392223, "time_this_iter_s": 64.00612878799438, "time_total_s": 66945.02628946304, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3174.6150012016296, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 25.808791208791213, "ram_util_percent": 72.41978021978021}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.90844054819894, "policy_loss": -9181083.715245195, "vf_loss": 6592358.826348397}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33271.5, "diff_num_grad_updates_vs_sampler_policy": 33270.5}}, "num_env_steps_sampled": 37766640, "num_env_steps_trained": 37766640, "num_agent_steps_sampled": 37766640, "num_agent_steps_trained": 37766640}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186872.24501516248, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2171424392498461, "mean_inference_ms": 0.37098715412388755, "mean_action_processing_ms": 0.09086098814693343, "mean_env_wait_ms": 0.7797205393754705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037159238542829242, "StateBufferConnector_ms": 0.0027345151317362884, "ViewRequirementAgentConnector_ms": 0.06803833708471181}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186872.24501516248, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2171424392498461, "mean_inference_ms": 0.37098715412388755, "mean_action_processing_ms": 0.09086098814693343, "mean_env_wait_ms": 0.7797205393754705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037159238542829242, "StateBufferConnector_ms": 0.0027345151317362884, "ViewRequirementAgentConnector_ms": 0.06803833708471181}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37766640, "num_agent_steps_trained": 37766640, "num_env_steps_sampled": 37766640, "num_env_steps_trained": 37766640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 689.9553625656682, "num_env_steps_trained_throughput_per_sec": 689.9553625656682, "timesteps_total": 37766640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37766640, "timers": {"training_iteration_time_ms": 65387.613, "sample_time_ms": 64211.478, "load_time_ms": 18.372, "load_throughput": 2390602.234, "learn_time_ms": 1156.657, "learn_throughput": 37971.485, "synch_weights_time_ms": 0.92}, "counters": {"num_env_steps_sampled": 37766640, "num_env_steps_trained": 37766640, "num_agent_steps_sampled": 37766640, "num_agent_steps_trained": 37766640}, "done": false, "episodes_total": 9033, "training_iteration": 2770, "trial_id": "11c4c_00000", "date": "2023-08-07_10-11-27", "timestamp": 1691392287, "time_this_iter_s": 63.659740924835205, "time_total_s": 67008.68603038788, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3238.274742126465, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 26.403333333333336, "ram_util_percent": 72.47444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.59732731855297, "policy_loss": -8714183.592665248, "vf_loss": 6171033.374088922}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33957.5, "diff_num_grad_updates_vs_sampler_policy": 33956.5}}, "num_env_steps_sampled": 37810560, "num_env_steps_trained": 37810560, "num_agent_steps_sampled": 37810560, "num_agent_steps_trained": 37810560}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186762.04138463366, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21717663402707, "mean_inference_ms": 0.37107182584390663, "mean_action_processing_ms": 0.09087633345467695, "mean_env_wait_ms": 0.779551627705484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037107467651367188, "StateBufferConnector_ms": 0.002727985382080078, "ViewRequirementAgentConnector_ms": 0.06798839569091797}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186762.04138463366, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21717663402707, "mean_inference_ms": 0.37107182584390663, "mean_action_processing_ms": 0.09087633345467695, "mean_env_wait_ms": 0.779551627705484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037107467651367188, "StateBufferConnector_ms": 0.002727985382080078, "ViewRequirementAgentConnector_ms": 0.06798839569091797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37810560, "num_agent_steps_trained": 37810560, "num_env_steps_sampled": 37810560, "num_env_steps_trained": 37810560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 691.6368690237812, "num_env_steps_trained_throughput_per_sec": 691.6368690237812, "timesteps_total": 37810560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37810560, "timers": {"training_iteration_time_ms": 65047.972, "sample_time_ms": 63889.046, "load_time_ms": 17.899, "load_throughput": 2453753.571, "learn_time_ms": 1139.934, "learn_throughput": 38528.544, "synch_weights_time_ms": 0.913}, "counters": {"num_env_steps_sampled": 37810560, "num_env_steps_trained": 37810560, "num_agent_steps_sampled": 37810560, "num_agent_steps_trained": 37810560}, "done": false, "episodes_total": 9034, "training_iteration": 2771, "trial_id": "11c4c_00000", "date": "2023-08-07_10-12-31", "timestamp": 1691392351, "time_this_iter_s": 63.50410795211792, "time_total_s": 67072.19013834, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3301.7788500785828, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 25.29111111111111, "ram_util_percent": 72.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8254837614454, "policy_loss": -9051380.302927978, "vf_loss": 6395859.121902333}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34643.5, "diff_num_grad_updates_vs_sampler_policy": 34642.5}}, "num_env_steps_sampled": 37854480, "num_env_steps_trained": 37854480, "num_agent_steps_sampled": 37854480, "num_agent_steps_trained": 37854480}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186699.9028121948, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21720915400500707, "mean_inference_ms": 0.3711529888812701, "mean_action_processing_ms": 0.09089114450307328, "mean_env_wait_ms": 0.7793822555000007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003703902749454274, "StateBufferConnector_ms": 0.002721711701037837, "ViewRequirementAgentConnector_ms": 0.06792077831193513}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186699.9028121948, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21720915400500707, "mean_inference_ms": 0.3711529888812701, "mean_action_processing_ms": 0.09089114450307328, "mean_env_wait_ms": 0.7793822555000007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003703902749454274, "StateBufferConnector_ms": 0.002721711701037837, "ViewRequirementAgentConnector_ms": 0.06792077831193513}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37854480, "num_agent_steps_trained": 37854480, "num_env_steps_sampled": 37854480, "num_env_steps_trained": 37854480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 674.2981394740273, "num_env_steps_trained_throughput_per_sec": 674.2981394740273, "timesteps_total": 37854480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37854480, "timers": {"training_iteration_time_ms": 64845.974, "sample_time_ms": 63687.632, "load_time_ms": 17.581, "load_throughput": 2498122.91, "learn_time_ms": 1139.673, "learn_throughput": 38537.356, "synch_weights_time_ms": 0.909}, "counters": {"num_env_steps_sampled": 37854480, "num_env_steps_trained": 37854480, "num_agent_steps_sampled": 37854480, "num_agent_steps_trained": 37854480}, "done": false, "episodes_total": 9035, "training_iteration": 2772, "trial_id": "11c4c_00000", "date": "2023-08-07_10-13-36", "timestamp": 1691392416, "time_this_iter_s": 65.13712286949158, "time_total_s": 67137.32726120949, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3366.9159729480743, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 26.108602150537628, "ram_util_percent": 71.89999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8299322990217, "policy_loss": -9848179.116518427, "vf_loss": 6438553.13830175}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35329.5, "diff_num_grad_updates_vs_sampler_policy": 35328.5}}, "num_env_steps_sampled": 37898400, "num_env_steps_trained": 37898400, "num_agent_steps_sampled": 37898400, "num_agent_steps_trained": 37898400}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186653.92447285468, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2172383840986808, "mean_inference_ms": 0.371226852371992, "mean_action_processing_ms": 0.0909045131966854, "mean_env_wait_ms": 0.7792111136349372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003692736992469201, "StateBufferConnector_ms": 0.0027220982771653393, "ViewRequirementAgentConnector_ms": 0.06787822796748234}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186653.92447285468, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2172383840986808, "mean_inference_ms": 0.371226852371992, "mean_action_processing_ms": 0.0909045131966854, "mean_env_wait_ms": 0.7792111136349372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003692736992469201, "StateBufferConnector_ms": 0.0027220982771653393, "ViewRequirementAgentConnector_ms": 0.06787822796748234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37898400, "num_agent_steps_trained": 37898400, "num_env_steps_sampled": 37898400, "num_env_steps_trained": 37898400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 684.6326516778482, "num_env_steps_trained_throughput_per_sec": 684.6326516778482, "timesteps_total": 37898400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37898400, "timers": {"training_iteration_time_ms": 64659.56, "sample_time_ms": 63500.421, "load_time_ms": 17.644, "load_throughput": 2489177.642, "learn_time_ms": 1140.405, "learn_throughput": 38512.626, "synch_weights_time_ms": 0.911}, "counters": {"num_env_steps_sampled": 37898400, "num_env_steps_trained": 37898400, "num_agent_steps_sampled": 37898400, "num_agent_steps_trained": 37898400}, "done": false, "episodes_total": 9036, "training_iteration": 2773, "trial_id": "11c4c_00000", "date": "2023-08-07_10-14-40", "timestamp": 1691392480, "time_this_iter_s": 64.15388584136963, "time_total_s": 67201.48114705086, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3431.069858789444, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 26.114285714285714, "ram_util_percent": 71.74065934065932}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7943329213312, "policy_loss": -10013207.689623952, "vf_loss": 6754502.358600583}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36015.5, "diff_num_grad_updates_vs_sampler_policy": 36014.5}}, "num_env_steps_sampled": 37942320, "num_env_steps_trained": 37942320, "num_agent_steps_sampled": 37942320, "num_agent_steps_trained": 37942320}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186674.82124098358, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21726382245103806, "mean_inference_ms": 0.37129292941723013, "mean_action_processing_ms": 0.09091644801344824, "mean_env_wait_ms": 0.7790399516565163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036869408949366154, "StateBufferConnector_ms": 0.0027193213408848024, "ViewRequirementAgentConnector_ms": 0.06783143529352152}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186674.82124098358, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21726382245103806, "mean_inference_ms": 0.37129292941723013, "mean_action_processing_ms": 0.09091644801344824, "mean_env_wait_ms": 0.7790399516565163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036869408949366154, "StateBufferConnector_ms": 0.0027193213408848024, "ViewRequirementAgentConnector_ms": 0.06783143529352152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37942320, "num_agent_steps_trained": 37942320, "num_env_steps_sampled": 37942320, "num_env_steps_trained": 37942320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 685.5036581545004, "num_env_steps_trained_throughput_per_sec": 685.5036581545004, "timesteps_total": 37942320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37942320, "timers": {"training_iteration_time_ms": 64596.801, "sample_time_ms": 63438.5, "load_time_ms": 17.606, "load_throughput": 2494584.391, "learn_time_ms": 1139.623, "learn_throughput": 38539.046, "synch_weights_time_ms": 0.897}, "counters": {"num_env_steps_sampled": 37942320, "num_env_steps_trained": 37942320, "num_agent_steps_sampled": 37942320, "num_agent_steps_trained": 37942320}, "done": false, "episodes_total": 9037, "training_iteration": 2774, "trial_id": "11c4c_00000", "date": "2023-08-07_10-15-44", "timestamp": 1691392544, "time_this_iter_s": 64.07277321815491, "time_total_s": 67265.55392026901, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3495.142632007599, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 25.813186813186807, "ram_util_percent": 71.68021978021977}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.71116762745135, "policy_loss": -8536610.497810563, "vf_loss": 6338164.688957726}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36701.5, "diff_num_grad_updates_vs_sampler_policy": 36700.5}}, "num_env_steps_sampled": 37986240, "num_env_steps_trained": 37986240, "num_agent_steps_sampled": 37986240, "num_agent_steps_trained": 37986240}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186602.30969388405, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21728676556084603, "mean_inference_ms": 0.3713510608726755, "mean_action_processing_ms": 0.09092689418412386, "mean_env_wait_ms": 0.7788703016797299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036800349200213395, "StateBufferConnector_ms": 0.002717088769983362, "ViewRequirementAgentConnector_ms": 0.06776165079187464}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186602.30969388405, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21728676556084603, "mean_inference_ms": 0.3713510608726755, "mean_action_processing_ms": 0.09092689418412386, "mean_env_wait_ms": 0.7788703016797299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036800349200213395, "StateBufferConnector_ms": 0.002717088769983362, "ViewRequirementAgentConnector_ms": 0.06776165079187464}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37986240, "num_agent_steps_trained": 37986240, "num_env_steps_sampled": 37986240, "num_env_steps_trained": 37986240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 683.9087448665169, "num_env_steps_trained_throughput_per_sec": 683.9087448665169, "timesteps_total": 37986240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 37986240, "timers": {"training_iteration_time_ms": 64556.51, "sample_time_ms": 63398.618, "load_time_ms": 17.594, "load_throughput": 2496332.099, "learn_time_ms": 1139.226, "learn_throughput": 38552.501, "synch_weights_time_ms": 0.899}, "counters": {"num_env_steps_sampled": 37986240, "num_env_steps_trained": 37986240, "num_agent_steps_sampled": 37986240, "num_agent_steps_trained": 37986240}, "done": false, "episodes_total": 9038, "training_iteration": 2775, "trial_id": "11c4c_00000", "date": "2023-08-07_10-16-48", "timestamp": 1691392608, "time_this_iter_s": 64.22172093391418, "time_total_s": 67329.77564120293, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3559.364352941513, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 19.645054945054945, "ram_util_percent": 71.62637362637362}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.75360378788093, "policy_loss": -8974103.303161442, "vf_loss": 6369605.874271137}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37387.5, "diff_num_grad_updates_vs_sampler_policy": 37386.5}}, "num_env_steps_sampled": 38030160, "num_env_steps_trained": 38030160, "num_agent_steps_sampled": 38030160, "num_agent_steps_trained": 38030160}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186539.0307121184, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21730736942413686, "mean_inference_ms": 0.37140171884054146, "mean_action_processing_ms": 0.0909360043795136, "mean_env_wait_ms": 0.7787077711337158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003676847978071733, "StateBufferConnector_ms": 0.0027162378484552555, "ViewRequirementAgentConnector_ms": 0.0677026401866566}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186539.0307121184, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21730736942413686, "mean_inference_ms": 0.37140171884054146, "mean_action_processing_ms": 0.0909360043795136, "mean_env_wait_ms": 0.7787077711337158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003676847978071733, "StateBufferConnector_ms": 0.0027162378484552555, "ViewRequirementAgentConnector_ms": 0.0677026401866566}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38030160, "num_agent_steps_trained": 38030160, "num_env_steps_sampled": 38030160, "num_env_steps_trained": 38030160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 676.2431947400247, "num_env_steps_trained_throughput_per_sec": 676.2431947400247, "timesteps_total": 38030160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38030160, "timers": {"training_iteration_time_ms": 64283.238, "sample_time_ms": 63139.822, "load_time_ms": 17.258, "load_throughput": 2544913.686, "learn_time_ms": 1125.097, "learn_throughput": 39036.635, "synch_weights_time_ms": 0.895}, "counters": {"num_env_steps_sampled": 38030160, "num_env_steps_trained": 38030160, "num_agent_steps_sampled": 38030160, "num_agent_steps_trained": 38030160}, "done": false, "episodes_total": 9039, "training_iteration": 2776, "trial_id": "11c4c_00000", "date": "2023-08-07_10-17-53", "timestamp": 1691392673, "time_this_iter_s": 64.94973087310791, "time_total_s": 67394.72537207603, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3624.314083814621, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 17.768817204301076, "ram_util_percent": 71.67741935483869}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7754045492011, "policy_loss": -9306148.973311087, "vf_loss": 6540114.927295919}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38073.5, "diff_num_grad_updates_vs_sampler_policy": 38072.5}}, "num_env_steps_sampled": 38074080, "num_env_steps_trained": 38074080, "num_agent_steps_sampled": 38074080, "num_agent_steps_trained": 38074080}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186520.70023273677, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2173256914595873, "mean_inference_ms": 0.37144548987918835, "mean_action_processing_ms": 0.09094384870224727, "mean_env_wait_ms": 0.7785535529148737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003669517380850656, "StateBufferConnector_ms": 0.002714991569519043, "ViewRequirementAgentConnector_ms": 0.0676823513848441}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186520.70023273677, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2173256914595873, "mean_inference_ms": 0.37144548987918835, "mean_action_processing_ms": 0.09094384870224727, "mean_env_wait_ms": 0.7785535529148737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003669517380850656, "StateBufferConnector_ms": 0.002714991569519043, "ViewRequirementAgentConnector_ms": 0.0676823513848441}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38074080, "num_agent_steps_trained": 38074080, "num_env_steps_sampled": 38074080, "num_env_steps_trained": 38074080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 674.1868466192194, "num_env_steps_trained_throughput_per_sec": 674.1868466192194, "timesteps_total": 38074080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38074080, "timers": {"training_iteration_time_ms": 64187.594, "sample_time_ms": 63043.542, "load_time_ms": 17.086, "load_throughput": 2570503.271, "learn_time_ms": 1125.901, "learn_throughput": 39008.745, "synch_weights_time_ms": 0.9}, "counters": {"num_env_steps_sampled": 38074080, "num_env_steps_trained": 38074080, "num_agent_steps_sampled": 38074080, "num_agent_steps_trained": 38074080}, "done": false, "episodes_total": 9040, "training_iteration": 2777, "trial_id": "11c4c_00000", "date": "2023-08-07_10-18-58", "timestamp": 1691392738, "time_this_iter_s": 65.14796710014343, "time_total_s": 67459.87333917618, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3689.4620509147644, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 17.111956521739128, "ram_util_percent": 71.63695652173912}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8372807627864, "policy_loss": -8827496.357438957, "vf_loss": 6507664.524963557}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38759.5, "diff_num_grad_updates_vs_sampler_policy": 38758.5}}, "num_env_steps_sampled": 38118000, "num_env_steps_trained": 38118000, "num_agent_steps_sampled": 38118000, "num_agent_steps_trained": 38118000}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186483.1215182888, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2173433593171828, "mean_inference_ms": 0.37148326715089564, "mean_action_processing_ms": 0.09095050631920074, "mean_env_wait_ms": 0.7784020918817907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003658261215477659, "StateBufferConnector_ms": 0.00270918795936986, "ViewRequirementAgentConnector_ms": 0.06763224016156114}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186483.1215182888, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2173433593171828, "mean_inference_ms": 0.37148326715089564, "mean_action_processing_ms": 0.09095050631920074, "mean_env_wait_ms": 0.7784020918817907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003658261215477659, "StateBufferConnector_ms": 0.00270918795936986, "ViewRequirementAgentConnector_ms": 0.06763224016156114}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38118000, "num_agent_steps_trained": 38118000, "num_env_steps_sampled": 38118000, "num_env_steps_trained": 38118000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 678.9625776703248, "num_env_steps_trained_throughput_per_sec": 678.9625776703248, "timesteps_total": 38118000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38118000, "timers": {"training_iteration_time_ms": 64351.457, "sample_time_ms": 63207.708, "load_time_ms": 16.922, "load_throughput": 2595412.744, "learn_time_ms": 1125.768, "learn_throughput": 39013.377, "synch_weights_time_ms": 0.898}, "counters": {"num_env_steps_sampled": 38118000, "num_env_steps_trained": 38118000, "num_agent_steps_sampled": 38118000, "num_agent_steps_trained": 38118000}, "done": false, "episodes_total": 9041, "training_iteration": 2778, "trial_id": "11c4c_00000", "date": "2023-08-07_10-20-03", "timestamp": 1691392803, "time_this_iter_s": 64.68968915939331, "time_total_s": 67524.56302833557, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3754.1517400741577, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 17.581521739130437, "ram_util_percent": 71.6413043478261}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.82996219379214, "policy_loss": -9048715.16562557, "vf_loss": 6268752.619351312}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39445.5, "diff_num_grad_updates_vs_sampler_policy": 39444.5}}, "num_env_steps_sampled": 38161920, "num_env_steps_trained": 38161920, "num_agent_steps_sampled": 38161920, "num_agent_steps_trained": 38161920}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186395.90569791643, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21735936305877154, "mean_inference_ms": 0.3715148663150975, "mean_action_processing_ms": 0.09095601820029423, "mean_env_wait_ms": 0.7782575206796033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003654381324504984, "StateBufferConnector_ms": 0.0027015291411301187, "ViewRequirementAgentConnector_ms": 0.06757481344814958}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186395.90569791643, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21735936305877154, "mean_inference_ms": 0.3715148663150975, "mean_action_processing_ms": 0.09095601820029423, "mean_env_wait_ms": 0.7782575206796033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003654381324504984, "StateBufferConnector_ms": 0.0027015291411301187, "ViewRequirementAgentConnector_ms": 0.06757481344814958}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38161920, "num_agent_steps_trained": 38161920, "num_env_steps_sampled": 38161920, "num_env_steps_trained": 38161920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 675.2353079939262, "num_env_steps_trained_throughput_per_sec": 675.2353079939262, "timesteps_total": 38161920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38161920, "timers": {"training_iteration_time_ms": 64455.51, "sample_time_ms": 63310.812, "load_time_ms": 16.955, "load_throughput": 2590328.923, "learn_time_ms": 1126.686, "learn_throughput": 38981.584, "synch_weights_time_ms": 0.897}, "counters": {"num_env_steps_sampled": 38161920, "num_env_steps_trained": 38161920, "num_agent_steps_sampled": 38161920, "num_agent_steps_trained": 38161920}, "done": false, "episodes_total": 9042, "training_iteration": 2779, "trial_id": "11c4c_00000", "date": "2023-08-07_10-21-08", "timestamp": 1691392868, "time_this_iter_s": 65.04663610458374, "time_total_s": 67589.60966444016, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3819.1983761787415, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 17.2752688172043, "ram_util_percent": 71.58924731182798}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8517088153272, "policy_loss": -8719899.743260864, "vf_loss": 6465567.833272595}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40131.5, "diff_num_grad_updates_vs_sampler_policy": 40130.5}}, "num_env_steps_sampled": 38205840, "num_env_steps_trained": 38205840, "num_agent_steps_sampled": 38205840, "num_agent_steps_trained": 38205840}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186364.95597999546, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21737355565471292, "mean_inference_ms": 0.3715410324368187, "mean_action_processing_ms": 0.09096052206436192, "mean_env_wait_ms": 0.7781175786133838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036421468702413267, "StateBufferConnector_ms": 0.002703424227439751, "ViewRequirementAgentConnector_ms": 0.06751731290655621}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186364.95597999546, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21737355565471292, "mean_inference_ms": 0.3715410324368187, "mean_action_processing_ms": 0.09096052206436192, "mean_env_wait_ms": 0.7781175786133838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036421468702413267, "StateBufferConnector_ms": 0.002703424227439751, "ViewRequirementAgentConnector_ms": 0.06751731290655621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38205840, "num_agent_steps_trained": 38205840, "num_env_steps_sampled": 38205840, "num_env_steps_trained": 38205840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 678.2389712660524, "num_env_steps_trained_throughput_per_sec": 678.2389712660524, "timesteps_total": 38205840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38205840, "timers": {"training_iteration_time_ms": 64565.474, "sample_time_ms": 63425.897, "load_time_ms": 16.853, "load_throughput": 2606027.531, "learn_time_ms": 1121.67, "learn_throughput": 39155.885, "synch_weights_time_ms": 0.9}, "counters": {"num_env_steps_sampled": 38205840, "num_env_steps_trained": 38205840, "num_agent_steps_sampled": 38205840, "num_agent_steps_trained": 38205840}, "done": false, "episodes_total": 9043, "training_iteration": 2780, "trial_id": "11c4c_00000", "date": "2023-08-07_10-22-13", "timestamp": 1691392933, "time_this_iter_s": 64.75864291191101, "time_total_s": 67654.36830735207, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3883.9570190906525, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 17.18901098901099, "ram_util_percent": 71.61648351648353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.89017288608386, "policy_loss": -9173348.021868736, "vf_loss": 6525952.393586006}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40817.5, "diff_num_grad_updates_vs_sampler_policy": 40816.5}}, "num_env_steps_sampled": 38249760, "num_env_steps_trained": 38249760, "num_agent_steps_sampled": 38249760, "num_agent_steps_trained": 38249760}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186343.21750914154, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2173855795205935, "mean_inference_ms": 0.3715618269902541, "mean_action_processing_ms": 0.09096404724833802, "mean_env_wait_ms": 0.7779819342602043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00363310178120931, "StateBufferConnector_ms": 0.0026988983154296875, "ViewRequirementAgentConnector_ms": 0.0674601395924886}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186343.21750914154, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2173855795205935, "mean_inference_ms": 0.3715618269902541, "mean_action_processing_ms": 0.09096404724833802, "mean_env_wait_ms": 0.7779819342602043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00363310178120931, "StateBufferConnector_ms": 0.0026988983154296875, "ViewRequirementAgentConnector_ms": 0.0674601395924886}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38249760, "num_agent_steps_trained": 38249760, "num_env_steps_sampled": 38249760, "num_env_steps_trained": 38249760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 679.9274165174663, "num_env_steps_trained_throughput_per_sec": 679.9274165174663, "timesteps_total": 38249760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38249760, "timers": {"training_iteration_time_ms": 64674.834, "sample_time_ms": 63538.104, "load_time_ms": 16.804, "load_throughput": 2613722.17, "learn_time_ms": 1118.873, "learn_throughput": 39253.791, "synch_weights_time_ms": 0.898}, "counters": {"num_env_steps_sampled": 38249760, "num_env_steps_trained": 38249760, "num_agent_steps_sampled": 38249760, "num_agent_steps_trained": 38249760}, "done": false, "episodes_total": 9044, "training_iteration": 2781, "trial_id": "11c4c_00000", "date": "2023-08-07_10-23-18", "timestamp": 1691392998, "time_this_iter_s": 64.59790587425232, "time_total_s": 67718.96621322632, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3948.554924964905, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 17.804347826086957, "ram_util_percent": 71.56847826086955}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9247850690569, "policy_loss": -8581195.587050725, "vf_loss": 6386806.39941691}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 41503.5, "diff_num_grad_updates_vs_sampler_policy": 41502.5}}, "num_env_steps_sampled": 38293680, "num_env_steps_trained": 38293680, "num_agent_steps_sampled": 38293680, "num_agent_steps_trained": 38293680}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186290.05201669017, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2173961675828364, "mean_inference_ms": 0.37157784961531215, "mean_action_processing_ms": 0.09096668214557152, "mean_env_wait_ms": 0.7778489204583413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003626307503121798, "StateBufferConnector_ms": 0.002701556096311475, "ViewRequirementAgentConnector_ms": 0.06742477416992188}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186290.05201669017, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2173961675828364, "mean_inference_ms": 0.37157784961531215, "mean_action_processing_ms": 0.09096668214557152, "mean_env_wait_ms": 0.7778489204583413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003626307503121798, "StateBufferConnector_ms": 0.002701556096311475, "ViewRequirementAgentConnector_ms": 0.06742477416992188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38293680, "num_agent_steps_trained": 38293680, "num_env_steps_sampled": 38293680, "num_env_steps_trained": 38293680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 680.7435073678522, "num_env_steps_trained_throughput_per_sec": 680.7435073678522, "timesteps_total": 38293680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38293680, "timers": {"training_iteration_time_ms": 64613.164, "sample_time_ms": 63473.267, "load_time_ms": 16.969, "load_throughput": 2588199.87, "learn_time_ms": 1121.869, "learn_throughput": 39148.973, "synch_weights_time_ms": 0.903}, "counters": {"num_env_steps_sampled": 38293680, "num_env_steps_trained": 38293680, "num_agent_steps_sampled": 38293680, "num_agent_steps_trained": 38293680}, "done": false, "episodes_total": 9045, "training_iteration": 2782, "trial_id": "11c4c_00000", "date": "2023-08-07_10-24-22", "timestamp": 1691393062, "time_this_iter_s": 64.52058792114258, "time_total_s": 67783.48680114746, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4013.0755128860474, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 18.850549450549448, "ram_util_percent": 70.97692307692306}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8840223929625, "policy_loss": -8906002.649046784, "vf_loss": 6331807.337099126}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 42189.5, "diff_num_grad_updates_vs_sampler_policy": 42188.5}}, "num_env_steps_sampled": 38337600, "num_env_steps_trained": 38337600, "num_agent_steps_sampled": 38337600, "num_agent_steps_trained": 38337600}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186230.7263326225, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2174064581352482, "mean_inference_ms": 0.3715919382794468, "mean_action_processing_ms": 0.09096894618122364, "mean_env_wait_ms": 0.7777172577058914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036651088345435357, "StateBufferConnector_ms": 0.0026945144899429814, "ViewRequirementAgentConnector_ms": 0.06738708865258002}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186230.7263326225, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2174064581352482, "mean_inference_ms": 0.3715919382794468, "mean_action_processing_ms": 0.09096894618122364, "mean_env_wait_ms": 0.7777172577058914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036651088345435357, "StateBufferConnector_ms": 0.0026945144899429814, "ViewRequirementAgentConnector_ms": 0.06738708865258002}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38337600, "num_agent_steps_trained": 38337600, "num_env_steps_sampled": 38337600, "num_env_steps_trained": 38337600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 675.9937789169305, "num_env_steps_trained_throughput_per_sec": 675.9937789169305, "timesteps_total": 38337600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38337600, "timers": {"training_iteration_time_ms": 64695.146, "sample_time_ms": 63556.145, "load_time_ms": 16.997, "load_throughput": 2584024.74, "learn_time_ms": 1120.95, "learn_throughput": 39181.065, "synch_weights_time_ms": 0.9}, "counters": {"num_env_steps_sampled": 38337600, "num_env_steps_trained": 38337600, "num_agent_steps_sampled": 38337600, "num_agent_steps_trained": 38337600}, "done": false, "episodes_total": 9046, "training_iteration": 2783, "trial_id": "11c4c_00000", "date": "2023-08-07_10-25-27", "timestamp": 1691393127, "time_this_iter_s": 64.97408938407898, "time_total_s": 67848.46089053154, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4078.0496022701263, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 19.376344086021504, "ram_util_percent": 71.852688172043}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9139761521587, "policy_loss": -8707215.059348237, "vf_loss": 6401744.627915452}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 42875.5, "diff_num_grad_updates_vs_sampler_policy": 42874.5}}, "num_env_steps_sampled": 38381520, "num_env_steps_trained": 38381520, "num_agent_steps_sampled": 38381520, "num_agent_steps_trained": 38381520}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186178.6846971172, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21741667750946017, "mean_inference_ms": 0.37160393737573744, "mean_action_processing_ms": 0.0909708177740041, "mean_env_wait_ms": 0.7775832903486556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036595359681144595, "StateBufferConnector_ms": 0.0026941299438476562, "ViewRequirementAgentConnector_ms": 0.0673524917118133}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186178.6846971172, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21741667750946017, "mean_inference_ms": 0.37160393737573744, "mean_action_processing_ms": 0.0909708177740041, "mean_env_wait_ms": 0.7775832903486556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036595359681144595, "StateBufferConnector_ms": 0.0026941299438476562, "ViewRequirementAgentConnector_ms": 0.0673524917118133}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38381520, "num_agent_steps_trained": 38381520, "num_env_steps_sampled": 38381520, "num_env_steps_trained": 38381520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 683.0031535284072, "num_env_steps_trained_throughput_per_sec": 683.0031535284072, "timesteps_total": 38381520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38381520, "timers": {"training_iteration_time_ms": 64718.602, "sample_time_ms": 63579.554, "load_time_ms": 17.038, "load_throughput": 2577787.239, "learn_time_ms": 1120.908, "learn_throughput": 39182.53, "synch_weights_time_ms": 0.942}, "counters": {"num_env_steps_sampled": 38381520, "num_env_steps_trained": 38381520, "num_agent_steps_sampled": 38381520, "num_agent_steps_trained": 38381520}, "done": false, "episodes_total": 9047, "training_iteration": 2784, "trial_id": "11c4c_00000", "date": "2023-08-07_10-26-32", "timestamp": 1691393192, "time_this_iter_s": 64.3076229095459, "time_total_s": 67912.76851344109, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4142.357225179672, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 18.948351648351647, "ram_util_percent": 72.09340659340658}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.81346944469755, "policy_loss": -9156263.60007488, "vf_loss": 6730509.291362974}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43561.5, "diff_num_grad_updates_vs_sampler_policy": 43560.5}}, "num_env_steps_sampled": 38425440, "num_env_steps_trained": 38425440, "num_agent_steps_sampled": 38425440, "num_agent_steps_trained": 38425440}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186197.9086431432, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21742781097842037, "mean_inference_ms": 0.37161562058666864, "mean_action_processing_ms": 0.09097265532902984, "mean_env_wait_ms": 0.7774537634688622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036537647247314453, "StateBufferConnector_ms": 0.0026892870664596558, "ViewRequirementAgentConnector_ms": 0.06731785833835602}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186197.9086431432, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21742781097842037, "mean_inference_ms": 0.37161562058666864, "mean_action_processing_ms": 0.09097265532902984, "mean_env_wait_ms": 0.7774537634688622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036537647247314453, "StateBufferConnector_ms": 0.0026892870664596558, "ViewRequirementAgentConnector_ms": 0.06731785833835602}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38425440, "num_agent_steps_trained": 38425440, "num_env_steps_sampled": 38425440, "num_env_steps_trained": 38425440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 665.374089779611, "num_env_steps_trained_throughput_per_sec": 665.374089779611, "timesteps_total": 38425440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38425440, "timers": {"training_iteration_time_ms": 64897.49, "sample_time_ms": 63756.999, "load_time_ms": 18.436, "load_throughput": 2382270.509, "learn_time_ms": 1120.962, "learn_throughput": 39180.646, "synch_weights_time_ms": 0.932}, "counters": {"num_env_steps_sampled": 38425440, "num_env_steps_trained": 38425440, "num_agent_steps_sampled": 38425440, "num_agent_steps_trained": 38425440}, "done": false, "episodes_total": 9048, "training_iteration": 2785, "trial_id": "11c4c_00000", "date": "2023-08-07_10-27-38", "timestamp": 1691393258, "time_this_iter_s": 66.01062297821045, "time_total_s": 67978.7791364193, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4208.367848157883, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 20.700000000000003, "ram_util_percent": 72.02553191489362}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8355094086672, "policy_loss": -9288493.674958432, "vf_loss": 6411130.136115161}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 44247.5, "diff_num_grad_updates_vs_sampler_policy": 44246.5}}, "num_env_steps_sampled": 38469360, "num_env_steps_trained": 38469360, "num_agent_steps_sampled": 38469360, "num_agent_steps_trained": 38469360}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186154.37589726702, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21743818490906489, "mean_inference_ms": 0.3716252367833975, "mean_action_processing_ms": 0.09097398069901154, "mean_env_wait_ms": 0.7773284520879572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036445030799278845, "StateBufferConnector_ms": 0.002689361572265625, "ViewRequirementAgentConnector_ms": 0.06734114426832932}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186154.37589726702, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21743818490906489, "mean_inference_ms": 0.3716252367833975, "mean_action_processing_ms": 0.09097398069901154, "mean_env_wait_ms": 0.7773284520879572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036445030799278845, "StateBufferConnector_ms": 0.002689361572265625, "ViewRequirementAgentConnector_ms": 0.06734114426832932}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38469360, "num_agent_steps_trained": 38469360, "num_env_steps_sampled": 38469360, "num_env_steps_trained": 38469360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 672.566839005733, "num_env_steps_trained_throughput_per_sec": 672.566839005733, "timesteps_total": 38469360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38469360, "timers": {"training_iteration_time_ms": 64932.991, "sample_time_ms": 63791.785, "load_time_ms": 18.955, "load_throughput": 2317021.049, "learn_time_ms": 1121.159, "learn_throughput": 39173.744, "synch_weights_time_ms": 0.929}, "counters": {"num_env_steps_sampled": 38469360, "num_env_steps_trained": 38469360, "num_agent_steps_sampled": 38469360, "num_agent_steps_trained": 38469360}, "done": false, "episodes_total": 9049, "training_iteration": 2786, "trial_id": "11c4c_00000", "date": "2023-08-07_10-28-43", "timestamp": 1691393323, "time_this_iter_s": 65.30503797531128, "time_total_s": 68044.08417439461, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4273.672886133194, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 20.386021505376345, "ram_util_percent": 72.05268817204302}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8520470444037, "policy_loss": -8185072.5236424925, "vf_loss": 6464769.4455174925}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 44933.5, "diff_num_grad_updates_vs_sampler_policy": 44932.5}}, "num_env_steps_sampled": 38513280, "num_env_steps_trained": 38513280, "num_agent_steps_sampled": 38513280, "num_agent_steps_trained": 38513280}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186115.58613802405, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21744843881825968, "mean_inference_ms": 0.3716363008463157, "mean_action_processing_ms": 0.0909755743107017, "mean_env_wait_ms": 0.7771984449627268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036391344937411222, "StateBufferConnector_ms": 0.0026858214176062383, "ViewRequirementAgentConnector_ms": 0.06731134472471295}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186115.58613802405, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21744843881825968, "mean_inference_ms": 0.3716363008463157, "mean_action_processing_ms": 0.0909755743107017, "mean_env_wait_ms": 0.7771984449627268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036391344937411222, "StateBufferConnector_ms": 0.0026858214176062383, "ViewRequirementAgentConnector_ms": 0.06731134472471295}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38513280, "num_agent_steps_trained": 38513280, "num_env_steps_sampled": 38513280, "num_env_steps_trained": 38513280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 680.600061815422, "num_env_steps_trained_throughput_per_sec": 680.600061815422, "timesteps_total": 38513280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38513280, "timers": {"training_iteration_time_ms": 64871.606, "sample_time_ms": 63730.234, "load_time_ms": 19.102, "load_throughput": 2299206.842, "learn_time_ms": 1121.138, "learn_throughput": 39174.48, "synch_weights_time_ms": 0.956}, "counters": {"num_env_steps_sampled": 38513280, "num_env_steps_trained": 38513280, "num_agent_steps_sampled": 38513280, "num_agent_steps_trained": 38513280}, "done": false, "episodes_total": 9050, "training_iteration": 2787, "trial_id": "11c4c_00000", "date": "2023-08-07_10-29-47", "timestamp": 1691393387, "time_this_iter_s": 64.53500008583069, "time_total_s": 68108.61917448044, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4338.207886219025, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 26.48586956521739, "ram_util_percent": 72.30869565217392}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.85980335825036, "policy_loss": -8635959.773838945, "vf_loss": 6433736.037536443}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 45619.5, "diff_num_grad_updates_vs_sampler_policy": 45618.5}}, "num_env_steps_sampled": 38557200, "num_env_steps_trained": 38557200, "num_agent_steps_sampled": 38557200, "num_agent_steps_trained": 38557200}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186079.13565615698, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2174605838532655, "mean_inference_ms": 0.371652919770134, "mean_action_processing_ms": 0.09097833476983318, "mean_env_wait_ms": 0.7770728481084709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00369406458157212, "StateBufferConnector_ms": 0.0026976884301029035, "ViewRequirementAgentConnector_ms": 0.06744719263332993}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186079.13565615698, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2174605838532655, "mean_inference_ms": 0.371652919770134, "mean_action_processing_ms": 0.09097833476983318, "mean_env_wait_ms": 0.7770728481084709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00369406458157212, "StateBufferConnector_ms": 0.0026976884301029035, "ViewRequirementAgentConnector_ms": 0.06744719263332993}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38557200, "num_agent_steps_trained": 38557200, "num_env_steps_sampled": 38557200, "num_env_steps_trained": 38557200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 647.7180638010295, "num_env_steps_trained_throughput_per_sec": 647.7180638010295, "timesteps_total": 38557200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38557200, "timers": {"training_iteration_time_ms": 65183.637, "sample_time_ms": 64033.491, "load_time_ms": 19.89, "load_throughput": 2208163.498, "learn_time_ms": 1129.056, "learn_throughput": 38899.762, "synch_weights_time_ms": 0.999}, "counters": {"num_env_steps_sampled": 38557200, "num_env_steps_trained": 38557200, "num_agent_steps_sampled": 38557200, "num_agent_steps_trained": 38557200}, "done": false, "episodes_total": 9051, "training_iteration": 2788, "trial_id": "11c4c_00000", "date": "2023-08-07_10-30-55", "timestamp": 1691393455, "time_this_iter_s": 67.81081700325012, "time_total_s": 68176.42999148369, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4406.018703222275, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 28.176041666666663, "ram_util_percent": 72.48229166666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7916176131446, "policy_loss": -8828543.888532367, "vf_loss": 6301614.844569971}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 46304.5}}, "num_env_steps_sampled": 38601120, "num_env_steps_trained": 38601120, "num_agent_steps_sampled": 38601120, "num_agent_steps_trained": 38601120}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186021.22026048298, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21747391350118458, "mean_inference_ms": 0.37167406023851046, "mean_action_processing_ms": 0.09098192554378216, "mean_env_wait_ms": 0.7769502349957877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003690228742711684, "StateBufferConnector_ms": 0.00269623363719267, "ViewRequirementAgentConnector_ms": 0.06741635939654182}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -186021.22026048298, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21747391350118458, "mean_inference_ms": 0.37167406023851046, "mean_action_processing_ms": 0.09098192554378216, "mean_env_wait_ms": 0.7769502349957877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003690228742711684, "StateBufferConnector_ms": 0.00269623363719267, "ViewRequirementAgentConnector_ms": 0.06741635939654182}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38601120, "num_agent_steps_trained": 38601120, "num_env_steps_sampled": 38601120, "num_env_steps_trained": 38601120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 654.222407389013, "num_env_steps_trained_throughput_per_sec": 654.222407389013, "timesteps_total": 38601120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38601120, "timers": {"training_iteration_time_ms": 65392.551, "sample_time_ms": 64242.38, "load_time_ms": 20.144, "load_throughput": 2180308.53, "learn_time_ms": 1128.82, "learn_throughput": 38907.877, "synch_weights_time_ms": 1.006}, "counters": {"num_env_steps_sampled": 38601120, "num_env_steps_trained": 38601120, "num_agent_steps_sampled": 38601120, "num_agent_steps_trained": 38601120}, "done": false, "episodes_total": 9052, "training_iteration": 2789, "trial_id": "11c4c_00000", "date": "2023-08-07_10-32-02", "timestamp": 1691393522, "time_this_iter_s": 67.13595080375671, "time_total_s": 68243.56594228745, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4473.1546540260315, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 27.83894736842105, "ram_util_percent": 72.53157894736844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.72025639392194, "policy_loss": -8136658.670081314, "vf_loss": 6367951.417091837}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 46991.5, "diff_num_grad_updates_vs_sampler_policy": 46990.5}}, "num_env_steps_sampled": 38645040, "num_env_steps_trained": 38645040, "num_agent_steps_sampled": 38645040, "num_agent_steps_trained": 38645040}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185976.33787159403, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21748745078373172, "mean_inference_ms": 0.3716961788807321, "mean_action_processing_ms": 0.090985595127444, "mean_env_wait_ms": 0.7768238214538572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036837398142054462, "StateBufferConnector_ms": 0.0026955120805381002, "ViewRequirementAgentConnector_ms": 0.06739125735517862}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185976.33787159403, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21748745078373172, "mean_inference_ms": 0.3716961788807321, "mean_action_processing_ms": 0.090985595127444, "mean_env_wait_ms": 0.7768238214538572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036837398142054462, "StateBufferConnector_ms": 0.0026955120805381002, "ViewRequirementAgentConnector_ms": 0.06739125735517862}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38645040, "num_agent_steps_trained": 38645040, "num_env_steps_sampled": 38645040, "num_env_steps_trained": 38645040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 676.80782391059, "num_env_steps_trained_throughput_per_sec": 676.80782391059, "timesteps_total": 38645040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38645040, "timers": {"training_iteration_time_ms": 65406.244, "sample_time_ms": 64241.153, "load_time_ms": 20.329, "load_throughput": 2160483.383, "learn_time_ms": 1142.708, "learn_throughput": 38435.014, "synch_weights_time_ms": 1.842}, "counters": {"num_env_steps_sampled": 38645040, "num_env_steps_trained": 38645040, "num_agent_steps_sampled": 38645040, "num_agent_steps_trained": 38645040}, "done": false, "episodes_total": 9053, "training_iteration": 2790, "trial_id": "11c4c_00000", "date": "2023-08-07_10-33-07", "timestamp": 1691393587, "time_this_iter_s": 64.89747190475464, "time_total_s": 68308.4634141922, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4538.052125930786, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 26.304301075268818, "ram_util_percent": 72.7505376344086}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.81767740055005, "policy_loss": -9050116.370473078, "vf_loss": 6549763.928206997}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 47677.5, "diff_num_grad_updates_vs_sampler_policy": 47676.5}}, "num_env_steps_sampled": 38688960, "num_env_steps_trained": 38688960, "num_agent_steps_sampled": 38688960, "num_agent_steps_trained": 38688960}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185967.58054554817, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21750038907342809, "mean_inference_ms": 0.37171720976683076, "mean_action_processing_ms": 0.09098909307981323, "mean_env_wait_ms": 0.7766999751427452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036839076450892855, "StateBufferConnector_ms": 0.0026999201093401226, "ViewRequirementAgentConnector_ms": 0.06744350705827985}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185967.58054554817, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21750038907342809, "mean_inference_ms": 0.37171720976683076, "mean_action_processing_ms": 0.09098909307981323, "mean_env_wait_ms": 0.7766999751427452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036839076450892855, "StateBufferConnector_ms": 0.0026999201093401226, "ViewRequirementAgentConnector_ms": 0.06744350705827985}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38688960, "num_agent_steps_trained": 38688960, "num_env_steps_sampled": 38688960, "num_env_steps_trained": 38688960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 672.0158039245104, "num_env_steps_trained_throughput_per_sec": 672.0158039245104, "timesteps_total": 38688960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38688960, "timers": {"training_iteration_time_ms": 65482.291, "sample_time_ms": 64315.807, "load_time_ms": 20.293, "load_throughput": 2164280.674, "learn_time_ms": 1144.133, "learn_throughput": 38387.155, "synch_weights_time_ms": 1.847}, "counters": {"num_env_steps_sampled": 38688960, "num_env_steps_trained": 38688960, "num_agent_steps_sampled": 38688960, "num_agent_steps_trained": 38688960}, "done": false, "episodes_total": 9054, "training_iteration": 2791, "trial_id": "11c4c_00000", "date": "2023-08-07_10-34-13", "timestamp": 1691393653, "time_this_iter_s": 65.35864210128784, "time_total_s": 68373.82205629349, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4603.410768032074, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 23.012903225806454, "ram_util_percent": 72.6451612903226}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8556163554289, "policy_loss": -8045104.809496287, "vf_loss": 6508922.669460641}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 48363.5, "diff_num_grad_updates_vs_sampler_policy": 48362.5}}, "num_env_steps_sampled": 38732880, "num_env_steps_trained": 38732880, "num_agent_steps_sampled": 38732880, "num_agent_steps_trained": 38732880}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185944.67632897105, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21751402359771477, "mean_inference_ms": 0.3717418702971732, "mean_action_processing_ms": 0.09099314731347238, "mean_env_wait_ms": 0.7765744609569383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036743325246891504, "StateBufferConnector_ms": 0.0026991669560821963, "ViewRequirementAgentConnector_ms": 0.06741436434463716}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185944.67632897105, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21751402359771477, "mean_inference_ms": 0.3717418702971732, "mean_action_processing_ms": 0.09099314731347238, "mean_env_wait_ms": 0.7765744609569383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036743325246891504, "StateBufferConnector_ms": 0.0026991669560821963, "ViewRequirementAgentConnector_ms": 0.06741436434463716}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38732880, "num_agent_steps_trained": 38732880, "num_env_steps_sampled": 38732880, "num_env_steps_trained": 38732880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 666.0635725130129, "num_env_steps_trained_throughput_per_sec": 666.0635725130129, "timesteps_total": 38732880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38732880, "timers": {"training_iteration_time_ms": 65624.487, "sample_time_ms": 64458.242, "load_time_ms": 20.241, "load_throughput": 2169850.898, "learn_time_ms": 1143.933, "learn_throughput": 38393.847, "synch_weights_time_ms": 1.858}, "counters": {"num_env_steps_sampled": 38732880, "num_env_steps_trained": 38732880, "num_agent_steps_sampled": 38732880, "num_agent_steps_trained": 38732880}, "done": false, "episodes_total": 9055, "training_iteration": 2792, "trial_id": "11c4c_00000", "date": "2023-08-07_10-35-19", "timestamp": 1691393719, "time_this_iter_s": 65.94248223304749, "time_total_s": 68439.76453852654, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4669.3532502651215, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 29.01182795698925, "ram_util_percent": 72.67096774193548}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.90346849625035, "policy_loss": -8843364.54792274, "vf_loss": 6251760.483965015}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 49049.5, "diff_num_grad_updates_vs_sampler_policy": 49048.5}}, "num_env_steps_sampled": 38776800, "num_env_steps_trained": 38776800, "num_agent_steps_sampled": 38776800, "num_agent_steps_trained": 38776800}, "sampler_results": {"episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185881.7544912143, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21752690333000782, "mean_inference_ms": 0.37176483633466195, "mean_action_processing_ms": 0.09099690276399121, "mean_env_wait_ms": 0.7764423636794382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00366667906443278, "StateBufferConnector_ms": 0.0026997592714097765, "ViewRequirementAgentConnector_ms": 0.06739993890126546}}, "episode_reward_max": -181037.8913382251, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185881.7544912143, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21752690333000782, "mean_inference_ms": 0.37176483633466195, "mean_action_processing_ms": 0.09099690276399121, "mean_env_wait_ms": 0.7764423636794382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00366667906443278, "StateBufferConnector_ms": 0.0026997592714097765, "ViewRequirementAgentConnector_ms": 0.06739993890126546}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38776800, "num_agent_steps_trained": 38776800, "num_env_steps_sampled": 38776800, "num_env_steps_trained": 38776800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 695.4756127059517, "num_env_steps_trained_throughput_per_sec": 695.4756127059517, "timesteps_total": 38776800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38776800, "timers": {"training_iteration_time_ms": 65442.489, "sample_time_ms": 64268.773, "load_time_ms": 20.173, "load_throughput": 2177198.24, "learn_time_ms": 1151.467, "learn_throughput": 38142.656, "synch_weights_time_ms": 1.861}, "counters": {"num_env_steps_sampled": 38776800, "num_env_steps_trained": 38776800, "num_agent_steps_sampled": 38776800, "num_agent_steps_trained": 38776800}, "done": false, "episodes_total": 9056, "training_iteration": 2793, "trial_id": "11c4c_00000", "date": "2023-08-07_10-36-22", "timestamp": 1691393782, "time_this_iter_s": 63.15390729904175, "time_total_s": 68502.91844582558, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4732.507157564163, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 26.481111111111108, "ram_util_percent": 72.62555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9344344514452, "policy_loss": -7577177.739323297, "vf_loss": 6162773.804846939}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 49735.5, "diff_num_grad_updates_vs_sampler_policy": 49734.5}}, "num_env_steps_sampled": 38820720, "num_env_steps_trained": 38820720, "num_agent_steps_sampled": 38820720, "num_agent_steps_trained": 38820720}, "sampler_results": {"episode_reward_max": -180191.22052040152, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185803.80197106616, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21753998545798325, "mean_inference_ms": 0.37178885974791903, "mean_action_processing_ms": 0.09100078649713719, "mean_env_wait_ms": 0.7763068038645842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036579288848458905, "StateBufferConnector_ms": 0.0027006619597134524, "ViewRequirementAgentConnector_ms": 0.0673885214818667}}, "episode_reward_max": -180191.22052040152, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185803.80197106616, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21753998545798325, "mean_inference_ms": 0.37178885974791903, "mean_action_processing_ms": 0.09100078649713719, "mean_env_wait_ms": 0.7763068038645842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036579288848458905, "StateBufferConnector_ms": 0.0027006619597134524, "ViewRequirementAgentConnector_ms": 0.0673885214818667}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38820720, "num_agent_steps_trained": 38820720, "num_env_steps_sampled": 38820720, "num_env_steps_trained": 38820720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 679.1871863592289, "num_env_steps_trained_throughput_per_sec": 679.1871863592289, "timesteps_total": 38820720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38820720, "timers": {"training_iteration_time_ms": 65478.617, "sample_time_ms": 64302.519, "load_time_ms": 20.296, "load_throughput": 2163970.502, "learn_time_ms": 1153.758, "learn_throughput": 38066.896, "synch_weights_time_ms": 1.833}, "counters": {"num_env_steps_sampled": 38820720, "num_env_steps_trained": 38820720, "num_agent_steps_sampled": 38820720, "num_agent_steps_trained": 38820720}, "done": false, "episodes_total": 9057, "training_iteration": 2794, "trial_id": "11c4c_00000", "date": "2023-08-07_10-37-27", "timestamp": 1691393847, "time_this_iter_s": 64.66875100135803, "time_total_s": 68567.58719682693, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4797.175908565521, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 27.411956521739125, "ram_util_percent": 72.8586956521739}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8616365927649, "policy_loss": -8507505.412066668, "vf_loss": 6115315.47303207}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 50421.5, "diff_num_grad_updates_vs_sampler_policy": 50420.5}}, "num_env_steps_sampled": 38864640, "num_env_steps_trained": 38864640, "num_agent_steps_sampled": 38864640, "num_agent_steps_trained": 38864640}, "sampler_results": {"episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185720.80118575602, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2175525965684984, "mean_inference_ms": 0.3718130010207528, "mean_action_processing_ms": 0.0910045867721609, "mean_env_wait_ms": 0.7761673088996429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036523148820206924, "StateBufferConnector_ms": 0.002699284940152555, "ViewRequirementAgentConnector_ms": 0.06738063451406118}}, "episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185720.80118575602, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2175525965684984, "mean_inference_ms": 0.3718130010207528, "mean_action_processing_ms": 0.0910045867721609, "mean_env_wait_ms": 0.7761673088996429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036523148820206924, "StateBufferConnector_ms": 0.002699284940152555, "ViewRequirementAgentConnector_ms": 0.06738063451406118}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38864640, "num_agent_steps_trained": 38864640, "num_env_steps_sampled": 38864640, "num_env_steps_trained": 38864640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 685.5989815369329, "num_env_steps_trained_throughput_per_sec": 685.5989815369329, "timesteps_total": 38864640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38864640, "timers": {"training_iteration_time_ms": 65283.897, "sample_time_ms": 64106.978, "load_time_ms": 19.126, "load_throughput": 2296297.799, "learn_time_ms": 1155.736, "learn_throughput": 38001.773, "synch_weights_time_ms": 1.843}, "counters": {"num_env_steps_sampled": 38864640, "num_env_steps_trained": 38864640, "num_agent_steps_sampled": 38864640, "num_agent_steps_trained": 38864640}, "done": false, "episodes_total": 9058, "training_iteration": 2795, "trial_id": "11c4c_00000", "date": "2023-08-07_10-38-31", "timestamp": 1691393911, "time_this_iter_s": 64.06353902816772, "time_total_s": 68631.6507358551, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4861.239447593689, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 26.40769230769231, "ram_util_percent": 72.79560439560439}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.75407663239685, "policy_loss": -7981939.925994784, "vf_loss": 6156935.950983965}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51107.5, "diff_num_grad_updates_vs_sampler_policy": 51106.5}}, "num_env_steps_sampled": 38908560, "num_env_steps_trained": 38908560, "num_agent_steps_sampled": 38908560, "num_agent_steps_trained": 38908560}, "sampler_results": {"episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185647.993389067, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21756628035774672, "mean_inference_ms": 0.37183988175874716, "mean_action_processing_ms": 0.09100900017720577, "mean_env_wait_ms": 0.7760279059092535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036481221516927085, "StateBufferConnector_ms": 0.0026979446411132812, "ViewRequirementAgentConnector_ms": 0.0673513412475586}}, "episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185647.993389067, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21756628035774672, "mean_inference_ms": 0.37183988175874716, "mean_action_processing_ms": 0.09100900017720577, "mean_env_wait_ms": 0.7760279059092535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036481221516927085, "StateBufferConnector_ms": 0.0026979446411132812, "ViewRequirementAgentConnector_ms": 0.0673513412475586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38908560, "num_agent_steps_trained": 38908560, "num_env_steps_sampled": 38908560, "num_env_steps_trained": 38908560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 663.8999841800404, "num_env_steps_trained_throughput_per_sec": 663.8999841800404, "timesteps_total": 38908560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38908560, "timers": {"training_iteration_time_ms": 65369.145, "sample_time_ms": 64192.487, "load_time_ms": 19.191, "load_throughput": 2288532.625, "learn_time_ms": 1155.41, "learn_throughput": 38012.492, "synch_weights_time_ms": 1.843}, "counters": {"num_env_steps_sampled": 38908560, "num_env_steps_trained": 38908560, "num_agent_steps_sampled": 38908560, "num_agent_steps_trained": 38908560}, "done": false, "episodes_total": 9059, "training_iteration": 2796, "trial_id": "11c4c_00000", "date": "2023-08-07_10-39-37", "timestamp": 1691393977, "time_this_iter_s": 66.15747213363647, "time_total_s": 68697.80820798874, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4927.396919727325, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 27.711702127659585, "ram_util_percent": 73.16063829787235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7966175579816, "policy_loss": -8336827.819626343, "vf_loss": 6454744.0625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51793.5, "diff_num_grad_updates_vs_sampler_policy": 51792.5}}, "num_env_steps_sampled": 38952480, "num_env_steps_trained": 38952480, "num_agent_steps_sampled": 38952480, "num_agent_steps_trained": 38952480}, "sampler_results": {"episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185630.4588090598, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21757988451758478, "mean_inference_ms": 0.3718665380015307, "mean_action_processing_ms": 0.09101321395149924, "mean_env_wait_ms": 0.7758869817650983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003640588961149517, "StateBufferConnector_ms": 0.002694443652504369, "ViewRequirementAgentConnector_ms": 0.06731403501410234}}, "episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185630.4588090598, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21757988451758478, "mean_inference_ms": 0.3718665380015307, "mean_action_processing_ms": 0.09101321395149924, "mean_env_wait_ms": 0.7758869817650983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003640588961149517, "StateBufferConnector_ms": 0.002694443652504369, "ViewRequirementAgentConnector_ms": 0.06731403501410234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38952480, "num_agent_steps_trained": 38952480, "num_env_steps_sampled": 38952480, "num_env_steps_trained": 38952480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 680.6280852084153, "num_env_steps_trained_throughput_per_sec": 680.6280852084153, "timesteps_total": 38952480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38952480, "timers": {"training_iteration_time_ms": 65368.879, "sample_time_ms": 64191.429, "load_time_ms": 19.368, "load_throughput": 2267696.512, "learn_time_ms": 1156.048, "learn_throughput": 37991.514, "synch_weights_time_ms": 1.833}, "counters": {"num_env_steps_sampled": 38952480, "num_env_steps_trained": 38952480, "num_agent_steps_sampled": 38952480, "num_agent_steps_trained": 38952480}, "done": false, "episodes_total": 9060, "training_iteration": 2797, "trial_id": "11c4c_00000", "date": "2023-08-07_10-40-41", "timestamp": 1691394041, "time_this_iter_s": 64.53144693374634, "time_total_s": 68762.33965492249, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4991.928366661072, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 24.198913043478264, "ram_util_percent": 73.20978260869565}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8102357380592, "policy_loss": -8592884.137988565, "vf_loss": 6357541.658345481}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 52479.5, "diff_num_grad_updates_vs_sampler_policy": 52478.5}}, "num_env_steps_sampled": 38996400, "num_env_steps_trained": 38996400, "num_agent_steps_sampled": 38996400, "num_agent_steps_trained": 38996400}, "sampler_results": {"episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185592.75689992006, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21759280130282282, "mean_inference_ms": 0.37189280945470865, "mean_action_processing_ms": 0.0910171827048898, "mean_env_wait_ms": 0.7757445704866258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003633870706929789, "StateBufferConnector_ms": 0.0026938203093293425, "ViewRequirementAgentConnector_ms": 0.0673575834794478}}, "episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185592.75689992006, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21759280130282282, "mean_inference_ms": 0.37189280945470865, "mean_action_processing_ms": 0.0910171827048898, "mean_env_wait_ms": 0.7757445704866258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003633870706929789, "StateBufferConnector_ms": 0.0026938203093293425, "ViewRequirementAgentConnector_ms": 0.0673575834794478}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38996400, "num_agent_steps_trained": 38996400, "num_env_steps_sampled": 38996400, "num_env_steps_trained": 38996400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 682.8419368114158, "num_env_steps_trained_throughput_per_sec": 682.8419368114158, "timesteps_total": 38996400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 38996400, "timers": {"training_iteration_time_ms": 65020.098, "sample_time_ms": 63848.198, "load_time_ms": 18.623, "load_throughput": 2358377.779, "learn_time_ms": 1151.304, "learn_throughput": 38148.047, "synch_weights_time_ms": 1.794}, "counters": {"num_env_steps_sampled": 38996400, "num_env_steps_trained": 38996400, "num_agent_steps_sampled": 38996400, "num_agent_steps_trained": 38996400}, "done": false, "episodes_total": 9061, "training_iteration": 2798, "trial_id": "11c4c_00000", "date": "2023-08-07_10-41-46", "timestamp": 1691394106, "time_this_iter_s": 64.32254385948181, "time_total_s": 68826.66219878197, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5056.250910520554, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 25.223076923076913, "ram_util_percent": 73.15384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8003759801214, "policy_loss": -9084973.592332134, "vf_loss": 6509645.998177842}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53165.5, "diff_num_grad_updates_vs_sampler_policy": 53164.5}}, "num_env_steps_sampled": 39040320, "num_env_steps_trained": 39040320, "num_agent_steps_sampled": 39040320, "num_agent_steps_trained": 39040320}, "sampler_results": {"episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185576.4609886495, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21760486222273073, "mean_inference_ms": 0.3719177560369762, "mean_action_processing_ms": 0.09102083831997199, "mean_env_wait_ms": 0.7755992201783817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003625185061723758, "StateBufferConnector_ms": 0.0026950469383826624, "ViewRequirementAgentConnector_ms": 0.06734255032661633}}, "episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185576.4609886495, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21760486222273073, "mean_inference_ms": 0.3719177560369762, "mean_action_processing_ms": 0.09102083831997199, "mean_env_wait_ms": 0.7755992201783817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003625185061723758, "StateBufferConnector_ms": 0.0026950469383826624, "ViewRequirementAgentConnector_ms": 0.06734255032661633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39040320, "num_agent_steps_trained": 39040320, "num_env_steps_sampled": 39040320, "num_env_steps_trained": 39040320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 691.5657844679245, "num_env_steps_trained_throughput_per_sec": 691.5657844679245, "timesteps_total": 39040320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39040320, "timers": {"training_iteration_time_ms": 64657.59, "sample_time_ms": 63484.566, "load_time_ms": 18.375, "load_throughput": 2390183.489, "learn_time_ms": 1152.682, "learn_throughput": 38102.441, "synch_weights_time_ms": 1.786}, "counters": {"num_env_steps_sampled": 39040320, "num_env_steps_trained": 39040320, "num_agent_steps_sampled": 39040320, "num_agent_steps_trained": 39040320}, "done": false, "episodes_total": 9062, "training_iteration": 2799, "trial_id": "11c4c_00000", "date": "2023-08-07_10-42-49", "timestamp": 1691394169, "time_this_iter_s": 63.51090717315674, "time_total_s": 68890.17310595512, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5119.76181769371, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 25.149450549450552, "ram_util_percent": 73.13296703296703}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.83622359117334, "policy_loss": -8694608.28653141, "vf_loss": 6445620.791180758}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53851.5, "diff_num_grad_updates_vs_sampler_policy": 53850.5}}, "num_env_steps_sampled": 39084240, "num_env_steps_trained": 39084240, "num_agent_steps_sampled": 39084240, "num_agent_steps_trained": 39084240}, "sampler_results": {"episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185552.18155598314, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21761950818556655, "mean_inference_ms": 0.37194849471245217, "mean_action_processing_ms": 0.09102558811373017, "mean_env_wait_ms": 0.7754602897483818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003616115714930281, "StateBufferConnector_ms": 0.002691715578489666, "ViewRequirementAgentConnector_ms": 0.06731522234180305}}, "episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185552.18155598314, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21761950818556655, "mean_inference_ms": 0.37194849471245217, "mean_action_processing_ms": 0.09102558811373017, "mean_env_wait_ms": 0.7754602897483818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003616115714930281, "StateBufferConnector_ms": 0.002691715578489666, "ViewRequirementAgentConnector_ms": 0.06731522234180305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39084240, "num_agent_steps_trained": 39084240, "num_env_steps_sampled": 39084240, "num_env_steps_trained": 39084240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 633.9496108263223, "num_env_steps_trained_throughput_per_sec": 633.9496108263223, "timesteps_total": 39084240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39084240, "timers": {"training_iteration_time_ms": 65096.299, "sample_time_ms": 63938.07, "load_time_ms": 18.499, "load_throughput": 2374241.436, "learn_time_ms": 1138.601, "learn_throughput": 38573.637, "synch_weights_time_ms": 0.956}, "counters": {"num_env_steps_sampled": 39084240, "num_env_steps_trained": 39084240, "num_agent_steps_sampled": 39084240, "num_agent_steps_trained": 39084240}, "done": false, "episodes_total": 9063, "training_iteration": 2800, "trial_id": "11c4c_00000", "date": "2023-08-07_10-43-59", "timestamp": 1691394239, "time_this_iter_s": 69.28276300430298, "time_total_s": 68959.45586895943, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5189.044580698013, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 28.493877551020407, "ram_util_percent": 73.38979591836734}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7375469152156, "policy_loss": -8062628.245467383, "vf_loss": 6576831.231231779}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 54537.5, "diff_num_grad_updates_vs_sampler_policy": 54536.5}}, "num_env_steps_sampled": 39128160, "num_env_steps_trained": 39128160, "num_agent_steps_sampled": 39128160, "num_agent_steps_trained": 39128160}, "sampler_results": {"episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185550.47521559865, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21763332300096944, "mean_inference_ms": 0.3719770721221189, "mean_action_processing_ms": 0.09103000992079138, "mean_env_wait_ms": 0.7753187786477612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003611743450164795, "StateBufferConnector_ms": 0.0026926398277282715, "ViewRequirementAgentConnector_ms": 0.0673171877861023}}, "episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185550.47521559865, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21763332300096944, "mean_inference_ms": 0.3719770721221189, "mean_action_processing_ms": 0.09103000992079138, "mean_env_wait_ms": 0.7753187786477612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003611743450164795, "StateBufferConnector_ms": 0.0026926398277282715, "ViewRequirementAgentConnector_ms": 0.0673171877861023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39128160, "num_agent_steps_trained": 39128160, "num_env_steps_sampled": 39128160, "num_env_steps_trained": 39128160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 693.0988564573288, "num_env_steps_trained_throughput_per_sec": 693.0988564573288, "timesteps_total": 39128160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39128160, "timers": {"training_iteration_time_ms": 64897.496, "sample_time_ms": 63739.472, "load_time_ms": 18.611, "load_throughput": 2359942.808, "learn_time_ms": 1138.286, "learn_throughput": 38584.322, "synch_weights_time_ms": 0.954}, "counters": {"num_env_steps_sampled": 39128160, "num_env_steps_trained": 39128160, "num_agent_steps_sampled": 39128160, "num_agent_steps_trained": 39128160}, "done": false, "episodes_total": 9064, "training_iteration": 2801, "trial_id": "11c4c_00000", "date": "2023-08-07_10-45-02", "timestamp": 1691394302, "time_this_iter_s": 63.37044715881348, "time_total_s": 69022.82631611824, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5252.415027856827, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 25.89555555555555, "ram_util_percent": 73.2611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8343178885324, "policy_loss": -8548858.586959617, "vf_loss": 6365127.311771137}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55223.5, "diff_num_grad_updates_vs_sampler_policy": 55222.5}}, "num_env_steps_sampled": 39172080, "num_env_steps_trained": 39172080, "num_agent_steps_sampled": 39172080, "num_agent_steps_trained": 39172080}, "sampler_results": {"episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185516.08562678393, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21764621700599848, "mean_inference_ms": 0.3720042556543235, "mean_action_processing_ms": 0.09103408659627285, "mean_env_wait_ms": 0.7751751326102377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036866576583297166, "StateBufferConnector_ms": 0.002693541255998023, "ViewRequirementAgentConnector_ms": 0.06725346600567852}}, "episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185516.08562678393, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21764621700599848, "mean_inference_ms": 0.3720042556543235, "mean_action_processing_ms": 0.09103408659627285, "mean_env_wait_ms": 0.7751751326102377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036866576583297166, "StateBufferConnector_ms": 0.002693541255998023, "ViewRequirementAgentConnector_ms": 0.06725346600567852}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39172080, "num_agent_steps_trained": 39172080, "num_env_steps_sampled": 39172080, "num_env_steps_trained": 39172080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 691.090462129944, "num_env_steps_trained_throughput_per_sec": 691.090462129944, "timesteps_total": 39172080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39172080, "timers": {"training_iteration_time_ms": 64658.705, "sample_time_ms": 63503.655, "load_time_ms": 18.52, "load_throughput": 2371490.589, "learn_time_ms": 1135.412, "learn_throughput": 38681.978, "synch_weights_time_ms": 0.944}, "counters": {"num_env_steps_sampled": 39172080, "num_env_steps_trained": 39172080, "num_agent_steps_sampled": 39172080, "num_agent_steps_trained": 39172080}, "done": false, "episodes_total": 9065, "training_iteration": 2802, "trial_id": "11c4c_00000", "date": "2023-08-07_10-46-06", "timestamp": 1691394366, "time_this_iter_s": 63.55476212501526, "time_total_s": 69086.38107824326, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5315.969789981842, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 25.30989010989011, "ram_util_percent": 73.15384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.6875e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.83271375828514, "policy_loss": -8323873.636416955, "vf_loss": 6281946.309220117}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55909.5, "diff_num_grad_updates_vs_sampler_policy": 55908.5}}, "num_env_steps_sampled": 39216000, "num_env_steps_trained": 39216000, "num_agent_steps_sampled": 39216000, "num_agent_steps_trained": 39216000}, "sampler_results": {"episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185468.09077502086, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21765884349350653, "mean_inference_ms": 0.3720301044638965, "mean_action_processing_ms": 0.09103798163020199, "mean_env_wait_ms": 0.7750300359555454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036829855383896247, "StateBufferConnector_ms": 0.002693839189482898, "ViewRequirementAgentConnector_ms": 0.06724188967448909}}, "episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185468.09077502086, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21765884349350653, "mean_inference_ms": 0.3720301044638965, "mean_action_processing_ms": 0.09103798163020199, "mean_env_wait_ms": 0.7750300359555454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036829855383896247, "StateBufferConnector_ms": 0.002693839189482898, "ViewRequirementAgentConnector_ms": 0.06724188967448909}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39216000, "num_agent_steps_trained": 39216000, "num_env_steps_sampled": 39216000, "num_env_steps_trained": 39216000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 686.2852684605062, "num_env_steps_trained_throughput_per_sec": 686.2852684605062, "timesteps_total": 39216000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39216000, "timers": {"training_iteration_time_ms": 64743.273, "sample_time_ms": 63587.683, "load_time_ms": 18.377, "load_throughput": 2389985.024, "learn_time_ms": 1136.099, "learn_throughput": 38658.606, "synch_weights_time_ms": 0.945}, "counters": {"num_env_steps_sampled": 39216000, "num_env_steps_trained": 39216000, "num_agent_steps_sampled": 39216000, "num_agent_steps_trained": 39216000}, "done": false, "episodes_total": 9066, "training_iteration": 2803, "trial_id": "11c4c_00000", "date": "2023-08-07_10-47-10", "timestamp": 1691394430, "time_this_iter_s": 63.99960803985596, "time_total_s": 69150.38068628311, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5379.969398021698, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 25.783333333333335, "ram_util_percent": 73.19}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.3749999999999997e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.6966435735497, "policy_loss": -8663306.20148221, "vf_loss": 6235748.80521137}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 56595.5, "diff_num_grad_updates_vs_sampler_policy": 56594.5}}, "num_env_steps_sampled": 39259920, "num_env_steps_trained": 39259920, "num_agent_steps_sampled": 39259920, "num_agent_steps_trained": 39259920}, "sampler_results": {"episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185420.53002076873, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21767129803565993, "mean_inference_ms": 0.37205536488173385, "mean_action_processing_ms": 0.09104171046991111, "mean_env_wait_ms": 0.7748838631496119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037135848079819277, "StateBufferConnector_ms": 0.0026975769594491245, "ViewRequirementAgentConnector_ms": 0.06730010710566876}}, "episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185420.53002076873, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21767129803565993, "mean_inference_ms": 0.37205536488173385, "mean_action_processing_ms": 0.09104171046991111, "mean_env_wait_ms": 0.7748838631496119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037135848079819277, "StateBufferConnector_ms": 0.0026975769594491245, "ViewRequirementAgentConnector_ms": 0.06730010710566876}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39259920, "num_agent_steps_trained": 39259920, "num_env_steps_sampled": 39259920, "num_env_steps_trained": 39259920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 683.8941557015548, "num_env_steps_trained_throughput_per_sec": 683.8941557015548, "timesteps_total": 39259920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39259920, "timers": {"training_iteration_time_ms": 64698.767, "sample_time_ms": 63545.131, "load_time_ms": 18.296, "load_throughput": 2400499.241, "learn_time_ms": 1134.233, "learn_throughput": 38722.205, "synch_weights_time_ms": 0.939}, "counters": {"num_env_steps_sampled": 39259920, "num_env_steps_trained": 39259920, "num_agent_steps_sampled": 39259920, "num_agent_steps_trained": 39259920}, "done": false, "episodes_total": 9067, "training_iteration": 2804, "trial_id": "11c4c_00000", "date": "2023-08-07_10-48-14", "timestamp": 1691394494, "time_this_iter_s": 64.22328495979309, "time_total_s": 69214.6039712429, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5444.192682981491, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 25.208695652173915, "ram_util_percent": 73.19347826086957}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.0625e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.88633625708934, "policy_loss": -8658073.068837691, "vf_loss": 6561097.421465015}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 57281.5, "diff_num_grad_updates_vs_sampler_policy": 57280.5}}, "num_env_steps_sampled": 39303840, "num_env_steps_trained": 39303840, "num_agent_steps_sampled": 39303840, "num_agent_steps_trained": 39303840}, "sampler_results": {"episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185417.87335568908, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21768353394508475, "mean_inference_ms": 0.37208001045799594, "mean_action_processing_ms": 0.09104541579599265, "mean_env_wait_ms": 0.7747390785000123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706557410103934, "StateBufferConnector_ms": 0.0026952652704148065, "ViewRequirementAgentConnector_ms": 0.06726753144037156}}, "episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185417.87335568908, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21768353394508475, "mean_inference_ms": 0.37208001045799594, "mean_action_processing_ms": 0.09104541579599265, "mean_env_wait_ms": 0.7747390785000123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706557410103934, "StateBufferConnector_ms": 0.0026952652704148065, "ViewRequirementAgentConnector_ms": 0.06726753144037156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39303840, "num_agent_steps_trained": 39303840, "num_env_steps_sampled": 39303840, "num_env_steps_trained": 39303840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 675.5033212063067, "num_env_steps_trained_throughput_per_sec": 675.5033212063067, "timesteps_total": 39303840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39303840, "timers": {"training_iteration_time_ms": 64794.508, "sample_time_ms": 63637.561, "load_time_ms": 18.448, "load_throughput": 2380746.502, "learn_time_ms": 1137.395, "learn_throughput": 38614.562, "synch_weights_time_ms": 0.939}, "counters": {"num_env_steps_sampled": 39303840, "num_env_steps_trained": 39303840, "num_agent_steps_sampled": 39303840, "num_agent_steps_trained": 39303840}, "done": false, "episodes_total": 9068, "training_iteration": 2805, "trial_id": "11c4c_00000", "date": "2023-08-07_10-49-19", "timestamp": 1691394559, "time_this_iter_s": 65.02103877067566, "time_total_s": 69279.62501001358, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5509.213721752167, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 24.958695652173912, "ram_util_percent": 73.36739130434782}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.75e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.98506106718634, "policy_loss": -8328576.711555325, "vf_loss": 6589981.584730321}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 57967.5, "diff_num_grad_updates_vs_sampler_policy": 57966.5}}, "num_env_steps_sampled": 39347760, "num_env_steps_trained": 39347760, "num_agent_steps_sampled": 39347760, "num_agent_steps_trained": 39347760}, "sampler_results": {"episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185415.7329797998, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21769615193107442, "mean_inference_ms": 0.37210648456862033, "mean_action_processing_ms": 0.09104930356178398, "mean_env_wait_ms": 0.7745962585666214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701378317440257, "StateBufferConnector_ms": 0.0026955324060776655, "ViewRequirementAgentConnector_ms": 0.06727779612821691}}, "episode_reward_max": -179661.74385811613, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185415.7329797998, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21769615193107442, "mean_inference_ms": 0.37210648456862033, "mean_action_processing_ms": 0.09104930356178398, "mean_env_wait_ms": 0.7745962585666214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701378317440257, "StateBufferConnector_ms": 0.0026955324060776655, "ViewRequirementAgentConnector_ms": 0.06727779612821691}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39347760, "num_agent_steps_trained": 39347760, "num_env_steps_sampled": 39347760, "num_env_steps_trained": 39347760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 663.588181353073, "num_env_steps_trained_throughput_per_sec": 663.588181353073, "timesteps_total": 39347760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39347760, "timers": {"training_iteration_time_ms": 64797.617, "sample_time_ms": 63640.944, "load_time_ms": 18.743, "load_throughput": 2343311.781, "learn_time_ms": 1136.826, "learn_throughput": 38633.889, "synch_weights_time_ms": 0.938}, "counters": {"num_env_steps_sampled": 39347760, "num_env_steps_trained": 39347760, "num_agent_steps_sampled": 39347760, "num_agent_steps_trained": 39347760}, "done": false, "episodes_total": 9069, "training_iteration": 2806, "trial_id": "11c4c_00000", "date": "2023-08-07_10-50-25", "timestamp": 1691394625, "time_this_iter_s": 66.1883749961853, "time_total_s": 69345.81338500977, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5575.402096748352, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 25.387234042553192, "ram_util_percent": 74.04787234042554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.437499999999999e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.92940487875535, "policy_loss": -7608270.712899166, "vf_loss": 6048963.693239796}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 58653.5, "diff_num_grad_updates_vs_sampler_policy": 58652.5}}, "num_env_steps_sampled": 39391680, "num_env_steps_trained": 39391680, "num_agent_steps_sampled": 39391680, "num_agent_steps_trained": 39391680}, "sampler_results": {"episode_reward_max": -178582.95507748966, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185336.28207395898, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2177083611964363, "mean_inference_ms": 0.37213163630650736, "mean_action_processing_ms": 0.09105300928052264, "mean_env_wait_ms": 0.774451347513542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037340230719987736, "StateBufferConnector_ms": 0.0026938527129417244, "ViewRequirementAgentConnector_ms": 0.06723681161569994}}, "episode_reward_max": -178582.95507748966, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185336.28207395898, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2177083611964363, "mean_inference_ms": 0.37213163630650736, "mean_action_processing_ms": 0.09105300928052264, "mean_env_wait_ms": 0.774451347513542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037340230719987736, "StateBufferConnector_ms": 0.0026938527129417244, "ViewRequirementAgentConnector_ms": 0.06723681161569994}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39391680, "num_agent_steps_trained": 39391680, "num_env_steps_sampled": 39391680, "num_env_steps_trained": 39391680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 691.4173088535986, "num_env_steps_trained_throughput_per_sec": 691.4173088535986, "timesteps_total": 39391680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39391680, "timers": {"training_iteration_time_ms": 64696.923, "sample_time_ms": 63540.101, "load_time_ms": 18.624, "load_throughput": 2358284.185, "learn_time_ms": 1137.106, "learn_throughput": 38624.382, "synch_weights_time_ms": 0.925}, "counters": {"num_env_steps_sampled": 39391680, "num_env_steps_trained": 39391680, "num_agent_steps_sampled": 39391680, "num_agent_steps_trained": 39391680}, "done": false, "episodes_total": 9070, "training_iteration": 2807, "trial_id": "11c4c_00000", "date": "2023-08-07_10-51-29", "timestamp": 1691394689, "time_this_iter_s": 63.52456784248352, "time_total_s": 69409.33795285225, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5638.926664590836, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 25.861538461538462, "ram_util_percent": 74.46373626373627}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.124999999999999e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9350226043612, "policy_loss": -7517978.59778437, "vf_loss": 6380727.127915452}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 59339.5, "diff_num_grad_updates_vs_sampler_policy": 59338.5}}, "num_env_steps_sampled": 39435600, "num_env_steps_trained": 39435600, "num_agent_steps_sampled": 39435600, "num_agent_steps_trained": 39435600}, "sampler_results": {"episode_reward_max": -178582.95507748966, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185305.32415124658, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21771994109646406, "mean_inference_ms": 0.37215561986849716, "mean_action_processing_ms": 0.09105654796043265, "mean_env_wait_ms": 0.7743033041017493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003727825208642017, "StateBufferConnector_ms": 0.0026916635447535022, "ViewRequirementAgentConnector_ms": 0.06723677975007858}}, "episode_reward_max": -178582.95507748966, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185305.32415124658, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21771994109646406, "mean_inference_ms": 0.37215561986849716, "mean_action_processing_ms": 0.09105654796043265, "mean_env_wait_ms": 0.7743033041017493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003727825208642017, "StateBufferConnector_ms": 0.0026916635447535022, "ViewRequirementAgentConnector_ms": 0.06723677975007858}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39435600, "num_agent_steps_trained": 39435600, "num_env_steps_sampled": 39435600, "num_env_steps_trained": 39435600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 696.531652228288, "num_env_steps_trained_throughput_per_sec": 696.531652228288, "timesteps_total": 39435600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39435600, "timers": {"training_iteration_time_ms": 64570.509, "sample_time_ms": 63415.992, "load_time_ms": 18.714, "load_throughput": 2346942.091, "learn_time_ms": 1134.712, "learn_throughput": 38705.865, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 39435600, "num_env_steps_trained": 39435600, "num_agent_steps_sampled": 39435600, "num_agent_steps_trained": 39435600}, "done": false, "episodes_total": 9071, "training_iteration": 2808, "trial_id": "11c4c_00000", "date": "2023-08-07_10-52-32", "timestamp": 1691394752, "time_this_iter_s": 63.05820417404175, "time_total_s": 69472.39615702629, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5701.984868764877, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 25.65505617977528, "ram_util_percent": 74.49213483146066}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8125000000000003e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.7713424638131, "policy_loss": -7646604.94005102, "vf_loss": 5864242.881468659}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 60025.5, "diff_num_grad_updates_vs_sampler_policy": 60024.5}}, "num_env_steps_sampled": 39479520, "num_env_steps_trained": 39479520, "num_agent_steps_sampled": 39479520, "num_agent_steps_trained": 39479520}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185202.52132941855, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21773378297019608, "mean_inference_ms": 0.3721805293354745, "mean_action_processing_ms": 0.09106036386217627, "mean_env_wait_ms": 0.7741588487109085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003720413554798473, "StateBufferConnector_ms": 0.0026870857585560193, "ViewRequirementAgentConnector_ms": 0.06720938465811989}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185202.52132941855, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21773378297019608, "mean_inference_ms": 0.3721805293354745, "mean_action_processing_ms": 0.09106036386217627, "mean_env_wait_ms": 0.7741588487109085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003720413554798473, "StateBufferConnector_ms": 0.0026870857585560193, "ViewRequirementAgentConnector_ms": 0.06720938465811989}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39479520, "num_agent_steps_trained": 39479520, "num_env_steps_sampled": 39479520, "num_env_steps_trained": 39479520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 651.491184700565, "num_env_steps_trained_throughput_per_sec": 651.491184700565, "timesteps_total": 39479520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39479520, "timers": {"training_iteration_time_ms": 64961.161, "sample_time_ms": 63794.362, "load_time_ms": 19.125, "load_throughput": 2296518.227, "learn_time_ms": 1146.581, "learn_throughput": 38305.193, "synch_weights_time_ms": 0.926}, "counters": {"num_env_steps_sampled": 39479520, "num_env_steps_trained": 39479520, "num_agent_steps_sampled": 39479520, "num_agent_steps_trained": 39479520}, "done": false, "episodes_total": 9072, "training_iteration": 2809, "trial_id": "11c4c_00000", "date": "2023-08-07_10-53-39", "timestamp": 1691394819, "time_this_iter_s": 67.41734790802002, "time_total_s": 69539.81350493431, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5769.402216672897, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 29.255208333333332, "ram_util_percent": 74.41041666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8054437665133, "policy_loss": -7586159.160523528, "vf_loss": 6289492.139030612}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 60711.5, "diff_num_grad_updates_vs_sampler_policy": 60710.5}}, "num_env_steps_sampled": 39523440, "num_env_steps_trained": 39523440, "num_agent_steps_sampled": 39523440, "num_agent_steps_trained": 39523440}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185161.2827802177, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21775043444709763, "mean_inference_ms": 0.37220992539382136, "mean_action_processing_ms": 0.0910650385836728, "mean_env_wait_ms": 0.7740303965696789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037257590990387992, "StateBufferConnector_ms": 0.002689040109012904, "ViewRequirementAgentConnector_ms": 0.06732378113135863}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185161.2827802177, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21775043444709763, "mean_inference_ms": 0.37220992539382136, "mean_action_processing_ms": 0.0910650385836728, "mean_env_wait_ms": 0.7740303965696789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037257590990387992, "StateBufferConnector_ms": 0.002689040109012904, "ViewRequirementAgentConnector_ms": 0.06732378113135863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39523440, "num_agent_steps_trained": 39523440, "num_env_steps_sampled": 39523440, "num_env_steps_trained": 39523440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 598.4411812840912, "num_env_steps_trained_throughput_per_sec": 598.4411812840912, "timesteps_total": 39523440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39523440, "timers": {"training_iteration_time_ms": 65372.232, "sample_time_ms": 64186.447, "load_time_ms": 19.474, "load_throughput": 2255361.059, "learn_time_ms": 1165.018, "learn_throughput": 37698.987, "synch_weights_time_ms": 1.124}, "counters": {"num_env_steps_sampled": 39523440, "num_env_steps_trained": 39523440, "num_agent_steps_sampled": 39523440, "num_agent_steps_trained": 39523440}, "done": false, "episodes_total": 9073, "training_iteration": 2810, "trial_id": "11c4c_00000", "date": "2023-08-07_10-54-53", "timestamp": 1691394893, "time_this_iter_s": 73.39389085769653, "time_total_s": 69613.20739579201, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5842.796107530594, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 35.222115384615385, "ram_util_percent": 74.18846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8542464008832, "policy_loss": -7951224.020934881, "vf_loss": 6406531.709365889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 61397.5, "diff_num_grad_updates_vs_sampler_policy": 61396.5}}, "num_env_steps_sampled": 39567360, "num_env_steps_trained": 39567360, "num_agent_steps_sampled": 39567360, "num_agent_steps_trained": 39567360}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185134.208054438, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2177677015436981, "mean_inference_ms": 0.37224007568830086, "mean_action_processing_ms": 0.09106986199271806, "mean_env_wait_ms": 0.7739080528173454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037188000149197048, "StateBufferConnector_ms": 0.002685917748345269, "ViewRequirementAgentConnector_ms": 0.06729470358954535}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185134.208054438, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2177677015436981, "mean_inference_ms": 0.37224007568830086, "mean_action_processing_ms": 0.09106986199271806, "mean_env_wait_ms": 0.7739080528173454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037188000149197048, "StateBufferConnector_ms": 0.002685917748345269, "ViewRequirementAgentConnector_ms": 0.06729470358954535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39567360, "num_agent_steps_trained": 39567360, "num_env_steps_sampled": 39567360, "num_env_steps_trained": 39567360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 648.3813564583719, "num_env_steps_trained_throughput_per_sec": 648.3813564583719, "timesteps_total": 39567360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39567360, "timers": {"training_iteration_time_ms": 65809.265, "sample_time_ms": 64624.098, "load_time_ms": 19.336, "load_throughput": 2271370.57, "learn_time_ms": 1164.543, "learn_throughput": 37714.381, "synch_weights_time_ms": 1.122}, "counters": {"num_env_steps_sampled": 39567360, "num_env_steps_trained": 39567360, "num_agent_steps_sampled": 39567360, "num_agent_steps_trained": 39567360}, "done": false, "episodes_total": 9074, "training_iteration": 2811, "trial_id": "11c4c_00000", "date": "2023-08-07_10-56-00", "timestamp": 1691394960, "time_this_iter_s": 67.74126386642456, "time_total_s": 69680.94865965843, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5910.537371397018, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 26.377319587628865, "ram_util_percent": 73.97628865979382}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.91425672703514, "policy_loss": -7036462.265232097, "vf_loss": 6116618.627186589}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 62083.5, "diff_num_grad_updates_vs_sampler_policy": 62082.5}}, "num_env_steps_sampled": 39611280, "num_env_steps_trained": 39611280, "num_agent_steps_sampled": 39611280, "num_agent_steps_trained": 39611280}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185072.801158041, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21778453527238706, "mean_inference_ms": 0.3722704797559487, "mean_action_processing_ms": 0.09107464679395826, "mean_env_wait_ms": 0.7737853861261091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037101598886343148, "StateBufferConnector_ms": 0.0026839120047433035, "ViewRequirementAgentConnector_ms": 0.06728932097717956}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185072.801158041, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21778453527238706, "mean_inference_ms": 0.3722704797559487, "mean_action_processing_ms": 0.09107464679395826, "mean_env_wait_ms": 0.7737853861261091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037101598886343148, "StateBufferConnector_ms": 0.0026839120047433035, "ViewRequirementAgentConnector_ms": 0.06728932097717956}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39611280, "num_agent_steps_trained": 39611280, "num_env_steps_sampled": 39611280, "num_env_steps_trained": 39611280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 676.3496994391037, "num_env_steps_trained_throughput_per_sec": 676.3496994391037, "timesteps_total": 39611280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39611280, "timers": {"training_iteration_time_ms": 65947.773, "sample_time_ms": 64756.122, "load_time_ms": 19.312, "load_throughput": 2274261.682, "learn_time_ms": 1171.038, "learn_throughput": 37505.197, "synch_weights_time_ms": 1.129}, "counters": {"num_env_steps_sampled": 39611280, "num_env_steps_trained": 39611280, "num_agent_steps_sampled": 39611280, "num_agent_steps_trained": 39611280}, "done": false, "episodes_total": 9075, "training_iteration": 2812, "trial_id": "11c4c_00000", "date": "2023-08-07_10-57-05", "timestamp": 1691395025, "time_this_iter_s": 64.94006323814392, "time_total_s": 69745.88872289658, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5975.477434635162, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 23.323913043478257, "ram_util_percent": 74.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.0319164932296, "policy_loss": -7291766.938641695, "vf_loss": 6176517.171465015}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 62769.5, "diff_num_grad_updates_vs_sampler_policy": 62768.5}}, "num_env_steps_sampled": 39655200, "num_env_steps_trained": 39655200, "num_agent_steps_sampled": 39655200, "num_agent_steps_trained": 39655200}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185014.60075536152, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2178008131435496, "mean_inference_ms": 0.37230038846866764, "mean_action_processing_ms": 0.09107926174661622, "mean_env_wait_ms": 0.7736616533358693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706372302511464, "StateBufferConnector_ms": 0.0026827273161514945, "ViewRequirementAgentConnector_ms": 0.06726073182147482}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -185014.60075536152, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2178008131435496, "mean_inference_ms": 0.37230038846866764, "mean_action_processing_ms": 0.09107926174661622, "mean_env_wait_ms": 0.7736616533358693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706372302511464, "StateBufferConnector_ms": 0.0026827273161514945, "ViewRequirementAgentConnector_ms": 0.06726073182147482}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39655200, "num_agent_steps_trained": 39655200, "num_env_steps_sampled": 39655200, "num_env_steps_trained": 39655200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 683.7249709244776, "num_env_steps_trained_throughput_per_sec": 683.7249709244776, "timesteps_total": 39655200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39655200, "timers": {"training_iteration_time_ms": 65971.737, "sample_time_ms": 64786.17, "load_time_ms": 19.829, "load_throughput": 2214984.431, "learn_time_ms": 1164.415, "learn_throughput": 37718.509, "synch_weights_time_ms": 1.144}, "counters": {"num_env_steps_sampled": 39655200, "num_env_steps_trained": 39655200, "num_agent_steps_sampled": 39655200, "num_agent_steps_trained": 39655200}, "done": false, "episodes_total": 9076, "training_iteration": 2813, "trial_id": "11c4c_00000", "date": "2023-08-07_10-58-10", "timestamp": 1691395090, "time_this_iter_s": 64.2397711277008, "time_total_s": 69810.12849402428, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6039.717205762863, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 23.215384615384615, "ram_util_percent": 73.69230769230771}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.85324399186294, "policy_loss": -8025084.470691737, "vf_loss": 6248977.2233965015}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 63455.5, "diff_num_grad_updates_vs_sampler_policy": 63454.5}}, "num_env_steps_sampled": 39699120, "num_env_steps_trained": 39699120, "num_agent_steps_sampled": 39699120, "num_agent_steps_trained": 39699120}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184973.29869301667, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21781845245409384, "mean_inference_ms": 0.37233487929929593, "mean_action_processing_ms": 0.09108473864452767, "mean_env_wait_ms": 0.773546416684188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00370087162140877, "StateBufferConnector_ms": 0.0026807990125430527, "ViewRequirementAgentConnector_ms": 0.06722839929724253}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184973.29869301667, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21781845245409384, "mean_inference_ms": 0.37233487929929593, "mean_action_processing_ms": 0.09108473864452767, "mean_env_wait_ms": 0.773546416684188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00370087162140877, "StateBufferConnector_ms": 0.0026807990125430527, "ViewRequirementAgentConnector_ms": 0.06722839929724253}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39699120, "num_agent_steps_trained": 39699120, "num_env_steps_sampled": 39699120, "num_env_steps_trained": 39699120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 619.6697386085174, "num_env_steps_trained_throughput_per_sec": 619.6697386085174, "timesteps_total": 39699120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39699120, "timers": {"training_iteration_time_ms": 66637.337, "sample_time_ms": 65452.318, "load_time_ms": 19.982, "load_throughput": 2198017.061, "learn_time_ms": 1163.712, "learn_throughput": 37741.281, "synch_weights_time_ms": 1.146}, "counters": {"num_env_steps_sampled": 39699120, "num_env_steps_trained": 39699120, "num_agent_steps_sampled": 39699120, "num_agent_steps_trained": 39699120}, "done": false, "episodes_total": 9077, "training_iteration": 2814, "trial_id": "11c4c_00000", "date": "2023-08-07_10-59-21", "timestamp": 1691395161, "time_this_iter_s": 70.87929701805115, "time_total_s": 69881.00779104233, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6110.596502780914, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 28.779207920792082, "ram_util_percent": 73.64059405940593}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.90334727117687, "policy_loss": -7630148.367139099, "vf_loss": 6363973.045918368}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 64141.5, "diff_num_grad_updates_vs_sampler_policy": 64140.5}}, "num_env_steps_sampled": 39743040, "num_env_steps_trained": 39743040, "num_agent_steps_sampled": 39743040, "num_agent_steps_trained": 39743040}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184940.89604671078, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2178356123466499, "mean_inference_ms": 0.3723689073226868, "mean_action_processing_ms": 0.09109014217606695, "mean_env_wait_ms": 0.7734313527203641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00369675616000561, "StateBufferConnector_ms": 0.0026847453827553605, "ViewRequirementAgentConnector_ms": 0.06723860476879363}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184940.89604671078, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2178356123466499, "mean_inference_ms": 0.3723689073226868, "mean_action_processing_ms": 0.09109014217606695, "mean_env_wait_ms": 0.7734313527203641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00369675616000561, "StateBufferConnector_ms": 0.0026847453827553605, "ViewRequirementAgentConnector_ms": 0.06723860476879363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39743040, "num_agent_steps_trained": 39743040, "num_env_steps_sampled": 39743040, "num_env_steps_trained": 39743040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 675.8395879510709, "num_env_steps_trained_throughput_per_sec": 675.8395879510709, "timesteps_total": 39743040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39743040, "timers": {"training_iteration_time_ms": 66634.102, "sample_time_ms": 65453.49, "load_time_ms": 19.684, "load_throughput": 2231215.433, "learn_time_ms": 1159.594, "learn_throughput": 37875.313, "synch_weights_time_ms": 1.15}, "counters": {"num_env_steps_sampled": 39743040, "num_env_steps_trained": 39743040, "num_agent_steps_sampled": 39743040, "num_agent_steps_trained": 39743040}, "done": false, "episodes_total": 9078, "training_iteration": 2815, "trial_id": "11c4c_00000", "date": "2023-08-07_11-00-26", "timestamp": 1691395226, "time_this_iter_s": 64.98888397216797, "time_total_s": 69945.9966750145, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6175.585386753082, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 23.796774193548387, "ram_util_percent": 73.46451612903223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8723696605805, "policy_loss": -7743580.575665087, "vf_loss": 6267095.501457726}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 64827.5, "diff_num_grad_updates_vs_sampler_policy": 64826.5}}, "num_env_steps_sampled": 39786960, "num_env_steps_trained": 39786960, "num_agent_steps_sampled": 39786960, "num_agent_steps_trained": 39786960}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184902.42631115258, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2178525863735234, "mean_inference_ms": 0.37240238173393647, "mean_action_processing_ms": 0.09109548772198423, "mean_env_wait_ms": 0.7733139620780561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036934802406712584, "StateBufferConnector_ms": 0.0026863499691611842, "ViewRequirementAgentConnector_ms": 0.06721622065493935}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184902.42631115258, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2178525863735234, "mean_inference_ms": 0.37240238173393647, "mean_action_processing_ms": 0.09109548772198423, "mean_env_wait_ms": 0.7733139620780561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036934802406712584, "StateBufferConnector_ms": 0.0026863499691611842, "ViewRequirementAgentConnector_ms": 0.06721622065493935}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39786960, "num_agent_steps_trained": 39786960, "num_env_steps_sampled": 39786960, "num_env_steps_trained": 39786960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 684.7357935490294, "num_env_steps_trained_throughput_per_sec": 684.7357935490294, "timesteps_total": 39786960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39786960, "timers": {"training_iteration_time_ms": 66429.692, "sample_time_ms": 65229.045, "load_time_ms": 19.453, "load_throughput": 2257801.905, "learn_time_ms": 1179.84, "learn_throughput": 37225.381, "synch_weights_time_ms": 1.165}, "counters": {"num_env_steps_sampled": 39786960, "num_env_steps_trained": 39786960, "num_agent_steps_sampled": 39786960, "num_agent_steps_trained": 39786960}, "done": false, "episodes_total": 9079, "training_iteration": 2816, "trial_id": "11c4c_00000", "date": "2023-08-07_11-01-30", "timestamp": 1691395290, "time_this_iter_s": 64.14599514007568, "time_total_s": 70010.14267015457, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6239.731381893158, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 28.024175824175828, "ram_util_percent": 73.70989010989011}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9799583145898, "policy_loss": -7455709.504162491, "vf_loss": 6236947.458090379}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 65513.5, "diff_num_grad_updates_vs_sampler_policy": 65512.5}}, "num_env_steps_sampled": 39830880, "num_env_steps_trained": 39830880, "num_agent_steps_sampled": 39830880, "num_agent_steps_trained": 39830880}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184856.52906691618, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21787054852434848, "mean_inference_ms": 0.37243963292526666, "mean_action_processing_ms": 0.0911014817407868, "mean_env_wait_ms": 0.7732006695935167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003690520922342936, "StateBufferConnector_ms": 0.002685685952504476, "ViewRequirementAgentConnector_ms": 0.06729935606320699}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184856.52906691618, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21787054852434848, "mean_inference_ms": 0.37243963292526666, "mean_action_processing_ms": 0.0911014817407868, "mean_env_wait_ms": 0.7732006695935167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003690520922342936, "StateBufferConnector_ms": 0.002685685952504476, "ViewRequirementAgentConnector_ms": 0.06729935606320699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39830880, "num_agent_steps_trained": 39830880, "num_env_steps_sampled": 39830880, "num_env_steps_trained": 39830880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 636.0254907748167, "num_env_steps_trained_throughput_per_sec": 636.0254907748167, "timesteps_total": 39830880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39830880, "timers": {"training_iteration_time_ms": 66982.905, "sample_time_ms": 65780.403, "load_time_ms": 21.337, "load_throughput": 2058439.097, "learn_time_ms": 1179.815, "learn_throughput": 37226.173, "synch_weights_time_ms": 1.162}, "counters": {"num_env_steps_sampled": 39830880, "num_env_steps_trained": 39830880, "num_agent_steps_sampled": 39830880, "num_agent_steps_trained": 39830880}, "done": false, "episodes_total": 9080, "training_iteration": 2817, "trial_id": "11c4c_00000", "date": "2023-08-07_11-02-39", "timestamp": 1691395359, "time_this_iter_s": 69.05678176879883, "time_total_s": 70079.19945192337, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6308.788163661957, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 26.424489795918365, "ram_util_percent": 74.42040816326531}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.786955052145, "policy_loss": -7704429.87999385, "vf_loss": 6115550.085641399}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 66199.5, "diff_num_grad_updates_vs_sampler_policy": 66198.5}}, "num_env_steps_sampled": 39874800, "num_env_steps_trained": 39874800, "num_agent_steps_sampled": 39874800, "num_agent_steps_trained": 39874800}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184804.14485608775, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21788858821709012, "mean_inference_ms": 0.37247806728506727, "mean_action_processing_ms": 0.09110771099527482, "mean_env_wait_ms": 0.7730909191002011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036849189050418814, "StateBufferConnector_ms": 0.0026882309274575147, "ViewRequirementAgentConnector_ms": 0.0673419421481103}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184804.14485608775, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21788858821709012, "mean_inference_ms": 0.37247806728506727, "mean_action_processing_ms": 0.09110771099527482, "mean_env_wait_ms": 0.7730909191002011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036849189050418814, "StateBufferConnector_ms": 0.0026882309274575147, "ViewRequirementAgentConnector_ms": 0.0673419421481103}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39874800, "num_agent_steps_trained": 39874800, "num_env_steps_sampled": 39874800, "num_env_steps_trained": 39874800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 651.8643597458871, "num_env_steps_trained_throughput_per_sec": 651.8643597458871, "timesteps_total": 39874800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39874800, "timers": {"training_iteration_time_ms": 67414.975, "sample_time_ms": 66209.308, "load_time_ms": 23.762, "load_throughput": 1848354.332, "learn_time_ms": 1180.561, "learn_throughput": 37202.662, "synch_weights_time_ms": 1.158}, "counters": {"num_env_steps_sampled": 39874800, "num_env_steps_trained": 39874800, "num_agent_steps_sampled": 39874800, "num_agent_steps_trained": 39874800}, "done": false, "episodes_total": 9081, "training_iteration": 2818, "trial_id": "11c4c_00000", "date": "2023-08-07_11-03-46", "timestamp": 1691395426, "time_this_iter_s": 67.37883400917053, "time_total_s": 70146.57828593254, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6376.166997671127, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 25.457291666666663, "ram_util_percent": 74.37708333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.95639296106276, "policy_loss": -7358017.227846552, "vf_loss": 6190584.917274052}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 66885.5, "diff_num_grad_updates_vs_sampler_policy": 66884.5}}, "num_env_steps_sampled": 39918720, "num_env_steps_trained": 39918720, "num_agent_steps_sampled": 39918720, "num_agent_steps_trained": 39918720}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184756.02460480013, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2179080954436017, "mean_inference_ms": 0.37251744345188587, "mean_action_processing_ms": 0.0911142125139421, "mean_env_wait_ms": 0.7729821289427606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681620773004026, "StateBufferConnector_ms": 0.0026916971012037627, "ViewRequirementAgentConnector_ms": 0.06738390241350446}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184756.02460480013, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2179080954436017, "mean_inference_ms": 0.37251744345188587, "mean_action_processing_ms": 0.0911142125139421, "mean_env_wait_ms": 0.7729821289427606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681620773004026, "StateBufferConnector_ms": 0.0026916971012037627, "ViewRequirementAgentConnector_ms": 0.06738390241350446}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39918720, "num_agent_steps_trained": 39918720, "num_env_steps_sampled": 39918720, "num_env_steps_trained": 39918720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 654.7711001471845, "num_env_steps_trained_throughput_per_sec": 654.7711001471845, "timesteps_total": 39918720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39918720, "timers": {"training_iteration_time_ms": 67381.206, "sample_time_ms": 66180.553, "load_time_ms": 23.887, "load_throughput": 1838688.936, "learn_time_ms": 1175.193, "learn_throughput": 37372.582, "synch_weights_time_ms": 1.382}, "counters": {"num_env_steps_sampled": 39918720, "num_env_steps_trained": 39918720, "num_agent_steps_sampled": 39918720, "num_agent_steps_trained": 39918720}, "done": false, "episodes_total": 9082, "training_iteration": 2819, "trial_id": "11c4c_00000", "date": "2023-08-07_11-04-53", "timestamp": 1691395493, "time_this_iter_s": 67.08245182037354, "time_total_s": 70213.66073775291, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6443.249449491501, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 28.556842105263158, "ram_util_percent": 74.76421052631578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8410526642646, "policy_loss": -7525376.465330607, "vf_loss": 6275310.428753644}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 67571.5, "diff_num_grad_updates_vs_sampler_policy": 67570.5}}, "num_env_steps_sampled": 39962640, "num_env_steps_trained": 39962640, "num_agent_steps_sampled": 39962640, "num_agent_steps_trained": 39962640}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184722.5490636682, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21792756557463155, "mean_inference_ms": 0.37255684888064117, "mean_action_processing_ms": 0.09112079044507183, "mean_env_wait_ms": 0.7728755406213923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003679352577286537, "StateBufferConnector_ms": 0.0026946115975428108, "ViewRequirementAgentConnector_ms": 0.06742934988002584}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184722.5490636682, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21792756557463155, "mean_inference_ms": 0.37255684888064117, "mean_action_processing_ms": 0.09112079044507183, "mean_env_wait_ms": 0.7728755406213923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003679352577286537, "StateBufferConnector_ms": 0.0026946115975428108, "ViewRequirementAgentConnector_ms": 0.06742934988002584}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39962640, "num_agent_steps_trained": 39962640, "num_env_steps_sampled": 39962640, "num_env_steps_trained": 39962640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 661.3902637536909, "num_env_steps_trained_throughput_per_sec": 661.3902637536909, "timesteps_total": 39962640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 39962640, "timers": {"training_iteration_time_ms": 66682.693, "sample_time_ms": 65496.857, "load_time_ms": 24.636, "load_throughput": 1782773.734, "learn_time_ms": 1159.782, "learn_throughput": 37869.177, "synch_weights_time_ms": 1.208}, "counters": {"num_env_steps_sampled": 39962640, "num_env_steps_trained": 39962640, "num_agent_steps_sampled": 39962640, "num_agent_steps_trained": 39962640}, "done": false, "episodes_total": 9083, "training_iteration": 2820, "trial_id": "11c4c_00000", "date": "2023-08-07_11-06-00", "timestamp": 1691395560, "time_this_iter_s": 66.4093189239502, "time_total_s": 70280.07005667686, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6509.658768415451, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 25.075789473684207, "ram_util_percent": 75.69368421052633}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.82144004888505, "policy_loss": -7857725.575719182, "vf_loss": 6174320.581086006}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 68257.5, "diff_num_grad_updates_vs_sampler_policy": 68256.5}}, "num_env_steps_sampled": 40006560, "num_env_steps_trained": 40006560, "num_agent_steps_sampled": 40006560, "num_agent_steps_trained": 40006560}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184676.63979726605, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21794668755981814, "mean_inference_ms": 0.3725947438018637, "mean_action_processing_ms": 0.0911271254806598, "mean_env_wait_ms": 0.7727701481762856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036754608154296875, "StateBufferConnector_ms": 0.00269317626953125, "ViewRequirementAgentConnector_ms": 0.06740689277648926}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184676.63979726605, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189608.46149446574, -188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21794668755981814, "mean_inference_ms": 0.3725947438018637, "mean_action_processing_ms": 0.0911271254806598, "mean_env_wait_ms": 0.7727701481762856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036754608154296875, "StateBufferConnector_ms": 0.00269317626953125, "ViewRequirementAgentConnector_ms": 0.06740689277648926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40006560, "num_agent_steps_trained": 40006560, "num_env_steps_sampled": 40006560, "num_env_steps_trained": 40006560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 676.2468812244251, "num_env_steps_trained_throughput_per_sec": 676.2468812244251, "timesteps_total": 40006560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40006560, "timers": {"training_iteration_time_ms": 66403.571, "sample_time_ms": 65216.934, "load_time_ms": 25.023, "load_throughput": 1755181.366, "learn_time_ms": 1160.201, "learn_throughput": 37855.501, "synch_weights_time_ms": 1.201}, "counters": {"num_env_steps_sampled": 40006560, "num_env_steps_trained": 40006560, "num_agent_steps_sampled": 40006560, "num_agent_steps_trained": 40006560}, "done": false, "episodes_total": 9084, "training_iteration": 2821, "trial_id": "11c4c_00000", "date": "2023-08-07_11-07-05", "timestamp": 1691395625, "time_this_iter_s": 64.9495780467987, "time_total_s": 70345.01963472366, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6574.60834646225, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 21.518478260869564, "ram_util_percent": 74.92173913043477}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.92565446414335, "policy_loss": -7060879.8044825075, "vf_loss": 6311254.848305394}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 68943.5, "diff_num_grad_updates_vs_sampler_policy": 68942.5}}, "num_env_steps_sampled": 40050480, "num_env_steps_trained": 40050480, "num_agent_steps_sampled": 40050480, "num_agent_steps_trained": 40050480}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184591.9548058768, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21799062291528457, "mean_inference_ms": 0.3726471941672922, "mean_action_processing_ms": 0.09113957217504641, "mean_env_wait_ms": 0.7720267487713298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003675699234008789, "StateBufferConnector_ms": 0.0026917457580566406, "ViewRequirementAgentConnector_ms": 0.06742191314697266}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184591.9548058768, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-188491.8924627381, -188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21799062291528457, "mean_inference_ms": 0.3726471941672922, "mean_action_processing_ms": 0.09113957217504641, "mean_env_wait_ms": 0.7720267487713298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003675699234008789, "StateBufferConnector_ms": 0.0026917457580566406, "ViewRequirementAgentConnector_ms": 0.06742191314697266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40050480, "num_agent_steps_trained": 40050480, "num_env_steps_sampled": 40050480, "num_env_steps_trained": 40050480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 687.2877185847359, "num_env_steps_trained_throughput_per_sec": 687.2877185847359, "timesteps_total": 40050480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40050480, "timers": {"training_iteration_time_ms": 66300.226, "sample_time_ms": 65118.994, "load_time_ms": 25.494, "load_throughput": 1722762.907, "learn_time_ms": 1154.347, "learn_throughput": 38047.483, "synch_weights_time_ms": 1.187}, "counters": {"num_env_steps_sampled": 40050480, "num_env_steps_trained": 40050480, "num_agent_steps_sampled": 40050480, "num_agent_steps_trained": 40050480}, "done": false, "episodes_total": 9085, "training_iteration": 2822, "trial_id": "11c4c_00000", "date": "2023-08-07_11-08-09", "timestamp": 1691395689, "time_this_iter_s": 63.906404972076416, "time_total_s": 70408.92603969574, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6638.514751434326, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 21.8978021978022, "ram_util_percent": 74.43186813186813}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.929099525029, "policy_loss": -7593160.857441805, "vf_loss": 6272386.448797376}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 69629.5, "diff_num_grad_updates_vs_sampler_policy": 69628.5}}, "num_env_steps_sampled": 40094400, "num_env_steps_trained": 40094400, "num_agent_steps_sampled": 40094400, "num_agent_steps_trained": 40094400}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184518.82615853037, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21803211434402875, "mean_inference_ms": 0.3727355378276649, "mean_action_processing_ms": 0.09115545136892993, "mean_env_wait_ms": 0.7716163387003845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003675699234008789, "StateBufferConnector_ms": 0.0026960372924804688, "ViewRequirementAgentConnector_ms": 0.06746983528137207}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184518.82615853037, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-188289.94439385986, -188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21803211434402875, "mean_inference_ms": 0.3727355378276649, "mean_action_processing_ms": 0.09115545136892993, "mean_env_wait_ms": 0.7716163387003845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003675699234008789, "StateBufferConnector_ms": 0.0026960372924804688, "ViewRequirementAgentConnector_ms": 0.06746983528137207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40094400, "num_agent_steps_trained": 40094400, "num_env_steps_sampled": 40094400, "num_env_steps_trained": 40094400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 678.6320993305753, "num_env_steps_trained_throughput_per_sec": 678.6320993305753, "timesteps_total": 40094400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40094400, "timers": {"training_iteration_time_ms": 66348.433, "sample_time_ms": 65166.979, "load_time_ms": 25.872, "load_throughput": 1697560.485, "learn_time_ms": 1154.216, "learn_throughput": 38051.791, "synch_weights_time_ms": 1.168}, "counters": {"num_env_steps_sampled": 40094400, "num_env_steps_trained": 40094400, "num_agent_steps_sampled": 40094400, "num_agent_steps_trained": 40094400}, "done": false, "episodes_total": 9086, "training_iteration": 2823, "trial_id": "11c4c_00000", "date": "2023-08-07_11-09-13", "timestamp": 1691395753, "time_this_iter_s": 64.72132468223572, "time_total_s": 70473.64736437798, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6703.236076116562, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 22.91847826086957, "ram_util_percent": 74.46739130434784}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.88946542100376, "policy_loss": -6958881.084294711, "vf_loss": 6084407.754919825}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 70315.5, "diff_num_grad_updates_vs_sampler_policy": 70314.5}}, "num_env_steps_sampled": 40138320, "num_env_steps_trained": 40138320, "num_agent_steps_sampled": 40138320, "num_agent_steps_trained": 40138320}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184418.17447526357, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21807902369827428, "mean_inference_ms": 0.3728410818480956, "mean_action_processing_ms": 0.09117420715155054, "mean_env_wait_ms": 0.771295859661857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036742687225341797, "StateBufferConnector_ms": 0.0026977062225341797, "ViewRequirementAgentConnector_ms": 0.06748294830322266}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184418.17447526357, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-188395.10913611087, -190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21807902369827428, "mean_inference_ms": 0.3728410818480956, "mean_action_processing_ms": 0.09117420715155054, "mean_env_wait_ms": 0.771295859661857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036742687225341797, "StateBufferConnector_ms": 0.0026977062225341797, "ViewRequirementAgentConnector_ms": 0.06748294830322266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40138320, "num_agent_steps_trained": 40138320, "num_env_steps_sampled": 40138320, "num_env_steps_trained": 40138320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 675.2398770100028, "num_env_steps_trained_throughput_per_sec": 675.2398770100028, "timesteps_total": 40138320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40138320, "timers": {"training_iteration_time_ms": 65765.142, "sample_time_ms": 64583.693, "load_time_ms": 26.544, "load_throughput": 1654620.209, "learn_time_ms": 1153.506, "learn_throughput": 38075.233, "synch_weights_time_ms": 1.198}, "counters": {"num_env_steps_sampled": 40138320, "num_env_steps_trained": 40138320, "num_agent_steps_sampled": 40138320, "num_agent_steps_trained": 40138320}, "done": false, "episodes_total": 9087, "training_iteration": 2824, "trial_id": "11c4c_00000", "date": "2023-08-07_11-10-19", "timestamp": 1691395819, "time_this_iter_s": 65.04662799835205, "time_total_s": 70538.69399237633, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6768.282704114914, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 23.80543478260869, "ram_util_percent": 74.82065217391305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8422329738606, "policy_loss": -7645696.628900556, "vf_loss": 6274050.59675656}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71001.5, "diff_num_grad_updates_vs_sampler_policy": 71000.5}}, "num_env_steps_sampled": 40182240, "num_env_steps_trained": 40182240, "num_agent_steps_sampled": 40182240, "num_agent_steps_trained": 40182240}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184345.64311726968, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21812373174137206, "mean_inference_ms": 0.3729444276296527, "mean_action_processing_ms": 0.09119312126904777, "mean_env_wait_ms": 0.7710154990099796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036716461181640625, "StateBufferConnector_ms": 0.0027010440826416016, "ViewRequirementAgentConnector_ms": 0.06746363639831543}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184345.64311726968, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-190104.72640469635, -187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21812373174137206, "mean_inference_ms": 0.3729444276296527, "mean_action_processing_ms": 0.09119312126904777, "mean_env_wait_ms": 0.7710154990099796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036716461181640625, "StateBufferConnector_ms": 0.0027010440826416016, "ViewRequirementAgentConnector_ms": 0.06746363639831543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40182240, "num_agent_steps_trained": 40182240, "num_env_steps_sampled": 40182240, "num_env_steps_trained": 40182240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 682.111110748646, "num_env_steps_trained_throughput_per_sec": 682.111110748646, "timesteps_total": 40182240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40182240, "timers": {"training_iteration_time_ms": 65705.392, "sample_time_ms": 64514.598, "load_time_ms": 27.849, "load_throughput": 1577074.649, "learn_time_ms": 1161.526, "learn_throughput": 37812.325, "synch_weights_time_ms": 1.211}, "counters": {"num_env_steps_sampled": 40182240, "num_env_steps_trained": 40182240, "num_agent_steps_sampled": 40182240, "num_agent_steps_trained": 40182240}, "done": false, "episodes_total": 9088, "training_iteration": 2825, "trial_id": "11c4c_00000", "date": "2023-08-07_11-11-23", "timestamp": 1691395883, "time_this_iter_s": 64.39138698577881, "time_total_s": 70603.0853793621, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6832.674091100693, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 22.17717391304348, "ram_util_percent": 74.7141304347826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.92670718712986, "policy_loss": -7879569.40769349, "vf_loss": 6277922.506559767}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71687.5, "diff_num_grad_updates_vs_sampler_policy": 71686.5}}, "num_env_steps_sampled": 40226160, "num_env_steps_trained": 40226160, "num_agent_steps_sampled": 40226160, "num_agent_steps_trained": 40226160}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184256.28901135354, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21816810555887972, "mean_inference_ms": 0.37305250769977666, "mean_action_processing_ms": 0.09121192155508386, "mean_env_wait_ms": 0.7707556039832326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003673553466796875, "StateBufferConnector_ms": 0.002702951431274414, "ViewRequirementAgentConnector_ms": 0.06745243072509766}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184256.28901135354, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-187766.29191046522, -188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21816810555887972, "mean_inference_ms": 0.37305250769977666, "mean_action_processing_ms": 0.09121192155508386, "mean_env_wait_ms": 0.7707556039832326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003673553466796875, "StateBufferConnector_ms": 0.002702951431274414, "ViewRequirementAgentConnector_ms": 0.06745243072509766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40226160, "num_agent_steps_trained": 40226160, "num_env_steps_sampled": 40226160, "num_env_steps_trained": 40226160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 673.9223472125049, "num_env_steps_trained_throughput_per_sec": 673.9223472125049, "timesteps_total": 40226160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40226160, "timers": {"training_iteration_time_ms": 65808.311, "sample_time_ms": 64638.024, "load_time_ms": 27.682, "load_throughput": 1586589.517, "learn_time_ms": 1141.208, "learn_throughput": 38485.549, "synch_weights_time_ms": 1.195}, "counters": {"num_env_steps_sampled": 40226160, "num_env_steps_trained": 40226160, "num_agent_steps_sampled": 40226160, "num_agent_steps_trained": 40226160}, "done": false, "episodes_total": 9089, "training_iteration": 2826, "trial_id": "11c4c_00000", "date": "2023-08-07_11-12-28", "timestamp": 1691395948, "time_this_iter_s": 65.17351913452148, "time_total_s": 70668.25889849663, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6897.847610235214, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 25.735869565217396, "ram_util_percent": 74.9141304347826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.84805822789497, "policy_loss": -7162588.2896831725, "vf_loss": 5995152.4271137025}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 72373.5, "diff_num_grad_updates_vs_sampler_policy": 72372.5}}, "num_env_steps_sampled": 40270080, "num_env_steps_trained": 40270080, "num_agent_steps_sampled": 40270080, "num_agent_steps_trained": 40270080}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184152.99501897156, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21821359987539496, "mean_inference_ms": 0.37315464643076085, "mean_action_processing_ms": 0.0912299284585885, "mean_env_wait_ms": 0.7705168734391924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687620162963867, "StateBufferConnector_ms": 0.0027112960815429688, "ViewRequirementAgentConnector_ms": 0.06765222549438477}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184152.99501897156, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-188761.73259223078, -187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21821359987539496, "mean_inference_ms": 0.37315464643076085, "mean_action_processing_ms": 0.0912299284585885, "mean_env_wait_ms": 0.7705168734391924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687620162963867, "StateBufferConnector_ms": 0.0027112960815429688, "ViewRequirementAgentConnector_ms": 0.06765222549438477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40270080, "num_agent_steps_trained": 40270080, "num_env_steps_sampled": 40270080, "num_env_steps_trained": 40270080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 655.9599360923645, "num_env_steps_trained_throughput_per_sec": 655.9599360923645, "timesteps_total": 40270080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40270080, "timers": {"training_iteration_time_ms": 65598.459, "sample_time_ms": 64416.957, "load_time_ms": 27.328, "load_throughput": 1607171.457, "learn_time_ms": 1152.737, "learn_throughput": 38100.619, "synch_weights_time_ms": 1.227}, "counters": {"num_env_steps_sampled": 40270080, "num_env_steps_trained": 40270080, "num_agent_steps_sampled": 40270080, "num_agent_steps_trained": 40270080}, "done": false, "episodes_total": 9090, "training_iteration": 2827, "trial_id": "11c4c_00000", "date": "2023-08-07_11-13-35", "timestamp": 1691396015, "time_this_iter_s": 66.95921015739441, "time_total_s": 70735.21810865402, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6964.806820392609, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 27.90416666666667, "ram_util_percent": 75.0875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9900366780362, "policy_loss": -6823717.935242233, "vf_loss": 6227921.496173469}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73059.5, "diff_num_grad_updates_vs_sampler_policy": 73058.5}}, "num_env_steps_sampled": 40314000, "num_env_steps_trained": 40314000, "num_agent_steps_sampled": 40314000, "num_agent_steps_trained": 40314000}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184070.64670030985, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21826307311587503, "mean_inference_ms": 0.3732669303365206, "mean_action_processing_ms": 0.09124982932916334, "mean_env_wait_ms": 0.770300142198626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003688335418701172, "StateBufferConnector_ms": 0.002711057662963867, "ViewRequirementAgentConnector_ms": 0.06767010688781738}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -184070.64670030985, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-187429.08669829488, -186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21826307311587503, "mean_inference_ms": 0.3732669303365206, "mean_action_processing_ms": 0.09124982932916334, "mean_env_wait_ms": 0.770300142198626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003688335418701172, "StateBufferConnector_ms": 0.002711057662963867, "ViewRequirementAgentConnector_ms": 0.06767010688781738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40314000, "num_agent_steps_trained": 40314000, "num_env_steps_sampled": 40314000, "num_env_steps_trained": 40314000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 667.3399036744356, "num_env_steps_trained_throughput_per_sec": 667.3399036744356, "timesteps_total": 40314000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40314000, "timers": {"training_iteration_time_ms": 65442.206, "sample_time_ms": 64262.307, "load_time_ms": 27.13, "load_throughput": 1618860.254, "learn_time_ms": 1151.084, "learn_throughput": 38155.353, "synch_weights_time_ms": 1.45}, "counters": {"num_env_steps_sampled": 40314000, "num_env_steps_trained": 40314000, "num_agent_steps_sampled": 40314000, "num_agent_steps_trained": 40314000}, "done": false, "episodes_total": 9091, "training_iteration": 2828, "trial_id": "11c4c_00000", "date": "2023-08-07_11-14-41", "timestamp": 1691396081, "time_this_iter_s": 65.81773328781128, "time_total_s": 70801.03584194183, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7030.62455368042, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 24.798924731182794, "ram_util_percent": 75.52580645161291}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8719465517094, "policy_loss": -7379975.208765146, "vf_loss": 6115391.15670554}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73745.5, "diff_num_grad_updates_vs_sampler_policy": 73744.5}}, "num_env_steps_sampled": 40357920, "num_env_steps_trained": 40357920, "num_agent_steps_sampled": 40357920, "num_agent_steps_trained": 40357920}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183983.06585273132, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21831359305549383, "mean_inference_ms": 0.37338294571487046, "mean_action_processing_ms": 0.09127061553017538, "mean_env_wait_ms": 0.7700947136352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036907196044921875, "StateBufferConnector_ms": 0.00270843505859375, "ViewRequirementAgentConnector_ms": 0.06775093078613281}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183983.06585273132, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-186914.0450234686, -184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21831359305549383, "mean_inference_ms": 0.37338294571487046, "mean_action_processing_ms": 0.09127061553017538, "mean_env_wait_ms": 0.7700947136352783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036907196044921875, "StateBufferConnector_ms": 0.00270843505859375, "ViewRequirementAgentConnector_ms": 0.06775093078613281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40357920, "num_agent_steps_trained": 40357920, "num_env_steps_sampled": 40357920, "num_env_steps_trained": 40357920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 696.2393808742322, "num_env_steps_trained_throughput_per_sec": 696.2393808742322, "timesteps_total": 40357920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40357920, "timers": {"training_iteration_time_ms": 65042.694, "sample_time_ms": 63866.036, "load_time_ms": 26.757, "load_throughput": 1641427.807, "learn_time_ms": 1148.443, "learn_throughput": 38243.07, "synch_weights_time_ms": 1.227}, "counters": {"num_env_steps_sampled": 40357920, "num_env_steps_trained": 40357920, "num_agent_steps_sampled": 40357920, "num_agent_steps_trained": 40357920}, "done": false, "episodes_total": 9092, "training_iteration": 2829, "trial_id": "11c4c_00000", "date": "2023-08-07_11-15-44", "timestamp": 1691396144, "time_this_iter_s": 63.08453893661499, "time_total_s": 70864.12038087845, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7093.709092617035, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 20.21333333333333, "ram_util_percent": 75.00444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8707752283391, "policy_loss": -7141055.114109762, "vf_loss": 5979693.542365161}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 74431.5, "diff_num_grad_updates_vs_sampler_policy": 74430.5}}, "num_env_steps_sampled": 40401840, "num_env_steps_trained": 40401840, "num_agent_steps_sampled": 40401840, "num_agent_steps_trained": 40401840}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183882.46674475088, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2183642759092171, "mean_inference_ms": 0.3734988296893224, "mean_action_processing_ms": 0.09129185628668235, "mean_env_wait_ms": 0.7698994124700476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036916732788085938, "StateBufferConnector_ms": 0.0027098655700683594, "ViewRequirementAgentConnector_ms": 0.06776714324951172}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183882.46674475088, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-184723.23919924293, -190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2183642759092171, "mean_inference_ms": 0.3734988296893224, "mean_action_processing_ms": 0.09129185628668235, "mean_env_wait_ms": 0.7698994124700476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036916732788085938, "StateBufferConnector_ms": 0.0027098655700683594, "ViewRequirementAgentConnector_ms": 0.06776714324951172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40401840, "num_agent_steps_trained": 40401840, "num_env_steps_sampled": 40401840, "num_env_steps_trained": 40401840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 685.2036198977207, "num_env_steps_trained_throughput_per_sec": 685.2036198977207, "timesteps_total": 40401840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40401840, "timers": {"training_iteration_time_ms": 64811.914, "sample_time_ms": 63629.017, "load_time_ms": 26.35, "load_throughput": 1666785.785, "learn_time_ms": 1155.123, "learn_throughput": 38021.909, "synch_weights_time_ms": 1.211}, "counters": {"num_env_steps_sampled": 40401840, "num_env_steps_trained": 40401840, "num_agent_steps_sampled": 40401840, "num_agent_steps_trained": 40401840}, "done": false, "episodes_total": 9093, "training_iteration": 2830, "trial_id": "11c4c_00000", "date": "2023-08-07_11-16-48", "timestamp": 1691396208, "time_this_iter_s": 64.10062432289124, "time_total_s": 70928.22100520134, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7157.809716939926, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 24.186813186813183, "ram_util_percent": 75.6054945054945}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.0056923290731, "policy_loss": -7629680.021939915, "vf_loss": 6555042.603498543}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75117.5, "diff_num_grad_updates_vs_sampler_policy": 75116.5}}, "num_env_steps_sampled": 40445760, "num_env_steps_trained": 40445760, "num_agent_steps_sampled": 40445760, "num_agent_steps_trained": 40445760}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183877.3601958201, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21841657657948813, "mean_inference_ms": 0.37361958470431617, "mean_action_processing_ms": 0.09131384044003514, "mean_env_wait_ms": 0.7697193629410836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036878585815429688, "StateBufferConnector_ms": 0.0027120113372802734, "ViewRequirementAgentConnector_ms": 0.06777143478393555}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183877.3601958201, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-190122.64899743997, -186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21841657657948813, "mean_inference_ms": 0.37361958470431617, "mean_action_processing_ms": 0.09131384044003514, "mean_env_wait_ms": 0.7697193629410836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036878585815429688, "StateBufferConnector_ms": 0.0027120113372802734, "ViewRequirementAgentConnector_ms": 0.06777143478393555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40445760, "num_agent_steps_trained": 40445760, "num_env_steps_sampled": 40445760, "num_env_steps_trained": 40445760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 662.4590859469545, "num_env_steps_trained_throughput_per_sec": 662.4590859469545, "timesteps_total": 40445760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40445760, "timers": {"training_iteration_time_ms": 64947.088, "sample_time_ms": 63758.395, "load_time_ms": 27.211, "load_throughput": 1614065.955, "learn_time_ms": 1160.021, "learn_throughput": 37861.377, "synch_weights_time_ms": 1.242}, "counters": {"num_env_steps_sampled": 40445760, "num_env_steps_trained": 40445760, "num_agent_steps_sampled": 40445760, "num_agent_steps_trained": 40445760}, "done": false, "episodes_total": 9094, "training_iteration": 2831, "trial_id": "11c4c_00000", "date": "2023-08-07_11-17-55", "timestamp": 1691396275, "time_this_iter_s": 66.30203485488892, "time_total_s": 70994.52304005623, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7224.111751794815, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 27.30851063829787, "ram_util_percent": 74.86595744680851}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.91251535665884, "policy_loss": -6091402.9934630105, "vf_loss": 5945371.952441691}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75803.5, "diff_num_grad_updates_vs_sampler_policy": 75802.5}}, "num_env_steps_sampled": 40489680, "num_env_steps_trained": 40489680, "num_agent_steps_sampled": 40489680, "num_agent_steps_trained": 40489680}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183740.59149267475, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21847127022160412, "mean_inference_ms": 0.3737444132213912, "mean_action_processing_ms": 0.09133651829390946, "mean_env_wait_ms": 0.76954615451305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687143325805664, "StateBufferConnector_ms": 0.002713441848754883, "ViewRequirementAgentConnector_ms": 0.06777548789978027}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183740.59149267475, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-186042.6021146306, -188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21847127022160412, "mean_inference_ms": 0.3737444132213912, "mean_action_processing_ms": 0.09133651829390946, "mean_env_wait_ms": 0.76954615451305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687143325805664, "StateBufferConnector_ms": 0.002713441848754883, "ViewRequirementAgentConnector_ms": 0.06777548789978027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40489680, "num_agent_steps_trained": 40489680, "num_env_steps_sampled": 40489680, "num_env_steps_trained": 40489680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 652.9870422820786, "num_env_steps_trained_throughput_per_sec": 652.9870422820786, "timesteps_total": 40489680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40489680, "timers": {"training_iteration_time_ms": 65282.76, "sample_time_ms": 64092.656, "load_time_ms": 28.311, "load_throughput": 1551322.708, "learn_time_ms": 1160.267, "learn_throughput": 37853.346, "synch_weights_time_ms": 1.286}, "counters": {"num_env_steps_sampled": 40489680, "num_env_steps_trained": 40489680, "num_agent_steps_sampled": 40489680, "num_agent_steps_trained": 40489680}, "done": false, "episodes_total": 9095, "training_iteration": 2832, "trial_id": "11c4c_00000", "date": "2023-08-07_11-19-02", "timestamp": 1691396342, "time_this_iter_s": 67.26374888420105, "time_total_s": 71061.78678894043, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7291.375500679016, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 28.996875, "ram_util_percent": 74.484375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.93792648982725, "policy_loss": -7053337.663908755, "vf_loss": 6059005.148141399}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 76489.5, "diff_num_grad_updates_vs_sampler_policy": 76488.5}}, "num_env_steps_sampled": 40533600, "num_env_steps_trained": 40533600, "num_agent_steps_sampled": 40533600, "num_agent_steps_trained": 40533600}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183658.73561688975, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2185281981576134, "mean_inference_ms": 0.3738723277396614, "mean_action_processing_ms": 0.09135986083175447, "mean_env_wait_ms": 0.7693771167777349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036869049072265625, "StateBufferConnector_ms": 0.0027124881744384766, "ViewRequirementAgentConnector_ms": 0.06780600547790527}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183658.73561688975, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-188703.08933549558, -187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2185281981576134, "mean_inference_ms": 0.3738723277396614, "mean_action_processing_ms": 0.09135986083175447, "mean_env_wait_ms": 0.7693771167777349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036869049072265625, "StateBufferConnector_ms": 0.0027124881744384766, "ViewRequirementAgentConnector_ms": 0.06780600547790527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40533600, "num_agent_steps_trained": 40533600, "num_env_steps_sampled": 40533600, "num_env_steps_trained": 40533600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 698.4461603486876, "num_env_steps_trained_throughput_per_sec": 698.4461603486876, "timesteps_total": 40533600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40533600, "timers": {"training_iteration_time_ms": 65099.162, "sample_time_ms": 63905.574, "load_time_ms": 27.572, "load_throughput": 1592901.758, "learn_time_ms": 1164.49, "learn_throughput": 37716.087, "synch_weights_time_ms": 1.287}, "counters": {"num_env_steps_sampled": 40533600, "num_env_steps_trained": 40533600, "num_agent_steps_sampled": 40533600, "num_agent_steps_trained": 40533600}, "done": false, "episodes_total": 9096, "training_iteration": 2833, "trial_id": "11c4c_00000", "date": "2023-08-07_11-20-05", "timestamp": 1691396405, "time_this_iter_s": 62.885282039642334, "time_total_s": 71124.67207098007, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7354.260782718658, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 21.17752808988764, "ram_util_percent": 74.4685393258427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.03156433995196, "policy_loss": -6482667.006616709, "vf_loss": 6091961.341290087}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 77175.5, "diff_num_grad_updates_vs_sampler_policy": 77174.5}}, "num_env_steps_sampled": 40577520, "num_env_steps_trained": 40577520, "num_agent_steps_sampled": 40577520, "num_agent_steps_trained": 40577520}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183558.46118845028, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2185850042609856, "mean_inference_ms": 0.37400339218510864, "mean_action_processing_ms": 0.09138362118631267, "mean_env_wait_ms": 0.7692235404948177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036878585815429688, "StateBufferConnector_ms": 0.002706289291381836, "ViewRequirementAgentConnector_ms": 0.06780529022216797}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183558.46118845028, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-187699.27657172334, -189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2185850042609856, "mean_inference_ms": 0.37400339218510864, "mean_action_processing_ms": 0.09138362118631267, "mean_env_wait_ms": 0.7692235404948177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036878585815429688, "StateBufferConnector_ms": 0.002706289291381836, "ViewRequirementAgentConnector_ms": 0.06780529022216797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40577520, "num_agent_steps_trained": 40577520, "num_env_steps_sampled": 40577520, "num_env_steps_trained": 40577520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 668.4355159453752, "num_env_steps_trained_throughput_per_sec": 668.4355159453752, "timesteps_total": 40577520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40577520, "timers": {"training_iteration_time_ms": 65165.373, "sample_time_ms": 63971.199, "load_time_ms": 27.123, "load_throughput": 1619265.809, "learn_time_ms": 1165.557, "learn_throughput": 37681.542, "synch_weights_time_ms": 1.253}, "counters": {"num_env_steps_sampled": 40577520, "num_env_steps_trained": 40577520, "num_agent_steps_sampled": 40577520, "num_agent_steps_trained": 40577520}, "done": false, "episodes_total": 9097, "training_iteration": 2834, "trial_id": "11c4c_00000", "date": "2023-08-07_11-21-11", "timestamp": 1691396471, "time_this_iter_s": 65.70863103866577, "time_total_s": 71190.38070201874, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7419.969413757324, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 25.310638297872337, "ram_util_percent": 74.4744680851064}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.312500000000001e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8385477316275, "policy_loss": -7101606.26451747, "vf_loss": 6222773.060860058}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 77861.5, "diff_num_grad_updates_vs_sampler_policy": 77860.5}}, "num_env_steps_sampled": 40621440, "num_env_steps_trained": 40621440, "num_agent_steps_sampled": 40621440, "num_agent_steps_trained": 40621440}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183483.83623010945, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21864309830997938, "mean_inference_ms": 0.3741357916927428, "mean_action_processing_ms": 0.09140745868249828, "mean_env_wait_ms": 0.7690740690198611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696918487548828, "StateBufferConnector_ms": 0.0027141571044921875, "ViewRequirementAgentConnector_ms": 0.06788372993469238}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183483.83623010945, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189499.95988336185, -189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21864309830997938, "mean_inference_ms": 0.3741357916927428, "mean_action_processing_ms": 0.09140745868249828, "mean_env_wait_ms": 0.7690740690198611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696918487548828, "StateBufferConnector_ms": 0.0027141571044921875, "ViewRequirementAgentConnector_ms": 0.06788372993469238}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40621440, "num_agent_steps_trained": 40621440, "num_env_steps_sampled": 40621440, "num_env_steps_trained": 40621440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 664.4944632288511, "num_env_steps_trained_throughput_per_sec": 664.4944632288511, "timesteps_total": 40621440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40621440, "timers": {"training_iteration_time_ms": 65336.072, "sample_time_ms": 64149.511, "load_time_ms": 27.734, "load_throughput": 1583618.871, "learn_time_ms": 1157.244, "learn_throughput": 37952.235, "synch_weights_time_ms": 1.329}, "counters": {"num_env_steps_sampled": 40621440, "num_env_steps_trained": 40621440, "num_agent_steps_sampled": 40621440, "num_agent_steps_trained": 40621440}, "done": false, "episodes_total": 9098, "training_iteration": 2835, "trial_id": "11c4c_00000", "date": "2023-08-07_11-22-17", "timestamp": 1691396537, "time_this_iter_s": 66.0994188785553, "time_total_s": 71256.4801208973, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7486.0688326358795, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 27.619148936170212, "ram_util_percent": 75.57978723404257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1250000000000007e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.85279152205663, "policy_loss": -6713254.373661853, "vf_loss": 6209977.057944606}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 78547.5, "diff_num_grad_updates_vs_sampler_policy": 78546.5}}, "num_env_steps_sampled": 40665360, "num_env_steps_trained": 40665360, "num_agent_steps_sampled": 40665360, "num_agent_steps_trained": 40665360}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183390.5305554647, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21870155875554556, "mean_inference_ms": 0.3742673811717192, "mean_action_processing_ms": 0.09143125677585871, "mean_env_wait_ms": 0.7689297618213221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696441650390625, "StateBufferConnector_ms": 0.0027153491973876953, "ViewRequirementAgentConnector_ms": 0.06786274909973145}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183390.5305554647, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189240.57774436002, -188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21870155875554556, "mean_inference_ms": 0.3742673811717192, "mean_action_processing_ms": 0.09143125677585871, "mean_env_wait_ms": 0.7689297618213221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696441650390625, "StateBufferConnector_ms": 0.0027153491973876953, "ViewRequirementAgentConnector_ms": 0.06786274909973145}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40665360, "num_agent_steps_trained": 40665360, "num_env_steps_sampled": 40665360, "num_env_steps_trained": 40665360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 701.3506240364006, "num_env_steps_trained_throughput_per_sec": 701.3506240364006, "timesteps_total": 40665360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40665360, "timers": {"training_iteration_time_ms": 65081.204, "sample_time_ms": 63893.655, "load_time_ms": 27.629, "load_throughput": 1589637.17, "learn_time_ms": 1158.333, "learn_throughput": 37916.563, "synch_weights_time_ms": 1.332}, "counters": {"num_env_steps_sampled": 40665360, "num_env_steps_trained": 40665360, "num_agent_steps_sampled": 40665360, "num_agent_steps_trained": 40665360}, "done": false, "episodes_total": 9099, "training_iteration": 2836, "trial_id": "11c4c_00000", "date": "2023-08-07_11-23-19", "timestamp": 1691396599, "time_this_iter_s": 62.624995946884155, "time_total_s": 71319.10511684418, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7548.693828582764, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 22.320224719101123, "ram_util_percent": 75.96741573033707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9375000000000003e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.95494978212406, "policy_loss": -6103357.277733806, "vf_loss": 6113162.203717201}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 79233.5, "diff_num_grad_updates_vs_sampler_policy": 79232.5}}, "num_env_steps_sampled": 40709280, "num_env_steps_trained": 40709280, "num_agent_steps_sampled": 40709280, "num_agent_steps_trained": 40709280}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183278.76797922776, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21875970934820008, "mean_inference_ms": 0.3743972235322285, "mean_action_processing_ms": 0.09145478487334727, "mean_env_wait_ms": 0.7687898715933373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036957263946533203, "StateBufferConnector_ms": 0.0027163028717041016, "ViewRequirementAgentConnector_ms": 0.0678412914276123}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183278.76797922776, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-188764.89464812848, -189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21875970934820008, "mean_inference_ms": 0.3743972235322285, "mean_action_processing_ms": 0.09145478487334727, "mean_env_wait_ms": 0.7687898715933373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036957263946533203, "StateBufferConnector_ms": 0.0027163028717041016, "ViewRequirementAgentConnector_ms": 0.0678412914276123}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40709280, "num_agent_steps_trained": 40709280, "num_env_steps_sampled": 40709280, "num_env_steps_trained": 40709280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 699.4936633936087, "num_env_steps_trained_throughput_per_sec": 699.4936633936087, "timesteps_total": 40709280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40709280, "timers": {"training_iteration_time_ms": 64664.5, "sample_time_ms": 63490.669, "load_time_ms": 26.188, "load_throughput": 1677127.426, "learn_time_ms": 1146.095, "learn_throughput": 38321.434, "synch_weights_time_ms": 1.302}, "counters": {"num_env_steps_sampled": 40709280, "num_env_steps_trained": 40709280, "num_agent_steps_sampled": 40709280, "num_agent_steps_trained": 40709280}, "done": false, "episodes_total": 9100, "training_iteration": 2837, "trial_id": "11c4c_00000", "date": "2023-08-07_11-24-22", "timestamp": 1691396662, "time_this_iter_s": 62.791393995285034, "time_total_s": 71381.89651083946, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7611.485222578049, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 20.331460674157302, "ram_util_percent": 75.37752808988765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.75e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.77711179861177, "policy_loss": -7106961.71326075, "vf_loss": 6200462.56933309}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 79919.5, "diff_num_grad_updates_vs_sampler_policy": 79918.5}}, "num_env_steps_sampled": 40753200, "num_env_steps_trained": 40753200, "num_agent_steps_sampled": 40753200, "num_agent_steps_trained": 40753200}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183197.01323755604, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21881718300421696, "mean_inference_ms": 0.37452571500130155, "mean_action_processing_ms": 0.09147786686640433, "mean_env_wait_ms": 0.7686511666492991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0027196407318115234, "ViewRequirementAgentConnector_ms": 0.0680239200592041}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183197.01323755604, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189792.85287229446, -188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21881718300421696, "mean_inference_ms": 0.37452571500130155, "mean_action_processing_ms": 0.09147786686640433, "mean_env_wait_ms": 0.7686511666492991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.0027196407318115234, "ViewRequirementAgentConnector_ms": 0.0680239200592041}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40753200, "num_agent_steps_trained": 40753200, "num_env_steps_sampled": 40753200, "num_env_steps_trained": 40753200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 673.8065621153953, "num_env_steps_trained_throughput_per_sec": 673.8065621153953, "timesteps_total": 40753200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40753200, "timers": {"training_iteration_time_ms": 64601.346, "sample_time_ms": 63426.509, "load_time_ms": 25.653, "load_throughput": 1712057.872, "learn_time_ms": 1147.877, "learn_throughput": 38261.956, "synch_weights_time_ms": 1.085}, "counters": {"num_env_steps_sampled": 40753200, "num_env_steps_trained": 40753200, "num_agent_steps_sampled": 40753200, "num_agent_steps_trained": 40753200}, "done": false, "episodes_total": 9101, "training_iteration": 2838, "trial_id": "11c4c_00000", "date": "2023-08-07_11-25-27", "timestamp": 1691396727, "time_this_iter_s": 65.18493890762329, "time_total_s": 71447.08144974709, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7676.670161485672, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 23.253763440860215, "ram_util_percent": 75.81935483870967}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5624999999999997e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8430874215618, "policy_loss": -7406632.538299471, "vf_loss": 6234372.88784621}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 80605.5, "diff_num_grad_updates_vs_sampler_policy": 80604.5}}, "num_env_steps_sampled": 40797120, "num_env_steps_trained": 40797120, "num_agent_steps_sampled": 40797120, "num_agent_steps_trained": 40797120}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183102.8761701329, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21887319719484954, "mean_inference_ms": 0.37464845751936315, "mean_action_processing_ms": 0.09149983937564535, "mean_env_wait_ms": 0.7685104667107726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037088394165039062, "StateBufferConnector_ms": 0.002719402313232422, "ViewRequirementAgentConnector_ms": 0.0680239200592041}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183102.8761701329, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-188090.73553897813, -190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21887319719484954, "mean_inference_ms": 0.37464845751936315, "mean_action_processing_ms": 0.09149983937564535, "mean_env_wait_ms": 0.7685104667107726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037088394165039062, "StateBufferConnector_ms": 0.002719402313232422, "ViewRequirementAgentConnector_ms": 0.0680239200592041}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40797120, "num_agent_steps_trained": 40797120, "num_env_steps_sampled": 40797120, "num_env_steps_trained": 40797120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 694.2139250349423, "num_env_steps_trained_throughput_per_sec": 694.2139250349423, "timesteps_total": 40797120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40797120, "timers": {"training_iteration_time_ms": 64619.751, "sample_time_ms": 63448.07, "load_time_ms": 25.641, "load_throughput": 1712904.789, "learn_time_ms": 1144.731, "learn_throughput": 38367.092, "synch_weights_time_ms": 1.088}, "counters": {"num_env_steps_sampled": 40797120, "num_env_steps_trained": 40797120, "num_agent_steps_sampled": 40797120, "num_agent_steps_trained": 40797120}, "done": false, "episodes_total": 9102, "training_iteration": 2839, "trial_id": "11c4c_00000", "date": "2023-08-07_11-26-31", "timestamp": 1691396791, "time_this_iter_s": 63.268672943115234, "time_total_s": 71510.3501226902, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7739.938834428787, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 19.277528089887642, "ram_util_percent": 75.79775280898875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3750000000000003e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9785792848459, "policy_loss": -6644102.2436993215, "vf_loss": 6093628.8159620995}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 81291.5, "diff_num_grad_updates_vs_sampler_policy": 81290.5}}, "num_env_steps_sampled": 40841040, "num_env_steps_trained": 40841040, "num_agent_steps_sampled": 40841040, "num_agent_steps_trained": 40841040}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183003.37928133062, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21892949555857272, "mean_inference_ms": 0.37477049801464096, "mean_action_processing_ms": 0.09152178442235226, "mean_env_wait_ms": 0.7683728477041205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706216812133789, "StateBufferConnector_ms": 0.0027163028717041016, "ViewRequirementAgentConnector_ms": 0.06799912452697754}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190159.62028790492, "episode_reward_mean": -183003.37928133062, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-190159.62028790492, -188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21892949555857272, "mean_inference_ms": 0.37477049801464096, "mean_action_processing_ms": 0.09152178442235226, "mean_env_wait_ms": 0.7683728477041205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706216812133789, "StateBufferConnector_ms": 0.0027163028717041016, "ViewRequirementAgentConnector_ms": 0.06799912452697754}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40841040, "num_agent_steps_trained": 40841040, "num_env_steps_sampled": 40841040, "num_env_steps_trained": 40841040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 693.4012071705446, "num_env_steps_trained_throughput_per_sec": 693.4012071705446, "timesteps_total": 40841040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40841040, "timers": {"training_iteration_time_ms": 64543.969, "sample_time_ms": 63379.012, "load_time_ms": 25.755, "load_throughput": 1705309.406, "learn_time_ms": 1137.811, "learn_throughput": 38600.431, "synch_weights_time_ms": 1.141}, "counters": {"num_env_steps_sampled": 40841040, "num_env_steps_trained": 40841040, "num_agent_steps_sampled": 40841040, "num_agent_steps_trained": 40841040}, "done": false, "episodes_total": 9103, "training_iteration": 2840, "trial_id": "11c4c_00000", "date": "2023-08-07_11-27-34", "timestamp": 1691396854, "time_this_iter_s": 63.34375715255737, "time_total_s": 71573.69387984276, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7803.282591581345, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 20.121111111111112, "ram_util_percent": 75.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1875000000000003e-14, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.95811400121573, "policy_loss": -6865701.756400328, "vf_loss": 6105737.07279519}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 81977.5, "diff_num_grad_updates_vs_sampler_policy": 81976.5}}, "num_env_steps_sampled": 40884960, "num_env_steps_trained": 40884960, "num_agent_steps_sampled": 40884960, "num_agent_steps_trained": 40884960}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190009.93632238606, "episode_reward_mean": -182887.7169881385, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21898583466754687, "mean_inference_ms": 0.3748924605827291, "mean_action_processing_ms": 0.09154384417675553, "mean_env_wait_ms": 0.7682375551841355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037086009979248047, "StateBufferConnector_ms": 0.002719402313232422, "ViewRequirementAgentConnector_ms": 0.06800627708435059}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190009.93632238606, "episode_reward_mean": -182887.7169881385, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-188576.35779911763, -190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21898583466754687, "mean_inference_ms": 0.3748924605827291, "mean_action_processing_ms": 0.09154384417675553, "mean_env_wait_ms": 0.7682375551841355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037086009979248047, "StateBufferConnector_ms": 0.002719402313232422, "ViewRequirementAgentConnector_ms": 0.06800627708435059}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40884960, "num_agent_steps_trained": 40884960, "num_env_steps_sampled": 40884960, "num_env_steps_trained": 40884960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 698.2189562583204, "num_env_steps_trained_throughput_per_sec": 698.2189562583204, "timesteps_total": 40884960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40884960, "timers": {"training_iteration_time_ms": 64204.416, "sample_time_ms": 63042.502, "load_time_ms": 26.445, "load_throughput": 1660782.526, "learn_time_ms": 1134.111, "learn_throughput": 38726.367, "synch_weights_time_ms": 1.117}, "counters": {"num_env_steps_sampled": 40884960, "num_env_steps_trained": 40884960, "num_agent_steps_sampled": 40884960, "num_agent_steps_trained": 40884960}, "done": false, "episodes_total": 9104, "training_iteration": 2841, "trial_id": "11c4c_00000", "date": "2023-08-07_11-28-37", "timestamp": 1691396917, "time_this_iter_s": 62.90603804588318, "time_total_s": 71636.59991788864, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7866.188629627228, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 19.666666666666664, "ram_util_percent": 75.63444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.81007247346486, "policy_loss": -6754737.8944316, "vf_loss": 6118138.576348397}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 82663.5, "diff_num_grad_updates_vs_sampler_policy": 82662.5}}, "num_env_steps_sampled": 40928880, "num_env_steps_trained": 40928880, "num_agent_steps_sampled": 40928880, "num_agent_steps_trained": 40928880}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -190009.93632238606, "episode_reward_mean": -182793.55819594662, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2190416763916634, "mean_inference_ms": 0.3750114227810071, "mean_action_processing_ms": 0.09156526303451114, "mean_env_wait_ms": 0.7681039568637817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003708362579345703, "StateBufferConnector_ms": 0.002722024917602539, "ViewRequirementAgentConnector_ms": 0.06800317764282227}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -190009.93632238606, "episode_reward_mean": -182793.55819594662, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-190009.93632238606, -189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2190416763916634, "mean_inference_ms": 0.3750114227810071, "mean_action_processing_ms": 0.09156526303451114, "mean_env_wait_ms": 0.7681039568637817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003708362579345703, "StateBufferConnector_ms": 0.002722024917602539, "ViewRequirementAgentConnector_ms": 0.06800317764282227}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40928880, "num_agent_steps_trained": 40928880, "num_env_steps_sampled": 40928880, "num_env_steps_trained": 40928880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 696.0599307490509, "num_env_steps_trained_throughput_per_sec": 696.0599307490509, "timesteps_total": 40928880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40928880, "timers": {"training_iteration_time_ms": 63788.207, "sample_time_ms": 62625.273, "load_time_ms": 28.11, "load_throughput": 1562407.926, "learn_time_ms": 1133.521, "learn_throughput": 38746.527, "synch_weights_time_ms": 1.083}, "counters": {"num_env_steps_sampled": 40928880, "num_env_steps_trained": 40928880, "num_agent_steps_sampled": 40928880, "num_agent_steps_trained": 40928880}, "done": false, "episodes_total": 9105, "training_iteration": 2842, "trial_id": "11c4c_00000", "date": "2023-08-07_11-29-40", "timestamp": 1691396980, "time_this_iter_s": 63.10092902183533, "time_total_s": 71699.70084691048, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7929.289558649063, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 21.324719101123595, "ram_util_percent": 75.43707865168538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.11230215178284, "policy_loss": -6515825.0836598035, "vf_loss": 5987294.662764213}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 83349.5, "diff_num_grad_updates_vs_sampler_policy": 83348.5}}, "num_env_steps_sampled": 40972800, "num_env_steps_trained": 40972800, "num_agent_steps_sampled": 40972800, "num_agent_steps_trained": 40972800}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -189466.5332609256, "episode_reward_mean": -182664.1208052459, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2190982366520359, "mean_inference_ms": 0.3751312722852747, "mean_action_processing_ms": 0.09158668588681733, "mean_env_wait_ms": 0.7679742699851865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003716707229614258, "StateBufferConnector_ms": 0.002725839614868164, "ViewRequirementAgentConnector_ms": 0.06812334060668945}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -189466.5332609256, "episode_reward_mean": -182664.1208052459, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-189466.5332609256, -187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2190982366520359, "mean_inference_ms": 0.3751312722852747, "mean_action_processing_ms": 0.09158668588681733, "mean_env_wait_ms": 0.7679742699851865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003716707229614258, "StateBufferConnector_ms": 0.002725839614868164, "ViewRequirementAgentConnector_ms": 0.06812334060668945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40972800, "num_agent_steps_trained": 40972800, "num_env_steps_sampled": 40972800, "num_env_steps_trained": 40972800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 701.8760507037575, "num_env_steps_trained_throughput_per_sec": 701.8760507037575, "timesteps_total": 40972800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 40972800, "timers": {"training_iteration_time_ms": 63757.478, "sample_time_ms": 62595.438, "load_time_ms": 28.836, "load_throughput": 1523104.317, "learn_time_ms": 1131.842, "learn_throughput": 38803.988, "synch_weights_time_ms": 1.123}, "counters": {"num_env_steps_sampled": 40972800, "num_env_steps_trained": 40972800, "num_agent_steps_sampled": 40972800, "num_agent_steps_trained": 40972800}, "done": false, "episodes_total": 9106, "training_iteration": 2843, "trial_id": "11c4c_00000", "date": "2023-08-07_11-30-43", "timestamp": 1691397043, "time_this_iter_s": 62.57910919189453, "time_total_s": 71762.27995610237, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7991.868667840958, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 22.0876404494382, "ram_util_percent": 76.31460674157304}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8985128152475, "policy_loss": -6710939.950445859, "vf_loss": 6152600.198432945}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 84035.5, "diff_num_grad_updates_vs_sampler_policy": 84034.5}}, "num_env_steps_sampled": 41016720, "num_env_steps_trained": 41016720, "num_agent_steps_sampled": 41016720, "num_agent_steps_trained": 41016720}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -188970.8521094683, "episode_reward_mean": -182564.40301458386, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2191447860099123, "mean_inference_ms": 0.37522020622525376, "mean_action_processing_ms": 0.09160253064109593, "mean_env_wait_ms": 0.7678143769252995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003709077835083008, "StateBufferConnector_ms": 0.0027189254760742188, "ViewRequirementAgentConnector_ms": 0.06801080703735352}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -188970.8521094683, "episode_reward_mean": -182564.40301458386, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-187468.79737827368, -188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2191447860099123, "mean_inference_ms": 0.37522020622525376, "mean_action_processing_ms": 0.09160253064109593, "mean_env_wait_ms": 0.7678143769252995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003709077835083008, "StateBufferConnector_ms": 0.0027189254760742188, "ViewRequirementAgentConnector_ms": 0.06801080703735352}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41016720, "num_agent_steps_trained": 41016720, "num_env_steps_sampled": 41016720, "num_env_steps_trained": 41016720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 688.8837443466599, "num_env_steps_trained_throughput_per_sec": 688.8837443466599, "timesteps_total": 41016720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41016720, "timers": {"training_iteration_time_ms": 63562.442, "sample_time_ms": 62400.283, "load_time_ms": 28.741, "load_throughput": 1528116.49, "learn_time_ms": 1132.034, "learn_throughput": 38797.431, "synch_weights_time_ms": 1.141}, "counters": {"num_env_steps_sampled": 41016720, "num_env_steps_trained": 41016720, "num_agent_steps_sampled": 41016720, "num_agent_steps_trained": 41016720}, "done": false, "episodes_total": 9107, "training_iteration": 2844, "trial_id": "11c4c_00000", "date": "2023-08-07_11-31-46", "timestamp": 1691397106, "time_this_iter_s": 63.758262634277344, "time_total_s": 71826.03821873665, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8055.626930475235, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 22.275824175824177, "ram_util_percent": 76.12967032967035}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.88497955945076, "policy_loss": -6947870.79856619, "vf_loss": 6168780.382106414}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 84721.5, "diff_num_grad_updates_vs_sampler_policy": 84720.5}}, "num_env_steps_sampled": 41060640, "num_env_steps_trained": 41060640, "num_agent_steps_sampled": 41060640, "num_agent_steps_trained": 41060640}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -188970.8521094683, "episode_reward_mean": -182488.7118702826, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21918326810297004, "mean_inference_ms": 0.37528458973466655, "mean_action_processing_ms": 0.09161396662903817, "mean_env_wait_ms": 0.767634221849067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036993026733398438, "StateBufferConnector_ms": 0.0027146339416503906, "ViewRequirementAgentConnector_ms": 0.06789064407348633}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -188970.8521094683, "episode_reward_mean": -182488.7118702826, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-188970.8521094683, -187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21918326810297004, "mean_inference_ms": 0.37528458973466655, "mean_action_processing_ms": 0.09161396662903817, "mean_env_wait_ms": 0.767634221849067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036993026733398438, "StateBufferConnector_ms": 0.0027146339416503906, "ViewRequirementAgentConnector_ms": 0.06789064407348633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41060640, "num_agent_steps_trained": 41060640, "num_env_steps_sampled": 41060640, "num_env_steps_trained": 41060640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 690.1045009491784, "num_env_steps_trained_throughput_per_sec": 690.1045009491784, "timesteps_total": 41060640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41060640, "timers": {"training_iteration_time_ms": 63317.163, "sample_time_ms": 62155.481, "load_time_ms": 27.889, "load_throughput": 1574800.23, "learn_time_ms": 1132.524, "learn_throughput": 38780.645, "synch_weights_time_ms": 1.054}, "counters": {"num_env_steps_sampled": 41060640, "num_env_steps_trained": 41060640, "num_agent_steps_sampled": 41060640, "num_agent_steps_trained": 41060640}, "done": false, "episodes_total": 9108, "training_iteration": 2845, "trial_id": "11c4c_00000", "date": "2023-08-07_11-32-50", "timestamp": 1691397170, "time_this_iter_s": 63.645811319351196, "time_total_s": 71889.684030056, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8119.272741794586, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 21.934444444444445, "ram_util_percent": 76.32444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.85696535694353, "policy_loss": -6935365.18139862, "vf_loss": 6065095.763848397}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 85407.5, "diff_num_grad_updates_vs_sampler_policy": 85406.5}}, "num_env_steps_sampled": 41104560, "num_env_steps_trained": 41104560, "num_agent_steps_sampled": 41104560, "num_agent_steps_trained": 41104560}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -182381.04258838465, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21919406708719666, "mean_inference_ms": 0.3752945328694866, "mean_action_processing_ms": 0.09161475868191371, "mean_env_wait_ms": 0.7673892141666571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037026405334472656, "StateBufferConnector_ms": 0.0027153491973876953, "ViewRequirementAgentConnector_ms": 0.06794977188110352}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -182381.04258838465, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-187756.25588088797, -185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21919406708719666, "mean_inference_ms": 0.3752945328694866, "mean_action_processing_ms": 0.09161475868191371, "mean_env_wait_ms": 0.7673892141666571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037026405334472656, "StateBufferConnector_ms": 0.0027153491973876953, "ViewRequirementAgentConnector_ms": 0.06794977188110352}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41104560, "num_agent_steps_trained": 41104560, "num_env_steps_sampled": 41104560, "num_env_steps_trained": 41104560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 685.8826592107611, "num_env_steps_trained_throughput_per_sec": 685.8826592107611, "timesteps_total": 41104560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41104560, "timers": {"training_iteration_time_ms": 63458.388, "sample_time_ms": 62297.813, "load_time_ms": 28.338, "load_throughput": 1549849.163, "learn_time_ms": 1130.973, "learn_throughput": 38833.83, "synch_weights_time_ms": 1.05}, "counters": {"num_env_steps_sampled": 41104560, "num_env_steps_trained": 41104560, "num_agent_steps_sampled": 41104560, "num_agent_steps_trained": 41104560}, "done": false, "episodes_total": 9109, "training_iteration": 2846, "trial_id": "11c4c_00000", "date": "2023-08-07_11-33-54", "timestamp": 1691397234, "time_this_iter_s": 64.03712010383606, "time_total_s": 71953.72115015984, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8183.309861898422, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 21.00769230769231, "ram_util_percent": 76.04945054945055}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8752997039706, "policy_loss": -6500479.506055826, "vf_loss": 5979906.356778426}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 86093.5, "diff_num_grad_updates_vs_sampler_policy": 86092.5}}, "num_env_steps_sampled": 41148480, "num_env_steps_trained": 41148480, "num_agent_steps_sampled": 41148480, "num_agent_steps_trained": 41148480}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -182273.32811923895, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2191925516471749, "mean_inference_ms": 0.3752596453040023, "mean_action_processing_ms": 0.09160688136740804, "mean_env_wait_ms": 0.7670979592159961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037047863006591797, "StateBufferConnector_ms": 0.002716064453125, "ViewRequirementAgentConnector_ms": 0.06801247596740723}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -182273.32811923895, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185490.662170677, -184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2191925516471749, "mean_inference_ms": 0.3752596453040023, "mean_action_processing_ms": 0.09160688136740804, "mean_env_wait_ms": 0.7670979592159961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037047863006591797, "StateBufferConnector_ms": 0.002716064453125, "ViewRequirementAgentConnector_ms": 0.06801247596740723}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41148480, "num_agent_steps_trained": 41148480, "num_env_steps_sampled": 41148480, "num_env_steps_trained": 41148480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 689.6762568022262, "num_env_steps_trained_throughput_per_sec": 689.6762568022262, "timesteps_total": 41148480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41148480, "timers": {"training_iteration_time_ms": 63547.76, "sample_time_ms": 62366.187, "load_time_ms": 28.52, "load_throughput": 1539959.721, "learn_time_ms": 1151.619, "learn_throughput": 38137.628, "synch_weights_time_ms": 1.205}, "counters": {"num_env_steps_sampled": 41148480, "num_env_steps_trained": 41148480, "num_agent_steps_sampled": 41148480, "num_agent_steps_trained": 41148480}, "done": false, "episodes_total": 9110, "training_iteration": 2847, "trial_id": "11c4c_00000", "date": "2023-08-07_11-34-58", "timestamp": 1691397298, "time_this_iter_s": 63.692874908447266, "time_total_s": 72017.41402506828, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8247.00273680687, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 21.005494505494507, "ram_util_percent": 76.05824175824175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.838309196272, "policy_loss": -6849123.920494147, "vf_loss": 6247497.544460641}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 86779.5, "diff_num_grad_updates_vs_sampler_policy": 86778.5}}, "num_env_steps_sampled": 41192400, "num_env_steps_trained": 41192400, "num_agent_steps_sampled": 41192400, "num_agent_steps_trained": 41192400}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -182222.50987599415, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21919156796906494, "mean_inference_ms": 0.3752255457666584, "mean_action_processing_ms": 0.09159919926754084, "mean_env_wait_ms": 0.7668110913882289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037026405334472656, "StateBufferConnector_ms": 0.0027129650115966797, "ViewRequirementAgentConnector_ms": 0.06796002388000488}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -182222.50987599415, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-184487.05452948884, -185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21919156796906494, "mean_inference_ms": 0.3752255457666584, "mean_action_processing_ms": 0.09159919926754084, "mean_env_wait_ms": 0.7668110913882289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037026405334472656, "StateBufferConnector_ms": 0.0027129650115966797, "ViewRequirementAgentConnector_ms": 0.06796002388000488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41192400, "num_agent_steps_trained": 41192400, "num_env_steps_sampled": 41192400, "num_env_steps_trained": 41192400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 688.5367146913122, "num_env_steps_trained_throughput_per_sec": 688.5367146913122, "timesteps_total": 41192400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41192400, "timers": {"training_iteration_time_ms": 63408.312, "sample_time_ms": 62229.053, "load_time_ms": 28.949, "load_throughput": 1517150.933, "learn_time_ms": 1148.883, "learn_throughput": 38228.427, "synch_weights_time_ms": 1.197}, "counters": {"num_env_steps_sampled": 41192400, "num_env_steps_trained": 41192400, "num_agent_steps_sampled": 41192400, "num_agent_steps_trained": 41192400}, "done": false, "episodes_total": 9111, "training_iteration": 2848, "trial_id": "11c4c_00000", "date": "2023-08-07_11-36-02", "timestamp": 1691397362, "time_this_iter_s": 63.790284872055054, "time_total_s": 72081.20430994034, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8310.793021678925, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 23.26, "ram_util_percent": 75.51222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.87003479893633, "policy_loss": -6791032.880008086, "vf_loss": 6243397.288629738}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 87465.5, "diff_num_grad_updates_vs_sampler_policy": 87464.5}}, "num_env_steps_sampled": 41236320, "num_env_steps_trained": 41236320, "num_agent_steps_sampled": 41236320, "num_agent_steps_trained": 41236320}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -182177.80826582902, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21919123986826225, "mean_inference_ms": 0.3751929903975658, "mean_action_processing_ms": 0.09159186451021732, "mean_env_wait_ms": 0.7665273250915042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037009716033935547, "StateBufferConnector_ms": 0.002709627151489258, "ViewRequirementAgentConnector_ms": 0.06793427467346191}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -182177.80826582902, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185202.15072842973, -185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21919123986826225, "mean_inference_ms": 0.3751929903975658, "mean_action_processing_ms": 0.09159186451021732, "mean_env_wait_ms": 0.7665273250915042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037009716033935547, "StateBufferConnector_ms": 0.002709627151489258, "ViewRequirementAgentConnector_ms": 0.06793427467346191}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41236320, "num_agent_steps_trained": 41236320, "num_env_steps_sampled": 41236320, "num_env_steps_trained": 41236320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 693.6328001506238, "num_env_steps_trained_throughput_per_sec": 693.6328001506238, "timesteps_total": 41236320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41236320, "timers": {"training_iteration_time_ms": 63413.613, "sample_time_ms": 62222.446, "load_time_ms": 30.012, "load_throughput": 1463411.747, "learn_time_ms": 1159.729, "learn_throughput": 37870.911, "synch_weights_time_ms": 1.196}, "counters": {"num_env_steps_sampled": 41236320, "num_env_steps_trained": 41236320, "num_agent_steps_sampled": 41236320, "num_agent_steps_trained": 41236320}, "done": false, "episodes_total": 9112, "training_iteration": 2849, "trial_id": "11c4c_00000", "date": "2023-08-07_11-37-05", "timestamp": 1691397425, "time_this_iter_s": 63.321995973587036, "time_total_s": 72144.52630591393, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8374.115017652512, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 20.674444444444443, "ram_util_percent": 75.76777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8961387612034, "policy_loss": -6121830.866363258, "vf_loss": 5935274.139212828}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 88151.5, "diff_num_grad_updates_vs_sampler_policy": 88150.5}}, "num_env_steps_sampled": 41280240, "num_env_steps_trained": 41280240, "num_agent_steps_sampled": 41280240, "num_agent_steps_trained": 41280240}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -182088.3908296218, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2191927041758162, "mean_inference_ms": 0.3751647382239291, "mean_action_processing_ms": 0.09158566218148659, "mean_env_wait_ms": 0.7662553454659293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037136077880859375, "StateBufferConnector_ms": 0.002696514129638672, "ViewRequirementAgentConnector_ms": 0.06794381141662598}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -182088.3908296218, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185143.74320679513, -184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2191927041758162, "mean_inference_ms": 0.3751647382239291, "mean_action_processing_ms": 0.09158566218148659, "mean_env_wait_ms": 0.7662553454659293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037136077880859375, "StateBufferConnector_ms": 0.002696514129638672, "ViewRequirementAgentConnector_ms": 0.06794381141662598}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41280240, "num_agent_steps_trained": 41280240, "num_env_steps_sampled": 41280240, "num_env_steps_trained": 41280240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 656.2148409469444, "num_env_steps_trained_throughput_per_sec": 656.2148409469444, "timesteps_total": 41280240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41280240, "timers": {"training_iteration_time_ms": 63772.548, "sample_time_ms": 62571.175, "load_time_ms": 32.636, "load_throughput": 1345746.327, "learn_time_ms": 1167.308, "learn_throughput": 37625.041, "synch_weights_time_ms": 1.205}, "counters": {"num_env_steps_sampled": 41280240, "num_env_steps_trained": 41280240, "num_agent_steps_sampled": 41280240, "num_agent_steps_trained": 41280240}, "done": false, "episodes_total": 9113, "training_iteration": 2850, "trial_id": "11c4c_00000", "date": "2023-08-07_11-38-12", "timestamp": 1691397492, "time_this_iter_s": 66.93292880058289, "time_total_s": 72211.45923471451, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8441.047946453094, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 27.517894736842102, "ram_util_percent": 76.02526315789476}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.00493543975205, "policy_loss": -6306906.729574754, "vf_loss": 6217830.916909621}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 88837.5, "diff_num_grad_updates_vs_sampler_policy": 88836.5}}, "num_env_steps_sampled": 41324160, "num_env_steps_trained": 41324160, "num_agent_steps_sampled": 41324160, "num_agent_steps_trained": 41324160}, "sampler_results": {"episode_reward_max": -176258.67583038137, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -182036.25375571492, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2191958692923579, "mean_inference_ms": 0.37514052704965534, "mean_action_processing_ms": 0.09158026550306937, "mean_env_wait_ms": 0.765980857550684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003713846206665039, "StateBufferConnector_ms": 0.0026998519897460938, "ViewRequirementAgentConnector_ms": 0.06801986694335938}}, "episode_reward_max": -176258.67583038137, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -182036.25375571492, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-184876.9452373972, -186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2191958692923579, "mean_inference_ms": 0.37514052704965534, "mean_action_processing_ms": 0.09158026550306937, "mean_env_wait_ms": 0.765980857550684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003713846206665039, "StateBufferConnector_ms": 0.0026998519897460938, "ViewRequirementAgentConnector_ms": 0.06801986694335938}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41324160, "num_agent_steps_trained": 41324160, "num_env_steps_sampled": 41324160, "num_env_steps_trained": 41324160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 674.9772540401308, "num_env_steps_trained_throughput_per_sec": 674.9772540401308, "timesteps_total": 41324160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41324160, "timers": {"training_iteration_time_ms": 63989.143, "sample_time_ms": 62786.106, "load_time_ms": 31.938, "load_throughput": 1375174.453, "learn_time_ms": 1169.627, "learn_throughput": 37550.445, "synch_weights_time_ms": 1.241}, "counters": {"num_env_steps_sampled": 41324160, "num_env_steps_trained": 41324160, "num_agent_steps_sampled": 41324160, "num_agent_steps_trained": 41324160}, "done": false, "episodes_total": 9114, "training_iteration": 2851, "trial_id": "11c4c_00000", "date": "2023-08-07_11-39-17", "timestamp": 1691397557, "time_this_iter_s": 65.07218027114868, "time_total_s": 72276.53141498566, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8506.120126724243, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 26.169892473118278, "ram_util_percent": 77.44301075268817}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.77255609362186, "policy_loss": -6224638.708073297, "vf_loss": 5915126.745080175}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 89523.5, "diff_num_grad_updates_vs_sampler_policy": 89522.5}}, "num_env_steps_sampled": 41368080, "num_env_steps_trained": 41368080, "num_agent_steps_sampled": 41368080, "num_agent_steps_trained": 41368080}, "sampler_results": {"episode_reward_max": -176097.3253238217, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181948.45755657915, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2192013333698187, "mean_inference_ms": 0.3751242384801267, "mean_action_processing_ms": 0.09157643032890464, "mean_env_wait_ms": 0.7657100516643155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037178993225097656, "StateBufferConnector_ms": 0.0026993751525878906, "ViewRequirementAgentConnector_ms": 0.06804800033569336}}, "episode_reward_max": -176097.3253238217, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181948.45755657915, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-186257.5820786808, -183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2192013333698187, "mean_inference_ms": 0.3751242384801267, "mean_action_processing_ms": 0.09157643032890464, "mean_env_wait_ms": 0.7657100516643155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037178993225097656, "StateBufferConnector_ms": 0.0026993751525878906, "ViewRequirementAgentConnector_ms": 0.06804800033569336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41368080, "num_agent_steps_trained": 41368080, "num_env_steps_sampled": 41368080, "num_env_steps_trained": 41368080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 651.3142206338184, "num_env_steps_trained_throughput_per_sec": 651.3142206338184, "timesteps_total": 41368080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41368080, "timers": {"training_iteration_time_ms": 64422.626, "sample_time_ms": 63218.561, "load_time_ms": 30.651, "load_throughput": 1432903.845, "learn_time_ms": 1171.849, "learn_throughput": 37479.224, "synch_weights_time_ms": 1.309}, "counters": {"num_env_steps_sampled": 41368080, "num_env_steps_trained": 41368080, "num_agent_steps_sampled": 41368080, "num_agent_steps_trained": 41368080}, "done": false, "episodes_total": 9115, "training_iteration": 2852, "trial_id": "11c4c_00000", "date": "2023-08-07_11-40-25", "timestamp": 1691397625, "time_this_iter_s": 67.43656206130981, "time_total_s": 72343.96797704697, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8573.556688785553, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 27.911458333333332, "ram_util_percent": 76.67708333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9994744837458, "policy_loss": -6354317.302045371, "vf_loss": 5950545.930029155}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 90209.5, "diff_num_grad_updates_vs_sampler_policy": 90208.5}}, "num_env_steps_sampled": 41412000, "num_env_steps_trained": 41412000, "num_agent_steps_sampled": 41412000, "num_agent_steps_trained": 41412000}, "sampler_results": {"episode_reward_max": -176097.3253238217, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181852.8286611934, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21920857716428307, "mean_inference_ms": 0.3751107925216594, "mean_action_processing_ms": 0.09157329579687565, "mean_env_wait_ms": 0.7654397964809921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003718137741088867, "StateBufferConnector_ms": 0.0027008056640625, "ViewRequirementAgentConnector_ms": 0.06805944442749023}}, "episode_reward_max": -176097.3253238217, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181852.8286611934, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-183985.15715032018, -185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21920857716428307, "mean_inference_ms": 0.3751107925216594, "mean_action_processing_ms": 0.09157329579687565, "mean_env_wait_ms": 0.7654397964809921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003718137741088867, "StateBufferConnector_ms": 0.0027008056640625, "ViewRequirementAgentConnector_ms": 0.06805944442749023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41412000, "num_agent_steps_trained": 41412000, "num_env_steps_sampled": 41412000, "num_env_steps_trained": 41412000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 665.4698609889795, "num_env_steps_trained_throughput_per_sec": 665.4698609889795, "timesteps_total": 41412000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41412000, "timers": {"training_iteration_time_ms": 64764.96, "sample_time_ms": 63560.617, "load_time_ms": 31.424, "load_throughput": 1397668.54, "learn_time_ms": 1171.405, "learn_throughput": 37493.433, "synch_weights_time_ms": 1.275}, "counters": {"num_env_steps_sampled": 41412000, "num_env_steps_trained": 41412000, "num_agent_steps_sampled": 41412000, "num_agent_steps_trained": 41412000}, "done": false, "episodes_total": 9116, "training_iteration": 2853, "trial_id": "11c4c_00000", "date": "2023-08-07_11-41-31", "timestamp": 1691397691, "time_this_iter_s": 66.00156688690186, "time_total_s": 72409.96954393387, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8639.558255672455, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 26.646808510638294, "ram_util_percent": 74.3468085106383}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.92804898186955, "policy_loss": -6375600.850452123, "vf_loss": 6217363.121264577}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 90895.5, "diff_num_grad_updates_vs_sampler_policy": 90894.5}}, "num_env_steps_sampled": 41455920, "num_env_steps_trained": 41455920, "num_agent_steps_sampled": 41455920, "num_agent_steps_trained": 41455920}, "sampler_results": {"episode_reward_max": -176097.3253238217, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181806.6102306233, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21921857998329253, "mean_inference_ms": 0.37510281679864754, "mean_action_processing_ms": 0.09157125678923853, "mean_env_wait_ms": 0.7651814127908765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003718137741088867, "StateBufferConnector_ms": 0.002703428268432617, "ViewRequirementAgentConnector_ms": 0.06813549995422363}}, "episode_reward_max": -176097.3253238217, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181806.6102306233, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185434.6277288061, -185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21921857998329253, "mean_inference_ms": 0.37510281679864754, "mean_action_processing_ms": 0.09157125678923853, "mean_env_wait_ms": 0.7651814127908765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003718137741088867, "StateBufferConnector_ms": 0.002703428268432617, "ViewRequirementAgentConnector_ms": 0.06813549995422363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41455920, "num_agent_steps_trained": 41455920, "num_env_steps_sampled": 41455920, "num_env_steps_trained": 41455920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 655.2584760577087, "num_env_steps_trained_throughput_per_sec": 655.2584760577087, "timesteps_total": 41455920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41455920, "timers": {"training_iteration_time_ms": 65092.127, "sample_time_ms": 63885.931, "load_time_ms": 32.934, "load_throughput": 1333594.663, "learn_time_ms": 1171.772, "learn_throughput": 37481.707, "synch_weights_time_ms": 1.259}, "counters": {"num_env_steps_sampled": 41455920, "num_env_steps_trained": 41455920, "num_agent_steps_sampled": 41455920, "num_agent_steps_trained": 41455920}, "done": false, "episodes_total": 9117, "training_iteration": 2854, "trial_id": "11c4c_00000", "date": "2023-08-07_11-42-38", "timestamp": 1691397758, "time_this_iter_s": 67.03030395507812, "time_total_s": 72476.99984788895, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8706.588559627533, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 25.532631578947363, "ram_util_percent": 73.77684210526317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.0031748068228, "policy_loss": -6011332.444834184, "vf_loss": 5972128.803115889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 91581.5, "diff_num_grad_updates_vs_sampler_policy": 91580.5}}, "num_env_steps_sampled": 41499840, "num_env_steps_trained": 41499840, "num_agent_steps_sampled": 41499840, "num_agent_steps_trained": 41499840}, "sampler_results": {"episode_reward_max": -176097.3253238217, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181713.63754439197, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.219230333507296, "mean_inference_ms": 0.3751001419850779, "mean_action_processing_ms": 0.09157017838784197, "mean_env_wait_ms": 0.7649283907762956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003715038299560547, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.06816315650939941}}, "episode_reward_max": -176097.3253238217, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181713.63754439197, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185050.07149341717, -187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.219230333507296, "mean_inference_ms": 0.3751001419850779, "mean_action_processing_ms": 0.09157017838784197, "mean_env_wait_ms": 0.7649283907762956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003715038299560547, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.06816315650939941}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41499840, "num_agent_steps_trained": 41499840, "num_env_steps_sampled": 41499840, "num_env_steps_trained": 41499840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 674.1686451530549, "num_env_steps_trained_throughput_per_sec": 674.1686451530549, "timesteps_total": 41499840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41499840, "timers": {"training_iteration_time_ms": 65242.565, "sample_time_ms": 64034.266, "load_time_ms": 32.212, "load_throughput": 1363454.118, "learn_time_ms": 1174.6, "learn_throughput": 37391.455, "synch_weights_time_ms": 1.253}, "counters": {"num_env_steps_sampled": 41499840, "num_env_steps_trained": 41499840, "num_agent_steps_sampled": 41499840, "num_agent_steps_trained": 41499840}, "done": false, "episodes_total": 9118, "training_iteration": 2855, "trial_id": "11c4c_00000", "date": "2023-08-07_11-43-43", "timestamp": 1691397823, "time_this_iter_s": 65.14992690086365, "time_total_s": 72542.14977478981, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8771.738486528397, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 23.583870967741937, "ram_util_percent": 73.67419354838711}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.0498158090664, "policy_loss": -5797086.376318217, "vf_loss": 5828304.894952624}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 92267.5, "diff_num_grad_updates_vs_sampler_policy": 92266.5}}, "num_env_steps_sampled": 41543760, "num_env_steps_trained": 41543760, "num_agent_steps_sampled": 41543760, "num_agent_steps_trained": 41543760}, "sampler_results": {"episode_reward_max": -174238.8397993808, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181605.5252274516, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21924420191758107, "mean_inference_ms": 0.37509980882953753, "mean_action_processing_ms": 0.09156974942144366, "mean_env_wait_ms": 0.764680591196018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037221908569335938, "StateBufferConnector_ms": 0.002705812454223633, "ViewRequirementAgentConnector_ms": 0.06829953193664551}}, "episode_reward_max": -174238.8397993808, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181605.5252274516, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-187316.71054178666, -186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21924420191758107, "mean_inference_ms": 0.37509980882953753, "mean_action_processing_ms": 0.09156974942144366, "mean_env_wait_ms": 0.764680591196018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037221908569335938, "StateBufferConnector_ms": 0.002705812454223633, "ViewRequirementAgentConnector_ms": 0.06829953193664551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41543760, "num_agent_steps_trained": 41543760, "num_env_steps_sampled": 41543760, "num_env_steps_trained": 41543760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 649.3889681490907, "num_env_steps_trained_throughput_per_sec": 649.3889681490907, "timesteps_total": 41543760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41543760, "timers": {"training_iteration_time_ms": 65602.417, "sample_time_ms": 64352.545, "load_time_ms": 32.299, "load_throughput": 1359794.671, "learn_time_ms": 1216.056, "learn_throughput": 36116.761, "synch_weights_time_ms": 1.277}, "counters": {"num_env_steps_sampled": 41543760, "num_env_steps_trained": 41543760, "num_agent_steps_sampled": 41543760, "num_agent_steps_trained": 41543760}, "done": false, "episodes_total": 9119, "training_iteration": 2856, "trial_id": "11c4c_00000", "date": "2023-08-07_11-44-51", "timestamp": 1691397891, "time_this_iter_s": 67.63603377342224, "time_total_s": 72609.78580856323, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8839.374520301819, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 27.90416666666667, "ram_util_percent": 73.55312500000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8833227129789, "policy_loss": -6231151.422860104, "vf_loss": 5875388.654883382}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 92953.5, "diff_num_grad_updates_vs_sampler_policy": 92952.5}}, "num_env_steps_sampled": 41587680, "num_env_steps_trained": 41587680, "num_agent_steps_sampled": 41587680, "num_agent_steps_trained": 41587680}, "sampler_results": {"episode_reward_max": -174238.8397993808, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181491.75709898662, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21925969730620096, "mean_inference_ms": 0.37510552541926645, "mean_action_processing_ms": 0.09157037356134384, "mean_env_wait_ms": 0.7644395549382288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719806671142578, "StateBufferConnector_ms": 0.002707242965698242, "ViewRequirementAgentConnector_ms": 0.06833243370056152}}, "episode_reward_max": -174238.8397993808, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181491.75709898662, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-186623.6479920499, -187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21925969730620096, "mean_inference_ms": 0.37510552541926645, "mean_action_processing_ms": 0.09157037356134384, "mean_env_wait_ms": 0.7644395549382288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719806671142578, "StateBufferConnector_ms": 0.002707242965698242, "ViewRequirementAgentConnector_ms": 0.06833243370056152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41587680, "num_agent_steps_trained": 41587680, "num_env_steps_sampled": 41587680, "num_env_steps_trained": 41587680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 644.6380849395911, "num_env_steps_trained_throughput_per_sec": 644.6380849395911, "timesteps_total": 41587680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41587680, "timers": {"training_iteration_time_ms": 66047.343, "sample_time_ms": 64818.105, "load_time_ms": 32.376, "load_throughput": 1356568.27, "learn_time_ms": 1195.509, "learn_throughput": 36737.48, "synch_weights_time_ms": 1.129}, "counters": {"num_env_steps_sampled": 41587680, "num_env_steps_trained": 41587680, "num_agent_steps_sampled": 41587680, "num_agent_steps_trained": 41587680}, "done": false, "episodes_total": 9120, "training_iteration": 2857, "trial_id": "11c4c_00000", "date": "2023-08-07_11-45-59", "timestamp": 1691397959, "time_this_iter_s": 68.13425397872925, "time_total_s": 72677.92006254196, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8907.508774280548, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 27.496907216494847, "ram_util_percent": 72.9680412371134}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9109501518939, "policy_loss": -5980013.081387801, "vf_loss": 5871727.718112245}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 93639.5, "diff_num_grad_updates_vs_sampler_policy": 93638.5}}, "num_env_steps_sampled": 41631600, "num_env_steps_trained": 41631600, "num_agent_steps_sampled": 41631600, "num_agent_steps_trained": 41631600}, "sampler_results": {"episode_reward_max": -174238.8397993808, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181378.79769925014, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21927671528768117, "mean_inference_ms": 0.3751153572325674, "mean_action_processing_ms": 0.09157199852322781, "mean_env_wait_ms": 0.7642040852470454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003715038299560547, "StateBufferConnector_ms": 0.0027031898498535156, "ViewRequirementAgentConnector_ms": 0.0683283805847168}}, "episode_reward_max": -174238.8397993808, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181378.79769925014, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-187603.52548318915, -185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21927671528768117, "mean_inference_ms": 0.3751153572325674, "mean_action_processing_ms": 0.09157199852322781, "mean_env_wait_ms": 0.7642040852470454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003715038299560547, "StateBufferConnector_ms": 0.0027031898498535156, "ViewRequirementAgentConnector_ms": 0.0683283805847168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41631600, "num_agent_steps_trained": 41631600, "num_env_steps_sampled": 41631600, "num_env_steps_trained": 41631600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 667.8121855523221, "num_env_steps_trained_throughput_per_sec": 667.8121855523221, "timesteps_total": 41631600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41631600, "timers": {"training_iteration_time_ms": 66245.299, "sample_time_ms": 65016.045, "load_time_ms": 30.31, "load_throughput": 1449039.88, "learn_time_ms": 1197.485, "learn_throughput": 36676.86, "synch_weights_time_ms": 1.235}, "counters": {"num_env_steps_sampled": 41631600, "num_env_steps_trained": 41631600, "num_agent_steps_sampled": 41631600, "num_agent_steps_trained": 41631600}, "done": false, "episodes_total": 9121, "training_iteration": 2858, "trial_id": "11c4c_00000", "date": "2023-08-07_11-47-05", "timestamp": 1691398025, "time_this_iter_s": 65.76990699768066, "time_total_s": 72743.68996953964, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 8973.278681278229, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 23.887096774193548, "ram_util_percent": 72.72795698924732}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.00248985179314, "policy_loss": -5735685.338024439, "vf_loss": 6114733.057033528}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 94325.5, "diff_num_grad_updates_vs_sampler_policy": 94324.5}}, "num_env_steps_sampled": 41675520, "num_env_steps_trained": 41675520, "num_agent_steps_sampled": 41675520, "num_agent_steps_trained": 41675520}, "sampler_results": {"episode_reward_max": -174238.8397993808, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181281.01309777747, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2192956541250311, "mean_inference_ms": 0.3751314497374696, "mean_action_processing_ms": 0.09157477456053208, "mean_env_wait_ms": 0.7639778132737801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037124156951904297, "StateBufferConnector_ms": 0.0027048587799072266, "ViewRequirementAgentConnector_ms": 0.0683135986328125}}, "episode_reward_max": -174238.8397993808, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181281.01309777747, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185511.65200127198, -184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2192956541250311, "mean_inference_ms": 0.3751314497374696, "mean_action_processing_ms": 0.09157477456053208, "mean_env_wait_ms": 0.7639778132737801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037124156951904297, "StateBufferConnector_ms": 0.0027048587799072266, "ViewRequirementAgentConnector_ms": 0.0683135986328125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41675520, "num_agent_steps_trained": 41675520, "num_env_steps_sampled": 41675520, "num_env_steps_trained": 41675520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 645.6190439784715, "num_env_steps_trained_throughput_per_sec": 645.6190439784715, "timesteps_total": 41675520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41675520, "timers": {"training_iteration_time_ms": 66716.185, "sample_time_ms": 65469.264, "load_time_ms": 29.483, "load_throughput": 1489653.521, "learn_time_ms": 1215.93, "learn_throughput": 36120.486, "synch_weights_time_ms": 1.276}, "counters": {"num_env_steps_sampled": 41675520, "num_env_steps_trained": 41675520, "num_agent_steps_sampled": 41675520, "num_agent_steps_trained": 41675520}, "done": false, "episodes_total": 9122, "training_iteration": 2859, "trial_id": "11c4c_00000", "date": "2023-08-07_11-48-13", "timestamp": 1691398093, "time_this_iter_s": 68.0314507484436, "time_total_s": 72811.72142028809, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9041.310132026672, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 26.901030927835052, "ram_util_percent": 72.23814432989691}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.94388756043014, "policy_loss": -5914156.48118053, "vf_loss": 5881574.580721574}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95011.5, "diff_num_grad_updates_vs_sampler_policy": 95010.5}}, "num_env_steps_sampled": 41719440, "num_env_steps_trained": 41719440, "num_agent_steps_sampled": 41719440, "num_agent_steps_trained": 41719440}, "sampler_results": {"episode_reward_max": -174238.8397993808, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181176.37363864676, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21931640280371392, "mean_inference_ms": 0.3751531371478272, "mean_action_processing_ms": 0.09157876717125638, "mean_env_wait_ms": 0.763761593326588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036945343017578125, "StateBufferConnector_ms": 0.002695798873901367, "ViewRequirementAgentConnector_ms": 0.06787419319152832}}, "episode_reward_max": -174238.8397993808, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181176.37363864676, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-184221.97186089255, -186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21931640280371392, "mean_inference_ms": 0.3751531371478272, "mean_action_processing_ms": 0.09157876717125638, "mean_env_wait_ms": 0.763761593326588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036945343017578125, "StateBufferConnector_ms": 0.002695798873901367, "ViewRequirementAgentConnector_ms": 0.06787419319152832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41719440, "num_agent_steps_trained": 41719440, "num_env_steps_sampled": 41719440, "num_env_steps_trained": 41719440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 640.3414119129119, "num_env_steps_trained_throughput_per_sec": 640.3414119129119, "timesteps_total": 41719440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41719440, "timers": {"training_iteration_time_ms": 66882.1, "sample_time_ms": 65643.662, "load_time_ms": 26.701, "load_throughput": 1644902.94, "learn_time_ms": 1210.323, "learn_throughput": 36287.831, "synch_weights_time_ms": 1.2}, "counters": {"num_env_steps_sampled": 41719440, "num_env_steps_trained": 41719440, "num_agent_steps_sampled": 41719440, "num_agent_steps_trained": 41719440}, "done": false, "episodes_total": 9123, "training_iteration": 2860, "trial_id": "11c4c_00000", "date": "2023-08-07_11-49-21", "timestamp": 1691398161, "time_this_iter_s": 68.59154510498047, "time_total_s": 72880.31296539307, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9109.901677131653, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 28.879381443298968, "ram_util_percent": 72.60618556701031}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.86891223251297, "policy_loss": -5351029.349373064, "vf_loss": 5693415.670827259}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95697.5, "diff_num_grad_updates_vs_sampler_policy": 95696.5}}, "num_env_steps_sampled": 41763360, "num_env_steps_trained": 41763360, "num_agent_steps_sampled": 41763360, "num_agent_steps_trained": 41763360}, "sampler_results": {"episode_reward_max": -173063.53959217155, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181064.78931595958, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21933739406568292, "mean_inference_ms": 0.3751750384710808, "mean_action_processing_ms": 0.09158272926864541, "mean_env_wait_ms": 0.7635460790910674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003693103790283203, "StateBufferConnector_ms": 0.0026967525482177734, "ViewRequirementAgentConnector_ms": 0.06789469718933105}}, "episode_reward_max": -173063.53959217155, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -181064.78931595958, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-186473.49499663376, -183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21933739406568292, "mean_inference_ms": 0.3751750384710808, "mean_action_processing_ms": 0.09158272926864541, "mean_env_wait_ms": 0.7635460790910674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003693103790283203, "StateBufferConnector_ms": 0.0026967525482177734, "ViewRequirementAgentConnector_ms": 0.06789469718933105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41763360, "num_agent_steps_trained": 41763360, "num_env_steps_sampled": 41763360, "num_env_steps_trained": 41763360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 646.2969979464034, "num_env_steps_trained_throughput_per_sec": 646.2969979464034, "timesteps_total": 41763360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41763360, "timers": {"training_iteration_time_ms": 67170.85, "sample_time_ms": 65930.778, "load_time_ms": 25.631, "load_throughput": 1713524.588, "learn_time_ms": 1213.044, "learn_throughput": 36206.436, "synch_weights_time_ms": 1.185}, "counters": {"num_env_steps_sampled": 41763360, "num_env_steps_trained": 41763360, "num_agent_steps_sampled": 41763360, "num_agent_steps_trained": 41763360}, "done": false, "episodes_total": 9124, "training_iteration": 2861, "trial_id": "11c4c_00000", "date": "2023-08-07_11-50-29", "timestamp": 1691398229, "time_this_iter_s": 67.9596118927002, "time_total_s": 72948.27257728577, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9177.861289024353, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 27.31546391752577, "ram_util_percent": 72.20515463917526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.0270791456929, "policy_loss": -5944745.146310701, "vf_loss": 6152721.72904519}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 96383.5, "diff_num_grad_updates_vs_sampler_policy": 96382.5}}, "num_env_steps_sampled": 41807280, "num_env_steps_trained": 41807280, "num_agent_steps_sampled": 41807280, "num_agent_steps_trained": 41807280}, "sampler_results": {"episode_reward_max": -173063.53959217155, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180987.65195760783, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21935522446913033, "mean_inference_ms": 0.37519729296833326, "mean_action_processing_ms": 0.09158669122776826, "mean_env_wait_ms": 0.7633343316325889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036923885345458984, "StateBufferConnector_ms": 0.0026950836181640625, "ViewRequirementAgentConnector_ms": 0.06787776947021484}}, "episode_reward_max": -173063.53959217155, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180987.65195760783, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-183542.6236804452, -181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21935522446913033, "mean_inference_ms": 0.37519729296833326, "mean_action_processing_ms": 0.09158669122776826, "mean_env_wait_ms": 0.7633343316325889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036923885345458984, "StateBufferConnector_ms": 0.0026950836181640625, "ViewRequirementAgentConnector_ms": 0.06787776947021484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41807280, "num_agent_steps_trained": 41807280, "num_env_steps_sampled": 41807280, "num_env_steps_trained": 41807280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 634.206286753639, "num_env_steps_trained_throughput_per_sec": 634.206286753639, "timesteps_total": 41807280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41807280, "timers": {"training_iteration_time_ms": 67352.757, "sample_time_ms": 66115.303, "load_time_ms": 23.918, "load_throughput": 1836306.208, "learn_time_ms": 1212.238, "learn_throughput": 36230.503, "synch_weights_time_ms": 1.11}, "counters": {"num_env_steps_sampled": 41807280, "num_env_steps_trained": 41807280, "num_agent_steps_sampled": 41807280, "num_agent_steps_trained": 41807280}, "done": false, "episodes_total": 9125, "training_iteration": 2862, "trial_id": "11c4c_00000", "date": "2023-08-07_11-51-39", "timestamp": 1691398299, "time_this_iter_s": 69.25483393669128, "time_total_s": 73017.52741122246, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9247.116122961044, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 27.839393939393943, "ram_util_percent": 71.7989898989899}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9312200963323, "policy_loss": -5279771.814797627, "vf_loss": 5620819.928206997}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 97069.5, "diff_num_grad_updates_vs_sampler_policy": 97068.5}}, "num_env_steps_sampled": 41851200, "num_env_steps_trained": 41851200, "num_agent_steps_sampled": 41851200, "num_agent_steps_trained": 41851200}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180869.6006617871, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2193738186113034, "mean_inference_ms": 0.3752201382260661, "mean_action_processing_ms": 0.09159091767682298, "mean_env_wait_ms": 0.763124621042127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003692150115966797, "StateBufferConnector_ms": 0.0026938915252685547, "ViewRequirementAgentConnector_ms": 0.0678861141204834}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180869.6006617871, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181037.8913382251, -181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2193738186113034, "mean_inference_ms": 0.3752201382260661, "mean_action_processing_ms": 0.09159091767682298, "mean_env_wait_ms": 0.763124621042127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003692150115966797, "StateBufferConnector_ms": 0.0026938915252685547, "ViewRequirementAgentConnector_ms": 0.0678861141204834}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41851200, "num_agent_steps_trained": 41851200, "num_env_steps_sampled": 41851200, "num_env_steps_trained": 41851200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 650.5283100281467, "num_env_steps_trained_throughput_per_sec": 650.5283100281467, "timesteps_total": 41851200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41851200, "timers": {"training_iteration_time_ms": 67504.345, "sample_time_ms": 66223.245, "load_time_ms": 23.088, "load_throughput": 1902271.006, "learn_time_ms": 1256.721, "learn_throughput": 34948.091, "synch_weights_time_ms": 1.103}, "counters": {"num_env_steps_sampled": 41851200, "num_env_steps_trained": 41851200, "num_agent_steps_sampled": 41851200, "num_agent_steps_trained": 41851200}, "done": false, "episodes_total": 9126, "training_iteration": 2863, "trial_id": "11c4c_00000", "date": "2023-08-07_11-52-46", "timestamp": 1691398366, "time_this_iter_s": 67.51737380027771, "time_total_s": 73085.04478502274, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9314.633496761322, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 29.12708333333333, "ram_util_percent": 71.54791666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.95368939725023, "policy_loss": -5648051.391177341, "vf_loss": 5980376.33090379}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 97755.5, "diff_num_grad_updates_vs_sampler_policy": 97754.5}}, "num_env_steps_sampled": 41895120, "num_env_steps_trained": 41895120, "num_agent_steps_sampled": 41895120, "num_agent_steps_trained": 41895120}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180826.07397408166, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2193934203711496, "mean_inference_ms": 0.3752457849399057, "mean_action_processing_ms": 0.09159565468400897, "mean_env_wait_ms": 0.7629207306111315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706693649291992, "StateBufferConnector_ms": 0.0026993751525878906, "ViewRequirementAgentConnector_ms": 0.06800484657287598}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180826.07397408166, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181974.2166623488, -183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2193934203711496, "mean_inference_ms": 0.3752457849399057, "mean_action_processing_ms": 0.09159565468400897, "mean_env_wait_ms": 0.7629207306111315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706693649291992, "StateBufferConnector_ms": 0.0026993751525878906, "ViewRequirementAgentConnector_ms": 0.06800484657287598}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41895120, "num_agent_steps_trained": 41895120, "num_env_steps_sampled": 41895120, "num_env_steps_trained": 41895120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 658.6492393011591, "num_env_steps_trained_throughput_per_sec": 658.6492393011591, "timesteps_total": 41895120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41895120, "timers": {"training_iteration_time_ms": 67469.839, "sample_time_ms": 66189.61, "load_time_ms": 21.403, "load_throughput": 2052018.8, "learn_time_ms": 1257.524, "learn_throughput": 34925.766, "synch_weights_time_ms": 1.108}, "counters": {"num_env_steps_sampled": 41895120, "num_env_steps_trained": 41895120, "num_agent_steps_sampled": 41895120, "num_agent_steps_trained": 41895120}, "done": false, "episodes_total": 9127, "training_iteration": 2864, "trial_id": "11c4c_00000", "date": "2023-08-07_11-53-53", "timestamp": 1691398433, "time_this_iter_s": 66.6852068901062, "time_total_s": 73151.72999191284, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9381.318703651428, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 25.376595744680852, "ram_util_percent": 71.65957446808511}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.02295531336836, "policy_loss": -6308718.349148141, "vf_loss": 6172526.73159621}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 98441.5, "diff_num_grad_updates_vs_sampler_policy": 98440.5}}, "num_env_steps_sampled": 41939040, "num_env_steps_trained": 41939040, "num_agent_steps_sampled": 41939040, "num_agent_steps_trained": 41939040}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180796.68124877173, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21941616496982674, "mean_inference_ms": 0.3752787820968655, "mean_action_processing_ms": 0.09160193830898894, "mean_env_wait_ms": 0.7627244630104844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706216812133789, "StateBufferConnector_ms": 0.0027015209197998047, "ViewRequirementAgentConnector_ms": 0.06808972358703613}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180796.68124877173, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-183869.75153743775, -186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21941616496982674, "mean_inference_ms": 0.3752787820968655, "mean_action_processing_ms": 0.09160193830898894, "mean_env_wait_ms": 0.7627244630104844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706216812133789, "StateBufferConnector_ms": 0.0027015209197998047, "ViewRequirementAgentConnector_ms": 0.06808972358703613}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41939040, "num_agent_steps_trained": 41939040, "num_env_steps_sampled": 41939040, "num_env_steps_trained": 41939040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 602.2902019047871, "num_env_steps_trained_throughput_per_sec": 602.2902019047871, "timesteps_total": 41939040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41939040, "timers": {"training_iteration_time_ms": 68247.314, "sample_time_ms": 66969.573, "load_time_ms": 21.739, "load_throughput": 2020291.678, "learn_time_ms": 1254.698, "learn_throughput": 35004.447, "synch_weights_time_ms": 1.109}, "counters": {"num_env_steps_sampled": 41939040, "num_env_steps_trained": 41939040, "num_agent_steps_sampled": 41939040, "num_agent_steps_trained": 41939040}, "done": false, "episodes_total": 9128, "training_iteration": 2865, "trial_id": "11c4c_00000", "date": "2023-08-07_11-55-06", "timestamp": 1691398506, "time_this_iter_s": 72.92463994026184, "time_total_s": 73224.6546318531, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9454.24334359169, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 32.20288461538462, "ram_util_percent": 72.1826923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9944660865183, "policy_loss": -6183656.421052182, "vf_loss": 5980367.641399417}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 99127.5, "diff_num_grad_updates_vs_sampler_policy": 99126.5}}, "num_env_steps_sampled": 41982960, "num_env_steps_trained": 41982960, "num_agent_steps_sampled": 41982960, "num_agent_steps_trained": 41982960}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180723.57145033183, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21943750052473998, "mean_inference_ms": 0.3753069687014894, "mean_action_processing_ms": 0.09160729280995138, "mean_env_wait_ms": 0.762526391347818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003699064254760742, "StateBufferConnector_ms": 0.002702474594116211, "ViewRequirementAgentConnector_ms": 0.06800508499145508}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180723.57145033183, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-186286.3500338967, -184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21943750052473998, "mean_inference_ms": 0.3753069687014894, "mean_action_processing_ms": 0.09160729280995138, "mean_env_wait_ms": 0.762526391347818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003699064254760742, "StateBufferConnector_ms": 0.002702474594116211, "ViewRequirementAgentConnector_ms": 0.06800508499145508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41982960, "num_agent_steps_trained": 41982960, "num_env_steps_sampled": 41982960, "num_env_steps_trained": 41982960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 685.0488627034595, "num_env_steps_trained_throughput_per_sec": 685.0488627034595, "timesteps_total": 41982960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 41982960, "timers": {"training_iteration_time_ms": 67895.256, "sample_time_ms": 66657.764, "load_time_ms": 21.186, "load_throughput": 2073081.69, "learn_time_ms": 1215.031, "learn_throughput": 36147.222, "synch_weights_time_ms": 1.086}, "counters": {"num_env_steps_sampled": 41982960, "num_env_steps_trained": 41982960, "num_agent_steps_sampled": 41982960, "num_agent_steps_trained": 41982960}, "done": false, "episodes_total": 9129, "training_iteration": 2866, "trial_id": "11c4c_00000", "date": "2023-08-07_11-56-10", "timestamp": 1691398570, "time_this_iter_s": 64.11536717414856, "time_total_s": 73288.76999902725, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9518.358710765839, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 20.223076923076924, "ram_util_percent": 72.44615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.108052245382, "policy_loss": -5196737.107399098, "vf_loss": 5675829.018950437}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 99813.5, "diff_num_grad_updates_vs_sampler_policy": 99812.5}}, "num_env_steps_sampled": 42026880, "num_env_steps_trained": 42026880, "num_agent_steps_sampled": 42026880, "num_agent_steps_trained": 42026880}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180585.49920749656, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21946046367119984, "mean_inference_ms": 0.375335628902032, "mean_action_processing_ms": 0.09161289589452241, "mean_env_wait_ms": 0.7623293728972019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036973953247070312, "StateBufferConnector_ms": 0.0027039051055908203, "ViewRequirementAgentConnector_ms": 0.06801795959472656}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180585.49920749656, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-184572.11782995966, -185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21946046367119984, "mean_inference_ms": 0.375335628902032, "mean_action_processing_ms": 0.09161289589452241, "mean_env_wait_ms": 0.7623293728972019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036973953247070312, "StateBufferConnector_ms": 0.0027039051055908203, "ViewRequirementAgentConnector_ms": 0.06801795959472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42026880, "num_agent_steps_trained": 42026880, "num_env_steps_sampled": 42026880, "num_env_steps_trained": 42026880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 647.723124345313, "num_env_steps_trained_throughput_per_sec": 647.723124345313, "timesteps_total": 42026880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42026880, "timers": {"training_iteration_time_ms": 67862.805, "sample_time_ms": 66592.395, "load_time_ms": 20.813, "load_throughput": 2110264.275, "learn_time_ms": 1248.317, "learn_throughput": 35183.373, "synch_weights_time_ms": 1.09}, "counters": {"num_env_steps_sampled": 42026880, "num_env_steps_trained": 42026880, "num_agent_steps_sampled": 42026880, "num_agent_steps_trained": 42026880}, "done": false, "episodes_total": 9130, "training_iteration": 2867, "trial_id": "11c4c_00000", "date": "2023-08-07_11-57-18", "timestamp": 1691398638, "time_this_iter_s": 67.8097448348999, "time_total_s": 73356.57974386215, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9586.168455600739, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 28.79278350515464, "ram_util_percent": 71.940206185567}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9790009256702, "policy_loss": -6042175.009267379, "vf_loss": 5960849.854591837}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 100499.5, "diff_num_grad_updates_vs_sampler_policy": 100498.5}}, "num_env_steps_sampled": 42070800, "num_env_steps_trained": 42070800, "num_agent_steps_sampled": 42070800, "num_agent_steps_trained": 42070800}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180504.98118198648, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21948550993851648, "mean_inference_ms": 0.37536934070080974, "mean_action_processing_ms": 0.09161950898571336, "mean_env_wait_ms": 0.7621420719894121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701448440551758, "StateBufferConnector_ms": 0.0027031898498535156, "ViewRequirementAgentConnector_ms": 0.06804847717285156}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180504.98118198648, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185334.25896012716, -185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21948550993851648, "mean_inference_ms": 0.37536934070080974, "mean_action_processing_ms": 0.09161950898571336, "mean_env_wait_ms": 0.7621420719894121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701448440551758, "StateBufferConnector_ms": 0.0027031898498535156, "ViewRequirementAgentConnector_ms": 0.06804847717285156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42070800, "num_agent_steps_trained": 42070800, "num_env_steps_sampled": 42070800, "num_env_steps_trained": 42070800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 652.3956900806058, "num_env_steps_trained_throughput_per_sec": 652.3956900806058, "timesteps_total": 42070800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42070800, "timers": {"training_iteration_time_ms": 68018.217, "sample_time_ms": 66748.137, "load_time_ms": 20.737, "load_throughput": 2117987.071, "learn_time_ms": 1248.156, "learn_throughput": 35187.9, "synch_weights_time_ms": 0.996}, "counters": {"num_env_steps_sampled": 42070800, "num_env_steps_trained": 42070800, "num_agent_steps_sampled": 42070800, "num_agent_steps_trained": 42070800}, "done": false, "episodes_total": 9131, "training_iteration": 2868, "trial_id": "11c4c_00000", "date": "2023-08-07_11-58-25", "timestamp": 1691398705, "time_this_iter_s": 67.32423996925354, "time_total_s": 73423.9039838314, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9653.492695569992, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 26.859375, "ram_util_percent": 70.85104166666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.89533636243283, "policy_loss": -5626258.6487620715, "vf_loss": 5986973.367802478}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 101185.5, "diff_num_grad_updates_vs_sampler_policy": 101184.5}}, "num_env_steps_sampled": 42114720, "num_env_steps_trained": 42114720, "num_agent_steps_sampled": 42114720, "num_agent_steps_trained": 42114720}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180419.5234515462, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2195116337854357, "mean_inference_ms": 0.37540790674187974, "mean_action_processing_ms": 0.09162697864589217, "mean_env_wait_ms": 0.7619609584230544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036995410919189453, "StateBufferConnector_ms": 0.0027031898498535156, "ViewRequirementAgentConnector_ms": 0.06803202629089355}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180419.5234515462, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185594.27843973675, -181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2195116337854357, "mean_inference_ms": 0.37540790674187974, "mean_action_processing_ms": 0.09162697864589217, "mean_env_wait_ms": 0.7619609584230544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036995410919189453, "StateBufferConnector_ms": 0.0027031898498535156, "ViewRequirementAgentConnector_ms": 0.06803202629089355}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42114720, "num_agent_steps_trained": 42114720, "num_env_steps_sampled": 42114720, "num_env_steps_trained": 42114720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 649.7643011652351, "num_env_steps_trained_throughput_per_sec": 649.7643011652351, "timesteps_total": 42114720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42114720, "timers": {"training_iteration_time_ms": 67974.823, "sample_time_ms": 66729.311, "load_time_ms": 20.518, "load_throughput": 2140562.729, "learn_time_ms": 1223.837, "learn_throughput": 35887.122, "synch_weights_time_ms": 0.967}, "counters": {"num_env_steps_sampled": 42114720, "num_env_steps_trained": 42114720, "num_agent_steps_sampled": 42114720, "num_agent_steps_trained": 42114720}, "done": false, "episodes_total": 9132, "training_iteration": 2869, "trial_id": "11c4c_00000", "date": "2023-08-07_11-59-33", "timestamp": 1691398773, "time_this_iter_s": 67.5973060131073, "time_total_s": 73491.50128984451, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9721.0900015831, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 27.840625, "ram_util_percent": 70.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9766397726431, "policy_loss": -5664969.615171738, "vf_loss": 6009290.923833819}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 101871.5, "diff_num_grad_updates_vs_sampler_policy": 101870.5}}, "num_env_steps_sampled": 42158640, "num_env_steps_trained": 42158640, "num_agent_steps_sampled": 42158640, "num_agent_steps_trained": 42158640}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180331.7177656717, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21953913193836208, "mean_inference_ms": 0.3754508816535351, "mean_action_processing_ms": 0.09163521168384584, "mean_env_wait_ms": 0.7617875442725276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003700733184814453, "StateBufferConnector_ms": 0.002701282501220703, "ViewRequirementAgentConnector_ms": 0.06802940368652344}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180331.7177656717, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181362.06348872217, -183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21953913193836208, "mean_inference_ms": 0.3754508816535351, "mean_action_processing_ms": 0.09163521168384584, "mean_env_wait_ms": 0.7617875442725276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003700733184814453, "StateBufferConnector_ms": 0.002701282501220703, "ViewRequirementAgentConnector_ms": 0.06802940368652344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42158640, "num_agent_steps_trained": 42158640, "num_env_steps_sampled": 42158640, "num_env_steps_trained": 42158640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 651.0503513904117, "num_env_steps_trained_throughput_per_sec": 651.0503513904117, "timesteps_total": 42158640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42158640, "timers": {"training_iteration_time_ms": 67862.005, "sample_time_ms": 66618.493, "load_time_ms": 19.765, "load_throughput": 2222134.412, "learn_time_ms": 1222.602, "learn_throughput": 35923.396, "synch_weights_time_ms": 0.962}, "counters": {"num_env_steps_sampled": 42158640, "num_env_steps_trained": 42158640, "num_agent_steps_sampled": 42158640, "num_agent_steps_trained": 42158640}, "done": false, "episodes_total": 9133, "training_iteration": 2870, "trial_id": "11c4c_00000", "date": "2023-08-07_12-00-40", "timestamp": 1691398840, "time_this_iter_s": 67.46332383155823, "time_total_s": 73558.96461367607, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9788.553325414658, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 26.634375000000002, "ram_util_percent": 70.46249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.0478748733031, "policy_loss": -5494107.405381628, "vf_loss": 5969405.9016034985}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 102557.5, "diff_num_grad_updates_vs_sampler_policy": 102556.5}}, "num_env_steps_sampled": 42202560, "num_env_steps_trained": 42202560, "num_agent_steps_sampled": 42202560, "num_agent_steps_trained": 42202560}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180278.36620573976, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21956859573224574, "mean_inference_ms": 0.37549911102991984, "mean_action_processing_ms": 0.09164436636007656, "mean_env_wait_ms": 0.7616206786374906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696918487548828, "StateBufferConnector_ms": 0.002710103988647461, "ViewRequirementAgentConnector_ms": 0.06804108619689941}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180278.36620573976, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-183592.9741902519, -184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21956859573224574, "mean_inference_ms": 0.37549911102991984, "mean_action_processing_ms": 0.09164436636007656, "mean_env_wait_ms": 0.7616206786374906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696918487548828, "StateBufferConnector_ms": 0.002710103988647461, "ViewRequirementAgentConnector_ms": 0.06804108619689941}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42202560, "num_agent_steps_trained": 42202560, "num_env_steps_sampled": 42202560, "num_env_steps_trained": 42202560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 648.5044957419689, "num_env_steps_trained_throughput_per_sec": 648.5044957419689, "timesteps_total": 42202560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42202560, "timers": {"training_iteration_time_ms": 67838.874, "sample_time_ms": 66599.361, "load_time_ms": 19.756, "load_throughput": 2223078.354, "learn_time_ms": 1218.632, "learn_throughput": 36040.407, "synch_weights_time_ms": 0.947}, "counters": {"num_env_steps_sampled": 42202560, "num_env_steps_trained": 42202560, "num_agent_steps_sampled": 42202560, "num_agent_steps_trained": 42202560}, "done": false, "episodes_total": 9134, "training_iteration": 2871, "trial_id": "11c4c_00000", "date": "2023-08-07_12-01-48", "timestamp": 1691398908, "time_this_iter_s": 67.72813296318054, "time_total_s": 73626.69274663925, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9856.281458377838, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 27.491666666666664, "ram_util_percent": 71.059375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.11514228843043, "policy_loss": -6010328.000609284, "vf_loss": 6245483.697521866}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 103243.5, "diff_num_grad_updates_vs_sampler_policy": 103242.5}}, "num_env_steps_sampled": 42246480, "num_env_steps_trained": 42246480, "num_agent_steps_sampled": 42246480, "num_agent_steps_trained": 42246480}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180239.8930324542, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21959990524011655, "mean_inference_ms": 0.3755488978794678, "mean_action_processing_ms": 0.09165373859664937, "mean_env_wait_ms": 0.7614558146878605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037415027618408203, "StateBufferConnector_ms": 0.002747058868408203, "ViewRequirementAgentConnector_ms": 0.06896042823791504}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180239.8930324542, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-184309.02916650884, -187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21959990524011655, "mean_inference_ms": 0.3755488978794678, "mean_action_processing_ms": 0.09165373859664937, "mean_env_wait_ms": 0.7614558146878605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037415027618408203, "StateBufferConnector_ms": 0.002747058868408203, "ViewRequirementAgentConnector_ms": 0.06896042823791504}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42246480, "num_agent_steps_trained": 42246480, "num_env_steps_sampled": 42246480, "num_env_steps_trained": 42246480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 655.1290286076423, "num_env_steps_trained_throughput_per_sec": 655.1290286076423, "timesteps_total": 42246480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42246480, "timers": {"training_iteration_time_ms": 67617.706, "sample_time_ms": 66375.345, "load_time_ms": 19.634, "load_throughput": 2236937.686, "learn_time_ms": 1221.601, "learn_throughput": 35952.816, "synch_weights_time_ms": 0.948}, "counters": {"num_env_steps_sampled": 42246480, "num_env_steps_trained": 42246480, "num_agent_steps_sampled": 42246480, "num_agent_steps_trained": 42246480}, "done": false, "episodes_total": 9135, "training_iteration": 2872, "trial_id": "11c4c_00000", "date": "2023-08-07_12-02-55", "timestamp": 1691398975, "time_this_iter_s": 67.04327774047852, "time_total_s": 73693.73602437973, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9923.324736118317, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 27.17368421052631, "ram_util_percent": 71.02842105263157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.04596788056045, "policy_loss": -5471833.122713761, "vf_loss": 5896295.253644315}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 103929.5, "diff_num_grad_updates_vs_sampler_policy": 103928.5}}, "num_env_steps_sampled": 42290400, "num_env_steps_trained": 42290400, "num_agent_steps_sampled": 42290400, "num_agent_steps_trained": 42290400}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180148.21730326072, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2196337047911407, "mean_inference_ms": 0.3756037851243477, "mean_action_processing_ms": 0.09166404742388026, "mean_env_wait_ms": 0.7612950976080545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003742218017578125, "StateBufferConnector_ms": 0.002743959426879883, "ViewRequirementAgentConnector_ms": 0.06894779205322266}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187761.45318368674, "episode_reward_mean": -180148.21730326072, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-187761.45318368674, -182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2196337047911407, "mean_inference_ms": 0.3756037851243477, "mean_action_processing_ms": 0.09166404742388026, "mean_env_wait_ms": 0.7612950976080545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003742218017578125, "StateBufferConnector_ms": 0.002743959426879883, "ViewRequirementAgentConnector_ms": 0.06894779205322266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42290400, "num_agent_steps_trained": 42290400, "num_env_steps_sampled": 42290400, "num_env_steps_trained": 42290400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 637.9114333821782, "num_env_steps_trained_throughput_per_sec": 637.9114333821782, "timesteps_total": 42290400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42290400, "timers": {"training_iteration_time_ms": 67751.238, "sample_time_ms": 66555.294, "load_time_ms": 18.912, "load_throughput": 2322387.059, "learn_time_ms": 1175.906, "learn_throughput": 37349.925, "synch_weights_time_ms": 0.947}, "counters": {"num_env_steps_sampled": 42290400, "num_env_steps_trained": 42290400, "num_agent_steps_sampled": 42290400, "num_agent_steps_trained": 42290400}, "done": false, "episodes_total": 9136, "training_iteration": 2873, "trial_id": "11c4c_00000", "date": "2023-08-07_12-04-04", "timestamp": 1691399044, "time_this_iter_s": 68.85275292396545, "time_total_s": 73762.5887773037, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 9992.177489042282, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 29.768367346938778, "ram_util_percent": 71.08775510204083}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.88065540547274, "policy_loss": -5661364.643705585, "vf_loss": 5779470.294642857}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 104615.5, "diff_num_grad_updates_vs_sampler_policy": 104614.5}}, "num_env_steps_sampled": 42334320, "num_env_steps_trained": 42334320, "num_agent_steps_sampled": 42334320, "num_agent_steps_trained": 42334320}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -180009.54596816486, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2196702225299739, "mean_inference_ms": 0.3756643994431616, "mean_action_processing_ms": 0.09167545996978116, "mean_env_wait_ms": 0.761138484891823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037415027618408203, "StateBufferConnector_ms": 0.002745389938354492, "ViewRequirementAgentConnector_ms": 0.06899094581604004}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -180009.54596816486, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-182759.19769760818, -183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2196702225299739, "mean_inference_ms": 0.3756643994431616, "mean_action_processing_ms": 0.09167545996978116, "mean_env_wait_ms": 0.761138484891823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037415027618408203, "StateBufferConnector_ms": 0.002745389938354492, "ViewRequirementAgentConnector_ms": 0.06899094581604004}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42334320, "num_agent_steps_trained": 42334320, "num_env_steps_sampled": 42334320, "num_env_steps_trained": 42334320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 631.6790970144303, "num_env_steps_trained_throughput_per_sec": 631.6790970144303, "timesteps_total": 42334320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42334320, "timers": {"training_iteration_time_ms": 68035.943, "sample_time_ms": 66841.244, "load_time_ms": 18.82, "load_throughput": 2333681.691, "learn_time_ms": 1174.773, "learn_throughput": 37385.932, "synch_weights_time_ms": 0.934}, "counters": {"num_env_steps_sampled": 42334320, "num_env_steps_trained": 42334320, "num_agent_steps_sampled": 42334320, "num_agent_steps_trained": 42334320}, "done": false, "episodes_total": 9137, "training_iteration": 2874, "trial_id": "11c4c_00000", "date": "2023-08-07_12-05-14", "timestamp": 1691399114, "time_this_iter_s": 69.53192186355591, "time_total_s": 73832.12069916725, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10061.709410905838, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 31.69090909090909, "ram_util_percent": 71.0080808080808}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.375e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.08803831940145, "policy_loss": -5734268.3341893675, "vf_loss": 6073508.853954081}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 105301.5, "diff_num_grad_updates_vs_sampler_policy": 105300.5}}, "num_env_steps_sampled": 42378240, "num_env_steps_trained": 42378240, "num_agent_steps_sampled": 42378240, "num_agent_steps_trained": 42378240}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179954.46601638626, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2197081293501388, "mean_inference_ms": 0.3757299104774656, "mean_action_processing_ms": 0.09168782413730675, "mean_env_wait_ms": 0.7609838766861797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003741741180419922, "StateBufferConnector_ms": 0.002747774124145508, "ViewRequirementAgentConnector_ms": 0.0690302848815918}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179954.46601638626, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-183121.9656967753, -185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2197081293501388, "mean_inference_ms": 0.3757299104774656, "mean_action_processing_ms": 0.09168782413730675, "mean_env_wait_ms": 0.7609838766861797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003741741180419922, "StateBufferConnector_ms": 0.002747774124145508, "ViewRequirementAgentConnector_ms": 0.0690302848815918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42378240, "num_agent_steps_trained": 42378240, "num_env_steps_sampled": 42378240, "num_env_steps_trained": 42378240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 652.7664072423311, "num_env_steps_trained_throughput_per_sec": 652.7664072423311, "timesteps_total": 42378240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42378240, "timers": {"training_iteration_time_ms": 67472.065, "sample_time_ms": 66277.181, "load_time_ms": 18.137, "load_throughput": 2421549.803, "learn_time_ms": 1175.65, "learn_throughput": 37358.072, "synch_weights_time_ms": 0.926}, "counters": {"num_env_steps_sampled": 42378240, "num_env_steps_trained": 42378240, "num_agent_steps_sampled": 42378240, "num_agent_steps_trained": 42378240}, "done": false, "episodes_total": 9138, "training_iteration": 2875, "trial_id": "11c4c_00000", "date": "2023-08-07_12-06-21", "timestamp": 1691399181, "time_this_iter_s": 67.28583312034607, "time_total_s": 73899.4065322876, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10128.995244026184, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 27.503125, "ram_util_percent": 71.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.75e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.1269640686213, "policy_loss": -5415620.299545599, "vf_loss": 5957537.77869898}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 105987.5, "diff_num_grad_updates_vs_sampler_policy": 105986.5}}, "num_env_steps_sampled": 42422160, "num_env_steps_trained": 42422160, "num_agent_steps_sampled": 42422160, "num_agent_steps_trained": 42422160}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179883.36919076447, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2197468567610497, "mean_inference_ms": 0.37579818400831927, "mean_action_processing_ms": 0.09170064748302796, "mean_env_wait_ms": 0.7608259800219624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003738880157470703, "StateBufferConnector_ms": 0.002747058868408203, "ViewRequirementAgentConnector_ms": 0.06907248497009277}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179883.36919076447, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185512.52386674195, -184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2197468567610497, "mean_inference_ms": 0.37579818400831927, "mean_action_processing_ms": 0.09170064748302796, "mean_env_wait_ms": 0.7608259800219624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003738880157470703, "StateBufferConnector_ms": 0.002747058868408203, "ViewRequirementAgentConnector_ms": 0.06907248497009277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42422160, "num_agent_steps_trained": 42422160, "num_env_steps_sampled": 42422160, "num_env_steps_trained": 42422160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 687.1807534988947, "num_env_steps_trained_throughput_per_sec": 687.1807534988947, "timesteps_total": 42422160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42422160, "timers": {"training_iteration_time_ms": 67452.175, "sample_time_ms": 66232.191, "load_time_ms": 19.166, "load_throughput": 2291587.342, "learn_time_ms": 1199.693, "learn_throughput": 36609.374, "synch_weights_time_ms": 0.951}, "counters": {"num_env_steps_sampled": 42422160, "num_env_steps_trained": 42422160, "num_agent_steps_sampled": 42422160, "num_agent_steps_trained": 42422160}, "done": false, "episodes_total": 9139, "training_iteration": 2876, "trial_id": "11c4c_00000", "date": "2023-08-07_12-07-25", "timestamp": 1691399245, "time_this_iter_s": 63.91662120819092, "time_total_s": 73963.32315349579, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10192.911865234375, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 21.462637362637363, "ram_util_percent": 71.11208791208792}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.125000000000002e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.0963681056965, "policy_loss": -4938542.255708477, "vf_loss": 5827894.142674927}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 106673.5, "diff_num_grad_updates_vs_sampler_policy": 106672.5}}, "num_env_steps_sampled": 42466080, "num_env_steps_trained": 42466080, "num_agent_steps_sampled": 42466080, "num_agent_steps_trained": 42466080}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179771.97155664218, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2197870888681856, "mean_inference_ms": 0.37587140045222056, "mean_action_processing_ms": 0.09171435612937419, "mean_env_wait_ms": 0.7606656809327385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737926483154297, "StateBufferConnector_ms": 0.002749919891357422, "ViewRequirementAgentConnector_ms": 0.06907105445861816}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179771.97155664218, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-184378.7135092014, -181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2197870888681856, "mean_inference_ms": 0.37587140045222056, "mean_action_processing_ms": 0.09171435612937419, "mean_env_wait_ms": 0.7606656809327385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737926483154297, "StateBufferConnector_ms": 0.002749919891357422, "ViewRequirementAgentConnector_ms": 0.06907105445861816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42466080, "num_agent_steps_trained": 42466080, "num_env_steps_sampled": 42466080, "num_env_steps_trained": 42466080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 653.4944181364303, "num_env_steps_trained_throughput_per_sec": 653.4944181364303, "timesteps_total": 42466080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42466080, "timers": {"training_iteration_time_ms": 67392.29, "sample_time_ms": 66203.021, "load_time_ms": 19.173, "load_throughput": 2290749.545, "learn_time_ms": 1168.961, "learn_throughput": 37571.825, "synch_weights_time_ms": 0.961}, "counters": {"num_env_steps_sampled": 42466080, "num_env_steps_trained": 42466080, "num_agent_steps_sampled": 42466080, "num_agent_steps_trained": 42466080}, "done": false, "episodes_total": 9140, "training_iteration": 2877, "trial_id": "11c4c_00000", "date": "2023-08-07_12-08-32", "timestamp": 1691399312, "time_this_iter_s": 67.21082997322083, "time_total_s": 74030.53398346901, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10260.122695207596, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 28.11894736842105, "ram_util_percent": 71.53263157894736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.499999999999998e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.95507354291465, "policy_loss": -5514428.256146934, "vf_loss": 5964128.603498543}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 107359.5, "diff_num_grad_updates_vs_sampler_policy": 107358.5}}, "num_env_steps_sampled": 42510000, "num_env_steps_trained": 42510000, "num_agent_steps_sampled": 42510000, "num_agent_steps_trained": 42510000}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179686.53537762762, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21982789396676355, "mean_inference_ms": 0.3759493204924975, "mean_action_processing_ms": 0.09172889374668315, "mean_env_wait_ms": 0.7605053714000144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037386417388916016, "StateBufferConnector_ms": 0.0027534961700439453, "ViewRequirementAgentConnector_ms": 0.0691220760345459}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179686.53537762762, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181424.60393669314, -184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21982789396676355, "mean_inference_ms": 0.3759493204924975, "mean_action_processing_ms": 0.09172889374668315, "mean_env_wait_ms": 0.7605053714000144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037386417388916016, "StateBufferConnector_ms": 0.0027534961700439453, "ViewRequirementAgentConnector_ms": 0.0691220760345459}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42510000, "num_agent_steps_trained": 42510000, "num_env_steps_sampled": 42510000, "num_env_steps_trained": 42510000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 656.5614232227692, "num_env_steps_trained_throughput_per_sec": 656.5614232227692, "timesteps_total": 42510000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42510000, "timers": {"training_iteration_time_ms": 67349.571, "sample_time_ms": 66150.107, "load_time_ms": 19.974, "load_throughput": 2198833.007, "learn_time_ms": 1178.275, "learn_throughput": 37274.816, "synch_weights_time_ms": 1.038}, "counters": {"num_env_steps_sampled": 42510000, "num_env_steps_trained": 42510000, "num_agent_steps_sampled": 42510000, "num_agent_steps_trained": 42510000}, "done": false, "episodes_total": 9141, "training_iteration": 2878, "trial_id": "11c4c_00000", "date": "2023-08-07_12-09-39", "timestamp": 1691399379, "time_this_iter_s": 66.89802169799805, "time_total_s": 74097.43200516701, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10327.020716905594, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 27.477894736842103, "ram_util_percent": 71.68947368421054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.874999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.0219727452225, "policy_loss": -5413848.711859968, "vf_loss": 5637151.391763848}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 108045.5, "diff_num_grad_updates_vs_sampler_policy": 108044.5}}, "num_env_steps_sampled": 42553920, "num_env_steps_trained": 42553920, "num_agent_steps_sampled": 42553920, "num_agent_steps_trained": 42553920}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179592.26520235837, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21986910960956305, "mean_inference_ms": 0.3760304293892116, "mean_action_processing_ms": 0.0917440081070584, "mean_env_wait_ms": 0.7603421156752084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003735065460205078, "StateBufferConnector_ms": 0.0027570724487304688, "ViewRequirementAgentConnector_ms": 0.06912970542907715}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179592.26520235837, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-184569.87234057908, -185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21986910960956305, "mean_inference_ms": 0.3760304293892116, "mean_action_processing_ms": 0.0917440081070584, "mean_env_wait_ms": 0.7603421156752084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003735065460205078, "StateBufferConnector_ms": 0.0027570724487304688, "ViewRequirementAgentConnector_ms": 0.06912970542907715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42553920, "num_agent_steps_trained": 42553920, "num_env_steps_sampled": 42553920, "num_env_steps_trained": 42553920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 681.0561812968227, "num_env_steps_trained_throughput_per_sec": 681.0561812968227, "timesteps_total": 42553920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42553920, "timers": {"training_iteration_time_ms": 67039.004, "sample_time_ms": 65846.011, "load_time_ms": 20.054, "load_throughput": 2190086.048, "learn_time_ms": 1171.742, "learn_throughput": 37482.66, "synch_weights_time_ms": 1.026}, "counters": {"num_env_steps_sampled": 42553920, "num_env_steps_trained": 42553920, "num_agent_steps_sampled": 42553920, "num_agent_steps_trained": 42553920}, "done": false, "episodes_total": 9142, "training_iteration": 2879, "trial_id": "11c4c_00000", "date": "2023-08-07_12-10-43", "timestamp": 1691399443, "time_this_iter_s": 64.49115371704102, "time_total_s": 74161.92315888405, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10391.511870622635, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 21.23478260869565, "ram_util_percent": 72.30217391304348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.25e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.01479942388505, "policy_loss": -5796025.718516536, "vf_loss": 6194953.408163265}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 108731.5, "diff_num_grad_updates_vs_sampler_policy": 108730.5}}, "num_env_steps_sampled": 42597840, "num_env_steps_trained": 42597840, "num_agent_steps_sampled": 42597840, "num_agent_steps_trained": 42597840}, "sampler_results": {"episode_reward_max": -171737.49409837037, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179538.82070442606, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21991080024015539, "mean_inference_ms": 0.3761132896211911, "mean_action_processing_ms": 0.09175943740445153, "mean_env_wait_ms": 0.7601767619493256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037343502044677734, "StateBufferConnector_ms": 0.0027549266815185547, "ViewRequirementAgentConnector_ms": 0.06912708282470703}}, "episode_reward_max": -171737.49409837037, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179538.82070442606, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185060.64772875918, -183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21991080024015539, "mean_inference_ms": 0.3761132896211911, "mean_action_processing_ms": 0.09175943740445153, "mean_env_wait_ms": 0.7601767619493256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037343502044677734, "StateBufferConnector_ms": 0.0027549266815185547, "ViewRequirementAgentConnector_ms": 0.06912708282470703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42597840, "num_agent_steps_trained": 42597840, "num_env_steps_sampled": 42597840, "num_env_steps_trained": 42597840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 694.4706077093479, "num_env_steps_trained_throughput_per_sec": 694.4706077093479, "timesteps_total": 42597840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42597840, "timers": {"training_iteration_time_ms": 66617.224, "sample_time_ms": 65425.708, "load_time_ms": 20.118, "load_throughput": 2183119.798, "learn_time_ms": 1170.195, "learn_throughput": 37532.206, "synch_weights_time_ms": 1.033}, "counters": {"num_env_steps_sampled": 42597840, "num_env_steps_trained": 42597840, "num_agent_steps_sampled": 42597840, "num_agent_steps_trained": 42597840}, "done": false, "episodes_total": 9143, "training_iteration": 2880, "trial_id": "11c4c_00000", "date": "2023-08-07_12-11-47", "timestamp": 1691399507, "time_this_iter_s": 63.24535083770752, "time_total_s": 74225.16850972176, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10454.757221460342, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 17.845555555555556, "ram_util_percent": 72.25333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.625000000000001e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9491857856773, "policy_loss": -4680843.1317128, "vf_loss": 5452745.630739796}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 109417.5, "diff_num_grad_updates_vs_sampler_policy": 109416.5}}, "num_env_steps_sampled": 42641760, "num_env_steps_trained": 42641760, "num_agent_steps_sampled": 42641760, "num_agent_steps_trained": 42641760}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179380.70855598708, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2199531645466089, "mean_inference_ms": 0.3761982617931111, "mean_action_processing_ms": 0.0917752188152317, "mean_env_wait_ms": 0.7600093304922937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037348270416259766, "StateBufferConnector_ms": 0.002756834030151367, "ViewRequirementAgentConnector_ms": 0.06913614273071289}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179380.70855598708, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-183100.12246960832, -182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2199531645466089, "mean_inference_ms": 0.3761982617931111, "mean_action_processing_ms": 0.0917752188152317, "mean_env_wait_ms": 0.7600093304922937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037348270416259766, "StateBufferConnector_ms": 0.002756834030151367, "ViewRequirementAgentConnector_ms": 0.06913614273071289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42641760, "num_agent_steps_trained": 42641760, "num_env_steps_sampled": 42641760, "num_env_steps_trained": 42641760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 693.6016769351542, "num_env_steps_trained_throughput_per_sec": 693.6016769351542, "timesteps_total": 42641760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42641760, "timers": {"training_iteration_time_ms": 66176.883, "sample_time_ms": 64986.225, "load_time_ms": 19.919, "load_throughput": 2204975.925, "learn_time_ms": 1169.545, "learn_throughput": 37553.065, "synch_weights_time_ms": 1.026}, "counters": {"num_env_steps_sampled": 42641760, "num_env_steps_trained": 42641760, "num_agent_steps_sampled": 42641760, "num_agent_steps_trained": 42641760}, "done": false, "episodes_total": 9144, "training_iteration": 2881, "trial_id": "11c4c_00000", "date": "2023-08-07_12-12-50", "timestamp": 1691399570, "time_this_iter_s": 63.32448887825012, "time_total_s": 74288.4929986, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10518.081710338593, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 18.143333333333334, "ram_util_percent": 72.25777777777776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.0652310118383, "policy_loss": -5209788.948273506, "vf_loss": 5966902.64340379}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 110103.5, "diff_num_grad_updates_vs_sampler_policy": 110102.5}}, "num_env_steps_sampled": 42685680, "num_env_steps_trained": 42685680, "num_agent_steps_sampled": 42685680, "num_agent_steps_trained": 42685680}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179309.12223122534, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21999590804851624, "mean_inference_ms": 0.3762855454244448, "mean_action_processing_ms": 0.09179143070096102, "mean_env_wait_ms": 0.7598399964704339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037338733673095703, "StateBufferConnector_ms": 0.002753019332885742, "ViewRequirementAgentConnector_ms": 0.06913423538208008}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179309.12223122534, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-182611.85960449468, -182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21999590804851624, "mean_inference_ms": 0.3762855454244448, "mean_action_processing_ms": 0.09179143070096102, "mean_env_wait_ms": 0.7598399964704339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037338733673095703, "StateBufferConnector_ms": 0.002753019332885742, "ViewRequirementAgentConnector_ms": 0.06913423538208008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42685680, "num_agent_steps_trained": 42685680, "num_env_steps_sampled": 42685680, "num_env_steps_trained": 42685680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 694.5949371435764, "num_env_steps_trained_throughput_per_sec": 694.5949371435764, "timesteps_total": 42685680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42685680, "timers": {"training_iteration_time_ms": 65795.97, "sample_time_ms": 64607.236, "load_time_ms": 19.947, "load_throughput": 2201847.545, "learn_time_ms": 1167.586, "learn_throughput": 37616.086, "synch_weights_time_ms": 1.032}, "counters": {"num_env_steps_sampled": 42685680, "num_env_steps_trained": 42685680, "num_agent_steps_sampled": 42685680, "num_agent_steps_trained": 42685680}, "done": false, "episodes_total": 9145, "training_iteration": 2882, "trial_id": "11c4c_00000", "date": "2023-08-07_12-13-53", "timestamp": 1691399633, "time_this_iter_s": 63.234137773513794, "time_total_s": 74351.72713637352, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10581.315848112106, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 18.90111111111111, "ram_util_percent": 72.52555555555554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.1113604220287, "policy_loss": -4550228.559479205, "vf_loss": 5664717.6909620995}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 110789.5, "diff_num_grad_updates_vs_sampler_policy": 110788.5}}, "num_env_steps_sampled": 42729600, "num_env_steps_trained": 42729600, "num_agent_steps_sampled": 42729600, "num_agent_steps_trained": 42729600}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179204.72544079472, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22003830214061373, "mean_inference_ms": 0.37637364842066434, "mean_action_processing_ms": 0.09180776172904619, "mean_env_wait_ms": 0.7596692255105875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003734111785888672, "StateBufferConnector_ms": 0.0027589797973632812, "ViewRequirementAgentConnector_ms": 0.06917142868041992}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179204.72544079472, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-182952.10329578724, -187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22003830214061373, "mean_inference_ms": 0.37637364842066434, "mean_action_processing_ms": 0.09180776172904619, "mean_env_wait_ms": 0.7596692255105875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003734111785888672, "StateBufferConnector_ms": 0.0027589797973632812, "ViewRequirementAgentConnector_ms": 0.06917142868041992}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42729600, "num_agent_steps_trained": 42729600, "num_env_steps_sampled": 42729600, "num_env_steps_trained": 42729600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 696.7212640424983, "num_env_steps_trained_throughput_per_sec": 696.7212640424983, "timesteps_total": 42729600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42729600, "timers": {"training_iteration_time_ms": 65214.814, "sample_time_ms": 64026.86, "load_time_ms": 20.006, "load_throughput": 2195342.596, "learn_time_ms": 1166.737, "learn_throughput": 37643.455, "synch_weights_time_ms": 1.043}, "counters": {"num_env_steps_sampled": 42729600, "num_env_steps_trained": 42729600, "num_agent_steps_sampled": 42729600, "num_agent_steps_trained": 42729600}, "done": false, "episodes_total": 9146, "training_iteration": 2883, "trial_id": "11c4c_00000", "date": "2023-08-07_12-14-56", "timestamp": 1691399696, "time_this_iter_s": 63.04115104675293, "time_total_s": 74414.76828742027, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10644.35699915886, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 18.174444444444443, "ram_util_percent": 72.52777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.09263299435986, "policy_loss": -5330831.610237678, "vf_loss": 5775217.231413994}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 111475.5, "diff_num_grad_updates_vs_sampler_policy": 111474.5}}, "num_env_steps_sampled": 42773520, "num_env_steps_trained": 42773520, "num_agent_steps_sampled": 42773520, "num_agent_steps_trained": 42773520}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179109.981668154, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22008044476165914, "mean_inference_ms": 0.3764625264631815, "mean_action_processing_ms": 0.09182424617976992, "mean_env_wait_ms": 0.7594993529073834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003735065460205078, "StateBufferConnector_ms": 0.0027589797973632812, "ViewRequirementAgentConnector_ms": 0.06918072700500488}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -187409.01724278316, "episode_reward_mean": -179109.981668154, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-187409.01724278316, -183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22008044476165914, "mean_inference_ms": 0.3764625264631815, "mean_action_processing_ms": 0.09182424617976992, "mean_env_wait_ms": 0.7594993529073834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003735065460205078, "StateBufferConnector_ms": 0.0027589797973632812, "ViewRequirementAgentConnector_ms": 0.06918072700500488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42773520, "num_agent_steps_trained": 42773520, "num_env_steps_sampled": 42773520, "num_env_steps_trained": 42773520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 696.1879003842766, "num_env_steps_trained_throughput_per_sec": 696.1879003842766, "timesteps_total": 42773520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42773520, "timers": {"training_iteration_time_ms": 64570.558, "sample_time_ms": 63381.489, "load_time_ms": 20.006, "load_throughput": 2195311.202, "learn_time_ms": 1167.851, "learn_throughput": 37607.531, "synch_weights_time_ms": 1.042}, "counters": {"num_env_steps_sampled": 42773520, "num_env_steps_trained": 42773520, "num_agent_steps_sampled": 42773520, "num_agent_steps_trained": 42773520}, "done": false, "episodes_total": 9147, "training_iteration": 2884, "trial_id": "11c4c_00000", "date": "2023-08-07_12-16-00", "timestamp": 1691399760, "time_this_iter_s": 63.08936405181885, "time_total_s": 74477.85765147209, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10707.446363210678, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 18.125842696629213, "ram_util_percent": 72.32584269662921}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.00820638139464, "policy_loss": -5263524.99102018, "vf_loss": 6129842.543549563}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 112161.5, "diff_num_grad_updates_vs_sampler_policy": 112160.5}}, "num_env_steps_sampled": 42817440, "num_env_steps_trained": 42817440, "num_agent_steps_sampled": 42817440, "num_agent_steps_trained": 42817440}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -179012.5528593718, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22012174995619027, "mean_inference_ms": 0.3765510738029479, "mean_action_processing_ms": 0.09184065493917332, "mean_env_wait_ms": 0.759326429128902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003732442855834961, "StateBufferConnector_ms": 0.0027620792388916016, "ViewRequirementAgentConnector_ms": 0.06920742988586426}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -179012.5528593718, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-183368.28016119293, -183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22012174995619027, "mean_inference_ms": 0.3765510738029479, "mean_action_processing_ms": 0.09184065493917332, "mean_env_wait_ms": 0.759326429128902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003732442855834961, "StateBufferConnector_ms": 0.0027620792388916016, "ViewRequirementAgentConnector_ms": 0.06920742988586426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42817440, "num_agent_steps_trained": 42817440, "num_env_steps_sampled": 42817440, "num_env_steps_trained": 42817440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 693.3797219975149, "num_env_steps_trained_throughput_per_sec": 693.3797219975149, "timesteps_total": 42817440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42817440, "timers": {"training_iteration_time_ms": 64176.462, "sample_time_ms": 62979.452, "load_time_ms": 19.847, "load_throughput": 2212922.3, "learn_time_ms": 1175.946, "learn_throughput": 37348.666, "synch_weights_time_ms": 1.045}, "counters": {"num_env_steps_sampled": 42817440, "num_env_steps_trained": 42817440, "num_agent_steps_sampled": 42817440, "num_agent_steps_trained": 42817440}, "done": false, "episodes_total": 9148, "training_iteration": 2885, "trial_id": "11c4c_00000", "date": "2023-08-07_12-17-03", "timestamp": 1691399823, "time_this_iter_s": 63.345053911209106, "time_total_s": 74541.2027053833, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10770.791417121887, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 17.44111111111111, "ram_util_percent": 72.30666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.00872851669266, "policy_loss": -4946552.64440313, "vf_loss": 5775622.465561224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 112847.5, "diff_num_grad_updates_vs_sampler_policy": 112846.5}}, "num_env_steps_sampled": 42861360, "num_env_steps_trained": 42861360, "num_agent_steps_sampled": 42861360, "num_agent_steps_trained": 42861360}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178910.65670502215, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22016326838835723, "mean_inference_ms": 0.37664049773674235, "mean_action_processing_ms": 0.09185730590868024, "mean_env_wait_ms": 0.7591508269982726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003733396530151367, "StateBufferConnector_ms": 0.0027620792388916016, "ViewRequirementAgentConnector_ms": 0.06919741630554199}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178910.65670502215, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-183594.25178723098, -183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22016326838835723, "mean_inference_ms": 0.37664049773674235, "mean_action_processing_ms": 0.09185730590868024, "mean_env_wait_ms": 0.7591508269982726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003733396530151367, "StateBufferConnector_ms": 0.0027620792388916016, "ViewRequirementAgentConnector_ms": 0.06919741630554199}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42861360, "num_agent_steps_trained": 42861360, "num_env_steps_sampled": 42861360, "num_env_steps_trained": 42861360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 691.1557595556759, "num_env_steps_trained_throughput_per_sec": 691.1557595556759, "timesteps_total": 42861360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42861360, "timers": {"training_iteration_time_ms": 64139.704, "sample_time_ms": 62967.378, "load_time_ms": 18.561, "load_throughput": 2366284.54, "learn_time_ms": 1152.568, "learn_throughput": 38106.214, "synch_weights_time_ms": 1.028}, "counters": {"num_env_steps_sampled": 42861360, "num_env_steps_trained": 42861360, "num_agent_steps_sampled": 42861360, "num_agent_steps_trained": 42861360}, "done": false, "episodes_total": 9149, "training_iteration": 2886, "trial_id": "11c4c_00000", "date": "2023-08-07_12-18-07", "timestamp": 1691399887, "time_this_iter_s": 63.54861402511597, "time_total_s": 74604.75131940842, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10834.340031147003, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 18.125274725274725, "ram_util_percent": 72.11538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.19386678534414, "policy_loss": -5140709.260915861, "vf_loss": 5926243.594023324}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 113533.5, "diff_num_grad_updates_vs_sampler_policy": 113532.5}}, "num_env_steps_sampled": 42905280, "num_env_steps_trained": 42905280, "num_agent_steps_sampled": 42905280, "num_agent_steps_trained": 42905280}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178828.11258473777, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22020457015648084, "mean_inference_ms": 0.37672841331825585, "mean_action_processing_ms": 0.0918736880852126, "mean_env_wait_ms": 0.7589781416658075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037369728088378906, "StateBufferConnector_ms": 0.0027620792388916016, "ViewRequirementAgentConnector_ms": 0.06921911239624023}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178828.11258473777, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-183673.40385292994, -182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22020457015648084, "mean_inference_ms": 0.37672841331825585, "mean_action_processing_ms": 0.0918736880852126, "mean_env_wait_ms": 0.7589781416658075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037369728088378906, "StateBufferConnector_ms": 0.0027620792388916016, "ViewRequirementAgentConnector_ms": 0.06921911239624023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42905280, "num_agent_steps_trained": 42905280, "num_env_steps_sampled": 42905280, "num_env_steps_trained": 42905280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 694.1375833992482, "num_env_steps_trained_throughput_per_sec": 694.1375833992482, "timesteps_total": 42905280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42905280, "timers": {"training_iteration_time_ms": 63746.19, "sample_time_ms": 62575.968, "load_time_ms": 18.533, "load_throughput": 2369864.479, "learn_time_ms": 1150.509, "learn_throughput": 38174.414, "synch_weights_time_ms": 1.012}, "counters": {"num_env_steps_sampled": 42905280, "num_env_steps_trained": 42905280, "num_agent_steps_sampled": 42905280, "num_agent_steps_trained": 42905280}, "done": false, "episodes_total": 9150, "training_iteration": 2887, "trial_id": "11c4c_00000", "date": "2023-08-07_12-19-10", "timestamp": 1691399950, "time_this_iter_s": 63.275733947753906, "time_total_s": 74668.02705335617, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10897.615765094757, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 17.907865168539328, "ram_util_percent": 72.03033707865167}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.2390465917115, "policy_loss": -5236235.602499203, "vf_loss": 6003937.572157434}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 114219.5, "diff_num_grad_updates_vs_sampler_policy": 114218.5}}, "num_env_steps_sampled": 42949200, "num_env_steps_trained": 42949200, "num_agent_steps_sampled": 42949200, "num_agent_steps_trained": 42949200}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178752.41181969614, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2202442310793782, "mean_inference_ms": 0.3768122354843657, "mean_action_processing_ms": 0.09188919295523956, "mean_env_wait_ms": 0.7588020062009277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037546157836914062, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.06915402412414551}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178752.41181969614, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-182140.88875032408, -182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2202442310793782, "mean_inference_ms": 0.3768122354843657, "mean_action_processing_ms": 0.09188919295523956, "mean_env_wait_ms": 0.7588020062009277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037546157836914062, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.06915402412414551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42949200, "num_agent_steps_trained": 42949200, "num_env_steps_sampled": 42949200, "num_env_steps_trained": 42949200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 696.6501132665385, "num_env_steps_trained_throughput_per_sec": 696.6501132665385, "timesteps_total": 42949200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42949200, "timers": {"training_iteration_time_ms": 63361.254, "sample_time_ms": 62200.572, "load_time_ms": 17.67, "load_throughput": 2485536.957, "learn_time_ms": 1141.916, "learn_throughput": 38461.662, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 42949200, "num_env_steps_trained": 42949200, "num_agent_steps_sampled": 42949200, "num_agent_steps_trained": 42949200}, "done": false, "episodes_total": 9151, "training_iteration": 2888, "trial_id": "11c4c_00000", "date": "2023-08-07_12-20-13", "timestamp": 1691400013, "time_this_iter_s": 63.04754900932312, "time_total_s": 74731.0746023655, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10960.66331410408, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 18.674444444444443, "ram_util_percent": 71.93777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.13648822217226, "policy_loss": -4946346.987478361, "vf_loss": 5607745.560860058}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 114905.5, "diff_num_grad_updates_vs_sampler_policy": 114904.5}}, "num_env_steps_sampled": 42993120, "num_env_steps_trained": 42993120, "num_agent_steps_sampled": 42993120, "num_agent_steps_trained": 42993120}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178642.09086024837, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22028276429643245, "mean_inference_ms": 0.3768924954279823, "mean_action_processing_ms": 0.09190401157695559, "mean_env_wait_ms": 0.7586232552822568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037539005279541016, "StateBufferConnector_ms": 0.002763986587524414, "ViewRequirementAgentConnector_ms": 0.06917428970336914}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178642.09086024837, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-182924.3354271455, -185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22028276429643245, "mean_inference_ms": 0.3768924954279823, "mean_action_processing_ms": 0.09190401157695559, "mean_env_wait_ms": 0.7586232552822568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037539005279541016, "StateBufferConnector_ms": 0.002763986587524414, "ViewRequirementAgentConnector_ms": 0.06917428970336914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42993120, "num_agent_steps_trained": 42993120, "num_env_steps_sampled": 42993120, "num_env_steps_trained": 42993120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 696.3210443093986, "num_env_steps_trained_throughput_per_sec": 696.3210443093986, "timesteps_total": 42993120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 42993120, "timers": {"training_iteration_time_ms": 63219.882, "sample_time_ms": 62059.111, "load_time_ms": 17.525, "load_throughput": 2506095.827, "learn_time_ms": 1142.153, "learn_throughput": 38453.677, "synch_weights_time_ms": 0.928}, "counters": {"num_env_steps_sampled": 42993120, "num_env_steps_trained": 42993120, "num_agent_steps_sampled": 42993120, "num_agent_steps_trained": 42993120}, "done": false, "episodes_total": 9152, "training_iteration": 2889, "trial_id": "11c4c_00000", "date": "2023-08-07_12-21-16", "timestamp": 1691400076, "time_this_iter_s": 63.07733702659607, "time_total_s": 74794.15193939209, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11023.740651130676, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 17.764044943820224, "ram_util_percent": 71.83932584269664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.02077922320575, "policy_loss": -5718108.037174859, "vf_loss": 5665249.593476676}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 115591.5, "diff_num_grad_updates_vs_sampler_policy": 115590.5}}, "num_env_steps_sampled": 43037040, "num_env_steps_trained": 43037040, "num_agent_steps_sampled": 43037040, "num_agent_steps_trained": 43037040}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178534.538457246, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2203208265929354, "mean_inference_ms": 0.3769717977872205, "mean_action_processing_ms": 0.0919186712023364, "mean_env_wait_ms": 0.7584471855288474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037539005279541016, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.06918883323669434}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178534.538457246, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185363.3250483832, -184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2203208265929354, "mean_inference_ms": 0.3769717977872205, "mean_action_processing_ms": 0.0919186712023364, "mean_env_wait_ms": 0.7584471855288474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037539005279541016, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.06918883323669434}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43037040, "num_agent_steps_trained": 43037040, "num_env_steps_sampled": 43037040, "num_env_steps_trained": 43037040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 688.1360846589181, "num_env_steps_trained_throughput_per_sec": 688.1360846589181, "timesteps_total": 43037040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43037040, "timers": {"training_iteration_time_ms": 63278.098, "sample_time_ms": 62116.758, "load_time_ms": 17.507, "load_throughput": 2508730.622, "learn_time_ms": 1142.742, "learn_throughput": 38433.878, "synch_weights_time_ms": 0.927}, "counters": {"num_env_steps_sampled": 43037040, "num_env_steps_trained": 43037040, "num_agent_steps_sampled": 43037040, "num_agent_steps_trained": 43037040}, "done": false, "episodes_total": 9153, "training_iteration": 2890, "trial_id": "11c4c_00000", "date": "2023-08-07_12-22-20", "timestamp": 1691400140, "time_this_iter_s": 63.82783007621765, "time_total_s": 74857.97976946831, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11087.568481206894, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 17.369230769230768, "ram_util_percent": 71.82197802197804}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9287102257197, "policy_loss": -4861578.277972964, "vf_loss": 5731710.606413994}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 116277.5, "diff_num_grad_updates_vs_sampler_policy": 116276.5}}, "num_env_steps_sampled": 43080960, "num_env_steps_trained": 43080960, "num_agent_steps_sampled": 43080960, "num_agent_steps_trained": 43080960}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178411.9882056866, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22035899711796145, "mean_inference_ms": 0.3770509838452344, "mean_action_processing_ms": 0.0919333236020414, "mean_env_wait_ms": 0.758269191084365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003750324249267578, "StateBufferConnector_ms": 0.0027654170989990234, "ViewRequirementAgentConnector_ms": 0.06915783882141113}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178411.9882056866, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-184341.38116857194, -181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22035899711796145, "mean_inference_ms": 0.3770509838452344, "mean_action_processing_ms": 0.0919333236020414, "mean_env_wait_ms": 0.758269191084365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003750324249267578, "StateBufferConnector_ms": 0.0027654170989990234, "ViewRequirementAgentConnector_ms": 0.06915783882141113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43080960, "num_agent_steps_trained": 43080960, "num_env_steps_sampled": 43080960, "num_env_steps_trained": 43080960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 695.4268966509574, "num_env_steps_trained_throughput_per_sec": 695.4268966509574, "timesteps_total": 43080960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43080960, "timers": {"training_iteration_time_ms": 63261.479, "sample_time_ms": 62100.699, "load_time_ms": 17.48, "load_throughput": 2512593.829, "learn_time_ms": 1142.209, "learn_throughput": 38451.823, "synch_weights_time_ms": 0.928}, "counters": {"num_env_steps_sampled": 43080960, "num_env_steps_trained": 43080960, "num_agent_steps_sampled": 43080960, "num_agent_steps_trained": 43080960}, "done": false, "episodes_total": 9154, "training_iteration": 2891, "trial_id": "11c4c_00000", "date": "2023-08-07_12-23-23", "timestamp": 1691400203, "time_this_iter_s": 63.15874266624451, "time_total_s": 74921.13851213455, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11150.727223873138, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 18.258426966292134, "ram_util_percent": 71.80449438202248}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8946678673213, "policy_loss": -4908234.035352701, "vf_loss": 5832382.895043732}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 116963.5, "diff_num_grad_updates_vs_sampler_policy": 116962.5}}, "num_env_steps_sampled": 43124880, "num_env_steps_trained": 43124880, "num_agent_steps_sampled": 43124880, "num_agent_steps_trained": 43124880}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178310.87929758235, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22039626525925293, "mean_inference_ms": 0.3771267844538036, "mean_action_processing_ms": 0.09194745757615355, "mean_env_wait_ms": 0.7580921610091937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037539005279541016, "StateBufferConnector_ms": 0.0027632713317871094, "ViewRequirementAgentConnector_ms": 0.06917285919189453}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178310.87929758235, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181414.30401048475, -180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22039626525925293, "mean_inference_ms": 0.3771267844538036, "mean_action_processing_ms": 0.09194745757615355, "mean_env_wait_ms": 0.7580921610091937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037539005279541016, "StateBufferConnector_ms": 0.0027632713317871094, "ViewRequirementAgentConnector_ms": 0.06917285919189453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43124880, "num_agent_steps_trained": 43124880, "num_env_steps_sampled": 43124880, "num_env_steps_trained": 43124880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 696.395337038957, "num_env_steps_trained_throughput_per_sec": 696.395337038957, "timesteps_total": 43124880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43124880, "timers": {"training_iteration_time_ms": 63245.131, "sample_time_ms": 62085.705, "load_time_ms": 17.31, "load_throughput": 2537296.724, "learn_time_ms": 1141.019, "learn_throughput": 38491.926, "synch_weights_time_ms": 0.934}, "counters": {"num_env_steps_sampled": 43124880, "num_env_steps_trained": 43124880, "num_agent_steps_sampled": 43124880, "num_agent_steps_trained": 43124880}, "done": false, "episodes_total": 9155, "training_iteration": 2892, "trial_id": "11c4c_00000", "date": "2023-08-07_12-24-26", "timestamp": 1691400266, "time_this_iter_s": 63.07040286064148, "time_total_s": 74984.2089149952, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11213.79762673378, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 17.61777777777778, "ram_util_percent": 71.69777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.87411525715197, "policy_loss": -4849168.065335733, "vf_loss": 5575858.54664723}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 117649.5, "diff_num_grad_updates_vs_sampler_policy": 117648.5}}, "num_env_steps_sampled": 43168800, "num_env_steps_trained": 43168800, "num_agent_steps_sampled": 43168800, "num_agent_steps_trained": 43168800}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178205.8312182486, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2204335918453813, "mean_inference_ms": 0.3772029333619756, "mean_action_processing_ms": 0.09196166160293714, "mean_env_wait_ms": 0.7579195431680228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037546157836914062, "StateBufferConnector_ms": 0.0027608871459960938, "ViewRequirementAgentConnector_ms": 0.06917428970336914}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178205.8312182486, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180191.22052040152, -179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2204335918453813, "mean_inference_ms": 0.3772029333619756, "mean_action_processing_ms": 0.09196166160293714, "mean_env_wait_ms": 0.7579195431680228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037546157836914062, "StateBufferConnector_ms": 0.0027608871459960938, "ViewRequirementAgentConnector_ms": 0.06917428970336914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43168800, "num_agent_steps_trained": 43168800, "num_env_steps_sampled": 43168800, "num_env_steps_trained": 43168800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 698.5228302438494, "num_env_steps_trained_throughput_per_sec": 698.5228302438494, "timesteps_total": 43168800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43168800, "timers": {"training_iteration_time_ms": 63228.873, "sample_time_ms": 62069.937, "load_time_ms": 17.125, "load_throughput": 2564705.668, "learn_time_ms": 1140.725, "learn_throughput": 38501.816, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 43168800, "num_env_steps_trained": 43168800, "num_agent_steps_sampled": 43168800, "num_agent_steps_trained": 43168800}, "done": false, "episodes_total": 9156, "training_iteration": 2893, "trial_id": "11c4c_00000", "date": "2023-08-07_12-25-29", "timestamp": 1691400329, "time_this_iter_s": 62.878631830215454, "time_total_s": 75047.08754682541, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11276.676258563995, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 18.225842696629215, "ram_util_percent": 71.73820224719103}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.0187308531113, "policy_loss": -5144532.169745353, "vf_loss": 5909782.601949709}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 118335.5, "diff_num_grad_updates_vs_sampler_policy": 118334.5}}, "num_env_steps_sampled": 43212720, "num_env_steps_trained": 43212720, "num_agent_steps_sampled": 43212720, "num_agent_steps_trained": 43212720}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178156.62649063635, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22047045390508488, "mean_inference_ms": 0.3772775316156911, "mean_action_processing_ms": 0.0919756324364783, "mean_env_wait_ms": 0.7577494987456503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037555694580078125, "StateBufferConnector_ms": 0.002759218215942383, "ViewRequirementAgentConnector_ms": 0.0691843032836914}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178156.62649063635, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-179661.74385811613, -180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22047045390508488, "mean_inference_ms": 0.3772775316156911, "mean_action_processing_ms": 0.0919756324364783, "mean_env_wait_ms": 0.7577494987456503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037555694580078125, "StateBufferConnector_ms": 0.002759218215942383, "ViewRequirementAgentConnector_ms": 0.0691843032836914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43212720, "num_agent_steps_trained": 43212720, "num_env_steps_sampled": 43212720, "num_env_steps_trained": 43212720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 694.9055938272753, "num_env_steps_trained_throughput_per_sec": 694.9055938272753, "timesteps_total": 43212720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43212720, "timers": {"training_iteration_time_ms": 63240.514, "sample_time_ms": 62081.438, "load_time_ms": 17.109, "load_throughput": 2567057.34, "learn_time_ms": 1140.867, "learn_throughput": 38497.027, "synch_weights_time_ms": 0.937}, "counters": {"num_env_steps_sampled": 43212720, "num_env_steps_trained": 43212720, "num_agent_steps_sampled": 43212720, "num_agent_steps_trained": 43212720}, "done": false, "episodes_total": 9157, "training_iteration": 2894, "trial_id": "11c4c_00000", "date": "2023-08-07_12-26-32", "timestamp": 1691400392, "time_this_iter_s": 63.20570087432861, "time_total_s": 75110.29324769974, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11339.881959438324, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 17.652808988764043, "ram_util_percent": 71.72808988764045}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.08039415543004, "policy_loss": -4683031.2829354955, "vf_loss": 5888123.7210276965}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 119021.5, "diff_num_grad_updates_vs_sampler_policy": 119020.5}}, "num_env_steps_sampled": 43256640, "num_env_steps_trained": 43256640, "num_agent_steps_sampled": 43256640, "num_agent_steps_trained": 43256640}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178108.57246318317, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22050728349309004, "mean_inference_ms": 0.37735142166044794, "mean_action_processing_ms": 0.09198953698058852, "mean_env_wait_ms": 0.7575821971555733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037577152252197266, "StateBufferConnector_ms": 0.002758502960205078, "ViewRequirementAgentConnector_ms": 0.06919384002685547}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178108.57246318317, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180260.2164340809, -184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22050728349309004, "mean_inference_ms": 0.37735142166044794, "mean_action_processing_ms": 0.09198953698058852, "mean_env_wait_ms": 0.7575821971555733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037577152252197266, "StateBufferConnector_ms": 0.002758502960205078, "ViewRequirementAgentConnector_ms": 0.06919384002685547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43256640, "num_agent_steps_trained": 43256640, "num_env_steps_sampled": 43256640, "num_env_steps_trained": 43256640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 696.3875971990717, "num_env_steps_trained_throughput_per_sec": 696.3875971990717, "timesteps_total": 43256640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43256640, "timers": {"training_iteration_time_ms": 63213.155, "sample_time_ms": 62061.898, "load_time_ms": 17.149, "load_throughput": 2561111.451, "learn_time_ms": 1133.015, "learn_throughput": 38763.823, "synch_weights_time_ms": 0.933}, "counters": {"num_env_steps_sampled": 43256640, "num_env_steps_trained": 43256640, "num_agent_steps_sampled": 43256640, "num_agent_steps_trained": 43256640}, "done": false, "episodes_total": 9158, "training_iteration": 2895, "trial_id": "11c4c_00000", "date": "2023-08-07_12-27-35", "timestamp": 1691400455, "time_this_iter_s": 63.071370124816895, "time_total_s": 75173.36461782455, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11402.95332956314, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 18.332584269662924, "ram_util_percent": 71.69438202247191}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.1061881818855, "policy_loss": -5070274.187363339, "vf_loss": 5671875.267766035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 119707.5, "diff_num_grad_updates_vs_sampler_policy": 119706.5}}, "num_env_steps_sampled": 43300560, "num_env_steps_trained": 43300560, "num_agent_steps_sampled": 43300560, "num_agent_steps_trained": 43300560}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178026.4221105714, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22054303368529177, "mean_inference_ms": 0.3774224819601244, "mean_action_processing_ms": 0.09200285351454479, "mean_env_wait_ms": 0.7574146790307402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037567615509033203, "StateBufferConnector_ms": 0.0027570724487304688, "ViewRequirementAgentConnector_ms": 0.06923198699951172}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -178026.4221105714, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-184315.36530851864, -182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22054303368529177, "mean_inference_ms": 0.3774224819601244, "mean_action_processing_ms": 0.09200285351454479, "mean_env_wait_ms": 0.7574146790307402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037567615509033203, "StateBufferConnector_ms": 0.0027570724487304688, "ViewRequirementAgentConnector_ms": 0.06923198699951172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43300560, "num_agent_steps_trained": 43300560, "num_env_steps_sampled": 43300560, "num_env_steps_trained": 43300560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 697.7528812587171, "num_env_steps_trained_throughput_per_sec": 697.7528812587171, "timesteps_total": 43300560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43300560, "timers": {"training_iteration_time_ms": 63153.074, "sample_time_ms": 62001.563, "load_time_ms": 17.204, "load_throughput": 2552820.595, "learn_time_ms": 1133.217, "learn_throughput": 38756.935, "synch_weights_time_ms": 0.93}, "counters": {"num_env_steps_sampled": 43300560, "num_env_steps_trained": 43300560, "num_agent_steps_sampled": 43300560, "num_agent_steps_trained": 43300560}, "done": false, "episodes_total": 9159, "training_iteration": 2896, "trial_id": "11c4c_00000", "date": "2023-08-07_12-28-38", "timestamp": 1691400518, "time_this_iter_s": 62.94774794578552, "time_total_s": 75236.31236577034, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11465.901077508926, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 17.64111111111111, "ram_util_percent": 71.69666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.1399995675935, "policy_loss": -4418466.566537217, "vf_loss": 5620778.34420554}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 120393.5, "diff_num_grad_updates_vs_sampler_policy": 120392.5}}, "num_env_steps_sampled": 43344480, "num_env_steps_trained": 43344480, "num_agent_steps_sampled": 43344480, "num_agent_steps_trained": 43344480}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -177897.68637295443, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2205785342798483, "mean_inference_ms": 0.37749279281469883, "mean_action_processing_ms": 0.09201617978429572, "mean_env_wait_ms": 0.757248402559947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037572383880615234, "StateBufferConnector_ms": 0.0027589797973632812, "ViewRequirementAgentConnector_ms": 0.06925129890441895}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -177897.68637295443, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-182727.41180529917, -184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2205785342798483, "mean_inference_ms": 0.37749279281469883, "mean_action_processing_ms": 0.09201617978429572, "mean_env_wait_ms": 0.757248402559947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037572383880615234, "StateBufferConnector_ms": 0.0027589797973632812, "ViewRequirementAgentConnector_ms": 0.06925129890441895}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43344480, "num_agent_steps_trained": 43344480, "num_env_steps_sampled": 43344480, "num_env_steps_trained": 43344480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 697.0106699515778, "num_env_steps_trained_throughput_per_sec": 697.0106699515778, "timesteps_total": 43344480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43344480, "timers": {"training_iteration_time_ms": 63126.992, "sample_time_ms": 61975.615, "load_time_ms": 17.068, "load_throughput": 2573221.393, "learn_time_ms": 1133.222, "learn_throughput": 38756.753, "synch_weights_time_ms": 0.928}, "counters": {"num_env_steps_sampled": 43344480, "num_env_steps_trained": 43344480, "num_agent_steps_sampled": 43344480, "num_agent_steps_trained": 43344480}, "done": false, "episodes_total": 9160, "training_iteration": 2897, "trial_id": "11c4c_00000", "date": "2023-08-07_12-29-41", "timestamp": 1691400581, "time_this_iter_s": 63.01497483253479, "time_total_s": 75299.32734060287, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11528.916052341461, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 17.9, "ram_util_percent": 71.76966292134833}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.13173366357563, "policy_loss": -4720102.152693946, "vf_loss": 5915156.90324344}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 121079.5, "diff_num_grad_updates_vs_sampler_policy": 121078.5}}, "num_env_steps_sampled": 43388400, "num_env_steps_trained": 43388400, "num_agent_steps_sampled": 43388400, "num_agent_steps_trained": 43388400}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -177819.63944588532, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22061405521129418, "mean_inference_ms": 0.37756256217861556, "mean_action_processing_ms": 0.09202954784489399, "mean_env_wait_ms": 0.7570828097616246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003757476806640625, "StateBufferConnector_ms": 0.0027604103088378906, "ViewRequirementAgentConnector_ms": 0.06920838356018066}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -177819.63944588532, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-184321.67582081552, -183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22061405521129418, "mean_inference_ms": 0.37756256217861556, "mean_action_processing_ms": 0.09202954784489399, "mean_env_wait_ms": 0.7570828097616246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003757476806640625, "StateBufferConnector_ms": 0.0027604103088378906, "ViewRequirementAgentConnector_ms": 0.06920838356018066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43388400, "num_agent_steps_trained": 43388400, "num_env_steps_sampled": 43388400, "num_env_steps_trained": 43388400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 703.4453018462781, "num_env_steps_trained_throughput_per_sec": 703.4453018462781, "timesteps_total": 43388400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43388400, "timers": {"training_iteration_time_ms": 63066.092, "sample_time_ms": 61915.266, "load_time_ms": 17.106, "load_throughput": 2567594.04, "learn_time_ms": 1132.639, "learn_throughput": 38776.693, "synch_weights_time_ms": 0.922}, "counters": {"num_env_steps_sampled": 43388400, "num_env_steps_trained": 43388400, "num_agent_steps_sampled": 43388400, "num_agent_steps_trained": 43388400}, "done": false, "episodes_total": 9161, "training_iteration": 2898, "trial_id": "11c4c_00000", "date": "2023-08-07_12-30-44", "timestamp": 1691400644, "time_this_iter_s": 62.4385941028595, "time_total_s": 75361.76593470573, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11591.35464644432, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 18.101136363636364, "ram_util_percent": 71.73181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.94030152256914, "policy_loss": -4829939.844174221, "vf_loss": 5611608.104591837}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 121765.5, "diff_num_grad_updates_vs_sampler_policy": 121764.5}}, "num_env_steps_sampled": 43432320, "num_env_steps_trained": 43432320, "num_agent_steps_sampled": 43432320, "num_agent_steps_trained": 43432320}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -177685.09038940014, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22064964809795293, "mean_inference_ms": 0.3776324489116971, "mean_action_processing_ms": 0.09204302259706061, "mean_env_wait_ms": 0.7569193006877737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003762483596801758, "StateBufferConnector_ms": 0.0027632713317871094, "ViewRequirementAgentConnector_ms": 0.0692892074584961}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -177685.09038940014, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-183658.38580800756, -185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22064964809795293, "mean_inference_ms": 0.3776324489116971, "mean_action_processing_ms": 0.09204302259706061, "mean_env_wait_ms": 0.7569193006877737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003762483596801758, "StateBufferConnector_ms": 0.0027632713317871094, "ViewRequirementAgentConnector_ms": 0.0692892074584961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43432320, "num_agent_steps_trained": 43432320, "num_env_steps_sampled": 43432320, "num_env_steps_trained": 43432320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 703.4639284539711, "num_env_steps_trained_throughput_per_sec": 703.4639284539711, "timesteps_total": 43432320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43432320, "timers": {"training_iteration_time_ms": 63002.047, "sample_time_ms": 61851.492, "load_time_ms": 17.031, "load_throughput": 2578877.078, "learn_time_ms": 1132.439, "learn_throughput": 38783.556, "synch_weights_time_ms": 0.927}, "counters": {"num_env_steps_sampled": 43432320, "num_env_steps_trained": 43432320, "num_agent_steps_sampled": 43432320, "num_agent_steps_trained": 43432320}, "done": false, "episodes_total": 9162, "training_iteration": 2899, "trial_id": "11c4c_00000", "date": "2023-08-07_12-31-46", "timestamp": 1691400706, "time_this_iter_s": 62.43722105026245, "time_total_s": 75424.203155756, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11653.791867494583, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 17.86067415730337, "ram_util_percent": 70.29550561797753}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.8848426752118, "policy_loss": -4260232.374402105, "vf_loss": 5630035.03425656}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 122451.5, "diff_num_grad_updates_vs_sampler_policy": 122450.5}}, "num_env_steps_sampled": 43476240, "num_env_steps_trained": 43476240, "num_agent_steps_sampled": 43476240, "num_agent_steps_trained": 43476240}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -177561.66990623504, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22068285486546738, "mean_inference_ms": 0.3776972180754322, "mean_action_processing_ms": 0.09205550061145903, "mean_env_wait_ms": 0.7567506044522478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037641525268554688, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.06929564476013184}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185415.67432522596, "episode_reward_mean": -177561.66990623504, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185415.67432522596, -182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22068285486546738, "mean_inference_ms": 0.3776972180754322, "mean_action_processing_ms": 0.09205550061145903, "mean_env_wait_ms": 0.7567506044522478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037641525268554688, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.06929564476013184}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43476240, "num_agent_steps_trained": 43476240, "num_env_steps_sampled": 43476240, "num_env_steps_trained": 43476240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 698.4615305867179, "num_env_steps_trained_throughput_per_sec": 698.4615305867179, "timesteps_total": 43476240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43476240, "timers": {"training_iteration_time_ms": 62907.695, "sample_time_ms": 61758.02, "load_time_ms": 16.798, "load_throughput": 2614616.221, "learn_time_ms": 1131.799, "learn_throughput": 38805.463, "synch_weights_time_ms": 0.919}, "counters": {"num_env_steps_sampled": 43476240, "num_env_steps_trained": 43476240, "num_agent_steps_sampled": 43476240, "num_agent_steps_trained": 43476240}, "done": false, "episodes_total": 9163, "training_iteration": 2900, "trial_id": "11c4c_00000", "date": "2023-08-07_12-32-49", "timestamp": 1691400769, "time_this_iter_s": 62.884870767593384, "time_total_s": 75487.08802652359, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11716.676738262177, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 17.70112359550562, "ram_util_percent": 70.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.15472025078867, "policy_loss": -4369416.906156045, "vf_loss": 5511769.445699709}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 123137.5, "diff_num_grad_updates_vs_sampler_policy": 123136.5}}, "num_env_steps_sampled": 43520160, "num_env_steps_trained": 43520160, "num_agent_steps_sampled": 43520160, "num_agent_steps_trained": 43520160}, "sampler_results": {"episode_reward_max": -169249.43288486157, "episode_reward_min": -185235.94140509883, "episode_reward_mean": -177409.15655593685, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22071621465755922, "mean_inference_ms": 0.37776273848921954, "mean_action_processing_ms": 0.09206807963154988, "mean_env_wait_ms": 0.7565838322673648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003765583038330078, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.06928849220275879}}, "episode_reward_max": -169249.43288486157, "episode_reward_min": -185235.94140509883, "episode_reward_mean": -177409.15655593685, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-182764.91852160517, -181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22071621465755922, "mean_inference_ms": 0.37776273848921954, "mean_action_processing_ms": 0.09206807963154988, "mean_env_wait_ms": 0.7565838322673648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003765583038330078, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.06928849220275879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43520160, "num_agent_steps_trained": 43520160, "num_env_steps_sampled": 43520160, "num_env_steps_trained": 43520160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 701.7327466368736, "num_env_steps_trained_throughput_per_sec": 701.7327466368736, "timesteps_total": 43520160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43520160, "timers": {"training_iteration_time_ms": 62850.943, "sample_time_ms": 61700.795, "load_time_ms": 16.763, "load_throughput": 2619997.122, "learn_time_ms": 1132.305, "learn_throughput": 38788.15, "synch_weights_time_ms": 0.92}, "counters": {"num_env_steps_sampled": 43520160, "num_env_steps_trained": 43520160, "num_agent_steps_sampled": 43520160, "num_agent_steps_trained": 43520160}, "done": false, "episodes_total": 9164, "training_iteration": 2901, "trial_id": "11c4c_00000", "date": "2023-08-07_12-33-52", "timestamp": 1691400832, "time_this_iter_s": 62.59165811538696, "time_total_s": 75549.67968463898, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11779.268396377563, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 17.42584269662921, "ram_util_percent": 70.35730337078651}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.11000136661806, "policy_loss": -4114477.8946992303, "vf_loss": 5426601.831541545}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 123823.5, "diff_num_grad_updates_vs_sampler_policy": 123822.5}}, "num_env_steps_sampled": 43564080, "num_env_steps_trained": 43564080, "num_agent_steps_sampled": 43564080, "num_agent_steps_trained": 43564080}, "sampler_results": {"episode_reward_max": -168346.31731170102, "episode_reward_min": -185235.94140509883, "episode_reward_mean": -177264.97054383782, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22074990014759346, "mean_inference_ms": 0.3778284913798495, "mean_action_processing_ms": 0.09208078863788456, "mean_env_wait_ms": 0.7564185786692513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003774881362915039, "StateBufferConnector_ms": 0.002767801284790039, "ViewRequirementAgentConnector_ms": 0.06940031051635742}}, "episode_reward_max": -168346.31731170102, "episode_reward_min": -185235.94140509883, "episode_reward_mean": -177264.97054383782, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181580.50778221074, -181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22074990014759346, "mean_inference_ms": 0.3778284913798495, "mean_action_processing_ms": 0.09208078863788456, "mean_env_wait_ms": 0.7564185786692513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003774881362915039, "StateBufferConnector_ms": 0.002767801284790039, "ViewRequirementAgentConnector_ms": 0.06940031051635742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43564080, "num_agent_steps_trained": 43564080, "num_env_steps_sampled": 43564080, "num_env_steps_trained": 43564080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 702.1763024761188, "num_env_steps_trained_throughput_per_sec": 702.1763024761188, "timesteps_total": 43564080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43564080, "timers": {"training_iteration_time_ms": 62799.02, "sample_time_ms": 61648.694, "load_time_ms": 16.793, "load_throughput": 2615425.474, "learn_time_ms": 1132.464, "learn_throughput": 38782.69, "synch_weights_time_ms": 0.911}, "counters": {"num_env_steps_sampled": 43564080, "num_env_steps_trained": 43564080, "num_agent_steps_sampled": 43564080, "num_agent_steps_trained": 43564080}, "done": false, "episodes_total": 9165, "training_iteration": 2902, "trial_id": "11c4c_00000", "date": "2023-08-07_12-34-54", "timestamp": 1691400894, "time_this_iter_s": 62.552197217941284, "time_total_s": 75612.23188185692, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11841.820593595505, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 17.72840909090909, "ram_util_percent": 70.46590909090911}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.2081110651222, "policy_loss": -4113871.044221483, "vf_loss": 5733280.384657434}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 124509.5, "diff_num_grad_updates_vs_sampler_policy": 124508.5}}, "num_env_steps_sampled": 43608000, "num_env_steps_trained": 43608000, "num_agent_steps_sampled": 43608000, "num_agent_steps_trained": 43608000}, "sampler_results": {"episode_reward_max": -168346.31731170102, "episode_reward_min": -185235.94140509883, "episode_reward_mean": -177174.00161805586, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22078337668446568, "mean_inference_ms": 0.37789446557893336, "mean_action_processing_ms": 0.09209351857479894, "mean_env_wait_ms": 0.7562542756308146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037736892700195312, "StateBufferConnector_ms": 0.002765178680419922, "ViewRequirementAgentConnector_ms": 0.06940984725952148}}, "episode_reward_max": -168346.31731170102, "episode_reward_min": -185235.94140509883, "episode_reward_mean": -177174.00161805586, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181520.5481720935, -185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22078337668446568, "mean_inference_ms": 0.37789446557893336, "mean_action_processing_ms": 0.09209351857479894, "mean_env_wait_ms": 0.7562542756308146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037736892700195312, "StateBufferConnector_ms": 0.002765178680419922, "ViewRequirementAgentConnector_ms": 0.06940984725952148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43608000, "num_agent_steps_trained": 43608000, "num_env_steps_sampled": 43608000, "num_env_steps_trained": 43608000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 703.3937359487652, "num_env_steps_trained_throughput_per_sec": 703.3937359487652, "timesteps_total": 43608000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43608000, "timers": {"training_iteration_time_ms": 62755.479, "sample_time_ms": 61604.196, "load_time_ms": 16.913, "load_throughput": 2596835.984, "learn_time_ms": 1133.3, "learn_throughput": 38754.094, "synch_weights_time_ms": 0.911}, "counters": {"num_env_steps_sampled": 43608000, "num_env_steps_trained": 43608000, "num_agent_steps_sampled": 43608000, "num_agent_steps_trained": 43608000}, "done": false, "episodes_total": 9166, "training_iteration": 2903, "trial_id": "11c4c_00000", "date": "2023-08-07_12-35-57", "timestamp": 1691400957, "time_this_iter_s": 62.443432331085205, "time_total_s": 75674.675314188, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11904.26402592659, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 17.938202247191008, "ram_util_percent": 70.47303370786517}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.88668387276783, "policy_loss": -4192737.438066577, "vf_loss": 5335024.751503279}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 125195.5, "diff_num_grad_updates_vs_sampler_policy": 125194.5}}, "num_env_steps_sampled": 43651920, "num_env_steps_trained": 43651920, "num_agent_steps_sampled": 43651920, "num_agent_steps_trained": 43651920}, "sampler_results": {"episode_reward_max": -167630.6890568682, "episode_reward_min": -185235.94140509883, "episode_reward_mean": -177035.10302690364, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22081661884100104, "mean_inference_ms": 0.3779600478192481, "mean_action_processing_ms": 0.09210625088538134, "mean_env_wait_ms": 0.7560901503023532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037450790405273438, "StateBufferConnector_ms": 0.0027632713317871094, "ViewRequirementAgentConnector_ms": 0.06934452056884766}}, "episode_reward_max": -167630.6890568682, "episode_reward_min": -185235.94140509883, "episode_reward_mean": -177035.10302690364, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185197.37015407992, -185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22081661884100104, "mean_inference_ms": 0.3779600478192481, "mean_action_processing_ms": 0.09210625088538134, "mean_env_wait_ms": 0.7560901503023532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037450790405273438, "StateBufferConnector_ms": 0.0027632713317871094, "ViewRequirementAgentConnector_ms": 0.06934452056884766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43651920, "num_agent_steps_trained": 43651920, "num_env_steps_sampled": 43651920, "num_env_steps_trained": 43651920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 707.4437544565226, "num_env_steps_trained_throughput_per_sec": 707.4437544565226, "timesteps_total": 43651920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43651920, "timers": {"training_iteration_time_ms": 62643.464, "sample_time_ms": 61485.782, "load_time_ms": 16.948, "load_throughput": 2591458.559, "learn_time_ms": 1139.671, "learn_throughput": 38537.451, "synch_weights_time_ms": 0.905}, "counters": {"num_env_steps_sampled": 43651920, "num_env_steps_trained": 43651920, "num_agent_steps_sampled": 43651920, "num_agent_steps_trained": 43651920}, "done": false, "episodes_total": 9167, "training_iteration": 2904, "trial_id": "11c4c_00000", "date": "2023-08-07_12-36-59", "timestamp": 1691401019, "time_this_iter_s": 62.08604907989502, "time_total_s": 75736.7613632679, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11966.350075006485, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 21.397727272727273, "ram_util_percent": 70.0909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.07541578643173, "policy_loss": -4035218.4406546103, "vf_loss": 5577359.856413994}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 125881.5, "diff_num_grad_updates_vs_sampler_policy": 125880.5}}, "num_env_steps_sampled": 43695840, "num_env_steps_trained": 43695840, "num_agent_steps_sampled": 43695840, "num_agent_steps_trained": 43695840}, "sampler_results": {"episode_reward_max": -167630.6890568682, "episode_reward_min": -185235.94140509883, "episode_reward_mean": -176892.62836918895, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22084969807405233, "mean_inference_ms": 0.3780256007278865, "mean_action_processing_ms": 0.09211888875803886, "mean_env_wait_ms": 0.755924722462538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003747224807739258, "StateBufferConnector_ms": 0.002766132354736328, "ViewRequirementAgentConnector_ms": 0.06936097145080566}}, "episode_reward_max": -167630.6890568682, "episode_reward_min": -185235.94140509883, "episode_reward_mean": -176892.62836918895, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185235.94140509883, -178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22084969807405233, "mean_inference_ms": 0.3780256007278865, "mean_action_processing_ms": 0.09211888875803886, "mean_env_wait_ms": 0.755924722462538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003747224807739258, "StateBufferConnector_ms": 0.002766132354736328, "ViewRequirementAgentConnector_ms": 0.06936097145080566}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43695840, "num_agent_steps_trained": 43695840, "num_env_steps_sampled": 43695840, "num_env_steps_trained": 43695840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 700.2603030957472, "num_env_steps_trained_throughput_per_sec": 700.2603030957472, "timesteps_total": 43695840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43695840, "timers": {"training_iteration_time_ms": 62608.585, "sample_time_ms": 61451.731, "load_time_ms": 16.929, "load_throughput": 2594308.887, "learn_time_ms": 1138.852, "learn_throughput": 38565.158, "synch_weights_time_ms": 0.914}, "counters": {"num_env_steps_sampled": 43695840, "num_env_steps_trained": 43695840, "num_agent_steps_sampled": 43695840, "num_agent_steps_trained": 43695840}, "done": false, "episodes_total": 9168, "training_iteration": 2905, "trial_id": "11c4c_00000", "date": "2023-08-07_12-38-02", "timestamp": 1691401082, "time_this_iter_s": 62.72332215309143, "time_total_s": 75799.48468542099, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12029.073397159576, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 18.4, "ram_util_percent": 69.99772727272729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.15956235835574, "policy_loss": -4576448.273702282, "vf_loss": 5792313.121173469}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 126567.5, "diff_num_grad_updates_vs_sampler_policy": 126566.5}}, "num_env_steps_sampled": 43739760, "num_env_steps_trained": 43739760, "num_agent_steps_sampled": 43739760, "num_agent_steps_trained": 43739760}, "sampler_results": {"episode_reward_max": -167630.6890568682, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -176778.1679256717, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2208820786182228, "mean_inference_ms": 0.3780887940142278, "mean_action_processing_ms": 0.09213124315087036, "mean_env_wait_ms": 0.7557578262205276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003748655319213867, "StateBufferConnector_ms": 0.0027647018432617188, "ViewRequirementAgentConnector_ms": 0.069366455078125}}, "episode_reward_max": -167630.6890568682, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -176778.1679256717, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-178582.95507748966, -182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2208820786182228, "mean_inference_ms": 0.3780887940142278, "mean_action_processing_ms": 0.09213124315087036, "mean_env_wait_ms": 0.7557578262205276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003748655319213867, "StateBufferConnector_ms": 0.0027647018432617188, "ViewRequirementAgentConnector_ms": 0.069366455078125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43739760, "num_agent_steps_trained": 43739760, "num_env_steps_sampled": 43739760, "num_env_steps_trained": 43739760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 700.0686539449523, "num_env_steps_trained_throughput_per_sec": 700.0686539449523, "timesteps_total": 43739760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43739760, "timers": {"training_iteration_time_ms": 62587.763, "sample_time_ms": 61431.261, "load_time_ms": 16.794, "load_throughput": 2615143.292, "learn_time_ms": 1138.601, "learn_throughput": 38573.638, "synch_weights_time_ms": 0.937}, "counters": {"num_env_steps_sampled": 43739760, "num_env_steps_trained": 43739760, "num_agent_steps_sampled": 43739760, "num_agent_steps_trained": 43739760}, "done": false, "episodes_total": 9169, "training_iteration": 2906, "trial_id": "11c4c_00000", "date": "2023-08-07_12-39-05", "timestamp": 1691401145, "time_this_iter_s": 62.74024033546448, "time_total_s": 75862.22492575645, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12091.81363749504, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 17.979775280898878, "ram_util_percent": 70.17752808988764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.1599464082857, "policy_loss": -3899767.9670018675, "vf_loss": 5196270.094387755}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 127253.5, "diff_num_grad_updates_vs_sampler_policy": 127252.5}}, "num_env_steps_sampled": 43783680, "num_env_steps_trained": 43783680, "num_agent_steps_sampled": 43783680, "num_agent_steps_trained": 43783680}, "sampler_results": {"episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -176651.92202648788, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2209144214459495, "mean_inference_ms": 0.37815225800107904, "mean_action_processing_ms": 0.09214364160130288, "mean_env_wait_ms": 0.7555923392374376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003747701644897461, "StateBufferConnector_ms": 0.0027637481689453125, "ViewRequirementAgentConnector_ms": 0.0693819522857666}}, "episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -176651.92202648788, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-182642.94279797972, -176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2209144214459495, "mean_inference_ms": 0.37815225800107904, "mean_action_processing_ms": 0.09214364160130288, "mean_env_wait_ms": 0.7555923392374376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003747701644897461, "StateBufferConnector_ms": 0.0027637481689453125, "ViewRequirementAgentConnector_ms": 0.0693819522857666}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43783680, "num_agent_steps_trained": 43783680, "num_env_steps_sampled": 43783680, "num_env_steps_trained": 43783680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 705.5272418237256, "num_env_steps_trained_throughput_per_sec": 705.5272418237256, "timesteps_total": 43783680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43783680, "timers": {"training_iteration_time_ms": 62511.7, "sample_time_ms": 61354.02, "load_time_ms": 16.804, "load_throughput": 2613740.713, "learn_time_ms": 1139.762, "learn_throughput": 38534.349, "synch_weights_time_ms": 0.944}, "counters": {"num_env_steps_sampled": 43783680, "num_env_steps_trained": 43783680, "num_agent_steps_sampled": 43783680, "num_agent_steps_trained": 43783680}, "done": false, "episodes_total": 9170, "training_iteration": 2907, "trial_id": "11c4c_00000", "date": "2023-08-07_12-40-07", "timestamp": 1691401207, "time_this_iter_s": 62.2541708946228, "time_total_s": 75924.47909665108, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12154.067808389664, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 17.94090909090909, "ram_util_percent": 70.2806818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9850597325984, "policy_loss": -3838054.541476859, "vf_loss": 5484753.660258747}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 127939.5, "diff_num_grad_updates_vs_sampler_policy": 127938.5}}, "num_env_steps_sampled": 43827600, "num_env_steps_trained": 43827600, "num_agent_steps_sampled": 43827600, "num_agent_steps_trained": 43827600}, "sampler_results": {"episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -176515.5847500153, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2209470159841842, "mean_inference_ms": 0.378216064562092, "mean_action_processing_ms": 0.09215606570605304, "mean_env_wait_ms": 0.755429360721483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037479400634765625, "StateBufferConnector_ms": 0.002763032913208008, "ViewRequirementAgentConnector_ms": 0.06939077377319336}}, "episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -176515.5847500153, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-176258.67583038137, -181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2209470159841842, "mean_inference_ms": 0.378216064562092, "mean_action_processing_ms": 0.09215606570605304, "mean_env_wait_ms": 0.755429360721483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037479400634765625, "StateBufferConnector_ms": 0.002763032913208008, "ViewRequirementAgentConnector_ms": 0.06939077377319336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43827600, "num_agent_steps_trained": 43827600, "num_env_steps_sampled": 43827600, "num_env_steps_trained": 43827600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 702.5982278141689, "num_env_steps_trained_throughput_per_sec": 702.5982278141689, "timesteps_total": 43827600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43827600, "timers": {"training_iteration_time_ms": 62519.228, "sample_time_ms": 61361.629, "load_time_ms": 16.757, "load_throughput": 2620951.406, "learn_time_ms": 1139.719, "learn_throughput": 38535.825, "synch_weights_time_ms": 0.952}, "counters": {"num_env_steps_sampled": 43827600, "num_env_steps_trained": 43827600, "num_agent_steps_sampled": 43827600, "num_agent_steps_trained": 43827600}, "done": false, "episodes_total": 9171, "training_iteration": 2908, "trial_id": "11c4c_00000", "date": "2023-08-07_12-41-09", "timestamp": 1691401269, "time_this_iter_s": 62.51388597488403, "time_total_s": 75986.99298262596, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12216.581694364548, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 17.81573033707865, "ram_util_percent": 70.4943820224719}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.9099896044495, "policy_loss": -4133170.152512442, "vf_loss": 5361754.838101312}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 128625.5, "diff_num_grad_updates_vs_sampler_policy": 128624.5}}, "num_env_steps_sampled": 43871520, "num_env_steps_trained": 43871520, "num_agent_steps_sampled": 43871520, "num_agent_steps_trained": 43871520}, "sampler_results": {"episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -176426.35987334073, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22097709997526718, "mean_inference_ms": 0.37827827401959974, "mean_action_processing_ms": 0.09216812102221054, "mean_env_wait_ms": 0.755263209167948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751516342163086, "StateBufferConnector_ms": 0.0027642250061035156, "ViewRequirementAgentConnector_ms": 0.06943106651306152}}, "episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -176426.35987334073, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181532.29045054538, -182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22097709997526718, "mean_inference_ms": 0.37827827401959974, "mean_action_processing_ms": 0.09216812102221054, "mean_env_wait_ms": 0.755263209167948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751516342163086, "StateBufferConnector_ms": 0.0027642250061035156, "ViewRequirementAgentConnector_ms": 0.06943106651306152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43871520, "num_agent_steps_trained": 43871520, "num_env_steps_sampled": 43871520, "num_env_steps_trained": 43871520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 705.0749963193026, "num_env_steps_trained_throughput_per_sec": 705.0749963193026, "timesteps_total": 43871520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43871520, "timers": {"training_iteration_time_ms": 62504.962, "sample_time_ms": 61346.611, "load_time_ms": 16.789, "load_throughput": 2616001.166, "learn_time_ms": 1140.436, "learn_throughput": 38511.587, "synch_weights_time_ms": 0.954}, "counters": {"num_env_steps_sampled": 43871520, "num_env_steps_trained": 43871520, "num_agent_steps_sampled": 43871520, "num_agent_steps_trained": 43871520}, "done": false, "episodes_total": 9172, "training_iteration": 2909, "trial_id": "11c4c_00000", "date": "2023-08-07_12-42-12", "timestamp": 1691401332, "time_this_iter_s": 62.294201135635376, "time_total_s": 76049.2871837616, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12278.875895500183, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 18.529545454545453, "ram_util_percent": 70.38977272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.17421003958924, "policy_loss": -4110347.1337022255, "vf_loss": 5734138.878644315}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 129311.5, "diff_num_grad_updates_vs_sampler_policy": 129310.5}}, "num_env_steps_sampled": 43915440, "num_env_steps_trained": 43915440, "num_agent_steps_sampled": 43915440, "num_agent_steps_trained": 43915440}, "sampler_results": {"episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -176331.50707583583, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22100429741677804, "mean_inference_ms": 0.37833572668041154, "mean_action_processing_ms": 0.09217929834437395, "mean_env_wait_ms": 0.7550826867468562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003741741180419922, "StateBufferConnector_ms": 0.0027608871459960938, "ViewRequirementAgentConnector_ms": 0.06935715675354004}}, "episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -176331.50707583583, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-182724.55746004346, -179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22100429741677804, "mean_inference_ms": 0.37833572668041154, "mean_action_processing_ms": 0.09217929834437395, "mean_env_wait_ms": 0.7550826867468562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003741741180419922, "StateBufferConnector_ms": 0.0027608871459960938, "ViewRequirementAgentConnector_ms": 0.06935715675354004}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43915440, "num_agent_steps_trained": 43915440, "num_env_steps_sampled": 43915440, "num_env_steps_trained": 43915440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 703.6317278910683, "num_env_steps_trained_throughput_per_sec": 703.6317278910683, "timesteps_total": 43915440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43915440, "timers": {"training_iteration_time_ms": 62458.758, "sample_time_ms": 61300.049, "load_time_ms": 16.78, "load_throughput": 2617395.016, "learn_time_ms": 1140.792, "learn_throughput": 38499.571, "synch_weights_time_ms": 0.964}, "counters": {"num_env_steps_sampled": 43915440, "num_env_steps_trained": 43915440, "num_agent_steps_sampled": 43915440, "num_agent_steps_trained": 43915440}, "done": false, "episodes_total": 9173, "training_iteration": 2910, "trial_id": "11c4c_00000", "date": "2023-08-07_12-43-14", "timestamp": 1691401394, "time_this_iter_s": 62.42228293418884, "time_total_s": 76111.70946669579, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12341.298178434372, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 17.640449438202246, "ram_util_percent": 70.3561797752809}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.3216207965817, "policy_loss": -3748439.9420269225, "vf_loss": 5731199.170827259}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 129997.5, "diff_num_grad_updates_vs_sampler_policy": 129996.5}}, "num_env_steps_sampled": 43959360, "num_env_steps_trained": 43959360, "num_agent_steps_sampled": 43959360, "num_agent_steps_trained": 43959360}, "sampler_results": {"episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -176226.36788248722, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22103034076829656, "mean_inference_ms": 0.37839184718810365, "mean_action_processing_ms": 0.09219021444721762, "mean_env_wait_ms": 0.7548958275240558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037431716918945312, "StateBufferConnector_ms": 0.0027658939361572266, "ViewRequirementAgentConnector_ms": 0.0693821907043457}}, "episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -176226.36788248722, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-179546.18048231152, -179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22103034076829656, "mean_inference_ms": 0.37839184718810365, "mean_action_processing_ms": 0.09219021444721762, "mean_env_wait_ms": 0.7548958275240558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037431716918945312, "StateBufferConnector_ms": 0.0027658939361572266, "ViewRequirementAgentConnector_ms": 0.0693821907043457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43959360, "num_agent_steps_trained": 43959360, "num_env_steps_sampled": 43959360, "num_env_steps_trained": 43959360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 707.1880931673004, "num_env_steps_trained_throughput_per_sec": 707.1880931673004, "timesteps_total": 43959360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 43959360, "timers": {"training_iteration_time_ms": 62410.476, "sample_time_ms": 61251.819, "load_time_ms": 16.803, "load_throughput": 2613777.798, "learn_time_ms": 1140.708, "learn_throughput": 38502.416, "synch_weights_time_ms": 0.975}, "counters": {"num_env_steps_sampled": 43959360, "num_env_steps_trained": 43959360, "num_agent_steps_sampled": 43959360, "num_agent_steps_trained": 43959360}, "done": false, "episodes_total": 9174, "training_iteration": 2911, "trial_id": "11c4c_00000", "date": "2023-08-07_12-44-16", "timestamp": 1691401456, "time_this_iter_s": 62.10809302330017, "time_total_s": 76173.81755971909, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12403.406271457672, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 17.895454545454545, "ram_util_percent": 70.51249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.0817672685006, "policy_loss": -4246189.269411671, "vf_loss": 5640192.793185132}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 130683.5, "diff_num_grad_updates_vs_sampler_policy": 130682.5}}, "num_env_steps_sampled": 44003280, "num_env_steps_trained": 44003280, "num_agent_steps_sampled": 44003280, "num_agent_steps_trained": 44003280}, "sampler_results": {"episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -176143.0101319808, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2210563536300825, "mean_inference_ms": 0.37844712408965103, "mean_action_processing_ms": 0.0922010260981587, "mean_env_wait_ms": 0.7547089095964131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003745555877685547, "StateBufferConnector_ms": 0.0027670860290527344, "ViewRequirementAgentConnector_ms": 0.0693824291229248}}, "episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -176143.0101319808, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-179718.3641115264, -181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2210563536300825, "mean_inference_ms": 0.37844712408965103, "mean_action_processing_ms": 0.0922010260981587, "mean_env_wait_ms": 0.7547089095964131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003745555877685547, "StateBufferConnector_ms": 0.0027670860290527344, "ViewRequirementAgentConnector_ms": 0.0693824291229248}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44003280, "num_agent_steps_trained": 44003280, "num_env_steps_sampled": 44003280, "num_env_steps_trained": 44003280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 699.5545200664413, "num_env_steps_trained_throughput_per_sec": 699.5545200664413, "timesteps_total": 44003280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44003280, "timers": {"training_iteration_time_ms": 62433.918, "sample_time_ms": 61274.047, "load_time_ms": 16.797, "load_throughput": 2614775.804, "learn_time_ms": 1141.877, "learn_throughput": 38462.986, "synch_weights_time_ms": 1.015}, "counters": {"num_env_steps_sampled": 44003280, "num_env_steps_trained": 44003280, "num_agent_steps_sampled": 44003280, "num_agent_steps_trained": 44003280}, "done": false, "episodes_total": 9175, "training_iteration": 2912, "trial_id": "11c4c_00000", "date": "2023-08-07_12-45-19", "timestamp": 1691401519, "time_this_iter_s": 62.785998821258545, "time_total_s": 76236.60355854034, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12466.19227027893, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 17.951685393258426, "ram_util_percent": 70.55393258426966}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.15017557839263, "policy_loss": -4042347.193951576, "vf_loss": 5480160.584183673}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 131369.5, "diff_num_grad_updates_vs_sampler_policy": 131368.5}}, "num_env_steps_sampled": 44047200, "num_env_steps_trained": 44047200, "num_agent_steps_sampled": 44047200, "num_agent_steps_trained": 44047200}, "sampler_results": {"episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -176039.62279673218, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2210822977221879, "mean_inference_ms": 0.3785018648096773, "mean_action_processing_ms": 0.09221184082889218, "mean_env_wait_ms": 0.7545223537724541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003743410110473633, "StateBufferConnector_ms": 0.0027680397033691406, "ViewRequirementAgentConnector_ms": 0.0693817138671875}}, "episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -176039.62279673218, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181173.50895728773, -181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2210822977221879, "mean_inference_ms": 0.3785018648096773, "mean_action_processing_ms": 0.09221184082889218, "mean_env_wait_ms": 0.7545223537724541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003743410110473633, "StateBufferConnector_ms": 0.0027680397033691406, "ViewRequirementAgentConnector_ms": 0.0693817138671875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44047200, "num_agent_steps_trained": 44047200, "num_env_steps_sampled": 44047200, "num_env_steps_trained": 44047200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 707.8128645495675, "num_env_steps_trained_throughput_per_sec": 707.8128645495675, "timesteps_total": 44047200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44047200, "timers": {"training_iteration_time_ms": 62394.934, "sample_time_ms": 61235.339, "load_time_ms": 16.911, "load_throughput": 2597106.906, "learn_time_ms": 1141.474, "learn_throughput": 38476.559, "synch_weights_time_ms": 1.028}, "counters": {"num_env_steps_sampled": 44047200, "num_env_steps_trained": 44047200, "num_agent_steps_sampled": 44047200, "num_agent_steps_trained": 44047200}, "done": false, "episodes_total": 9176, "training_iteration": 2913, "trial_id": "11c4c_00000", "date": "2023-08-07_12-46-21", "timestamp": 1691401581, "time_this_iter_s": 62.0532341003418, "time_total_s": 76298.65679264069, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12528.245504379272, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 17.719318181818185, "ram_util_percent": 70.51249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.1367276472531, "policy_loss": -3894507.3135932945, "vf_loss": 5814725.389941691}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 132055.5, "diff_num_grad_updates_vs_sampler_policy": 132054.5}}, "num_env_steps_sampled": 44091120, "num_env_steps_trained": 44091120, "num_agent_steps_sampled": 44091120, "num_agent_steps_trained": 44091120}, "sampler_results": {"episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175959.84930851284, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22110649730564658, "mean_inference_ms": 0.37855156508252435, "mean_action_processing_ms": 0.09222170948620338, "mean_env_wait_ms": 0.7543270122395679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003738880157470703, "StateBufferConnector_ms": 0.002771615982055664, "ViewRequirementAgentConnector_ms": 0.06939101219177246}}, "episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175959.84930851284, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181927.44994026527, -181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22110649730564658, "mean_inference_ms": 0.37855156508252435, "mean_action_processing_ms": 0.09222170948620338, "mean_env_wait_ms": 0.7543270122395679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003738880157470703, "StateBufferConnector_ms": 0.002771615982055664, "ViewRequirementAgentConnector_ms": 0.06939101219177246}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44091120, "num_agent_steps_trained": 44091120, "num_env_steps_sampled": 44091120, "num_env_steps_trained": 44091120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 708.1195057756936, "num_env_steps_trained_throughput_per_sec": 708.1195057756936, "timesteps_total": 44091120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44091120, "timers": {"training_iteration_time_ms": 62389.01, "sample_time_ms": 61236.147, "load_time_ms": 16.806, "load_throughput": 2613310.593, "learn_time_ms": 1134.854, "learn_throughput": 38701.02, "synch_weights_time_ms": 1.02}, "counters": {"num_env_steps_sampled": 44091120, "num_env_steps_trained": 44091120, "num_agent_steps_sampled": 44091120, "num_agent_steps_trained": 44091120}, "done": false, "episodes_total": 9177, "training_iteration": 2914, "trial_id": "11c4c_00000", "date": "2023-08-07_12-47-23", "timestamp": 1691401643, "time_this_iter_s": 62.02628707885742, "time_total_s": 76360.68307971954, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12590.27179145813, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 18.48409090909091, "ram_util_percent": 70.53295454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.1836382807518, "policy_loss": -3860370.30780225, "vf_loss": 5781039.935860058}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 132741.5, "diff_num_grad_updates_vs_sampler_policy": 132740.5}}, "num_env_steps_sampled": 44135040, "num_env_steps_trained": 44135040, "num_agent_steps_sampled": 44135040, "num_agent_steps_trained": 44135040}, "sampler_results": {"episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175870.40169076857, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22113069081570533, "mean_inference_ms": 0.3786007980022223, "mean_action_processing_ms": 0.09223148995420295, "mean_env_wait_ms": 0.7541306804773703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037393569946289062, "StateBufferConnector_ms": 0.002766847610473633, "ViewRequirementAgentConnector_ms": 0.06940913200378418}}, "episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175870.40169076857, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181286.27116868316, -180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22113069081570533, "mean_inference_ms": 0.3786007980022223, "mean_action_processing_ms": 0.09223148995420295, "mean_env_wait_ms": 0.7541306804773703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037393569946289062, "StateBufferConnector_ms": 0.002766847610473633, "ViewRequirementAgentConnector_ms": 0.06940913200378418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44135040, "num_agent_steps_trained": 44135040, "num_env_steps_sampled": 44135040, "num_env_steps_trained": 44135040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 706.0568014312146, "num_env_steps_trained_throughput_per_sec": 706.0568014312146, "timesteps_total": 44135040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44135040, "timers": {"training_iteration_time_ms": 62337.519, "sample_time_ms": 61184.363, "load_time_ms": 16.897, "load_throughput": 2599232.306, "learn_time_ms": 1135.052, "learn_throughput": 38694.275, "synch_weights_time_ms": 1.026}, "counters": {"num_env_steps_sampled": 44135040, "num_env_steps_trained": 44135040, "num_agent_steps_sampled": 44135040, "num_agent_steps_trained": 44135040}, "done": false, "episodes_total": 9178, "training_iteration": 2915, "trial_id": "11c4c_00000", "date": "2023-08-07_12-48-25", "timestamp": 1691401705, "time_this_iter_s": 62.207996129989624, "time_total_s": 76422.89107584953, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12652.47978758812, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 17.48181818181818, "ram_util_percent": 70.34772727272725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.2625621651074, "policy_loss": -3664908.3113326803, "vf_loss": 5543197.897776968}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 133427.5, "diff_num_grad_updates_vs_sampler_policy": 133426.5}}, "num_env_steps_sampled": 44178960, "num_env_steps_trained": 44178960, "num_agent_steps_sampled": 44178960, "num_agent_steps_trained": 44178960}, "sampler_results": {"episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175751.62224461767, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22115463514016998, "mean_inference_ms": 0.3786497133700453, "mean_action_processing_ms": 0.09224117289031346, "mean_env_wait_ms": 0.7539356026136764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737211227416992, "StateBufferConnector_ms": 0.0027654170989990234, "ViewRequirementAgentConnector_ms": 0.06942224502563477}}, "episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175751.62224461767, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180496.29086445455, -179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22115463514016998, "mean_inference_ms": 0.3786497133700453, "mean_action_processing_ms": 0.09224117289031346, "mean_env_wait_ms": 0.7539356026136764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737211227416992, "StateBufferConnector_ms": 0.0027654170989990234, "ViewRequirementAgentConnector_ms": 0.06942224502563477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44178960, "num_agent_steps_trained": 44178960, "num_env_steps_sampled": 44178960, "num_env_steps_trained": 44178960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 706.752376785738, "num_env_steps_trained_throughput_per_sec": 706.752376785738, "timesteps_total": 44178960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44178960, "timers": {"training_iteration_time_ms": 62278.189, "sample_time_ms": 61124.439, "load_time_ms": 16.97, "load_throughput": 2588021.698, "learn_time_ms": 1135.6, "learn_throughput": 38675.596, "synch_weights_time_ms": 1.008}, "counters": {"num_env_steps_sampled": 44178960, "num_env_steps_trained": 44178960, "num_agent_steps_sampled": 44178960, "num_agent_steps_trained": 44178960}, "done": false, "episodes_total": 9179, "training_iteration": 2916, "trial_id": "11c4c_00000", "date": "2023-08-07_12-49-28", "timestamp": 1691401768, "time_this_iter_s": 62.146669149398804, "time_total_s": 76485.03774499893, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12714.626456737518, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 17.712500000000002, "ram_util_percent": 70.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.1645170161745, "policy_loss": -4459116.406742552, "vf_loss": 5403417.235969388}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 134113.5, "diff_num_grad_updates_vs_sampler_policy": 134112.5}}, "num_env_steps_sampled": 44222880, "num_env_steps_trained": 44222880, "num_agent_steps_sampled": 44222880, "num_agent_steps_trained": 44222880}, "sampler_results": {"episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175628.74255532294, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22117714334365407, "mean_inference_ms": 0.3786940679104248, "mean_action_processing_ms": 0.092250082086321, "mean_env_wait_ms": 0.7537363626454209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037336349487304688, "StateBufferConnector_ms": 0.002766132354736328, "ViewRequirementAgentConnector_ms": 0.06932282447814941}}, "episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175628.74255532294, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-179775.2606165606, -180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22117714334365407, "mean_inference_ms": 0.3786940679104248, "mean_action_processing_ms": 0.092250082086321, "mean_env_wait_ms": 0.7537363626454209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037336349487304688, "StateBufferConnector_ms": 0.002766132354736328, "ViewRequirementAgentConnector_ms": 0.06932282447814941}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44222880, "num_agent_steps_trained": 44222880, "num_env_steps_sampled": 44222880, "num_env_steps_trained": 44222880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 702.1368207088099, "num_env_steps_trained_throughput_per_sec": 702.1368207088099, "timesteps_total": 44222880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44222880, "timers": {"training_iteration_time_ms": 62308.249, "sample_time_ms": 61154.903, "load_time_ms": 16.93, "load_throughput": 2594228.51, "learn_time_ms": 1135.241, "learn_throughput": 38687.806, "synch_weights_time_ms": 1.004}, "counters": {"num_env_steps_sampled": 44222880, "num_env_steps_trained": 44222880, "num_agent_steps_sampled": 44222880, "num_agent_steps_trained": 44222880}, "done": false, "episodes_total": 9180, "training_iteration": 2917, "trial_id": "11c4c_00000", "date": "2023-08-07_12-50-30", "timestamp": 1691401830, "time_this_iter_s": 62.55474495887756, "time_total_s": 76547.59248995781, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12777.181201696396, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 17.456818181818182, "ram_util_percent": 70.48068181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.0508588785333, "policy_loss": -3894721.2080163537, "vf_loss": 5303697.619989067}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 134799.5, "diff_num_grad_updates_vs_sampler_policy": 134798.5}}, "num_env_steps_sampled": 44266800, "num_env_steps_trained": 44266800, "num_agent_steps_sampled": 44266800, "num_agent_steps_trained": 44266800}, "sampler_results": {"episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175498.9664886411, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22119889002319545, "mean_inference_ms": 0.378736256332274, "mean_action_processing_ms": 0.09225859477960029, "mean_env_wait_ms": 0.7535330782266011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003731966018676758, "StateBufferConnector_ms": 0.002763509750366211, "ViewRequirementAgentConnector_ms": 0.06925106048583984}}, "episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175498.9664886411, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180088.36022990238, -181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22119889002319545, "mean_inference_ms": 0.378736256332274, "mean_action_processing_ms": 0.09225859477960029, "mean_env_wait_ms": 0.7535330782266011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003731966018676758, "StateBufferConnector_ms": 0.002763509750366211, "ViewRequirementAgentConnector_ms": 0.06925106048583984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44266800, "num_agent_steps_trained": 44266800, "num_env_steps_sampled": 44266800, "num_env_steps_trained": 44266800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 707.27069160858, "num_env_steps_trained_throughput_per_sec": 707.27069160858, "timesteps_total": 44266800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44266800, "timers": {"training_iteration_time_ms": 62266.951, "sample_time_ms": 61113.181, "load_time_ms": 17.003, "load_throughput": 2583010.224, "learn_time_ms": 1135.598, "learn_throughput": 38675.647, "synch_weights_time_ms": 0.997}, "counters": {"num_env_steps_sampled": 44266800, "num_env_steps_trained": 44266800, "num_agent_steps_sampled": 44266800, "num_agent_steps_trained": 44266800}, "done": false, "episodes_total": 9181, "training_iteration": 2918, "trial_id": "11c4c_00000", "date": "2023-08-07_12-51-32", "timestamp": 1691401892, "time_this_iter_s": 62.100979804992676, "time_total_s": 76609.6934697628, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12839.282181501389, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 18.138636363636365, "ram_util_percent": 70.52499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.17700809222964, "policy_loss": -3930197.7978544096, "vf_loss": 5469377.70335277}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 135485.5, "diff_num_grad_updates_vs_sampler_policy": 135484.5}}, "num_env_steps_sampled": 44310720, "num_env_steps_trained": 44310720, "num_agent_steps_sampled": 44310720, "num_agent_steps_trained": 44310720}, "sampler_results": {"episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175390.94183297467, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22121865078559166, "mean_inference_ms": 0.3787764883138751, "mean_action_processing_ms": 0.09226667578289155, "mean_env_wait_ms": 0.7533280885476884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037293434143066406, "StateBufferConnector_ms": 0.002762317657470703, "ViewRequirementAgentConnector_ms": 0.06917238235473633}}, "episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175390.94183297467, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181441.94603274032, -180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22121865078559166, "mean_inference_ms": 0.3787764883138751, "mean_action_processing_ms": 0.09226667578289155, "mean_env_wait_ms": 0.7533280885476884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037293434143066406, "StateBufferConnector_ms": 0.002762317657470703, "ViewRequirementAgentConnector_ms": 0.06917238235473633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44310720, "num_agent_steps_trained": 44310720, "num_env_steps_sampled": 44310720, "num_env_steps_trained": 44310720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 706.9028627608163, "num_env_steps_trained_throughput_per_sec": 706.9028627608163, "timesteps_total": 44310720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44310720, "timers": {"training_iteration_time_ms": 62250.843, "sample_time_ms": 61097.819, "load_time_ms": 16.908, "load_throughput": 2597645.256, "learn_time_ms": 1134.946, "learn_throughput": 38697.862, "synch_weights_time_ms": 1.0}, "counters": {"num_env_steps_sampled": 44310720, "num_env_steps_trained": 44310720, "num_agent_steps_sampled": 44310720, "num_agent_steps_trained": 44310720}, "done": false, "episodes_total": 9182, "training_iteration": 2919, "trial_id": "11c4c_00000", "date": "2023-08-07_12-52-34", "timestamp": 1691401954, "time_this_iter_s": 62.13309288024902, "time_total_s": 76671.82656264305, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12901.415274381638, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 18.103409090909093, "ram_util_percent": 70.54431818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.1748616744061, "policy_loss": -3914471.291812819, "vf_loss": 5825826.576348397}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 136171.5, "diff_num_grad_updates_vs_sampler_policy": 136170.5}}, "num_env_steps_sampled": 44354640, "num_env_steps_trained": 44354640, "num_agent_steps_sampled": 44354640, "num_agent_steps_trained": 44354640}, "sampler_results": {"episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175310.43755708632, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22123791603936196, "mean_inference_ms": 0.37881563562098025, "mean_action_processing_ms": 0.09227450741987508, "mean_env_wait_ms": 0.7531204091510544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037255287170410156, "StateBufferConnector_ms": 0.0027608871459960938, "ViewRequirementAgentConnector_ms": 0.06910347938537598}}, "episode_reward_max": -165958.36515911392, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175310.43755708632, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180131.622423451, -181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22123791603936196, "mean_inference_ms": 0.37881563562098025, "mean_action_processing_ms": 0.09227450741987508, "mean_env_wait_ms": 0.7531204091510544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037255287170410156, "StateBufferConnector_ms": 0.0027608871459960938, "ViewRequirementAgentConnector_ms": 0.06910347938537598}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44354640, "num_agent_steps_trained": 44354640, "num_env_steps_sampled": 44354640, "num_env_steps_trained": 44354640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 704.1034236659883, "num_env_steps_trained_throughput_per_sec": 704.1034236659883, "timesteps_total": 44354640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44354640, "timers": {"training_iteration_time_ms": 62246.662, "sample_time_ms": 61092.609, "load_time_ms": 16.924, "load_throughput": 2595061.747, "learn_time_ms": 1135.957, "learn_throughput": 38663.436, "synch_weights_time_ms": 1.002}, "counters": {"num_env_steps_sampled": 44354640, "num_env_steps_trained": 44354640, "num_agent_steps_sampled": 44354640, "num_agent_steps_trained": 44354640}, "done": false, "episodes_total": 9183, "training_iteration": 2920, "trial_id": "11c4c_00000", "date": "2023-08-07_12-53-37", "timestamp": 1691402017, "time_this_iter_s": 62.38018989562988, "time_total_s": 76734.20675253868, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12963.795464277267, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 17.523595505617976, "ram_util_percent": 70.4561797752809}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.16038651091014, "policy_loss": -3454850.8933639303, "vf_loss": 5167042.4340379005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 136857.5, "diff_num_grad_updates_vs_sampler_policy": 136856.5}}, "num_env_steps_sampled": 44398560, "num_env_steps_trained": 44398560, "num_agent_steps_sampled": 44398560, "num_agent_steps_trained": 44398560}, "sampler_results": {"episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175158.19625776634, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22125699259062645, "mean_inference_ms": 0.3788552214212368, "mean_action_processing_ms": 0.09228241057466673, "mean_env_wait_ms": 0.7529107080988782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037238597869873047, "StateBufferConnector_ms": 0.0027625560760498047, "ViewRequirementAgentConnector_ms": 0.06912374496459961}}, "episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175158.19625776634, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181139.9623555423, -181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22125699259062645, "mean_inference_ms": 0.3788552214212368, "mean_action_processing_ms": 0.09228241057466673, "mean_env_wait_ms": 0.7529107080988782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037238597869873047, "StateBufferConnector_ms": 0.0027625560760498047, "ViewRequirementAgentConnector_ms": 0.06912374496459961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44398560, "num_agent_steps_trained": 44398560, "num_env_steps_sampled": 44398560, "num_env_steps_trained": 44398560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 707.31977216445, "num_env_steps_trained_throughput_per_sec": 707.31977216445, "timesteps_total": 44398560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44398560, "timers": {"training_iteration_time_ms": 62245.506, "sample_time_ms": 61091.426, "load_time_ms": 16.898, "load_throughput": 2599070.947, "learn_time_ms": 1136.018, "learn_throughput": 38661.354, "synch_weights_time_ms": 0.991}, "counters": {"num_env_steps_sampled": 44398560, "num_env_steps_trained": 44398560, "num_agent_steps_sampled": 44398560, "num_agent_steps_trained": 44398560}, "done": false, "episodes_total": 9184, "training_iteration": 2921, "trial_id": "11c4c_00000", "date": "2023-08-07_12-54-39", "timestamp": 1691402079, "time_this_iter_s": 62.096967935562134, "time_total_s": 76796.30372047424, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13025.89243221283, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 17.638636363636365, "ram_util_percent": 70.60795454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.1632071180872, "policy_loss": -3488880.0443980047, "vf_loss": 5293136.855867347}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 137543.5, "diff_num_grad_updates_vs_sampler_policy": 137542.5}}, "num_env_steps_sampled": 44442480, "num_env_steps_trained": 44442480, "num_agent_steps_sampled": 44442480, "num_agent_steps_trained": 44442480}, "sampler_results": {"episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175010.00513323382, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556, -166320.84990229117], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22127638480786554, "mean_inference_ms": 0.37889574148325733, "mean_action_processing_ms": 0.09229041700134659, "mean_env_wait_ms": 0.7527004848391385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00372314453125, "StateBufferConnector_ms": 0.002762317657470703, "ViewRequirementAgentConnector_ms": 0.06913161277770996}}, "episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -175010.00513323382, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181179.02772809644, -178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556, -166320.84990229117], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22127638480786554, "mean_inference_ms": 0.37889574148325733, "mean_action_processing_ms": 0.09229041700134659, "mean_env_wait_ms": 0.7527004848391385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00372314453125, "StateBufferConnector_ms": 0.002762317657470703, "ViewRequirementAgentConnector_ms": 0.06913161277770996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44442480, "num_agent_steps_trained": 44442480, "num_env_steps_sampled": 44442480, "num_env_steps_trained": 44442480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 705.3525711191849, "num_env_steps_trained_throughput_per_sec": 705.3525711191849, "timesteps_total": 44442480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44442480, "timers": {"training_iteration_time_ms": 62193.898, "sample_time_ms": 61039.45, "load_time_ms": 17.019, "load_throughput": 2580593.095, "learn_time_ms": 1136.316, "learn_throughput": 38651.204, "synch_weights_time_ms": 0.95}, "counters": {"num_env_steps_sampled": 44442480, "num_env_steps_trained": 44442480, "num_agent_steps_sampled": 44442480, "num_agent_steps_trained": 44442480}, "done": false, "episodes_total": 9185, "training_iteration": 2922, "trial_id": "11c4c_00000", "date": "2023-08-07_12-55-41", "timestamp": 1691402141, "time_this_iter_s": 62.269678831100464, "time_total_s": 76858.57339930534, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13088.16211104393, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 18.039772727272727, "ram_util_percent": 70.53522727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.10459588498486, "policy_loss": -3938144.3035564814, "vf_loss": 5505175.78425656}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 138229.5, "diff_num_grad_updates_vs_sampler_policy": 138228.5}}, "num_env_steps_sampled": 44486400, "num_env_steps_trained": 44486400, "num_agent_steps_sampled": 44486400, "num_agent_steps_trained": 44486400}, "sampler_results": {"episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -174893.69886173445, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556, -166320.84990229117, -169548.40057816176], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22129580134372684, "mean_inference_ms": 0.3789363230912734, "mean_action_processing_ms": 0.09229841379089772, "mean_env_wait_ms": 0.7524897564249652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003720998764038086, "StateBufferConnector_ms": 0.002759218215942383, "ViewRequirementAgentConnector_ms": 0.0690920352935791}}, "episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -174893.69886173445, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-178224.77606717826, -181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556, -166320.84990229117, -169548.40057816176], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22129580134372684, "mean_inference_ms": 0.3789363230912734, "mean_action_processing_ms": 0.09229841379089772, "mean_env_wait_ms": 0.7524897564249652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003720998764038086, "StateBufferConnector_ms": 0.002759218215942383, "ViewRequirementAgentConnector_ms": 0.0690920352935791}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44486400, "num_agent_steps_trained": 44486400, "num_env_steps_sampled": 44486400, "num_env_steps_trained": 44486400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 699.2130840592799, "num_env_steps_trained_throughput_per_sec": 699.2130840592799, "timesteps_total": 44486400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44486400, "timers": {"training_iteration_time_ms": 62270.215, "sample_time_ms": 61109.22, "load_time_ms": 17.016, "load_throughput": 2581106.537, "learn_time_ms": 1142.874, "learn_throughput": 38429.434, "synch_weights_time_ms": 0.944}, "counters": {"num_env_steps_sampled": 44486400, "num_env_steps_trained": 44486400, "num_agent_steps_sampled": 44486400, "num_agent_steps_trained": 44486400}, "done": false, "episodes_total": 9186, "training_iteration": 2923, "trial_id": "11c4c_00000", "date": "2023-08-07_12-56-44", "timestamp": 1691402204, "time_this_iter_s": 62.81657600402832, "time_total_s": 76921.38997530937, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13150.978687047958, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 17.791011235955054, "ram_util_percent": 70.38764044943821}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.2040089865815, "policy_loss": -4026088.423662992, "vf_loss": 5584051.7882653065}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 138914.5}}, "num_env_steps_sampled": 44530320, "num_env_steps_trained": 44530320, "num_agent_steps_sampled": 44530320, "num_agent_steps_trained": 44530320}, "sampler_results": {"episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -174815.39249732942, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556, -166320.84990229117, -169548.40057816176, -170394.13962667482], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22131497212012927, "mean_inference_ms": 0.37897657741998386, "mean_action_processing_ms": 0.09230625816983429, "mean_env_wait_ms": 0.7522785344147942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037271976470947266, "StateBufferConnector_ms": 0.0027616024017333984, "ViewRequirementAgentConnector_ms": 0.06929469108581543}}, "episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -174815.39249732942, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181141.97333672087, -181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556, -166320.84990229117, -169548.40057816176, -170394.13962667482], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22131497212012927, "mean_inference_ms": 0.37897657741998386, "mean_action_processing_ms": 0.09230625816983429, "mean_env_wait_ms": 0.7522785344147942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037271976470947266, "StateBufferConnector_ms": 0.0027616024017333984, "ViewRequirementAgentConnector_ms": 0.06929469108581543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44530320, "num_agent_steps_trained": 44530320, "num_env_steps_sampled": 44530320, "num_env_steps_trained": 44530320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 700.329725149662, "num_env_steps_trained_throughput_per_sec": 700.329725149662, "timesteps_total": 44530320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44530320, "timers": {"training_iteration_time_ms": 62339.204, "sample_time_ms": 61178.401, "load_time_ms": 16.977, "load_throughput": 2587022.208, "learn_time_ms": 1142.696, "learn_throughput": 38435.427, "synch_weights_time_ms": 0.967}, "counters": {"num_env_steps_sampled": 44530320, "num_env_steps_trained": 44530320, "num_agent_steps_sampled": 44530320, "num_agent_steps_trained": 44530320}, "done": false, "episodes_total": 9187, "training_iteration": 2924, "trial_id": "11c4c_00000", "date": "2023-08-07_12-57-47", "timestamp": 1691402267, "time_this_iter_s": 62.71657705307007, "time_total_s": 76984.10655236244, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13213.695264101028, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 17.824719101123595, "ram_util_percent": 70.41573033707866}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.163027793951, "policy_loss": -3748428.409841643, "vf_loss": 5565670.854956268}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 139601.5, "diff_num_grad_updates_vs_sampler_policy": 139600.5}}, "num_env_steps_sampled": 44574240, "num_env_steps_trained": 44574240, "num_agent_steps_sampled": 44574240, "num_agent_steps_trained": 44574240}, "sampler_results": {"episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -174702.12177334994, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556, -166320.84990229117, -169548.40057816176, -170394.13962667482, -169814.90093877126], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22133363633381492, "mean_inference_ms": 0.3790178632768202, "mean_action_processing_ms": 0.0923142276639612, "mean_env_wait_ms": 0.7520667354451628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037310123443603516, "StateBufferConnector_ms": 0.0027565956115722656, "ViewRequirementAgentConnector_ms": 0.06930327415466309}}, "episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -174702.12177334994, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-181169.31581308297, -177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556, -166320.84990229117, -169548.40057816176, -170394.13962667482, -169814.90093877126], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22133363633381492, "mean_inference_ms": 0.3790178632768202, "mean_action_processing_ms": 0.0923142276639612, "mean_env_wait_ms": 0.7520667354451628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037310123443603516, "StateBufferConnector_ms": 0.0027565956115722656, "ViewRequirementAgentConnector_ms": 0.06930327415466309}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44574240, "num_agent_steps_trained": 44574240, "num_env_steps_sampled": 44574240, "num_env_steps_trained": 44574240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 704.6555717427158, "num_env_steps_trained_throughput_per_sec": 704.6555717427158, "timesteps_total": 44574240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44574240, "timers": {"training_iteration_time_ms": 62351.573, "sample_time_ms": 61189.235, "load_time_ms": 16.895, "load_throughput": 2599566.09, "learn_time_ms": 1144.325, "learn_throughput": 38380.719, "synch_weights_time_ms": 0.955}, "counters": {"num_env_steps_sampled": 44574240, "num_env_steps_trained": 44574240, "num_agent_steps_sampled": 44574240, "num_agent_steps_trained": 44574240}, "done": false, "episodes_total": 9188, "training_iteration": 2925, "trial_id": "11c4c_00000", "date": "2023-08-07_12-58-49", "timestamp": 1691402329, "time_this_iter_s": 62.331753969192505, "time_total_s": 77046.43830633163, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13276.027018070221, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 18.15340909090909, "ram_util_percent": 70.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.24841482090187, "policy_loss": -3561808.499427729, "vf_loss": 5301165.928115889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 140287.5, "diff_num_grad_updates_vs_sampler_policy": 140286.5}}, "num_env_steps_sampled": 44618160, "num_env_steps_trained": 44618160, "num_agent_steps_sampled": 44618160, "num_agent_steps_trained": 44618160}, "sampler_results": {"episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -174554.56973629515, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556, -166320.84990229117, -169548.40057816176, -170394.13962667482, -169814.90093877126, -166414.11210760547], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22135218166783388, "mean_inference_ms": 0.37905914215908965, "mean_action_processing_ms": 0.09232211683823337, "mean_env_wait_ms": 0.7518531426857896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737211227416992, "StateBufferConnector_ms": 0.0027539730072021484, "ViewRequirementAgentConnector_ms": 0.06940221786499023}}, "episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -174554.56973629515, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-177436.8926722667, -180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556, -166320.84990229117, -169548.40057816176, -170394.13962667482, -169814.90093877126, -166414.11210760547], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22135218166783388, "mean_inference_ms": 0.37905914215908965, "mean_action_processing_ms": 0.09232211683823337, "mean_env_wait_ms": 0.7518531426857896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737211227416992, "StateBufferConnector_ms": 0.0027539730072021484, "ViewRequirementAgentConnector_ms": 0.06940221786499023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44618160, "num_agent_steps_trained": 44618160, "num_env_steps_sampled": 44618160, "num_env_steps_trained": 44618160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 705.2756719043887, "num_env_steps_trained_throughput_per_sec": 705.2756719043887, "timesteps_total": 44618160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44618160, "timers": {"training_iteration_time_ms": 62364.585, "sample_time_ms": 61202.336, "load_time_ms": 16.988, "load_throughput": 2585384.715, "learn_time_ms": 1144.139, "learn_throughput": 38386.932, "synch_weights_time_ms": 0.958}, "counters": {"num_env_steps_sampled": 44618160, "num_env_steps_trained": 44618160, "num_agent_steps_sampled": 44618160, "num_agent_steps_trained": 44618160}, "done": false, "episodes_total": 9189, "training_iteration": 2926, "trial_id": "11c4c_00000", "date": "2023-08-07_12-59-52", "timestamp": 1691402392, "time_this_iter_s": 62.276347160339355, "time_total_s": 77108.71465349197, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13338.30336523056, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 18.14090909090909, "ram_util_percent": 70.44659090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.0369631486453, "policy_loss": -3772122.581726608, "vf_loss": 5429543.679300291}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 140973.5, "diff_num_grad_updates_vs_sampler_policy": 140972.5}}, "num_env_steps_sampled": 44662080, "num_env_steps_trained": 44662080, "num_agent_steps_sampled": 44662080, "num_agent_steps_trained": 44662080}, "sampler_results": {"episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -174463.94552930235, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556, -166320.84990229117, -169548.40057816176, -170394.13962667482, -169814.90093877126, -166414.11210760547, -168374.47197298665], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22136992344672762, "mean_inference_ms": 0.3790988996341225, "mean_action_processing_ms": 0.09232966300076631, "mean_env_wait_ms": 0.7516375360688007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037255287170410156, "StateBufferConnector_ms": 0.0027475357055664062, "ViewRequirementAgentConnector_ms": 0.06922793388366699}}, "episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -174463.94552930235, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180526.90072605683, -178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556, -166320.84990229117, -169548.40057816176, -170394.13962667482, -169814.90093877126, -166414.11210760547, -168374.47197298665], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22136992344672762, "mean_inference_ms": 0.3790988996341225, "mean_action_processing_ms": 0.09232966300076631, "mean_env_wait_ms": 0.7516375360688007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037255287170410156, "StateBufferConnector_ms": 0.0027475357055664062, "ViewRequirementAgentConnector_ms": 0.06922793388366699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44662080, "num_agent_steps_trained": 44662080, "num_env_steps_sampled": 44662080, "num_env_steps_trained": 44662080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 700.4607053368246, "num_env_steps_trained_throughput_per_sec": 700.4607053368246, "timesteps_total": 44662080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44662080, "timers": {"training_iteration_time_ms": 62379.552, "sample_time_ms": 61217.681, "load_time_ms": 17.023, "load_throughput": 2580018.427, "learn_time_ms": 1143.73, "learn_throughput": 38400.683, "synch_weights_time_ms": 0.955}, "counters": {"num_env_steps_sampled": 44662080, "num_env_steps_trained": 44662080, "num_agent_steps_sampled": 44662080, "num_agent_steps_trained": 44662080}, "done": false, "episodes_total": 9190, "training_iteration": 2927, "trial_id": "11c4c_00000", "date": "2023-08-07_13-00-54", "timestamp": 1691402454, "time_this_iter_s": 62.70482683181763, "time_total_s": 77171.41948032379, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13401.008192062378, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 18.18876404494382, "ram_util_percent": 70.43707865168538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.30545635612646, "policy_loss": -3704070.5926310816, "vf_loss": 5662594.339832362}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 141659.5, "diff_num_grad_updates_vs_sampler_policy": 141658.5}}, "num_env_steps_sampled": 44706000, "num_env_steps_trained": 44706000, "num_agent_steps_sampled": 44706000, "num_agent_steps_trained": 44706000}, "sampler_results": {"episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -174366.26789602908, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556, -166320.84990229117, -169548.40057816176, -170394.13962667482, -169814.90093877126, -166414.11210760547, -168374.47197298665, -170759.13739873093], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22138712071584912, "mean_inference_ms": 0.3791374622353701, "mean_action_processing_ms": 0.09233697999218073, "mean_env_wait_ms": 0.7514202882138948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037255287170410156, "StateBufferConnector_ms": 0.0027446746826171875, "ViewRequirementAgentConnector_ms": 0.06922674179077148}}, "episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -174366.26789602908, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-178671.00194044225, -176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556, -166320.84990229117, -169548.40057816176, -170394.13962667482, -169814.90093877126, -166414.11210760547, -168374.47197298665, -170759.13739873093], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22138712071584912, "mean_inference_ms": 0.3791374622353701, "mean_action_processing_ms": 0.09233697999218073, "mean_env_wait_ms": 0.7514202882138948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037255287170410156, "StateBufferConnector_ms": 0.0027446746826171875, "ViewRequirementAgentConnector_ms": 0.06922674179077148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44706000, "num_agent_steps_trained": 44706000, "num_env_steps_sampled": 44706000, "num_env_steps_trained": 44706000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 709.7771495989581, "num_env_steps_trained_throughput_per_sec": 709.7771495989581, "timesteps_total": 44706000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44706000, "timers": {"training_iteration_time_ms": 62357.625, "sample_time_ms": 61193.883, "load_time_ms": 16.868, "load_throughput": 2603787.954, "learn_time_ms": 1145.744, "learn_throughput": 38333.179, "synch_weights_time_ms": 0.968}, "counters": {"num_env_steps_sampled": 44706000, "num_env_steps_trained": 44706000, "num_agent_steps_sampled": 44706000, "num_agent_steps_trained": 44706000}, "done": false, "episodes_total": 9191, "training_iteration": 2928, "trial_id": "11c4c_00000", "date": "2023-08-07_13-01-56", "timestamp": 1691402516, "time_this_iter_s": 61.8815221786499, "time_total_s": 77233.30100250244, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13462.889714241028, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 17.38409090909091, "ram_util_percent": 70.43863636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-15, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.1797446203649, "policy_loss": -3439253.78218955, "vf_loss": 5462843.303115889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 142345.5, "diff_num_grad_updates_vs_sampler_policy": 142344.5}}, "num_env_steps_sampled": 44749920, "num_env_steps_trained": 44749920, "num_agent_steps_sampled": 44749920, "num_agent_steps_trained": 44749920}, "sampler_results": {"episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -174262.6117594678, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556, -166320.84990229117, -169548.40057816176, -170394.13962667482, -169814.90093877126, -166414.11210760547, -168374.47197298665, -170759.13739873093, -168305.38828431617], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.221404640782003, "mean_inference_ms": 0.37917732505832397, "mean_action_processing_ms": 0.0923445177183533, "mean_env_wait_ms": 0.7512031968130937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003727436065673828, "StateBufferConnector_ms": 0.0027437210083007812, "ViewRequirementAgentConnector_ms": 0.0692448616027832}}, "episode_reward_max": -164907.4924914556, "episode_reward_min": -184212.58430616523, "episode_reward_mean": -174262.6117594678, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-176854.1342254282, -184212.58430616523, -176445.77868290606, -177857.01453612538, -178675.64649155535, -180236.78073763908, -180169.39241889058, -178064.32012065966, -180589.42048095824, -180379.14612997894, -178141.0466587488, -178593.39096868908, -179160.47857993128, -177066.19725231722, -179494.75419471902, -179899.68294814575, -178203.92391967226, -176984.80896632257, -180408.837846192, -180016.89351297714, -176260.40710770997, -179930.03581611018, -176097.3253238217, -176694.69254010578, -179363.3140933089, -176137.3591056782, -174238.8397993808, -175939.89769528506, -175327.70801840187, -177825.06533591799, -175047.7060882028, -173063.53959217155, -178759.75916145978, -171737.49409837037, -176685.2225676827, -179034.94413136056, -176558.77169344813, -172479.12575036543, -176520.31527895122, -176788.48591609983, -176813.70985228752, -176026.90749552747, -179745.65686169817, -175141.4562471604, -173894.3196741029, -177251.20251974312, -176012.28313459308, -174372.7604545079, -175835.09560774884, -171997.58640976873, -179225.42254734738, -169249.43288486157, -175941.4899934384, -172172.18056143384, -173477.7260317187, -177666.13636455964, -173178.66472623052, -175339.8397587929, -176103.3273487617, -171108.79280555178, -172169.09512690984, -173108.29989244102, -174230.49035814914, -170909.49607711204, -175270.74775917406, -174856.34111279986, -172045.1811729034, -171441.79154681752, -174922.71909838752, -170866.7701722983, -171316.33749149783, -170164.33929540793, -168346.31731170102, -172483.6152040164, -167630.6890568682, -170949.90438261183, -173789.8970533706, -165958.36515911392, -169009.21515071898, -167336.18816292606, -172047.0107000578, -172210.6381251814, -171210.4054316663, -169379.63058666806, -173196.16013535642, -172982.68816583673, -169408.3265535924, -168208.32193498232, -166797.65394837235, -169285.89466326273, -173391.51844389737, -164907.4924914556, -166320.84990229117, -169548.40057816176, -170394.13962667482, -169814.90093877126, -166414.11210760547, -168374.47197298665, -170759.13739873093, -168305.38828431617], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.221404640782003, "mean_inference_ms": 0.37917732505832397, "mean_action_processing_ms": 0.0923445177183533, "mean_env_wait_ms": 0.7512031968130937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003727436065673828, "StateBufferConnector_ms": 0.0027437210083007812, "ViewRequirementAgentConnector_ms": 0.0692448616027832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44749920, "num_agent_steps_trained": 44749920, "num_env_steps_sampled": 44749920, "num_env_steps_trained": 44749920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.5106655341211, "num_env_steps_trained_throughput_per_sec": 710.5106655341211, "timesteps_total": 44749920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44749920, "timers": {"training_iteration_time_ms": 62326.076, "sample_time_ms": 61160.935, "load_time_ms": 16.904, "load_throughput": 2598150.849, "learn_time_ms": 1147.117, "learn_throughput": 38287.273, "synch_weights_time_ms": 0.957}, "counters": {"num_env_steps_sampled": 44749920, "num_env_steps_trained": 44749920, "num_agent_steps_sampled": 44749920, "num_agent_steps_trained": 44749920}, "done": true, "episodes_total": 9192, "training_iteration": 2929, "trial_id": "11c4c_00000", "date": "2023-08-07_13-02-58", "timestamp": 1691402578, "time_this_iter_s": 61.81784391403198, "time_total_s": 77295.11884641647, "pid": 95696, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 1e-13], [35965920, 1e-13], [36317280, 1e-13], [36668640, 1e-13], [37020000, 1e-13], [37371360, 5e-14], [37722720, 5e-14], [38074080, 5e-14], [38425440, 5e-14], [38776800, 5e-14], [39128160, 5e-14], [39479520, 2.5e-14], [39830880, 2.5e-14], [40182240, 2.5e-14], [40533600, 2.5e-14], [40884960, 1e-14], [41236320, 1e-14], [41587680, 1e-14], [41939040, 1e-14], [42290400, 1e-14], [42641760, 5e-15], [42993120, 5e-15], [43344480, 5e-15], [43695840, 5e-15], [44047200, 5e-15], [44398560, 5e-15]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.1, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f9c4790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13524.70755815506, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 17.797701149425283, "ram_util_percent": 70.42183908045976}}
