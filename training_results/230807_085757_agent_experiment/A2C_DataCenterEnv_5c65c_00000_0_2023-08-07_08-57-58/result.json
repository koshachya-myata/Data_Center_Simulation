{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-13, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.5793998429101, "policy_loss": -21542132.9647925, "vf_loss": 8018361.162718659}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.5, "diff_num_grad_updates_vs_sampler_policy": 342.5}}, "num_env_steps_sampled": 35658480, "num_env_steps_trained": 35658480, "num_agent_steps_sampled": 35658480, "num_agent_steps_trained": 35658480}, "sampler_results": {"episode_reward_max": -207132.13395011952, "episode_reward_min": -207132.13395011952, "episode_reward_mean": -207132.13395011952, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207132.13395011952], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1381825956717771, "mean_inference_ms": 0.24063589740045405, "mean_action_processing_ms": 0.05747254072150117, "mean_env_wait_ms": 0.6256034141306543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.002002716064453125, "ViewRequirementAgentConnector_ms": 0.04589557647705078}}, "episode_reward_max": -207132.13395011952, "episode_reward_min": -207132.13395011952, "episode_reward_mean": -207132.13395011952, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-207132.13395011952], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1381825956717771, "mean_inference_ms": 0.24063589740045405, "mean_action_processing_ms": 0.05747254072150117, "mean_env_wait_ms": 0.6256034141306543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.002002716064453125, "ViewRequirementAgentConnector_ms": 0.04589557647705078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35658480, "num_agent_steps_trained": 35658480, "num_env_steps_sampled": 35658480, "num_env_steps_trained": 35658480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 916.5871480705215, "num_env_steps_trained_throughput_per_sec": 916.5871480705215, "timesteps_total": 35658480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 35658480, "timers": {"training_iteration_time_ms": 47916.86, "sample_time_ms": 47188.17, "load_time_ms": 0.46, "load_throughput": 95497061.524, "learn_time_ms": 727.087, "learn_throughput": 60405.424, "synch_weights_time_ms": 0.933}, "counters": {"num_env_steps_sampled": 35658480, "num_env_steps_trained": 35658480, "num_agent_steps_sampled": 35658480, "num_agent_steps_trained": 35658480}, "done": false, "episodes_total": 8985, "training_iteration": 2722, "trial_id": "5c65c_00000", "date": "2023-08-07_08-58-50", "timestamp": 1691387930, "time_this_iter_s": 47.91900992393494, "time_total_s": 63818.33029818535, "pid": 95351, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 5e-09], [35965920, 8e-10], [36317280, 2.5e-10], [36668640, 2.5e-10], [37020000, 2.5e-10], [37371360, 2.5e-10], [37722720, 1e-10], [38074080, 1e-10], [38425440, 1e-10], [38776800, 5e-11], [39128160, 5e-11], [39479520, 5e-11], [39830880, 5e-11], [40182240, 1e-11], [40533600, 1e-11], [40884960, 1e-11], [41236320, 1e-11], [41587680, 5e-12], [41939040, 5e-12], [42290400, 2.5e-12], [42641760, 2.5e-12], [42993120, 1e-12], [43344480, 1e-12], [43695840, 5e-13], [44047200, 5e-13], [44398560, 1e-13]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f957790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 47.91900992393494, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 24.302898550724635, "ram_util_percent": 70.65217391304348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.4749999999999995e-09, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.70149973877665, "policy_loss": -20403229.820813593, "vf_loss": 7877213.515215015}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1029.5, "diff_num_grad_updates_vs_sampler_policy": 1028.5}}, "num_env_steps_sampled": 35702400, "num_env_steps_trained": 35702400, "num_agent_steps_sampled": 35702400, "num_agent_steps_trained": 35702400}, "sampler_results": {"episode_reward_max": -205577.38282817995, "episode_reward_min": -207132.13395011952, "episode_reward_mean": -206354.75838914973, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13995641157914873, "mean_inference_ms": 0.2455244313656576, "mean_action_processing_ms": 0.05845373445145109, "mean_env_wait_ms": 0.6198191450176062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002562999725341797, "StateBufferConnector_ms": 0.0018596649169921875, "ViewRequirementAgentConnector_ms": 0.0446319580078125}}, "episode_reward_max": -205577.38282817995, "episode_reward_min": -207132.13395011952, "episode_reward_mean": -206354.75838914973, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13995641157914873, "mean_inference_ms": 0.2455244313656576, "mean_action_processing_ms": 0.05845373445145109, "mean_env_wait_ms": 0.6198191450176062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002562999725341797, "StateBufferConnector_ms": 0.0018596649169921875, "ViewRequirementAgentConnector_ms": 0.0446319580078125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35702400, "num_agent_steps_trained": 35702400, "num_env_steps_sampled": 35702400, "num_env_steps_trained": 35702400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 909.5051281178279, "num_env_steps_trained_throughput_per_sec": 909.5051281178279, "timesteps_total": 35702400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 35702400, "timers": {"training_iteration_time_ms": 48103.407, "sample_time_ms": 47375.617, "load_time_ms": 15.467, "load_throughput": 2839607.104, "learn_time_ms": 711.002, "learn_throughput": 61771.979, "synch_weights_time_ms": 1.058}, "counters": {"num_env_steps_sampled": 35702400, "num_env_steps_trained": 35702400, "num_agent_steps_sampled": 35702400, "num_agent_steps_trained": 35702400}, "done": false, "episodes_total": 8986, "training_iteration": 2723, "trial_id": "5c65c_00000", "date": "2023-08-07_08-59-39", "timestamp": 1691387979, "time_this_iter_s": 48.29232692718506, "time_total_s": 63866.62262511253, "pid": 95351, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 5e-09], [35965920, 8e-10], [36317280, 2.5e-10], [36668640, 2.5e-10], [37020000, 2.5e-10], [37371360, 2.5e-10], [37722720, 1e-10], [38074080, 1e-10], [38425440, 1e-10], [38776800, 5e-11], [39128160, 5e-11], [39479520, 5e-11], [39830880, 5e-11], [40182240, 1e-11], [40533600, 1e-11], [40884960, 1e-11], [41236320, 1e-11], [41587680, 5e-12], [41939040, 5e-12], [42290400, 2.5e-12], [42641760, 2.5e-12], [42993120, 1e-12], [43344480, 1e-12], [43695840, 5e-13], [44047200, 5e-13], [44398560, 1e-13]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f957790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 96.21133685112, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.03676470588235, "ram_util_percent": 73.01470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.95e-09, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.86165581083156, "policy_loss": -20833166.32425576, "vf_loss": 7883378.682215744}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1715.5, "diff_num_grad_updates_vs_sampler_policy": 1714.5}}, "num_env_steps_sampled": 35746320, "num_env_steps_trained": 35746320, "num_agent_steps_sampled": 35746320, "num_agent_steps_trained": 35746320}, "sampler_results": {"episode_reward_max": -205577.38282817995, "episode_reward_min": -207132.13395011952, "episode_reward_mean": -206146.8435997175, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14028706673808036, "mean_inference_ms": 0.24623605812151092, "mean_action_processing_ms": 0.0586590737468387, "mean_env_wait_ms": 0.6137811229117692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0018914540608723958, "ViewRequirementAgentConnector_ms": 0.04421075185139974}}, "episode_reward_max": -205577.38282817995, "episode_reward_min": -207132.13395011952, "episode_reward_mean": -206146.8435997175, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14028706673808036, "mean_inference_ms": 0.24623605812151092, "mean_action_processing_ms": 0.0586590737468387, "mean_env_wait_ms": 0.6137811229117692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025033950805664062, "StateBufferConnector_ms": 0.0018914540608723958, "ViewRequirementAgentConnector_ms": 0.04421075185139974}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35746320, "num_agent_steps_trained": 35746320, "num_env_steps_sampled": 35746320, "num_env_steps_trained": 35746320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 954.9337000487234, "num_env_steps_trained_throughput_per_sec": 954.9337000487234, "timesteps_total": 35746320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 35746320, "timers": {"training_iteration_time_ms": 47399.84, "sample_time_ms": 46669.256, "load_time_ms": 18.542, "load_throughput": 2368720.726, "learn_time_ms": 710.876, "learn_throughput": 61782.921, "synch_weights_time_ms": 0.947}, "counters": {"num_env_steps_sampled": 35746320, "num_env_steps_trained": 35746320, "num_agent_steps_sampled": 35746320, "num_agent_steps_trained": 35746320}, "done": false, "episodes_total": 8987, "training_iteration": 2724, "trial_id": "5c65c_00000", "date": "2023-08-07_09-00-25", "timestamp": 1691388025, "time_this_iter_s": 45.9946129322052, "time_total_s": 63912.61723804474, "pid": 95351, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 5e-09], [35965920, 8e-10], [36317280, 2.5e-10], [36668640, 2.5e-10], [37020000, 2.5e-10], [37371360, 2.5e-10], [37722720, 1e-10], [38074080, 1e-10], [38425440, 1e-10], [38776800, 5e-11], [39128160, 5e-11], [39479520, 5e-11], [39830880, 5e-11], [40182240, 1e-11], [40533600, 1e-11], [40884960, 1e-11], [41236320, 1e-11], [41587680, 5e-12], [41939040, 5e-12], [42290400, 2.5e-12], [42641760, 2.5e-12], [42993120, 1e-12], [43344480, 1e-12], [43695840, 5e-13], [44047200, 5e-13], [44398560, 1e-13]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f957790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 142.2059497833252, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.463636363636365, "ram_util_percent": 73.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.4250000000000005e-09, "entropy_coeff": 0.19999999999999998, "policy_entropy": -358.97981796042217, "policy_loss": -21376579.98399064, "vf_loss": 8038468.023688046}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2401.5, "diff_num_grad_updates_vs_sampler_policy": 2400.5}}, "num_env_steps_sampled": 35790240, "num_env_steps_trained": 35790240, "num_agent_steps_sampled": 35790240, "num_agent_steps_trained": 35790240}, "sampler_results": {"episode_reward_max": -205577.38282817995, "episode_reward_min": -207639.18811342452, "episode_reward_mean": -206519.92972814426, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312, -207639.18811342452], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14037840002137095, "mean_inference_ms": 0.24632786468233597, "mean_action_processing_ms": 0.058701042063615365, "mean_env_wait_ms": 0.6095745289516652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002384185791015625, "StateBufferConnector_ms": 0.0017940998077392578, "ViewRequirementAgentConnector_ms": 0.044411420822143555}}, "episode_reward_max": -205577.38282817995, "episode_reward_min": -207639.18811342452, "episode_reward_mean": -206519.92972814426, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312, -207639.18811342452], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14037840002137095, "mean_inference_ms": 0.24632786468233597, "mean_action_processing_ms": 0.058701042063615365, "mean_env_wait_ms": 0.6095745289516652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002384185791015625, "StateBufferConnector_ms": 0.0017940998077392578, "ViewRequirementAgentConnector_ms": 0.044411420822143555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35790240, "num_agent_steps_trained": 35790240, "num_env_steps_sampled": 35790240, "num_env_steps_trained": 35790240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 947.6989248298698, "num_env_steps_trained_throughput_per_sec": 947.6989248298698, "timesteps_total": 35790240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 35790240, "timers": {"training_iteration_time_ms": 47135.835, "sample_time_ms": 46387.221, "load_time_ms": 23.693, "load_throughput": 1853747.41, "learn_time_ms": 723.824, "learn_throughput": 60677.707, "synch_weights_time_ms": 0.883}, "counters": {"num_env_steps_sampled": 35790240, "num_env_steps_trained": 35790240, "num_agent_steps_sampled": 35790240, "num_agent_steps_trained": 35790240}, "done": false, "episodes_total": 8988, "training_iteration": 2725, "trial_id": "5c65c_00000", "date": "2023-08-07_09-01-11", "timestamp": 1691388071, "time_this_iter_s": 46.34603500366211, "time_total_s": 63958.9632730484, "pid": 95351, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 5e-09], [35965920, 8e-10], [36317280, 2.5e-10], [36668640, 2.5e-10], [37020000, 2.5e-10], [37371360, 2.5e-10], [37722720, 1e-10], [38074080, 1e-10], [38425440, 1e-10], [38776800, 5e-11], [39128160, 5e-11], [39479520, 5e-11], [39830880, 5e-11], [40182240, 1e-11], [40533600, 1e-11], [40884960, 1e-11], [41236320, 1e-11], [41587680, 5e-12], [41939040, 5e-12], [42290400, 2.5e-12], [42641760, 2.5e-12], [42993120, 1e-12], [43344480, 1e-12], [43695840, 5e-13], [44047200, 5e-13], [44398560, 1e-13]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f957790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 188.5519847869873, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.681538461538466, "ram_util_percent": 73.3923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.9e-09, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.0643431549517, "policy_loss": -19959509.830815528, "vf_loss": 7754651.5659620995}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3087.5, "diff_num_grad_updates_vs_sampler_policy": 3086.5}}, "num_env_steps_sampled": 35834160, "num_env_steps_trained": 35834160, "num_agent_steps_sampled": 35834160, "num_agent_steps_trained": 35834160}, "sampler_results": {"episode_reward_max": -204017.95044013814, "episode_reward_min": -207639.18811342452, "episode_reward_mean": -206019.53387054303, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312, -207639.18811342452, -204017.95044013814], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14052393250108605, "mean_inference_ms": 0.24670948571337853, "mean_action_processing_ms": 0.05880095405822393, "mean_env_wait_ms": 0.6068619951305969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002765655517578125, "StateBufferConnector_ms": 0.0017595291137695312, "ViewRequirementAgentConnector_ms": 0.044684410095214844}}, "episode_reward_max": -204017.95044013814, "episode_reward_min": -207639.18811342452, "episode_reward_mean": -206019.53387054303, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312, -207639.18811342452, -204017.95044013814], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14052393250108605, "mean_inference_ms": 0.24670948571337853, "mean_action_processing_ms": 0.05880095405822393, "mean_env_wait_ms": 0.6068619951305969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002765655517578125, "StateBufferConnector_ms": 0.0017595291137695312, "ViewRequirementAgentConnector_ms": 0.044684410095214844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35834160, "num_agent_steps_trained": 35834160, "num_env_steps_sampled": 35834160, "num_env_steps_trained": 35834160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 926.2971796821259, "num_env_steps_trained_throughput_per_sec": 926.2971796821259, "timesteps_total": 35834160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 35834160, "timers": {"training_iteration_time_ms": 47191.582, "sample_time_ms": 46451.04, "load_time_ms": 23.116, "load_throughput": 1899946.076, "learn_time_ms": 716.388, "learn_throughput": 61307.52, "synch_weights_time_ms": 0.844}, "counters": {"num_env_steps_sampled": 35834160, "num_env_steps_trained": 35834160, "num_agent_steps_sampled": 35834160, "num_agent_steps_trained": 35834160}, "done": false, "episodes_total": 8989, "training_iteration": 2726, "trial_id": "5c65c_00000", "date": "2023-08-07_09-01-58", "timestamp": 1691388118, "time_this_iter_s": 47.416648864746094, "time_total_s": 64006.37992191315, "pid": 95351, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 5e-09], [35965920, 8e-10], [36317280, 2.5e-10], [36668640, 2.5e-10], [37020000, 2.5e-10], [37371360, 2.5e-10], [37722720, 1e-10], [38074080, 1e-10], [38425440, 1e-10], [38776800, 5e-11], [39128160, 5e-11], [39479520, 5e-11], [39830880, 5e-11], [40182240, 1e-11], [40533600, 1e-11], [40884960, 1e-11], [41236320, 1e-11], [41587680, 5e-12], [41939040, 5e-12], [42290400, 2.5e-12], [42641760, 2.5e-12], [42993120, 1e-12], [43344480, 1e-12], [43695840, 5e-13], [44047200, 5e-13], [44398560, 1e-13]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f957790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 235.9686336517334, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 27.23235294117647, "ram_util_percent": 74.17941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3749999999999993e-09, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.05266519885714, "policy_loss": -20879425.752368804, "vf_loss": 7836400.576895044}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3773.5, "diff_num_grad_updates_vs_sampler_policy": 3772.5}}, "num_env_steps_sampled": 35878080, "num_env_steps_trained": 35878080, "num_agent_steps_sampled": 35878080, "num_agent_steps_trained": 35878080}, "sampler_results": {"episode_reward_max": -204017.95044013814, "episode_reward_min": -207639.18811342452, "episode_reward_mean": -205868.98596827235, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312, -207639.18811342452, -204017.95044013814, -205116.24645691895], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14048173702817393, "mean_inference_ms": 0.24654821377728875, "mean_action_processing_ms": 0.058790538220740964, "mean_env_wait_ms": 0.6041864282193838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027179718017578125, "StateBufferConnector_ms": 0.0017603238423665364, "ViewRequirementAgentConnector_ms": 0.04445314407348633}}, "episode_reward_max": -204017.95044013814, "episode_reward_min": -207639.18811342452, "episode_reward_mean": -205868.98596827235, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312, -207639.18811342452, -204017.95044013814, -205116.24645691895], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14048173702817393, "mean_inference_ms": 0.24654821377728875, "mean_action_processing_ms": 0.058790538220740964, "mean_env_wait_ms": 0.6041864282193838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027179718017578125, "StateBufferConnector_ms": 0.0017603238423665364, "ViewRequirementAgentConnector_ms": 0.04445314407348633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35878080, "num_agent_steps_trained": 35878080, "num_env_steps_sampled": 35878080, "num_env_steps_trained": 35878080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 981.1904764770854, "num_env_steps_trained_throughput_per_sec": 981.1904764770854, "timesteps_total": 35878080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 35878080, "timers": {"training_iteration_time_ms": 46786.641, "sample_time_ms": 46050.38, "load_time_ms": 21.647, "load_throughput": 2028943.109, "learn_time_ms": 713.617, "learn_throughput": 61545.642, "synch_weights_time_ms": 0.818}, "counters": {"num_env_steps_sampled": 35878080, "num_env_steps_trained": 35878080, "num_agent_steps_sampled": 35878080, "num_agent_steps_trained": 35878080}, "done": false, "episodes_total": 8990, "training_iteration": 2727, "trial_id": "5c65c_00000", "date": "2023-08-07_09-02-43", "timestamp": 1691388163, "time_this_iter_s": 44.76402306556702, "time_total_s": 64051.143944978714, "pid": 95351, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 5e-09], [35965920, 8e-10], [36317280, 2.5e-10], [36668640, 2.5e-10], [37020000, 2.5e-10], [37371360, 2.5e-10], [37722720, 1e-10], [38074080, 1e-10], [38425440, 1e-10], [38776800, 5e-11], [39128160, 5e-11], [39479520, 5e-11], [39830880, 5e-11], [40182240, 1e-11], [40533600, 1e-11], [40884960, 1e-11], [41236320, 1e-11], [41587680, 5e-12], [41939040, 5e-12], [42290400, 2.5e-12], [42641760, 2.5e-12], [42993120, 1e-12], [43344480, 1e-12], [43695840, 5e-13], [44047200, 5e-13], [44398560, 1e-13]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f957790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 280.7326567173004, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.953968253968263, "ram_util_percent": 73.68730158730159}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.85e-09, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.05375053027626, "policy_loss": -20583974.882493623, "vf_loss": 7626196.23760933}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4459.5, "diff_num_grad_updates_vs_sampler_policy": 4458.5}}, "num_env_steps_sampled": 35922000, "num_env_steps_trained": 35922000, "num_agent_steps_sampled": 35922000, "num_agent_steps_trained": 35922000}, "sampler_results": {"episode_reward_max": -202464.6163006042, "episode_reward_min": -207639.18811342452, "episode_reward_mean": -205382.64744431977, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312, -207639.18811342452, -204017.95044013814, -205116.24645691895, -202464.6163006042], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14045917385576087, "mean_inference_ms": 0.24634536563771844, "mean_action_processing_ms": 0.058771182918804295, "mean_env_wait_ms": 0.6019926981492366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027622495378766742, "StateBufferConnector_ms": 0.0017881393432617188, "ViewRequirementAgentConnector_ms": 0.04641669137137277}}, "episode_reward_max": -202464.6163006042, "episode_reward_min": -207639.18811342452, "episode_reward_mean": -205382.64744431977, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312, -207639.18811342452, -204017.95044013814, -205116.24645691895, -202464.6163006042], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14045917385576087, "mean_inference_ms": 0.24634536563771844, "mean_action_processing_ms": 0.058771182918804295, "mean_env_wait_ms": 0.6019926981492366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027622495378766742, "StateBufferConnector_ms": 0.0017881393432617188, "ViewRequirementAgentConnector_ms": 0.04641669137137277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35922000, "num_agent_steps_trained": 35922000, "num_env_steps_sampled": 35922000, "num_env_steps_trained": 35922000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 954.8710591667084, "num_env_steps_trained_throughput_per_sec": 954.8710591667084, "timesteps_total": 35922000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 35922000, "timers": {"training_iteration_time_ms": 46673.653, "sample_time_ms": 45935.245, "load_time_ms": 20.969, "load_throughput": 2094512.059, "learn_time_ms": 716.434, "learn_throughput": 61303.632, "synch_weights_time_ms": 0.825}, "counters": {"num_env_steps_sampled": 35922000, "num_env_steps_trained": 35922000, "num_agent_steps_sampled": 35922000, "num_agent_steps_trained": 35922000}, "done": false, "episodes_total": 8991, "training_iteration": 2728, "trial_id": "5c65c_00000", "date": "2023-08-07_09-03-29", "timestamp": 1691388209, "time_this_iter_s": 45.99840712547302, "time_total_s": 64097.14235210419, "pid": 95351, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 5e-09], [35965920, 8e-10], [36317280, 2.5e-10], [36668640, 2.5e-10], [37020000, 2.5e-10], [37371360, 2.5e-10], [37722720, 1e-10], [38074080, 1e-10], [38425440, 1e-10], [38776800, 5e-11], [39128160, 5e-11], [39479520, 5e-11], [39830880, 5e-11], [40182240, 1e-11], [40533600, 1e-11], [40884960, 1e-11], [41236320, 1e-11], [41587680, 5e-12], [41939040, 5e-12], [42290400, 2.5e-12], [42641760, 2.5e-12], [42993120, 1e-12], [43344480, 1e-12], [43695840, 5e-13], [44047200, 5e-13], [44398560, 1e-13]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f957790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 326.73106384277344, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.55606060606061, "ram_util_percent": 73.87121212121211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.325e-09, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.2804385705175, "policy_loss": -19671827.89752642, "vf_loss": 7797444.503279883}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5145.5, "diff_num_grad_updates_vs_sampler_policy": 5144.5}}, "num_env_steps_sampled": 35965920, "num_env_steps_trained": 35965920, "num_agent_steps_sampled": 35965920, "num_agent_steps_trained": 35965920}, "sampler_results": {"episode_reward_max": -202464.6163006042, "episode_reward_min": -207639.18811342452, "episode_reward_mean": -205214.43342736614, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312, -207639.18811342452, -204017.95044013814, -205116.24645691895, -202464.6163006042, -204036.93530869056], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14149898288035573, "mean_inference_ms": 0.24756028689679857, "mean_action_processing_ms": 0.059117915117314186, "mean_env_wait_ms": 0.6035399437486756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002822279930114746, "StateBufferConnector_ms": 0.0018805265426635742, "ViewRequirementAgentConnector_ms": 0.049042701721191406}}, "episode_reward_max": -202464.6163006042, "episode_reward_min": -207639.18811342452, "episode_reward_mean": -205214.43342736614, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312, -207639.18811342452, -204017.95044013814, -205116.24645691895, -202464.6163006042, -204036.93530869056], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14149898288035573, "mean_inference_ms": 0.24756028689679857, "mean_action_processing_ms": 0.059117915117314186, "mean_env_wait_ms": 0.6035399437486756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002822279930114746, "StateBufferConnector_ms": 0.0018805265426635742, "ViewRequirementAgentConnector_ms": 0.049042701721191406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35965920, "num_agent_steps_trained": 35965920, "num_env_steps_sampled": 35965920, "num_env_steps_trained": 35965920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 683.4949802380336, "num_env_steps_trained_throughput_per_sec": 683.4949802380336, "timesteps_total": 35965920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 35965920, "timers": {"training_iteration_time_ms": 48871.69, "sample_time_ms": 48067.465, "load_time_ms": 23.296, "load_throughput": 1885338.492, "learn_time_ms": 779.885, "learn_throughput": 56316.0, "synch_weights_time_ms": 0.845}, "counters": {"num_env_steps_sampled": 35965920, "num_env_steps_trained": 35965920, "num_agent_steps_sampled": 35965920, "num_agent_steps_trained": 35965920}, "done": false, "episodes_total": 8992, "training_iteration": 2729, "trial_id": "5c65c_00000", "date": "2023-08-07_09-04-33", "timestamp": 1691388273, "time_this_iter_s": 64.26104092597961, "time_total_s": 64161.40339303017, "pid": 95351, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 5e-09], [35965920, 8e-10], [36317280, 2.5e-10], [36668640, 2.5e-10], [37020000, 2.5e-10], [37371360, 2.5e-10], [37722720, 1e-10], [38074080, 1e-10], [38425440, 1e-10], [38776800, 5e-11], [39128160, 5e-11], [39479520, 5e-11], [39830880, 5e-11], [40182240, 1e-11], [40533600, 1e-11], [40884960, 1e-11], [41236320, 1e-11], [41587680, 5e-12], [41939040, 5e-12], [42290400, 2.5e-12], [42641760, 2.5e-12], [42993120, 1e-12], [43344480, 1e-12], [43695840, 5e-13], [44047200, 5e-13], [44398560, 1e-13]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f957790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 390.99210476875305, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 25.583516483516483, "ram_util_percent": 74.02637362637361}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.999999999999999e-10, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.1164990750416, "policy_loss": -20264527.35347292, "vf_loss": 7844698.86169825}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5831.5, "diff_num_grad_updates_vs_sampler_policy": 5830.5}}, "num_env_steps_sampled": 36009840, "num_env_steps_trained": 36009840, "num_agent_steps_sampled": 36009840, "num_agent_steps_trained": 36009840}, "sampler_results": {"episode_reward_max": -202464.6163006042, "episode_reward_min": -207639.18811342452, "episode_reward_mean": -205173.952593317, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312, -207639.18811342452, -204017.95044013814, -205116.24645691895, -202464.6163006042, -204036.93530869056, -204850.10592092396], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14311814348138327, "mean_inference_ms": 0.24981148100452596, "mean_action_processing_ms": 0.05972810522127065, "mean_env_wait_ms": 0.6079794660476108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002887513902452257, "StateBufferConnector_ms": 0.0019709269205729165, "ViewRequirementAgentConnector_ms": 0.050743420918782554}}, "episode_reward_max": -202464.6163006042, "episode_reward_min": -207639.18811342452, "episode_reward_mean": -205173.952593317, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312, -207639.18811342452, -204017.95044013814, -205116.24645691895, -202464.6163006042, -204036.93530869056, -204850.10592092396], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14311814348138327, "mean_inference_ms": 0.24981148100452596, "mean_action_processing_ms": 0.05972810522127065, "mean_env_wait_ms": 0.6079794660476108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002887513902452257, "StateBufferConnector_ms": 0.0019709269205729165, "ViewRequirementAgentConnector_ms": 0.050743420918782554}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36009840, "num_agent_steps_trained": 36009840, "num_env_steps_sampled": 36009840, "num_env_steps_trained": 36009840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 630.324906038513, "num_env_steps_trained_throughput_per_sec": 630.324906038513, "timesteps_total": 36009840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36009840, "timers": {"training_iteration_time_ms": 51183.539, "sample_time_ms": 50344.845, "load_time_ms": 22.678, "load_throughput": 1936676.084, "learn_time_ms": 814.966, "learn_throughput": 53891.842, "synch_weights_time_ms": 0.855}, "counters": {"num_env_steps_sampled": 36009840, "num_env_steps_trained": 36009840, "num_agent_steps_sampled": 36009840, "num_agent_steps_trained": 36009840}, "done": false, "episodes_total": 8993, "training_iteration": 2730, "trial_id": "5c65c_00000", "date": "2023-08-07_09-05-43", "timestamp": 1691388343, "time_this_iter_s": 69.68099904060364, "time_total_s": 64231.08439207077, "pid": 95351, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 5e-09], [35965920, 8e-10], [36317280, 2.5e-10], [36668640, 2.5e-10], [37020000, 2.5e-10], [37371360, 2.5e-10], [37722720, 1e-10], [38074080, 1e-10], [38425440, 1e-10], [38776800, 5e-11], [39128160, 5e-11], [39479520, 5e-11], [39830880, 5e-11], [40182240, 1e-11], [40533600, 1e-11], [40884960, 1e-11], [41236320, 1e-11], [41587680, 5e-12], [41939040, 5e-12], [42290400, 2.5e-12], [42641760, 2.5e-12], [42993120, 1e-12], [43344480, 1e-12], [43695840, 5e-13], [44047200, 5e-13], [44398560, 1e-13]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f957790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 460.6731038093567, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 24.071717171717165, "ram_util_percent": 73.36161616161617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.312500000000001e-10, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.29946547972565, "policy_loss": -19737019.654527493, "vf_loss": 7721387.094478863}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6517.5, "diff_num_grad_updates_vs_sampler_policy": 6516.5}}, "num_env_steps_sampled": 36053760, "num_env_steps_trained": 36053760, "num_agent_steps_sampled": 36053760, "num_agent_steps_trained": 36053760}, "sampler_results": {"episode_reward_max": -202464.6163006042, "episode_reward_min": -207639.18811342452, "episode_reward_mean": -204963.07557603432, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312, -207639.18811342452, -204017.95044013814, -205116.24645691895, -202464.6163006042, -204036.93530869056, -204850.10592092396, -203065.18242049002], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1449897948099224, "mean_inference_ms": 0.25253091605245237, "mean_action_processing_ms": 0.06046144974715689, "mean_env_wait_ms": 0.613746229046404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032138824462890625, "StateBufferConnector_ms": 0.0020313262939453125, "ViewRequirementAgentConnector_ms": 0.05206108093261719}}, "episode_reward_max": -202464.6163006042, "episode_reward_min": -207639.18811342452, "episode_reward_mean": -204963.07557603432, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312, -207639.18811342452, -204017.95044013814, -205116.24645691895, -202464.6163006042, -204036.93530869056, -204850.10592092396, -203065.18242049002], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1449897948099224, "mean_inference_ms": 0.25253091605245237, "mean_action_processing_ms": 0.06046144974715689, "mean_env_wait_ms": 0.613746229046404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032138824462890625, "StateBufferConnector_ms": 0.0020313262939453125, "ViewRequirementAgentConnector_ms": 0.05206108093261719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36053760, "num_agent_steps_trained": 36053760, "num_env_steps_sampled": 36053760, "num_env_steps_trained": 36053760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 636.0661232452561, "num_env_steps_trained_throughput_per_sec": 636.0661232452561, "timesteps_total": 36053760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36053760, "timers": {"training_iteration_time_ms": 52970.126, "sample_time_ms": 52103.099, "load_time_ms": 22.316, "load_throughput": 1968125.93, "learn_time_ms": 843.662, "learn_throughput": 52058.788, "synch_weights_time_ms": 0.858}, "counters": {"num_env_steps_sampled": 36053760, "num_env_steps_trained": 36053760, "num_agent_steps_sampled": 36053760, "num_agent_steps_trained": 36053760}, "done": false, "episodes_total": 8994, "training_iteration": 2731, "trial_id": "5c65c_00000", "date": "2023-08-07_09-06-52", "timestamp": 1691388412, "time_this_iter_s": 69.0518548488617, "time_total_s": 64300.13624691963, "pid": 95351, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 5e-09], [35965920, 8e-10], [36317280, 2.5e-10], [36668640, 2.5e-10], [37020000, 2.5e-10], [37371360, 2.5e-10], [37722720, 1e-10], [38074080, 1e-10], [38425440, 1e-10], [38776800, 5e-11], [39128160, 5e-11], [39479520, 5e-11], [39830880, 5e-11], [40182240, 1e-11], [40533600, 1e-11], [40884960, 1e-11], [41236320, 1e-11], [41587680, 5e-12], [41939040, 5e-12], [42290400, 2.5e-12], [42641760, 2.5e-12], [42993120, 1e-12], [43344480, 1e-12], [43695840, 5e-13], [44047200, 5e-13], [44398560, 1e-13]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f957790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 529.7249586582184, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.14242424242424, "ram_util_percent": 72.89898989898988}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.625e-10, "entropy_coeff": 0.19999999999999998, "policy_entropy": -359.323033235511, "policy_loss": -19920122.68256594, "vf_loss": 7721573.874271137}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7203.5, "diff_num_grad_updates_vs_sampler_policy": 7202.5}}, "num_env_steps_sampled": 36097680, "num_env_steps_trained": 36097680, "num_agent_steps_sampled": 36097680, "num_agent_steps_trained": 36097680}, "sampler_results": {"episode_reward_max": -202464.6163006042, "episode_reward_min": -207639.18811342452, "episode_reward_mean": -204823.3256053175, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312, -207639.18811342452, -204017.95044013814, -205116.24645691895, -202464.6163006042, -204036.93530869056, -204850.10592092396, -203065.18242049002, -203425.82589814998], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14700253869189409, "mean_inference_ms": 0.25544250282243214, "mean_action_processing_ms": 0.0612451463683513, "mean_env_wait_ms": 0.6201884251776482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032359903508966618, "StateBufferConnector_ms": 0.00209808349609375, "ViewRequirementAgentConnector_ms": 0.0532410361550071}}, "episode_reward_max": -202464.6163006042, "episode_reward_min": -207639.18811342452, "episode_reward_mean": -204823.3256053175, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-207132.13395011952, -205577.38282817995, -205731.01402085312, -207639.18811342452, -204017.95044013814, -205116.24645691895, -202464.6163006042, -204036.93530869056, -204850.10592092396, -203065.18242049002, -203425.82589814998], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14700253869189409, "mean_inference_ms": 0.25544250282243214, "mean_action_processing_ms": 0.0612451463683513, "mean_env_wait_ms": 0.6201884251776482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032359903508966618, "StateBufferConnector_ms": 0.00209808349609375, "ViewRequirementAgentConnector_ms": 0.0532410361550071}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36097680, "num_agent_steps_trained": 36097680, "num_env_steps_sampled": 36097680, "num_env_steps_trained": 36097680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 629.254092603678, "num_env_steps_trained_throughput_per_sec": 629.254092603678, "timesteps_total": 36097680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 36097680, "timers": {"training_iteration_time_ms": 55158.13, "sample_time_ms": 54250.398, "load_time_ms": 25.278, "load_throughput": 1737474.585, "learn_time_ms": 881.373, "learn_throughput": 49831.32, "synch_weights_time_ms": 0.883}, "counters": {"num_env_steps_sampled": 36097680, "num_env_steps_trained": 36097680, "num_agent_steps_sampled": 36097680, "num_agent_steps_trained": 36097680}, "done": false, "episodes_total": 8995, "training_iteration": 2732, "trial_id": "5c65c_00000", "date": "2023-08-07_09-08-02", "timestamp": 1691388482, "time_this_iter_s": 69.80062103271484, "time_total_s": 64369.93686795235, "pid": 95351, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[35614560, 5e-09], [35965920, 8e-10], [36317280, 2.5e-10], [36668640, 2.5e-10], [37020000, 2.5e-10], [37371360, 2.5e-10], [37722720, 1e-10], [38074080, 1e-10], [38425440, 1e-10], [38776800, 5e-11], [39128160, 5e-11], [39479520, 5e-11], [39830880, 5e-11], [40182240, 1e-11], [40533600, 1e-11], [40884960, 1e-11], [41236320, 1e-11], [41587680, 5e-12], [41939040, 5e-12], [42290400, 2.5e-12], [42641760, 2.5e-12], [42993120, 1e-12], [43344480, 1e-12], [43695840, 5e-13], [44047200, 5e-13], [44398560, 1e-13]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.2, "final_epsilon": 0.01, "epsilon_timesteps": 44749920}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.2, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17f957790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 599.5255796909332, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.010101010101014, "ram_util_percent": 72.98585858585858}}
