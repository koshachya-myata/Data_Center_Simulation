{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.8890752764555, "policy_loss": -1.4679272363409658e+19, "vf_loss": 325551617.5801749}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.5, "diff_num_grad_updates_vs_sampler_policy": 342.5}}, "num_env_steps_sampled": 1291920, "num_env_steps_trained": 1291920, "num_agent_steps_sampled": 1291920, "num_agent_steps_trained": 1291920}, "sampler_results": {"episode_reward_max": -1401603.4386268943, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1401603.4386268943, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13811671178264534, "mean_inference_ms": 0.24199383182985526, "mean_action_processing_ms": 0.05827460663883345, "mean_env_wait_ms": 0.6840243365268955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023603439331054688, "StateBufferConnector_ms": 0.0018358230590820312, "ViewRequirementAgentConnector_ms": 0.04334449768066406}}, "episode_reward_max": -1401603.4386268943, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1401603.4386268943, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13811671178264534, "mean_inference_ms": 0.24199383182985526, "mean_action_processing_ms": 0.05827460663883345, "mean_env_wait_ms": 0.6840243365268955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023603439331054688, "StateBufferConnector_ms": 0.0018358230590820312, "ViewRequirementAgentConnector_ms": 0.04334449768066406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1291920, "num_agent_steps_trained": 1291920, "num_env_steps_sampled": 1291920, "num_env_steps_trained": 1291920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 868.0818993472504, "num_env_steps_trained_throughput_per_sec": 868.0818993472504, "timesteps_total": 1291920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1291920, "timers": {"training_iteration_time_ms": 50594.271, "sample_time_ms": 49845.597, "load_time_ms": 0.877, "load_throughput": 50085326.721, "learn_time_ms": 746.594, "learn_throughput": 58827.139, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 1291920, "num_env_steps_trained": 1291920, "num_agent_steps_sampled": 1291920, "num_agent_steps_trained": 1291920}, "done": false, "episodes_total": 1220, "training_iteration": 341, "trial_id": "09673_00000", "date": "2023-07-27_03-33-10", "timestamp": 1690417990, "time_this_iter_s": 50.59642004966736, "time_total_s": 4718.141177892685, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 50.59642004966736, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.587671232876712, "ram_util_percent": 71.56575342465754}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1592.190851417297, "policy_loss": -4.146998916930167e+19, "vf_loss": 325250661.6909621}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1029.5, "diff_num_grad_updates_vs_sampler_policy": 1028.5}}, "num_env_steps_sampled": 1335840, "num_env_steps_trained": 1335840, "num_agent_steps_sampled": 1335840, "num_agent_steps_trained": 1335840}, "sampler_results": {"episode_reward_max": -1400921.5368220464, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1401262.4877244704, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1370783668613152, "mean_inference_ms": 0.24032882379813658, "mean_action_processing_ms": 0.05794037851297894, "mean_env_wait_ms": 0.6679988358157731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024080276489257812, "StateBufferConnector_ms": 0.0018835067749023438, "ViewRequirementAgentConnector_ms": 0.04458427429199219}}, "episode_reward_max": -1400921.5368220464, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1401262.4877244704, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1370783668613152, "mean_inference_ms": 0.24032882379813658, "mean_action_processing_ms": 0.05794037851297894, "mean_env_wait_ms": 0.6679988358157731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024080276489257812, "StateBufferConnector_ms": 0.0018835067749023438, "ViewRequirementAgentConnector_ms": 0.04458427429199219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1335840, "num_agent_steps_trained": 1335840, "num_env_steps_sampled": 1335840, "num_env_steps_trained": 1335840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 929.813754572282, "num_env_steps_trained_throughput_per_sec": 929.813754572282, "timesteps_total": 1335840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1335840, "timers": {"training_iteration_time_ms": 48914.762, "sample_time_ms": 48172.746, "load_time_ms": 8.005, "load_throughput": 5486310.024, "learn_time_ms": 732.947, "learn_throughput": 59922.517, "synch_weights_time_ms": 0.857}, "counters": {"num_env_steps_sampled": 1335840, "num_env_steps_trained": 1335840, "num_agent_steps_sampled": 1335840, "num_agent_steps_trained": 1335840}, "done": false, "episodes_total": 1221, "training_iteration": 342, "trial_id": "09673_00000", "date": "2023-07-27_03-33-57", "timestamp": 1690418037, "time_this_iter_s": 47.23722171783447, "time_total_s": 4765.378399610519, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 97.83364176750183, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.834328358208957, "ram_util_percent": 71.92835820895523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.2999999999999994e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1606.0298650535829, "policy_loss": -5.698942917783238e+19, "vf_loss": 324780805.59766763}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1715.5, "diff_num_grad_updates_vs_sampler_policy": 1714.5}}, "num_env_steps_sampled": 1379760, "num_env_steps_trained": 1379760, "num_agent_steps_sampled": 1379760, "num_agent_steps_trained": 1379760}, "sampler_results": {"episode_reward_max": -1399929.7374350629, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1400818.237628001, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13670364603493382, "mean_inference_ms": 0.2397464298606513, "mean_action_processing_ms": 0.057815518270603605, "mean_env_wait_ms": 0.6579946188764138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023365020751953125, "StateBufferConnector_ms": 0.0018358230590820312, "ViewRequirementAgentConnector_ms": 0.044345855712890625}}, "episode_reward_max": -1399929.7374350629, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1400818.237628001, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13670364603493382, "mean_inference_ms": 0.2397464298606513, "mean_action_processing_ms": 0.057815518270603605, "mean_env_wait_ms": 0.6579946188764138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023365020751953125, "StateBufferConnector_ms": 0.0018358230590820312, "ViewRequirementAgentConnector_ms": 0.044345855712890625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1379760, "num_agent_steps_trained": 1379760, "num_env_steps_sampled": 1379760, "num_env_steps_trained": 1379760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 933.7995874791297, "num_env_steps_trained_throughput_per_sec": 933.7995874791297, "timesteps_total": 1379760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1379760, "timers": {"training_iteration_time_ms": 48287.719, "sample_time_ms": 47550.962, "load_time_ms": 10.26, "load_throughput": 4280724.206, "learn_time_ms": 725.527, "learn_throughput": 60535.31, "synch_weights_time_ms": 0.796}, "counters": {"num_env_steps_sampled": 1379760, "num_env_steps_trained": 1379760, "num_agent_steps_sampled": 1379760, "num_agent_steps_trained": 1379760}, "done": false, "episodes_total": 1222, "training_iteration": 343, "trial_id": "09673_00000", "date": "2023-07-27_03-34-44", "timestamp": 1690418084, "time_this_iter_s": 47.035624980926514, "time_total_s": 4812.414024591446, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 144.86926674842834, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 22.068656716417912, "ram_util_percent": 72.00597014925373}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.600000000000002e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1627.033613644258, "policy_loss": -1.0196319242664757e+20, "vf_loss": 324265595.02040815}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2401.5, "diff_num_grad_updates_vs_sampler_policy": 2400.5}}, "num_env_steps_sampled": 1423680, "num_env_steps_trained": 1423680, "num_agent_steps_sampled": 1423680, "num_agent_steps_trained": 1423680}, "sampler_results": {"episode_reward_max": -1398724.0960677818, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1400294.7022379462, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13637225039177975, "mean_inference_ms": 0.2391075182293961, "mean_action_processing_ms": 0.05769591775972827, "mean_env_wait_ms": 0.6505138067024046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023245811462402344, "StateBufferConnector_ms": 0.001811981201171875, "ViewRequirementAgentConnector_ms": 0.044155120849609375}}, "episode_reward_max": -1398724.0960677818, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1400294.7022379462, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13637225039177975, "mean_inference_ms": 0.2391075182293961, "mean_action_processing_ms": 0.05769591775972827, "mean_env_wait_ms": 0.6505138067024046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023245811462402344, "StateBufferConnector_ms": 0.001811981201171875, "ViewRequirementAgentConnector_ms": 0.044155120849609375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1423680, "num_agent_steps_trained": 1423680, "num_env_steps_sampled": 1423680, "num_env_steps_trained": 1423680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 951.5569970062297, "num_env_steps_trained_throughput_per_sec": 951.5569970062297, "timesteps_total": 1423680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1423680, "timers": {"training_iteration_time_ms": 47754.768, "sample_time_ms": 47019.373, "load_time_ms": 11.325, "load_throughput": 3878063.465, "learn_time_ms": 723.118, "learn_throughput": 60737.0, "synch_weights_time_ms": 0.796}, "counters": {"num_env_steps_sampled": 1423680, "num_env_steps_trained": 1423680, "num_agent_steps_sampled": 1423680, "num_agent_steps_trained": 1423680}, "done": false, "episodes_total": 1223, "training_iteration": 344, "trial_id": "09673_00000", "date": "2023-07-27_03-35-30", "timestamp": 1690418130, "time_this_iter_s": 46.15786290168762, "time_total_s": 4858.5718874931335, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 191.02712965011597, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.101538461538464, "ram_util_percent": 71.74153846153845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.900000000000002e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1628.333475808013, "policy_loss": -1.0384519844662272e+20, "vf_loss": 323473336.54810494}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3087.5, "diff_num_grad_updates_vs_sampler_policy": 3086.5}}, "num_env_steps_sampled": 1467600, "num_env_steps_trained": 1467600, "num_agent_steps_sampled": 1467600, "num_agent_steps_trained": 1467600}, "sampler_results": {"episode_reward_max": -1397023.776841265, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1399640.51715861, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13611405773412547, "mean_inference_ms": 0.23854961836946859, "mean_action_processing_ms": 0.057595196051315925, "mean_env_wait_ms": 0.6446122037866681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00270843505859375, "StateBufferConnector_ms": 0.0017976760864257812, "ViewRequirementAgentConnector_ms": 0.04383563995361328}}, "episode_reward_max": -1397023.776841265, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1399640.51715861, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13611405773412547, "mean_inference_ms": 0.23854961836946859, "mean_action_processing_ms": 0.057595196051315925, "mean_env_wait_ms": 0.6446122037866681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00270843505859375, "StateBufferConnector_ms": 0.0017976760864257812, "ViewRequirementAgentConnector_ms": 0.04383563995361328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1467600, "num_agent_steps_trained": 1467600, "num_env_steps_sampled": 1467600, "num_env_steps_trained": 1467600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 956.6173012519337, "num_env_steps_trained_throughput_per_sec": 956.6173012519337, "timesteps_total": 1467600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1467600, "timers": {"training_iteration_time_ms": 47386.167, "sample_time_ms": 46651.835, "load_time_ms": 11.744, "load_throughput": 3739714.156, "learn_time_ms": 721.626, "learn_throughput": 60862.52, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 1467600, "num_env_steps_trained": 1467600, "num_agent_steps_sampled": 1467600, "num_agent_steps_trained": 1467600}, "done": false, "episodes_total": 1224, "training_iteration": 345, "trial_id": "09673_00000", "date": "2023-07-27_03-36-16", "timestamp": 1690418176, "time_this_iter_s": 45.91438317298889, "time_total_s": 4904.486270666122, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 236.94151282310486, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.421538461538464, "ram_util_percent": 71.68153846153848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.2e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1636.0931391146023, "policy_loss": -1.22828986950581e+20, "vf_loss": 322830878.25072885}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3773.5, "diff_num_grad_updates_vs_sampler_policy": 3772.5}}, "num_env_steps_sampled": 1511520, "num_env_steps_trained": 1511520, "num_agent_steps_sampled": 1511520, "num_agent_steps_trained": 1511520}, "sampler_results": {"episode_reward_max": -1395627.2890960537, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1398971.6458148507, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13593335784529964, "mean_inference_ms": 0.2381004821531757, "mean_action_processing_ms": 0.057512887566951644, "mean_env_wait_ms": 0.6396691443106518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026106834411621094, "StateBufferConnector_ms": 0.0018159548441569011, "ViewRequirementAgentConnector_ms": 0.044198830922444664}}, "episode_reward_max": -1395627.2890960537, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1398971.6458148507, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13593335784529964, "mean_inference_ms": 0.2381004821531757, "mean_action_processing_ms": 0.057512887566951644, "mean_env_wait_ms": 0.6396691443106518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026106834411621094, "StateBufferConnector_ms": 0.0018159548441569011, "ViewRequirementAgentConnector_ms": 0.044198830922444664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1511520, "num_agent_steps_trained": 1511520, "num_env_steps_sampled": 1511520, "num_env_steps_trained": 1511520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 962.5661705017599, "num_env_steps_trained_throughput_per_sec": 962.5661705017599, "timesteps_total": 1511520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1511520, "timers": {"training_iteration_time_ms": 47093.142, "sample_time_ms": 46359.326, "load_time_ms": 12.161, "load_throughput": 3611434.01, "learn_time_ms": 720.71, "learn_throughput": 60939.92, "synch_weights_time_ms": 0.792}, "counters": {"num_env_steps_sampled": 1511520, "num_env_steps_trained": 1511520, "num_agent_steps_sampled": 1511520, "num_agent_steps_trained": 1511520}, "done": false, "episodes_total": 1225, "training_iteration": 346, "trial_id": "09673_00000", "date": "2023-07-27_03-37-02", "timestamp": 1690418222, "time_this_iter_s": 45.62994384765625, "time_total_s": 4950.116214513779, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 282.5714566707611, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.35076923076923, "ram_util_percent": 71.52461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.5e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1636.0202903636343, "policy_loss": -1.1359873404734176e+20, "vf_loss": 320797232.08746356}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4459.5, "diff_num_grad_updates_vs_sampler_policy": 4458.5}}, "num_env_steps_sampled": 1555440, "num_env_steps_trained": 1555440, "num_agent_steps_sampled": 1555440, "num_agent_steps_trained": 1555440}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1397866.7065704868, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13577656529632426, "mean_inference_ms": 0.23773313234438026, "mean_action_processing_ms": 0.057449107862666604, "mean_env_wait_ms": 0.6354170998536718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025544847760881695, "StateBufferConnector_ms": 0.0018051692417689732, "ViewRequirementAgentConnector_ms": 0.04421302250453404}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1397866.7065704868, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13577656529632426, "mean_inference_ms": 0.23773313234438026, "mean_action_processing_ms": 0.057449107862666604, "mean_env_wait_ms": 0.6354170998536718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025544847760881695, "StateBufferConnector_ms": 0.0018051692417689732, "ViewRequirementAgentConnector_ms": 0.04421302250453404}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1555440, "num_agent_steps_trained": 1555440, "num_env_steps_sampled": 1555440, "num_env_steps_trained": 1555440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 968.0089734945781, "num_env_steps_trained_throughput_per_sec": 968.0089734945781, "timesteps_total": 1555440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1555440, "timers": {"training_iteration_time_ms": 46847.188, "sample_time_ms": 46113.56, "load_time_ms": 12.06, "load_throughput": 3641658.821, "learn_time_ms": 720.639, "learn_throughput": 60945.923, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 1555440, "num_env_steps_trained": 1555440, "num_agent_steps_sampled": 1555440, "num_agent_steps_trained": 1555440}, "done": false, "episodes_total": 1226, "training_iteration": 347, "trial_id": "09673_00000", "date": "2023-07-27_03-37-47", "timestamp": 1690418267, "time_this_iter_s": 45.373465061187744, "time_total_s": 4995.489679574966, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 327.94492173194885, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.786153846153844, "ram_util_percent": 71.44615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.800000000000003e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1637.7621417254122, "policy_loss": -1.2554259132675523e+20, "vf_loss": 323943811.877551}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5145.5, "diff_num_grad_updates_vs_sampler_policy": 5144.5}}, "num_env_steps_sampled": 1599360, "num_env_steps_trained": 1599360, "num_agent_steps_sampled": 1599360, "num_agent_steps_trained": 1599360}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1397878.6292614518, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13564103812367262, "mean_inference_ms": 0.2374086489527612, "mean_action_processing_ms": 0.05739431323534713, "mean_env_wait_ms": 0.6318077427221065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025272369384765625, "StateBufferConnector_ms": 0.0018149614334106445, "ViewRequirementAgentConnector_ms": 0.04456043243408203}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1397878.6292614518, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13564103812367262, "mean_inference_ms": 0.2374086489527612, "mean_action_processing_ms": 0.05739431323534713, "mean_env_wait_ms": 0.6318077427221065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025272369384765625, "StateBufferConnector_ms": 0.0018149614334106445, "ViewRequirementAgentConnector_ms": 0.04456043243408203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1599360, "num_agent_steps_trained": 1599360, "num_env_steps_sampled": 1599360, "num_env_steps_trained": 1599360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 964.9840885443145, "num_env_steps_trained_throughput_per_sec": 964.9840885443145, "timesteps_total": 1599360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1599360, "timers": {"training_iteration_time_ms": 46680.501, "sample_time_ms": 45939.949, "load_time_ms": 12.196, "load_throughput": 3601214.618, "learn_time_ms": 727.445, "learn_throughput": 60375.698, "synch_weights_time_ms": 0.768}, "counters": {"num_env_steps_sampled": 1599360, "num_env_steps_trained": 1599360, "num_agent_steps_sampled": 1599360, "num_agent_steps_trained": 1599360}, "done": false, "episodes_total": 1227, "training_iteration": 348, "trial_id": "09673_00000", "date": "2023-07-27_03-38-33", "timestamp": 1690418313, "time_this_iter_s": 45.5156672000885, "time_total_s": 5041.005346775055, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 373.46058893203735, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.192307692307693, "ram_util_percent": 71.58923076923075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1637.3705677443968, "policy_loss": -1.1558214964010502e+20, "vf_loss": 321440085.14285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5831.5, "diff_num_grad_updates_vs_sampler_policy": 5830.5}}, "num_env_steps_sampled": 1643280, "num_env_steps_trained": 1643280, "num_agent_steps_sampled": 1643280, "num_agent_steps_trained": 1643280}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1397304.133026578, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1355371554743753, "mean_inference_ms": 0.23714225390939447, "mean_action_processing_ms": 0.057346027151521345, "mean_env_wait_ms": 0.6285402226233355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002601411607530382, "StateBufferConnector_ms": 0.0018305248684353298, "ViewRequirementAgentConnector_ms": 0.04466904534233941}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1397304.133026578, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1355371554743753, "mean_inference_ms": 0.23714225390939447, "mean_action_processing_ms": 0.057346027151521345, "mean_env_wait_ms": 0.6285402226233355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002601411607530382, "StateBufferConnector_ms": 0.0018305248684353298, "ViewRequirementAgentConnector_ms": 0.04466904534233941}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1643280, "num_agent_steps_trained": 1643280, "num_env_steps_sampled": 1643280, "num_env_steps_trained": 1643280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 976.6613111083824, "num_env_steps_trained_throughput_per_sec": 976.6613111083824, "timesteps_total": 1643280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1643280, "timers": {"training_iteration_time_ms": 46490.391, "sample_time_ms": 45750.782, "load_time_ms": 12.178, "load_throughput": 3606410.23, "learn_time_ms": 726.525, "learn_throughput": 60452.133, "synch_weights_time_ms": 0.766}, "counters": {"num_env_steps_sampled": 1643280, "num_env_steps_trained": 1643280, "num_agent_steps_sampled": 1643280, "num_agent_steps_trained": 1643280}, "done": false, "episodes_total": 1228, "training_iteration": 349, "trial_id": "09673_00000", "date": "2023-07-27_03-39-18", "timestamp": 1690418358, "time_this_iter_s": 44.97180986404419, "time_total_s": 5085.977156639099, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 418.43239879608154, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 21.730158730158735, "ram_util_percent": 71.31904761904761}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.400000000000002e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1637.9888910677273, "policy_loss": -1.2453554001154644e+20, "vf_loss": 323506216.2798834}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6517.5, "diff_num_grad_updates_vs_sampler_policy": 6516.5}}, "num_env_steps_sampled": 1687200, "num_env_steps_trained": 1687200, "num_agent_steps_sampled": 1687200, "num_agent_steps_trained": 1687200}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1397274.9193452164, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13544867312712836, "mean_inference_ms": 0.2369153341091989, "mean_action_processing_ms": 0.057306433664353805, "mean_env_wait_ms": 0.625723621045528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002765655517578125, "StateBufferConnector_ms": 0.0018310546875, "ViewRequirementAgentConnector_ms": 0.04446983337402344}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1397274.9193452164, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13544867312712836, "mean_inference_ms": 0.2369153341091989, "mean_action_processing_ms": 0.057306433664353805, "mean_env_wait_ms": 0.625723621045528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002765655517578125, "StateBufferConnector_ms": 0.0018310546875, "ViewRequirementAgentConnector_ms": 0.04446983337402344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1687200, "num_agent_steps_trained": 1687200, "num_env_steps_sampled": 1687200, "num_env_steps_trained": 1687200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 965.212384277131, "num_env_steps_trained_throughput_per_sec": 965.212384277131, "timesteps_total": 1687200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1687200, "timers": {"training_iteration_time_ms": 46391.645, "sample_time_ms": 45652.688, "load_time_ms": 12.122, "load_throughput": 3623268.046, "learn_time_ms": 725.935, "learn_throughput": 60501.308, "synch_weights_time_ms": 0.763}, "counters": {"num_env_steps_sampled": 1687200, "num_env_steps_trained": 1687200, "num_agent_steps_sampled": 1687200, "num_agent_steps_trained": 1687200}, "done": false, "episodes_total": 1229, "training_iteration": 350, "trial_id": "09673_00000", "date": "2023-07-27_03-40-03", "timestamp": 1690418403, "time_this_iter_s": 45.504910945892334, "time_total_s": 5131.4820675849915, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 463.9373097419739, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.183076923076925, "ram_util_percent": 71.41230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.700000000000001e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1638.8565307261297, "policy_loss": -1.326596154937046e+20, "vf_loss": 322332250.42565596}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7203.5, "diff_num_grad_updates_vs_sampler_policy": 7202.5}}, "num_env_steps_sampled": 1731120, "num_env_steps_trained": 1731120, "num_agent_steps_sampled": 1731120, "num_agent_steps_trained": 1731120}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1397028.8690415719, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13537785304661315, "mean_inference_ms": 0.23671251202542792, "mean_action_processing_ms": 0.05727315887710798, "mean_env_wait_ms": 0.6232109112237013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027201392433860087, "StateBufferConnector_ms": 0.0018293207341974432, "ViewRequirementAgentConnector_ms": 0.04456043243408203}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1397028.8690415719, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13537785304661315, "mean_inference_ms": 0.23671251202542792, "mean_action_processing_ms": 0.05727315887710798, "mean_env_wait_ms": 0.6232109112237013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027201392433860087, "StateBufferConnector_ms": 0.0018293207341974432, "ViewRequirementAgentConnector_ms": 0.04456043243408203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1731120, "num_agent_steps_trained": 1731120, "num_env_steps_sampled": 1731120, "num_env_steps_trained": 1731120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 971.8403736246247, "num_env_steps_trained_throughput_per_sec": 971.8403736246247, "timesteps_total": 1731120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1731120, "timers": {"training_iteration_time_ms": 45851.477, "sample_time_ms": 45113.645, "load_time_ms": 13.222, "load_throughput": 3321849.559, "learn_time_ms": 723.75, "learn_throughput": 60683.946, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 1731120, "num_env_steps_trained": 1731120, "num_agent_steps_sampled": 1731120, "num_agent_steps_trained": 1731120}, "done": false, "episodes_total": 1230, "training_iteration": 351, "trial_id": "09673_00000", "date": "2023-07-27_03-40-49", "timestamp": 1690418449, "time_this_iter_s": 45.194655895233154, "time_total_s": 5176.676723480225, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 509.13196563720703, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.453125, "ram_util_percent": 71.41874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1638.6209049502893, "policy_loss": -1.3220834226635158e+20, "vf_loss": 322463826.07580173}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7889.5, "diff_num_grad_updates_vs_sampler_policy": 7888.5}}, "num_env_steps_sampled": 1775040, "num_env_steps_trained": 1775040, "num_agent_steps_sampled": 1775040, "num_agent_steps_trained": 1775040}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396856.0157238145, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13531748573179425, "mean_inference_ms": 0.23653239209298335, "mean_action_processing_ms": 0.057243776947350805, "mean_env_wait_ms": 0.6210467678420974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002686182657877604, "StateBufferConnector_ms": 0.001798073450724284, "ViewRequirementAgentConnector_ms": 0.04454652468363444}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396856.0157238145, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13531748573179425, "mean_inference_ms": 0.23653239209298335, "mean_action_processing_ms": 0.057243776947350805, "mean_env_wait_ms": 0.6210467678420974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002686182657877604, "StateBufferConnector_ms": 0.001798073450724284, "ViewRequirementAgentConnector_ms": 0.04454652468363444}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1775040, "num_agent_steps_trained": 1775040, "num_env_steps_sampled": 1775040, "num_env_steps_trained": 1775040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 960.372158497179, "num_env_steps_trained_throughput_per_sec": 960.372158497179, "timesteps_total": 1775040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1775040, "timers": {"training_iteration_time_ms": 45701.177, "sample_time_ms": 44964.778, "load_time_ms": 12.969, "load_throughput": 3386476.65, "learn_time_ms": 722.586, "learn_throughput": 60781.707, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 1775040, "num_env_steps_trained": 1775040, "num_agent_steps_sampled": 1775040, "num_agent_steps_trained": 1775040}, "done": false, "episodes_total": 1231, "training_iteration": 352, "trial_id": "09673_00000", "date": "2023-07-27_03-41-34", "timestamp": 1690418494, "time_this_iter_s": 45.734373331069946, "time_total_s": 5222.411096811295, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 554.866338968277, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.56923076923077, "ram_util_percent": 71.42307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.450000000000002e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1637.1714077162674, "policy_loss": -1.2254300397639213e+20, "vf_loss": 323363065.0495627}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8575.5, "diff_num_grad_updates_vs_sampler_policy": 8574.5}}, "num_env_steps_sampled": 1818960, "num_env_steps_trained": 1818960, "num_agent_steps_sampled": 1818960, "num_agent_steps_trained": 1818960}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396855.8192206312, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13526805482188042, "mean_inference_ms": 0.23637130669602857, "mean_action_processing_ms": 0.05721749805626946, "mean_env_wait_ms": 0.6191529813864434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026996319110576925, "StateBufferConnector_ms": 0.001800977266751803, "ViewRequirementAgentConnector_ms": 0.04485387068528395}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396855.8192206312, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13526805482188042, "mean_inference_ms": 0.23637130669602857, "mean_action_processing_ms": 0.05721749805626946, "mean_env_wait_ms": 0.6191529813864434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026996319110576925, "StateBufferConnector_ms": 0.001800977266751803, "ViewRequirementAgentConnector_ms": 0.04485387068528395}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1818960, "num_agent_steps_trained": 1818960, "num_env_steps_sampled": 1818960, "num_env_steps_trained": 1818960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 960.8855056203618, "num_env_steps_trained_throughput_per_sec": 960.8855056203618, "timesteps_total": 1818960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1818960, "timers": {"training_iteration_time_ms": 45568.596, "sample_time_ms": 44831.446, "load_time_ms": 13.665, "load_throughput": 3214065.307, "learn_time_ms": 722.639, "learn_throughput": 60777.238, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 1818960, "num_env_steps_trained": 1818960, "num_agent_steps_sampled": 1818960, "num_agent_steps_trained": 1818960}, "done": false, "episodes_total": 1232, "training_iteration": 353, "trial_id": "09673_00000", "date": "2023-07-27_03-42-20", "timestamp": 1690418540, "time_this_iter_s": 45.710039138793945, "time_total_s": 5268.1211359500885, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 600.5763781070709, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.583076923076923, "ram_util_percent": 71.4123076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.9e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1638.1937133077283, "policy_loss": -1.2874590024475969e+20, "vf_loss": 323968046.6122449}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9261.5, "diff_num_grad_updates_vs_sampler_policy": 9260.5}}, "num_env_steps_sampled": 1862880, "num_env_steps_trained": 1862880, "num_agent_steps_sampled": 1862880, "num_agent_steps_trained": 1862880}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396934.817196255, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13522598806882918, "mean_inference_ms": 0.23622891869395574, "mean_action_processing_ms": 0.05719351471558357, "mean_env_wait_ms": 0.617461534023711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002654961177280971, "StateBufferConnector_ms": 0.0018034662519182479, "ViewRequirementAgentConnector_ms": 0.04499469484601702}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396934.817196255, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13522598806882918, "mean_inference_ms": 0.23622891869395574, "mean_action_processing_ms": 0.05719351471558357, "mean_env_wait_ms": 0.617461534023711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002654961177280971, "StateBufferConnector_ms": 0.0018034662519182479, "ViewRequirementAgentConnector_ms": 0.04499469484601702}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1862880, "num_agent_steps_trained": 1862880, "num_env_steps_sampled": 1862880, "num_env_steps_trained": 1862880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 963.9353388188927, "num_env_steps_trained_throughput_per_sec": 963.9353388188927, "timesteps_total": 1862880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1862880, "timers": {"training_iteration_time_ms": 45509.325, "sample_time_ms": 44772.027, "load_time_ms": 13.56, "load_throughput": 3239055.499, "learn_time_ms": 722.894, "learn_throughput": 60755.815, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 1862880, "num_env_steps_trained": 1862880, "num_agent_steps_sampled": 1862880, "num_agent_steps_trained": 1862880}, "done": false, "episodes_total": 1233, "training_iteration": 354, "trial_id": "09673_00000", "date": "2023-07-27_03-43-06", "timestamp": 1690418586, "time_this_iter_s": 45.565123081207275, "time_total_s": 5313.686259031296, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 646.1415011882782, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.065624999999997, "ram_util_percent": 71.04218750000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.349999999999998e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1638.9550140647777, "policy_loss": -1.4202543538047554e+20, "vf_loss": 322759225.94752187}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9947.5, "diff_num_grad_updates_vs_sampler_policy": 9946.5}}, "num_env_steps_sampled": 1906800, "num_env_steps_trained": 1906800, "num_agent_steps_sampled": 1906800, "num_agent_steps_trained": 1906800}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396839.5378480616, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13519149665272873, "mean_inference_ms": 0.23610024343131816, "mean_action_processing_ms": 0.05717279008099671, "mean_env_wait_ms": 0.6159687434431697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026369094848632812, "StateBufferConnector_ms": 0.0018215179443359375, "ViewRequirementAgentConnector_ms": 0.04529158274332682}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396839.5378480616, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13519149665272873, "mean_inference_ms": 0.23610024343131816, "mean_action_processing_ms": 0.05717279008099671, "mean_env_wait_ms": 0.6159687434431697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026369094848632812, "StateBufferConnector_ms": 0.0018215179443359375, "ViewRequirementAgentConnector_ms": 0.04529158274332682}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1906800, "num_agent_steps_trained": 1906800, "num_env_steps_sampled": 1906800, "num_env_steps_trained": 1906800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 958.0413289111622, "num_env_steps_trained_throughput_per_sec": 958.0413289111622, "timesteps_total": 1906800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1906800, "timers": {"training_iteration_time_ms": 45502.501, "sample_time_ms": 44765.862, "load_time_ms": 13.536, "load_throughput": 3244709.366, "learn_time_ms": 722.279, "learn_throughput": 60807.547, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 1906800, "num_env_steps_trained": 1906800, "num_agent_steps_sampled": 1906800, "num_agent_steps_trained": 1906800}, "done": false, "episodes_total": 1234, "training_iteration": 355, "trial_id": "09673_00000", "date": "2023-07-27_03-43-52", "timestamp": 1690418632, "time_this_iter_s": 45.84573316574097, "time_total_s": 5359.531992197037, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 691.9872343540192, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.386153846153846, "ram_util_percent": 71.04153846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.7999999999999994e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1669.2551477726972, "policy_loss": -3.9689212125519204e+20, "vf_loss": 323367037.15451896}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10633.5, "diff_num_grad_updates_vs_sampler_policy": 10632.5}}, "num_env_steps_sampled": 1950720, "num_env_steps_trained": 1950720, "num_agent_steps_sampled": 1950720, "num_agent_steps_trained": 1950720}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396838.7724314898, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1351595987562238, "mean_inference_ms": 0.2359866689252987, "mean_action_processing_ms": 0.05715469379115355, "mean_env_wait_ms": 0.6146393456065773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026464462280273438, "StateBufferConnector_ms": 0.0018134713172912598, "ViewRequirementAgentConnector_ms": 0.045356154441833496}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396838.7724314898, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1351595987562238, "mean_inference_ms": 0.2359866689252987, "mean_action_processing_ms": 0.05715469379115355, "mean_env_wait_ms": 0.6146393456065773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026464462280273438, "StateBufferConnector_ms": 0.0018134713172912598, "ViewRequirementAgentConnector_ms": 0.045356154441833496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1950720, "num_agent_steps_trained": 1950720, "num_env_steps_sampled": 1950720, "num_env_steps_trained": 1950720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 958.1992350274276, "num_env_steps_trained_throughput_per_sec": 958.1992350274276, "timesteps_total": 1950720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1950720, "timers": {"training_iteration_time_ms": 45523.296, "sample_time_ms": 44786.819, "load_time_ms": 13.441, "load_throughput": 3267651.116, "learn_time_ms": 722.215, "learn_throughput": 60812.953, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 1950720, "num_env_steps_trained": 1950720, "num_agent_steps_sampled": 1950720, "num_agent_steps_trained": 1950720}, "done": false, "episodes_total": 1235, "training_iteration": 356, "trial_id": "09673_00000", "date": "2023-07-27_03-44-37", "timestamp": 1690418677, "time_this_iter_s": 45.83788585662842, "time_total_s": 5405.369878053665, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 737.8251202106476, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.99230769230769, "ram_util_percent": 71.05384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.250000000000001e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1669.5699158604568, "policy_loss": -3.7246769725437916e+20, "vf_loss": 322708454.16909623}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11319.5, "diff_num_grad_updates_vs_sampler_policy": 11318.5}}, "num_env_steps_sampled": 1994640, "num_env_steps_trained": 1994640, "num_agent_steps_sampled": 1994640, "num_agent_steps_trained": 1994640}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396758.012849029, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1351312070546552, "mean_inference_ms": 0.23588338397838862, "mean_action_processing_ms": 0.0571386050341136, "mean_env_wait_ms": 0.6134394782032281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026338240679572612, "StateBufferConnector_ms": 0.001834420596852022, "ViewRequirementAgentConnector_ms": 0.04534300635842716}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396758.012849029, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1351312070546552, "mean_inference_ms": 0.23588338397838862, "mean_action_processing_ms": 0.0571386050341136, "mean_env_wait_ms": 0.6134394782032281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026338240679572612, "StateBufferConnector_ms": 0.001834420596852022, "ViewRequirementAgentConnector_ms": 0.04534300635842716}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1994640, "num_agent_steps_trained": 1994640, "num_env_steps_sampled": 1994640, "num_env_steps_trained": 1994640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 960.7188516247666, "num_env_steps_trained_throughput_per_sec": 960.7188516247666, "timesteps_total": 1994640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1994640, "timers": {"training_iteration_time_ms": 45557.724, "sample_time_ms": 44822.224, "load_time_ms": 13.558, "load_throughput": 3239374.466, "learn_time_ms": 721.126, "learn_throughput": 60904.729, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 1994640, "num_env_steps_trained": 1994640, "num_agent_steps_sampled": 1994640, "num_agent_steps_trained": 1994640}, "done": false, "episodes_total": 1236, "training_iteration": 357, "trial_id": "09673_00000", "date": "2023-07-27_03-45-23", "timestamp": 1690418723, "time_this_iter_s": 45.71774411201477, "time_total_s": 5451.08762216568, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 783.5428643226624, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.40153846153846, "ram_util_percent": 71.02153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.700000000000001e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1669.0968670636503, "policy_loss": -3.58217231279318e+20, "vf_loss": 323018266.4956268}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12005.5, "diff_num_grad_updates_vs_sampler_policy": 12004.5}}, "num_env_steps_sampled": 2038560, "num_env_steps_trained": 2038560, "num_agent_steps_sampled": 2038560, "num_agent_steps_trained": 2038560}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396717.8970333398, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13510272466588574, "mean_inference_ms": 0.2357895777499753, "mean_action_processing_ms": 0.057124017598194396, "mean_env_wait_ms": 0.6123312827190537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026093588935004342, "StateBufferConnector_ms": 0.0018331739637586805, "ViewRequirementAgentConnector_ms": 0.04521475897894965}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396717.8970333398, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13510272466588574, "mean_inference_ms": 0.2357895777499753, "mean_action_processing_ms": 0.057124017598194396, "mean_env_wait_ms": 0.6123312827190537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026093588935004342, "StateBufferConnector_ms": 0.0018331739637586805, "ViewRequirementAgentConnector_ms": 0.04521475897894965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2038560, "num_agent_steps_trained": 2038560, "num_env_steps_sampled": 2038560, "num_env_steps_trained": 2038560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 967.2783725617613, "num_env_steps_trained_throughput_per_sec": 967.2783725617613, "timesteps_total": 2038560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2038560, "timers": {"training_iteration_time_ms": 45546.929, "sample_time_ms": 44818.422, "load_time_ms": 13.558, "load_throughput": 3239425.734, "learn_time_ms": 714.128, "learn_throughput": 61501.572, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 2038560, "num_env_steps_trained": 2038560, "num_agent_steps_sampled": 2038560, "num_agent_steps_trained": 2038560}, "done": false, "episodes_total": 1237, "training_iteration": 358, "trial_id": "09673_00000", "date": "2023-07-27_03-46-09", "timestamp": 1690418769, "time_this_iter_s": 45.40764594078064, "time_total_s": 5496.495268106461, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 828.950510263443, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.292187499999997, "ram_util_percent": 71.0078125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.15e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1669.5536152030568, "policy_loss": -3.579581412709563e+20, "vf_loss": 323083051.9183673}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12691.5, "diff_num_grad_updates_vs_sampler_policy": 12690.5}}, "num_env_steps_sampled": 2082480, "num_env_steps_trained": 2082480, "num_agent_steps_sampled": 2082480, "num_agent_steps_trained": 2082480}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396690.891842145, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13507755658068518, "mean_inference_ms": 0.23570442632524405, "mean_action_processing_ms": 0.05711077537517546, "mean_env_wait_ms": 0.6113181007387154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025887238351922285, "StateBufferConnector_ms": 0.0018245295474403783, "ViewRequirementAgentConnector_ms": 0.045217965778551604}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396690.891842145, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13507755658068518, "mean_inference_ms": 0.23570442632524405, "mean_action_processing_ms": 0.05711077537517546, "mean_env_wait_ms": 0.6113181007387154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025887238351922285, "StateBufferConnector_ms": 0.0018245295474403783, "ViewRequirementAgentConnector_ms": 0.045217965778551604}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2082480, "num_agent_steps_trained": 2082480, "num_env_steps_sampled": 2082480, "num_env_steps_trained": 2082480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 961.5034555154838, "num_env_steps_trained_throughput_per_sec": 961.5034555154838, "timesteps_total": 2082480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2082480, "timers": {"training_iteration_time_ms": 45617.822, "sample_time_ms": 44890.375, "load_time_ms": 13.619, "load_throughput": 3224862.694, "learn_time_ms": 713.015, "learn_throughput": 61597.6, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 2082480, "num_env_steps_trained": 2082480, "num_agent_steps_sampled": 2082480, "num_agent_steps_trained": 2082480}, "done": false, "episodes_total": 1238, "training_iteration": 359, "trial_id": "09673_00000", "date": "2023-07-27_03-46-54", "timestamp": 1690418814, "time_this_iter_s": 45.68042707443237, "time_total_s": 5542.175695180893, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 874.6309373378754, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.60923076923077, "ram_util_percent": 71.00461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.6e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1669.6639452342042, "policy_loss": -3.517577475959358e+20, "vf_loss": 321133067.3877551}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13377.5, "diff_num_grad_updates_vs_sampler_policy": 13376.5}}, "num_env_steps_sampled": 2126400, "num_env_steps_trained": 2126400, "num_agent_steps_sampled": 2126400, "num_agent_steps_trained": 2126400}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396457.1594117852, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13505555493279153, "mean_inference_ms": 0.23562550059680665, "mean_action_processing_ms": 0.05709857894087159, "mean_env_wait_ms": 0.6103759725250277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025665760040283203, "StateBufferConnector_ms": 0.0018262863159179688, "ViewRequirementAgentConnector_ms": 0.04530072212219238}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396457.1594117852, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13505555493279153, "mean_inference_ms": 0.23562550059680665, "mean_action_processing_ms": 0.05709857894087159, "mean_env_wait_ms": 0.6103759725250277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025665760040283203, "StateBufferConnector_ms": 0.0018262863159179688, "ViewRequirementAgentConnector_ms": 0.04530072212219238}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2126400, "num_agent_steps_trained": 2126400, "num_env_steps_sampled": 2126400, "num_env_steps_trained": 2126400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 966.0244489037185, "num_env_steps_trained_throughput_per_sec": 966.0244489037185, "timesteps_total": 2126400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2126400, "timers": {"training_iteration_time_ms": 45613.997, "sample_time_ms": 44886.854, "load_time_ms": 13.735, "load_throughput": 3197734.877, "learn_time_ms": 712.596, "learn_throughput": 61633.837, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 2126400, "num_env_steps_trained": 2126400, "num_agent_steps_sampled": 2126400, "num_agent_steps_trained": 2126400}, "done": false, "episodes_total": 1239, "training_iteration": 360, "trial_id": "09673_00000", "date": "2023-07-27_03-47-40", "timestamp": 1690418860, "time_this_iter_s": 45.46690392494202, "time_total_s": 5587.642599105835, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 920.0978412628174, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.84375, "ram_util_percent": 70.9765625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.049999999999999e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1669.4128348570175, "policy_loss": -3.628294276823076e+20, "vf_loss": 322654267.03207}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14063.5, "diff_num_grad_updates_vs_sampler_policy": 14062.5}}, "num_env_steps_sampled": 2170320, "num_env_steps_trained": 2170320, "num_agent_steps_sampled": 2170320, "num_agent_steps_trained": 2170320}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396408.9148456778, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1350340476373999, "mean_inference_ms": 0.23555263755905914, "mean_action_processing_ms": 0.05708694594657427, "mean_env_wait_ms": 0.6095120094170946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025544847760881695, "StateBufferConnector_ms": 0.0018221991402762277, "ViewRequirementAgentConnector_ms": 0.04517577943347749}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396408.9148456778, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1350340476373999, "mean_inference_ms": 0.23555263755905914, "mean_action_processing_ms": 0.05708694594657427, "mean_env_wait_ms": 0.6095120094170946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025544847760881695, "StateBufferConnector_ms": 0.0018221991402762277, "ViewRequirementAgentConnector_ms": 0.04517577943347749}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2170320, "num_agent_steps_trained": 2170320, "num_env_steps_sampled": 2170320, "num_env_steps_trained": 2170320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 961.0452783196222, "num_env_steps_trained_throughput_per_sec": 961.0452783196222, "timesteps_total": 2170320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2170320, "timers": {"training_iteration_time_ms": 45664.76, "sample_time_ms": 44938.747, "load_time_ms": 13.8, "load_throughput": 3182652.42, "learn_time_ms": 711.399, "learn_throughput": 61737.526, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 2170320, "num_env_steps_trained": 2170320, "num_agent_steps_sampled": 2170320, "num_agent_steps_trained": 2170320}, "done": false, "episodes_total": 1240, "training_iteration": 361, "trial_id": "09673_00000", "date": "2023-07-27_03-48-26", "timestamp": 1690418906, "time_this_iter_s": 45.70208787918091, "time_total_s": 5633.344686985016, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 965.7999291419983, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.093846153846155, "ram_util_percent": 70.9276923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1669.592015747426, "policy_loss": -3.5761934957121215e+20, "vf_loss": 322194726.38483965}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14749.5, "diff_num_grad_updates_vs_sampler_policy": 14748.5}}, "num_env_steps_sampled": 2214240, "num_env_steps_trained": 2214240, "num_agent_steps_sampled": 2214240, "num_agent_steps_trained": 2214240}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396318.1154770998, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13501287122174527, "mean_inference_ms": 0.2354829112110823, "mean_action_processing_ms": 0.057076276868665, "mean_env_wait_ms": 0.6087035449583322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002541325309059837, "StateBufferConnector_ms": 0.0018239021301269531, "ViewRequirementAgentConnector_ms": 0.04511638121171431}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396318.1154770998, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13501287122174527, "mean_inference_ms": 0.2354829112110823, "mean_action_processing_ms": 0.057076276868665, "mean_env_wait_ms": 0.6087035449583322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002541325309059837, "StateBufferConnector_ms": 0.0018239021301269531, "ViewRequirementAgentConnector_ms": 0.04511638121171431}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2214240, "num_agent_steps_trained": 2214240, "num_env_steps_sampled": 2214240, "num_env_steps_trained": 2214240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 966.7164252792918, "num_env_steps_trained_throughput_per_sec": 966.7164252792918, "timesteps_total": 2214240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2214240, "timers": {"training_iteration_time_ms": 45634.748, "sample_time_ms": 44903.045, "load_time_ms": 13.773, "load_throughput": 3188883.571, "learn_time_ms": 717.11, "learn_throughput": 61245.871, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 2214240, "num_env_steps_trained": 2214240, "num_agent_steps_sampled": 2214240, "num_agent_steps_trained": 2214240}, "done": false, "episodes_total": 1241, "training_iteration": 362, "trial_id": "09673_00000", "date": "2023-07-27_03-49-11", "timestamp": 1690418951, "time_this_iter_s": 45.43411684036255, "time_total_s": 5678.778803825378, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1011.2340459823608, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.417187499999997, "ram_util_percent": 70.821875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1669.4827213565393, "policy_loss": -3.664998073494789e+20, "vf_loss": 323894900.55976677}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15435.5, "diff_num_grad_updates_vs_sampler_policy": 15434.5}}, "num_env_steps_sampled": 2258160, "num_env_steps_trained": 2258160, "num_agent_steps_sampled": 2258160, "num_agent_steps_trained": 2258160}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396390.262250868, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13499191130947577, "mean_inference_ms": 0.23542062291784147, "mean_action_processing_ms": 0.057066337767657294, "mean_env_wait_ms": 0.60796310116047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025282735409943953, "StateBufferConnector_ms": 0.001828566841457201, "ViewRequirementAgentConnector_ms": 0.045047635617463486}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396390.262250868, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13499191130947577, "mean_inference_ms": 0.23542062291784147, "mean_action_processing_ms": 0.057066337767657294, "mean_env_wait_ms": 0.60796310116047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025282735409943953, "StateBufferConnector_ms": 0.001828566841457201, "ViewRequirementAgentConnector_ms": 0.045047635617463486}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2258160, "num_agent_steps_trained": 2258160, "num_env_steps_sampled": 2258160, "num_env_steps_trained": 2258160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 957.044002202553, "num_env_steps_trained_throughput_per_sec": 957.044002202553, "timesteps_total": 2258160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2258160, "timers": {"training_iteration_time_ms": 45653.095, "sample_time_ms": 44921.788, "load_time_ms": 12.827, "load_throughput": 3424023.459, "learn_time_ms": 717.649, "learn_throughput": 61199.875, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 2258160, "num_env_steps_trained": 2258160, "num_agent_steps_sampled": 2258160, "num_agent_steps_trained": 2258160}, "done": false, "episodes_total": 1242, "training_iteration": 363, "trial_id": "09673_00000", "date": "2023-07-27_03-49-57", "timestamp": 1690418997, "time_this_iter_s": 45.89331579208374, "time_total_s": 5724.672119617462, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1057.1273617744446, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.781538461538464, "ram_util_percent": 70.84923076923076}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1669.156775471768, "policy_loss": -3.465178484679132e+20, "vf_loss": 322905411.2244898}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16121.5, "diff_num_grad_updates_vs_sampler_policy": 16120.5}}, "num_env_steps_sampled": 2302080, "num_env_steps_trained": 2302080, "num_agent_steps_sampled": 2302080, "num_agent_steps_trained": 2302080}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396369.132600803, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13497389557206815, "mean_inference_ms": 0.23536253244337027, "mean_action_processing_ms": 0.057056936271057734, "mean_env_wait_ms": 0.6072726962824797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002603729565938314, "StateBufferConnector_ms": 0.0018378098805745442, "ViewRequirementAgentConnector_ms": 0.04502634207407633}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396369.132600803, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13497389557206815, "mean_inference_ms": 0.23536253244337027, "mean_action_processing_ms": 0.057056936271057734, "mean_env_wait_ms": 0.6072726962824797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002603729565938314, "StateBufferConnector_ms": 0.0018378098805745442, "ViewRequirementAgentConnector_ms": 0.04502634207407633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2302080, "num_agent_steps_trained": 2302080, "num_env_steps_sampled": 2302080, "num_env_steps_trained": 2302080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 961.8791012095385, "num_env_steps_trained_throughput_per_sec": 961.8791012095385, "timesteps_total": 2302080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2302080, "timers": {"training_iteration_time_ms": 45662.835, "sample_time_ms": 44931.834, "load_time_ms": 12.793, "load_throughput": 3433257.449, "learn_time_ms": 717.384, "learn_throughput": 61222.423, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 2302080, "num_env_steps_trained": 2302080, "num_agent_steps_sampled": 2302080, "num_agent_steps_trained": 2302080}, "done": false, "episodes_total": 1243, "training_iteration": 364, "trial_id": "09673_00000", "date": "2023-07-27_03-50-43", "timestamp": 1690419043, "time_this_iter_s": 45.66250681877136, "time_total_s": 5770.3346264362335, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1102.789868593216, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.433846153846154, "ram_util_percent": 70.86615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1669.356410791158, "policy_loss": -3.470778309475891e+20, "vf_loss": 322759802.851312}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16807.5, "diff_num_grad_updates_vs_sampler_policy": 16806.5}}, "num_env_steps_sampled": 2346000, "num_env_steps_trained": 2346000, "num_agent_steps_sampled": 2346000, "num_agent_steps_trained": 2346000}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396329.562711692, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1349560482585712, "mean_inference_ms": 0.23530749325127068, "mean_action_processing_ms": 0.05704809366254814, "mean_env_wait_ms": 0.6066174046348813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002593994140625, "StateBufferConnector_ms": 0.0018405914306640625, "ViewRequirementAgentConnector_ms": 0.044952392578125}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396329.562711692, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1349560482585712, "mean_inference_ms": 0.23530749325127068, "mean_action_processing_ms": 0.05704809366254814, "mean_env_wait_ms": 0.6066174046348813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002593994140625, "StateBufferConnector_ms": 0.0018405914306640625, "ViewRequirementAgentConnector_ms": 0.044952392578125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2346000, "num_agent_steps_trained": 2346000, "num_env_steps_sampled": 2346000, "num_env_steps_trained": 2346000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 969.15729955978, "num_env_steps_trained_throughput_per_sec": 969.15729955978, "timesteps_total": 2346000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2346000, "timers": {"training_iteration_time_ms": 45610.253, "sample_time_ms": 44878.113, "load_time_ms": 12.861, "load_throughput": 3414921.301, "learn_time_ms": 718.449, "learn_throughput": 61131.684, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 2346000, "num_env_steps_trained": 2346000, "num_agent_steps_sampled": 2346000, "num_agent_steps_trained": 2346000}, "done": false, "episodes_total": 1244, "training_iteration": 365, "trial_id": "09673_00000", "date": "2023-07-27_03-51-28", "timestamp": 1690419088, "time_this_iter_s": 45.31971478462219, "time_total_s": 5815.654341220856, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1148.1095833778381, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.1296875, "ram_util_percent": 70.88749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1669.809898265249, "policy_loss": -3.847067068412202e+20, "vf_loss": 324420776.40816325}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17493.5, "diff_num_grad_updates_vs_sampler_policy": 17492.5}}, "num_env_steps_sampled": 2389920, "num_env_steps_trained": 2389920, "num_agent_steps_sampled": 2389920, "num_agent_steps_trained": 2389920}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396433.3826407488, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13493847113399415, "mean_inference_ms": 0.23525530005482073, "mean_action_processing_ms": 0.05703960967743727, "mean_env_wait_ms": 0.6060035960140534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025840905996469352, "StateBufferConnector_ms": 0.0018431590153620793, "ViewRequirementAgentConnector_ms": 0.044908890357384317}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396433.3826407488, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13493847113399415, "mean_inference_ms": 0.23525530005482073, "mean_action_processing_ms": 0.05703960967743727, "mean_env_wait_ms": 0.6060035960140534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025840905996469352, "StateBufferConnector_ms": 0.0018431590153620793, "ViewRequirementAgentConnector_ms": 0.044908890357384317}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2389920, "num_agent_steps_trained": 2389920, "num_env_steps_sampled": 2389920, "num_env_steps_trained": 2389920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 963.8563716550351, "num_env_steps_trained_throughput_per_sec": 963.8563716550351, "timesteps_total": 2389920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2389920, "timers": {"training_iteration_time_ms": 45583.351, "sample_time_ms": 44851.912, "load_time_ms": 12.728, "load_throughput": 3450744.077, "learn_time_ms": 717.879, "learn_throughput": 61180.25, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 2389920, "num_env_steps_trained": 2389920, "num_agent_steps_sampled": 2389920, "num_agent_steps_trained": 2389920}, "done": false, "episodes_total": 1245, "training_iteration": 366, "trial_id": "09673_00000", "date": "2023-07-27_03-52-13", "timestamp": 1690419133, "time_this_iter_s": 45.568946838378906, "time_total_s": 5861.223288059235, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1193.678530216217, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 19.089230769230767, "ram_util_percent": 70.82923076923078}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1669.555804994989, "policy_loss": -3.715143730487722e+20, "vf_loss": 323097073.9650146}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18179.5, "diff_num_grad_updates_vs_sampler_policy": 18178.5}}, "num_env_steps_sampled": 2433840, "num_env_steps_trained": 2433840, "num_agent_steps_sampled": 2433840, "num_agent_steps_trained": 2433840}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396425.8461630177, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13492179673147003, "mean_inference_ms": 0.2352106803117831, "mean_action_processing_ms": 0.05703196893349403, "mean_env_wait_ms": 0.6054276296015864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025740376225224246, "StateBufferConnector_ms": 0.0018393551861798322, "ViewRequirementAgentConnector_ms": 0.04491452817563658}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396425.8461630177, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13492179673147003, "mean_inference_ms": 0.2352106803117831, "mean_action_processing_ms": 0.05703196893349403, "mean_env_wait_ms": 0.6054276296015864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025740376225224246, "StateBufferConnector_ms": 0.0018393551861798322, "ViewRequirementAgentConnector_ms": 0.04491452817563658}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2433840, "num_agent_steps_trained": 2433840, "num_env_steps_sampled": 2433840, "num_env_steps_trained": 2433840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 959.3449796846091, "num_env_steps_trained_throughput_per_sec": 959.3449796846091, "timesteps_total": 2433840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2433840, "timers": {"training_iteration_time_ms": 45589.898, "sample_time_ms": 44857.527, "load_time_ms": 12.731, "load_throughput": 3449742.444, "learn_time_ms": 718.802, "learn_throughput": 61101.632, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 2433840, "num_env_steps_trained": 2433840, "num_agent_steps_sampled": 2433840, "num_agent_steps_trained": 2433840}, "done": false, "episodes_total": 1246, "training_iteration": 367, "trial_id": "09673_00000", "date": "2023-07-27_03-52-59", "timestamp": 1690419179, "time_this_iter_s": 45.78319716453552, "time_total_s": 5907.00648522377, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1239.4617273807526, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.9171875, "ram_util_percent": 70.83749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1670.099756001731, "policy_loss": -4.017729565268181e+20, "vf_loss": 324142829.5860058}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18865.5, "diff_num_grad_updates_vs_sampler_policy": 18864.5}}, "num_env_steps_sampled": 2477760, "num_env_steps_trained": 2477760, "num_agent_steps_sampled": 2477760, "num_agent_steps_trained": 2477760}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396501.479089739, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13490533308889335, "mean_inference_ms": 0.2351683746114829, "mean_action_processing_ms": 0.0570247848184106, "mean_env_wait_ms": 0.6048919803132435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025664057050432476, "StateBufferConnector_ms": 0.001836674554007394, "ViewRequirementAgentConnector_ms": 0.04500320979527065}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396501.479089739, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13490533308889335, "mean_inference_ms": 0.2351683746114829, "mean_action_processing_ms": 0.0570247848184106, "mean_env_wait_ms": 0.6048919803132435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025664057050432476, "StateBufferConnector_ms": 0.001836674554007394, "ViewRequirementAgentConnector_ms": 0.04500320979527065}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2477760, "num_agent_steps_trained": 2477760, "num_env_steps_sampled": 2477760, "num_env_steps_trained": 2477760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 958.8065073152745, "num_env_steps_trained_throughput_per_sec": 958.8065073152745, "timesteps_total": 2477760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2477760, "timers": {"training_iteration_time_ms": 45630.017, "sample_time_ms": 44896.535, "load_time_ms": 12.7, "load_throughput": 3458213.234, "learn_time_ms": 719.943, "learn_throughput": 61004.832, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 2477760, "num_env_steps_trained": 2477760, "num_agent_steps_sampled": 2477760, "num_agent_steps_trained": 2477760}, "done": false, "episodes_total": 1247, "training_iteration": 368, "trial_id": "09673_00000", "date": "2023-07-27_03-53-45", "timestamp": 1690419225, "time_this_iter_s": 45.80886197090149, "time_total_s": 5952.815347194672, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1285.270589351654, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.439999999999998, "ram_util_percent": 70.87692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1669.817196326075, "policy_loss": -4.09274317532239e+20, "vf_loss": 323384921.5685131}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19551.5, "diff_num_grad_updates_vs_sampler_policy": 19550.5}}, "num_env_steps_sampled": 2521680, "num_env_steps_trained": 2521680, "num_agent_steps_sampled": 2521680, "num_agent_steps_trained": 2521680}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396510.9090771554, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13488919925602263, "mean_inference_ms": 0.23512768909359635, "mean_action_processing_ms": 0.057017738752245674, "mean_env_wait_ms": 0.6043983636063226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002661244622592268, "StateBufferConnector_ms": 0.0018391115912075701, "ViewRequirementAgentConnector_ms": 0.04519676340037379}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396510.9090771554, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13488919925602263, "mean_inference_ms": 0.23512768909359635, "mean_action_processing_ms": 0.057017738752245674, "mean_env_wait_ms": 0.6043983636063226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002661244622592268, "StateBufferConnector_ms": 0.0018391115912075701, "ViewRequirementAgentConnector_ms": 0.04519676340037379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2521680, "num_agent_steps_trained": 2521680, "num_env_steps_sampled": 2521680, "num_env_steps_trained": 2521680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 954.7470935536963, "num_env_steps_trained_throughput_per_sec": 954.7470935536963, "timesteps_total": 2521680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2521680, "timers": {"training_iteration_time_ms": 45662.342, "sample_time_ms": 44927.009, "load_time_ms": 12.739, "load_throughput": 3447547.347, "learn_time_ms": 721.742, "learn_throughput": 60852.747, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 2521680, "num_env_steps_trained": 2521680, "num_agent_steps_sampled": 2521680, "num_agent_steps_trained": 2521680}, "done": false, "episodes_total": 1248, "training_iteration": 369, "trial_id": "09673_00000", "date": "2023-07-27_03-54-31", "timestamp": 1690419271, "time_this_iter_s": 46.003663063049316, "time_total_s": 5998.819010257721, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1331.2742524147034, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.156923076923082, "ram_util_percent": 70.86153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1671.982686123417, "policy_loss": -4.3961576075561435e+20, "vf_loss": 323056413.8542274}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20237.5, "diff_num_grad_updates_vs_sampler_policy": 20236.5}}, "num_env_steps_sampled": 2565600, "num_env_steps_trained": 2565600, "num_agent_steps_sampled": 2565600, "num_agent_steps_trained": 2565600}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396500.380481158, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13487300904851215, "mean_inference_ms": 0.23508805654380951, "mean_action_processing_ms": 0.05701099828131335, "mean_env_wait_ms": 0.6039362655059328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026464462280273438, "StateBufferConnector_ms": 0.0018397967020670574, "ViewRequirementAgentConnector_ms": 0.045157273610432945}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396500.380481158, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13487300904851215, "mean_inference_ms": 0.23508805654380951, "mean_action_processing_ms": 0.05701099828131335, "mean_env_wait_ms": 0.6039362655059328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026464462280273438, "StateBufferConnector_ms": 0.0018397967020670574, "ViewRequirementAgentConnector_ms": 0.045157273610432945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2565600, "num_agent_steps_trained": 2565600, "num_env_steps_sampled": 2565600, "num_env_steps_trained": 2565600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 960.5162446609709, "num_env_steps_trained_throughput_per_sec": 960.5162446609709, "timesteps_total": 2565600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2565600, "timers": {"training_iteration_time_ms": 45688.415, "sample_time_ms": 44953.453, "load_time_ms": 12.733, "load_throughput": 3449277.367, "learn_time_ms": 721.383, "learn_throughput": 60883.074, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 2565600, "num_env_steps_trained": 2565600, "num_agent_steps_sampled": 2565600, "num_agent_steps_trained": 2565600}, "done": false, "episodes_total": 1249, "training_iteration": 370, "trial_id": "09673_00000", "date": "2023-07-27_03-55-17", "timestamp": 1690419317, "time_this_iter_s": 45.72751426696777, "time_total_s": 6044.546524524689, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1377.0017666816711, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 18.255384615384614, "ram_util_percent": 70.77230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1672.452734588534, "policy_loss": -4.380148900413616e+20, "vf_loss": 322784587.4635568}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20923.5, "diff_num_grad_updates_vs_sampler_policy": 20922.5}}, "num_env_steps_sampled": 2609520, "num_env_steps_trained": 2609520, "num_agent_steps_sampled": 2609520, "num_agent_steps_trained": 2609520}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396467.4110792698, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13485727687860244, "mean_inference_ms": 0.2350505815045019, "mean_action_processing_ms": 0.05700472732627419, "mean_env_wait_ms": 0.6035049994530863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002644138951455393, "StateBufferConnector_ms": 0.0018404376122259324, "ViewRequirementAgentConnector_ms": 0.04513032974735383}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396467.4110792698, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13485727687860244, "mean_inference_ms": 0.2350505815045019, "mean_action_processing_ms": 0.05700472732627419, "mean_env_wait_ms": 0.6035049994530863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002644138951455393, "StateBufferConnector_ms": 0.0018404376122259324, "ViewRequirementAgentConnector_ms": 0.04513032974735383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2609520, "num_agent_steps_trained": 2609520, "num_env_steps_sampled": 2609520, "num_env_steps_trained": 2609520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 956.773615191319, "num_env_steps_trained_throughput_per_sec": 956.773615191319, "timesteps_total": 2609520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2609520, "timers": {"training_iteration_time_ms": 45708.818, "sample_time_ms": 44972.917, "load_time_ms": 12.686, "load_throughput": 3462080.319, "learn_time_ms": 722.37, "learn_throughput": 60799.879, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 2609520, "num_env_steps_trained": 2609520, "num_agent_steps_sampled": 2609520, "num_agent_steps_trained": 2609520}, "done": false, "episodes_total": 1250, "training_iteration": 371, "trial_id": "09673_00000", "date": "2023-07-27_03-56-03", "timestamp": 1690419363, "time_this_iter_s": 45.90640711784363, "time_total_s": 6090.452931642532, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1422.9081737995148, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 17.583076923076923, "ram_util_percent": 70.83692307692306}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1673.5805158698524, "policy_loss": -4.4634956193191454e+20, "vf_loss": 324588002.48396504}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21609.5, "diff_num_grad_updates_vs_sampler_policy": 21608.5}}, "num_env_steps_sampled": 2653440, "num_env_steps_trained": 2653440, "num_agent_steps_sampled": 2653440, "num_agent_steps_trained": 2653440}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396559.160871522, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13484197365462763, "mean_inference_ms": 0.23501442976925838, "mean_action_processing_ms": 0.05699874967982, "mean_env_wait_ms": 0.6030909349997392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002635270357131958, "StateBufferConnector_ms": 0.0018365681171417236, "ViewRequirementAgentConnector_ms": 0.04507526755332947}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396559.160871522, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13484197365462763, "mean_inference_ms": 0.23501442976925838, "mean_action_processing_ms": 0.05699874967982, "mean_env_wait_ms": 0.6030909349997392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002635270357131958, "StateBufferConnector_ms": 0.0018365681171417236, "ViewRequirementAgentConnector_ms": 0.04507526755332947}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2653440, "num_agent_steps_trained": 2653440, "num_env_steps_sampled": 2653440, "num_env_steps_trained": 2653440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 967.5426202824376, "num_env_steps_trained_throughput_per_sec": 967.5426202824376, "timesteps_total": 2653440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2653440, "timers": {"training_iteration_time_ms": 45704.939, "sample_time_ms": 44972.94, "load_time_ms": 12.662, "load_throughput": 3468586.077, "learn_time_ms": 718.489, "learn_throughput": 61128.323, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 2653440, "num_env_steps_trained": 2653440, "num_agent_steps_sampled": 2653440, "num_agent_steps_trained": 2653440}, "done": false, "episodes_total": 1251, "training_iteration": 372, "trial_id": "09673_00000", "date": "2023-07-27_03-56-48", "timestamp": 1690419408, "time_this_iter_s": 45.395406007766724, "time_total_s": 6135.848337650299, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1468.3035798072815, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.52, "ram_util_percent": 70.84461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1675.5252080533664, "policy_loss": -4.836570203230472e+20, "vf_loss": 323638411.0670554}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22295.5, "diff_num_grad_updates_vs_sampler_policy": 22294.5}}, "num_env_steps_sampled": 2697360, "num_env_steps_trained": 2697360, "num_agent_steps_sampled": 2697360, "num_agent_steps_trained": 2697360}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396587.4454918099, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13482711456249952, "mean_inference_ms": 0.23497989765582483, "mean_action_processing_ms": 0.05699294233475193, "mean_env_wait_ms": 0.6026931948350347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026334415782581677, "StateBufferConnector_ms": 0.0018394354617956913, "ViewRequirementAgentConnector_ms": 0.045065446333451706}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396587.4454918099, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13482711456249952, "mean_inference_ms": 0.23497989765582483, "mean_action_processing_ms": 0.05699294233475193, "mean_env_wait_ms": 0.6026931948350347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026334415782581677, "StateBufferConnector_ms": 0.0018394354617956913, "ViewRequirementAgentConnector_ms": 0.045065446333451706}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2697360, "num_agent_steps_trained": 2697360, "num_env_steps_sampled": 2697360, "num_env_steps_trained": 2697360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 967.3328888557156, "num_env_steps_trained_throughput_per_sec": 967.3328888557156, "timesteps_total": 2697360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2697360, "timers": {"training_iteration_time_ms": 45656.127, "sample_time_ms": 44923.768, "load_time_ms": 12.729, "load_throughput": 3450349.817, "learn_time_ms": 718.793, "learn_throughput": 61102.437, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 2697360, "num_env_steps_trained": 2697360, "num_agent_steps_sampled": 2697360, "num_agent_steps_trained": 2697360}, "done": false, "episodes_total": 1252, "training_iteration": 373, "trial_id": "09673_00000", "date": "2023-07-27_03-57-34", "timestamp": 1690419454, "time_this_iter_s": 45.4054811000824, "time_total_s": 6181.2538187503815, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1513.709060907364, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 18.209374999999998, "ram_util_percent": 70.8578125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1675.647389403585, "policy_loss": -4.910539862472284e+20, "vf_loss": 322696419.33527696}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22981.5, "diff_num_grad_updates_vs_sampler_policy": 22980.5}}, "num_env_steps_sampled": 2741280, "num_env_steps_trained": 2741280, "num_agent_steps_sampled": 2741280, "num_agent_steps_trained": 2741280}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396551.6855154748, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13481391569368623, "mean_inference_ms": 0.23494722939205165, "mean_action_processing_ms": 0.05698754018128507, "mean_env_wait_ms": 0.6023117888840241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002621903139002183, "StateBufferConnector_ms": 0.001844939063577091, "ViewRequirementAgentConnector_ms": 0.04509617300594554}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396551.6855154748, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13481391569368623, "mean_inference_ms": 0.23494722939205165, "mean_action_processing_ms": 0.05698754018128507, "mean_env_wait_ms": 0.6023117888840241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002621903139002183, "StateBufferConnector_ms": 0.001844939063577091, "ViewRequirementAgentConnector_ms": 0.04509617300594554}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2741280, "num_agent_steps_trained": 2741280, "num_env_steps_sampled": 2741280, "num_env_steps_trained": 2741280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 964.1782122699937, "num_env_steps_trained_throughput_per_sec": 964.1782122699937, "timesteps_total": 2741280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2741280, "timers": {"training_iteration_time_ms": 45645.239, "sample_time_ms": 44912.361, "load_time_ms": 12.612, "load_throughput": 3482520.302, "learn_time_ms": 719.424, "learn_throughput": 61048.85, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 2741280, "num_env_steps_trained": 2741280, "num_agent_steps_sampled": 2741280, "num_agent_steps_trained": 2741280}, "done": false, "episodes_total": 1253, "training_iteration": 374, "trial_id": "09673_00000", "date": "2023-07-27_03-58-19", "timestamp": 1690419499, "time_this_iter_s": 45.55382800102234, "time_total_s": 6226.807646751404, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1559.2628889083862, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 18.9328125, "ram_util_percent": 70.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1678.897357373474, "policy_loss": -5.405385017109985e+20, "vf_loss": 323092657.76676387}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23667.5, "diff_num_grad_updates_vs_sampler_policy": 23666.5}}, "num_env_steps_sampled": 2785200, "num_env_steps_trained": 2785200, "num_agent_steps_sampled": 2785200, "num_agent_steps_trained": 2785200}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396541.081054407, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13480090328862177, "mean_inference_ms": 0.2349152259734337, "mean_action_processing_ms": 0.05698229390470263, "mean_env_wait_ms": 0.6019493927614374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026151112147739957, "StateBufferConnector_ms": 0.001850128173828125, "ViewRequirementAgentConnector_ms": 0.045033863612583706}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396541.081054407, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13480090328862177, "mean_inference_ms": 0.2349152259734337, "mean_action_processing_ms": 0.05698229390470263, "mean_env_wait_ms": 0.6019493927614374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026151112147739957, "StateBufferConnector_ms": 0.001850128173828125, "ViewRequirementAgentConnector_ms": 0.045033863612583706}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2785200, "num_agent_steps_trained": 2785200, "num_env_steps_sampled": 2785200, "num_env_steps_trained": 2785200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 963.0234230957991, "num_env_steps_trained_throughput_per_sec": 963.0234230957991, "timesteps_total": 2785200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2785200, "timers": {"training_iteration_time_ms": 45674.104, "sample_time_ms": 44940.999, "load_time_ms": 12.439, "load_throughput": 3530840.432, "learn_time_ms": 719.834, "learn_throughput": 61014.098, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 2785200, "num_env_steps_trained": 2785200, "num_agent_steps_sampled": 2785200, "num_agent_steps_trained": 2785200}, "done": false, "episodes_total": 1254, "training_iteration": 375, "trial_id": "09673_00000", "date": "2023-07-27_03-59-05", "timestamp": 1690419545, "time_this_iter_s": 45.60836100578308, "time_total_s": 6272.416007757187, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1604.8712499141693, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 18.032307692307693, "ram_util_percent": 70.82461538461537}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1689.990044507619, "policy_loss": -8.037144874447572e+20, "vf_loss": 322160918.64139944}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24353.5, "diff_num_grad_updates_vs_sampler_policy": 24352.5}}, "num_env_steps_sampled": 2829120, "num_env_steps_trained": 2829120, "num_agent_steps_sampled": 2829120, "num_agent_steps_trained": 2829120}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396474.561358491, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1347879197143072, "mean_inference_ms": 0.23488510712814603, "mean_action_processing_ms": 0.0569772765187336, "mean_env_wait_ms": 0.6016010482225104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002608696619669596, "StateBufferConnector_ms": 0.0018556912740071614, "ViewRequirementAgentConnector_ms": 0.04498230086432563}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396474.561358491, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1347879197143072, "mean_inference_ms": 0.23488510712814603, "mean_action_processing_ms": 0.0569772765187336, "mean_env_wait_ms": 0.6016010482225104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002608696619669596, "StateBufferConnector_ms": 0.0018556912740071614, "ViewRequirementAgentConnector_ms": 0.04498230086432563}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2829120, "num_agent_steps_trained": 2829120, "num_env_steps_sampled": 2829120, "num_env_steps_trained": 2829120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 964.6932984033749, "num_env_steps_trained_throughput_per_sec": 964.6932984033749, "timesteps_total": 2829120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2829120, "timers": {"training_iteration_time_ms": 45670.151, "sample_time_ms": 44929.966, "load_time_ms": 12.493, "load_throughput": 3515631.777, "learn_time_ms": 726.857, "learn_throughput": 60424.576, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 2829120, "num_env_steps_trained": 2829120, "num_agent_steps_sampled": 2829120, "num_agent_steps_trained": 2829120}, "done": false, "episodes_total": 1255, "training_iteration": 376, "trial_id": "09673_00000", "date": "2023-07-27_03-59-50", "timestamp": 1690419590, "time_this_iter_s": 45.52963304519653, "time_total_s": 6317.945640802383, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1650.4008829593658, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.7671875, "ram_util_percent": 70.87968749999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1697.005733211951, "policy_loss": -1.0130279003720922e+21, "vf_loss": 323153810.7463557}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25039.5, "diff_num_grad_updates_vs_sampler_policy": 25038.5}}, "num_env_steps_sampled": 2873040, "num_env_steps_trained": 2873040, "num_agent_steps_sampled": 2873040, "num_agent_steps_trained": 2873040}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396468.604296236, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1347763475270533, "mean_inference_ms": 0.23485646900718207, "mean_action_processing_ms": 0.056972526294621566, "mean_env_wait_ms": 0.6012642536049299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002594896264978357, "StateBufferConnector_ms": 0.0018454886771537163, "ViewRequirementAgentConnector_ms": 0.0449818533820075}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396468.604296236, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1347763475270533, "mean_inference_ms": 0.23485646900718207, "mean_action_processing_ms": 0.056972526294621566, "mean_env_wait_ms": 0.6012642536049299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002594896264978357, "StateBufferConnector_ms": 0.0018454886771537163, "ViewRequirementAgentConnector_ms": 0.0449818533820075}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2873040, "num_agent_steps_trained": 2873040, "num_env_steps_sampled": 2873040, "num_env_steps_trained": 2873040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 966.695042510896, "num_env_steps_trained_throughput_per_sec": 966.695042510896, "timesteps_total": 2873040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2873040, "timers": {"training_iteration_time_ms": 45635.342, "sample_time_ms": 44894.913, "load_time_ms": 12.517, "load_throughput": 3508694.541, "learn_time_ms": 727.083, "learn_throughput": 60405.795, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 2873040, "num_env_steps_trained": 2873040, "num_agent_steps_sampled": 2873040, "num_agent_steps_trained": 2873040}, "done": false, "episodes_total": 1256, "training_iteration": 377, "trial_id": "09673_00000", "date": "2023-07-27_04-00-36", "timestamp": 1690419636, "time_this_iter_s": 45.43504309654236, "time_total_s": 6363.380683898926, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1695.8359260559082, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 18.20769230769231, "ram_util_percent": 70.84153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1703.6807665588558, "policy_loss": -1.3431643991778905e+21, "vf_loss": 324404058.25072885}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25725.5, "diff_num_grad_updates_vs_sampler_policy": 25724.5}}, "num_env_steps_sampled": 2916960, "num_env_steps_trained": 2916960, "num_agent_steps_sampled": 2916960, "num_agent_steps_trained": 2916960}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396533.3032141516, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13476547079486717, "mean_inference_ms": 0.2348284776841684, "mean_action_processing_ms": 0.05696785646395472, "mean_env_wait_ms": 0.600945788302513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025874690005653783, "StateBufferConnector_ms": 0.001845861736096834, "ViewRequirementAgentConnector_ms": 0.04495068600303248}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396533.3032141516, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13476547079486717, "mean_inference_ms": 0.2348284776841684, "mean_action_processing_ms": 0.05696785646395472, "mean_env_wait_ms": 0.600945788302513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025874690005653783, "StateBufferConnector_ms": 0.001845861736096834, "ViewRequirementAgentConnector_ms": 0.04495068600303248}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2916960, "num_agent_steps_trained": 2916960, "num_env_steps_sampled": 2916960, "num_env_steps_trained": 2916960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 958.8595487521036, "num_env_steps_trained_throughput_per_sec": 958.8595487521036, "timesteps_total": 2916960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2916960, "timers": {"training_iteration_time_ms": 45635.088, "sample_time_ms": 44894.72, "load_time_ms": 12.463, "load_throughput": 3524099.273, "learn_time_ms": 727.077, "learn_throughput": 60406.26, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 2916960, "num_env_steps_trained": 2916960, "num_agent_steps_sampled": 2916960, "num_agent_steps_trained": 2916960}, "done": false, "episodes_total": 1257, "training_iteration": 378, "trial_id": "09673_00000", "date": "2023-07-27_04-01-22", "timestamp": 1690419682, "time_this_iter_s": 45.806370973587036, "time_total_s": 6409.187054872513, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1741.6422970294952, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 17.93076923076923, "ram_util_percent": 70.78307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1705.4991398135705, "policy_loss": -1.4108249454091268e+21, "vf_loss": 323052321.83090377}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26411.5, "diff_num_grad_updates_vs_sampler_policy": 26410.5}}, "num_env_steps_sampled": 2960880, "num_env_steps_trained": 2960880, "num_agent_steps_sampled": 2960880, "num_agent_steps_trained": 2960880}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396525.77586526, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13475503888841736, "mean_inference_ms": 0.23480153645188265, "mean_action_processing_ms": 0.05696340992998666, "mean_env_wait_ms": 0.6006413878056173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002576143313676883, "StateBufferConnector_ms": 0.0018425476856720753, "ViewRequirementAgentConnector_ms": 0.04491378099490435}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396525.77586526, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13475503888841736, "mean_inference_ms": 0.23480153645188265, "mean_action_processing_ms": 0.05696340992998666, "mean_env_wait_ms": 0.6006413878056173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002576143313676883, "StateBufferConnector_ms": 0.0018425476856720753, "ViewRequirementAgentConnector_ms": 0.04491378099490435}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960880, "num_agent_steps_trained": 2960880, "num_env_steps_sampled": 2960880, "num_env_steps_trained": 2960880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 962.0022633137866, "num_env_steps_trained_throughput_per_sec": 962.0022633137866, "timesteps_total": 2960880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2960880, "timers": {"training_iteration_time_ms": 45600.395, "sample_time_ms": 44859.76, "load_time_ms": 12.439, "load_throughput": 3530786.292, "learn_time_ms": 727.381, "learn_throughput": 60380.998, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 2960880, "num_env_steps_trained": 2960880, "num_agent_steps_sampled": 2960880, "num_agent_steps_trained": 2960880}, "done": false, "episodes_total": 1258, "training_iteration": 379, "trial_id": "09673_00000", "date": "2023-07-27_04-02-07", "timestamp": 1690419727, "time_this_iter_s": 45.6568717956543, "time_total_s": 6454.843926668167, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1787.2991688251495, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.2203125, "ram_util_percent": 70.8109375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1708.1506612794392, "policy_loss": -1.5149170194861714e+21, "vf_loss": 322619207.90670556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27097.5, "diff_num_grad_updates_vs_sampler_policy": 27096.5}}, "num_env_steps_sampled": 3004800, "num_env_steps_trained": 3004800, "num_agent_steps_sampled": 3004800, "num_agent_steps_trained": 3004800}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396494.5939931746, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13474523894693768, "mean_inference_ms": 0.23477467953505568, "mean_action_processing_ms": 0.05695908689498637, "mean_env_wait_ms": 0.6003500033411143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002580881118774414, "StateBufferConnector_ms": 0.0018519163131713867, "ViewRequirementAgentConnector_ms": 0.04498422145843506}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396494.5939931746, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13474523894693768, "mean_inference_ms": 0.23477467953505568, "mean_action_processing_ms": 0.05695908689498637, "mean_env_wait_ms": 0.6003500033411143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002580881118774414, "StateBufferConnector_ms": 0.0018519163131713867, "ViewRequirementAgentConnector_ms": 0.04498422145843506}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3004800, "num_agent_steps_trained": 3004800, "num_env_steps_sampled": 3004800, "num_env_steps_trained": 3004800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 963.6428261877634, "num_env_steps_trained_throughput_per_sec": 963.6428261877634, "timesteps_total": 3004800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3004800, "timers": {"training_iteration_time_ms": 45585.559, "sample_time_ms": 44844.395, "load_time_ms": 12.395, "load_throughput": 3543323.235, "learn_time_ms": 727.955, "learn_throughput": 60333.395, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 3004800, "num_env_steps_trained": 3004800, "num_agent_steps_sampled": 3004800, "num_agent_steps_trained": 3004800}, "done": false, "episodes_total": 1259, "training_iteration": 380, "trial_id": "09673_00000", "date": "2023-07-27_04-02-53", "timestamp": 1690419773, "time_this_iter_s": 45.57908773422241, "time_total_s": 6500.4230144023895, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1832.878256559372, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.755384615384617, "ram_util_percent": 70.86153846153844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1715.8429718462442, "policy_loss": -1.9293700029377348e+21, "vf_loss": 323860180.1516035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27783.5, "diff_num_grad_updates_vs_sampler_policy": 27782.5}}, "num_env_steps_sampled": 3048720, "num_env_steps_trained": 3048720, "num_agent_steps_sampled": 3048720, "num_agent_steps_trained": 3048720}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396528.3882935874, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13473610131047897, "mean_inference_ms": 0.23474866774884626, "mean_action_processing_ms": 0.05695489144453677, "mean_env_wait_ms": 0.6000703566966263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002587713846346227, "StateBufferConnector_ms": 0.0018567573733446075, "ViewRequirementAgentConnector_ms": 0.04504192166212129}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396528.3882935874, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13473610131047897, "mean_inference_ms": 0.23474866774884626, "mean_action_processing_ms": 0.05695489144453677, "mean_env_wait_ms": 0.6000703566966263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002587713846346227, "StateBufferConnector_ms": 0.0018567573733446075, "ViewRequirementAgentConnector_ms": 0.04504192166212129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3048720, "num_agent_steps_trained": 3048720, "num_env_steps_sampled": 3048720, "num_env_steps_trained": 3048720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 962.8126317888037, "num_env_steps_trained_throughput_per_sec": 962.8126317888037, "timesteps_total": 3048720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3048720, "timers": {"training_iteration_time_ms": 45556.767, "sample_time_ms": 44815.072, "load_time_ms": 12.49, "load_throughput": 3516403.529, "learn_time_ms": 728.39, "learn_throughput": 60297.37, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 3048720, "num_env_steps_trained": 3048720, "num_agent_steps_sampled": 3048720, "num_agent_steps_trained": 3048720}, "done": false, "episodes_total": 1260, "training_iteration": 381, "trial_id": "09673_00000", "date": "2023-07-27_04-03-39", "timestamp": 1690419819, "time_this_iter_s": 45.618512868881226, "time_total_s": 6546.041527271271, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1878.4967694282532, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 18.318461538461538, "ram_util_percent": 70.86153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1722.1482086626504, "policy_loss": -2.3008023629397906e+21, "vf_loss": 322271785.2827988}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28469.5, "diff_num_grad_updates_vs_sampler_policy": 28468.5}}, "num_env_steps_sampled": 3092640, "num_env_steps_trained": 3092640, "num_agent_steps_sampled": 3092640, "num_agent_steps_trained": 3092640}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396478.5052169529, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13472734583403806, "mean_inference_ms": 0.23472331871085497, "mean_action_processing_ms": 0.05695085141604456, "mean_env_wait_ms": 0.5997967059349846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025874092465355283, "StateBufferConnector_ms": 0.0018596649169921875, "ViewRequirementAgentConnector_ms": 0.04511049815586635}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396478.5052169529, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13472734583403806, "mean_inference_ms": 0.23472331871085497, "mean_action_processing_ms": 0.05695085141604456, "mean_env_wait_ms": 0.5997967059349846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025874092465355283, "StateBufferConnector_ms": 0.0018596649169921875, "ViewRequirementAgentConnector_ms": 0.04511049815586635}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3092640, "num_agent_steps_trained": 3092640, "num_env_steps_sampled": 3092640, "num_env_steps_trained": 3092640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 971.8109965103843, "num_env_steps_trained_throughput_per_sec": 971.8109965103843, "timesteps_total": 3092640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3092640, "timers": {"training_iteration_time_ms": 45536.829, "sample_time_ms": 44795.714, "load_time_ms": 12.58, "load_throughput": 3491252.278, "learn_time_ms": 727.73, "learn_throughput": 60352.023, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 3092640, "num_env_steps_trained": 3092640, "num_agent_steps_sampled": 3092640, "num_agent_steps_trained": 3092640}, "done": false, "episodes_total": 1261, "training_iteration": 382, "trial_id": "09673_00000", "date": "2023-07-27_04-04-24", "timestamp": 1690419864, "time_this_iter_s": 45.195919036865234, "time_total_s": 6591.237446308136, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1923.6926884651184, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 20.15, "ram_util_percent": 70.70156250000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1725.6739984184244, "policy_loss": -2.545393446124587e+21, "vf_loss": 322237187.5102041}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29155.5, "diff_num_grad_updates_vs_sampler_policy": 29154.5}}, "num_env_steps_sampled": 3136560, "num_env_steps_trained": 3136560, "num_agent_steps_sampled": 3136560, "num_agent_steps_trained": 3136560}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396430.0625491089, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13471859452717952, "mean_inference_ms": 0.23469918523057479, "mean_action_processing_ms": 0.056947039426135514, "mean_env_wait_ms": 0.5995315516123255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002625931140988372, "StateBufferConnector_ms": 0.0018618827642396438, "ViewRequirementAgentConnector_ms": 0.04513651825660883}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396430.0625491089, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13471859452717952, "mean_inference_ms": 0.23469918523057479, "mean_action_processing_ms": 0.056947039426135514, "mean_env_wait_ms": 0.5995315516123255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002625931140988372, "StateBufferConnector_ms": 0.0018618827642396438, "ViewRequirementAgentConnector_ms": 0.04513651825660883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3136560, "num_agent_steps_trained": 3136560, "num_env_steps_sampled": 3136560, "num_env_steps_trained": 3136560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 966.6167992815712, "num_env_steps_trained_throughput_per_sec": 966.6167992815712, "timesteps_total": 3136560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3136560, "timers": {"training_iteration_time_ms": 45540.193, "sample_time_ms": 44798.682, "load_time_ms": 12.613, "load_throughput": 3482112.165, "learn_time_ms": 728.093, "learn_throughput": 60321.932, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 3136560, "num_env_steps_trained": 3136560, "num_agent_steps_sampled": 3136560, "num_agent_steps_trained": 3136560}, "done": false, "episodes_total": 1262, "training_iteration": 383, "trial_id": "09673_00000", "date": "2023-07-27_04-05-09", "timestamp": 1690419909, "time_this_iter_s": 45.43889784812927, "time_total_s": 6636.676344156265, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1969.1315863132477, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 18.270312500000003, "ram_util_percent": 70.7640625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1733.5905192294551, "policy_loss": -3.4213525497068603e+21, "vf_loss": 322648367.5568513}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29841.5, "diff_num_grad_updates_vs_sampler_policy": 29840.5}}, "num_env_steps_sampled": 3180480, "num_env_steps_trained": 3180480, "num_agent_steps_sampled": 3180480, "num_agent_steps_trained": 3180480}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396404.8950838845, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13470994130883363, "mean_inference_ms": 0.23467634602488685, "mean_action_processing_ms": 0.056943431885634464, "mean_env_wait_ms": 0.5992770618272172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026226043701171875, "StateBufferConnector_ms": 0.0018661672418767755, "ViewRequirementAgentConnector_ms": 0.045201453295621}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396404.8950838845, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13470994130883363, "mean_inference_ms": 0.23467634602488685, "mean_action_processing_ms": 0.056943431885634464, "mean_env_wait_ms": 0.5992770618272172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026226043701171875, "StateBufferConnector_ms": 0.0018661672418767755, "ViewRequirementAgentConnector_ms": 0.045201453295621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3180480, "num_agent_steps_trained": 3180480, "num_env_steps_sampled": 3180480, "num_env_steps_trained": 3180480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 961.8058186762504, "num_env_steps_trained_throughput_per_sec": 961.8058186762504, "timesteps_total": 3180480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3180480, "timers": {"training_iteration_time_ms": 45551.429, "sample_time_ms": 44810.358, "load_time_ms": 12.731, "load_throughput": 3449858.733, "learn_time_ms": 727.546, "learn_throughput": 60367.309, "synch_weights_time_ms": 0.676}, "counters": {"num_env_steps_sampled": 3180480, "num_env_steps_trained": 3180480, "num_agent_steps_sampled": 3180480, "num_agent_steps_trained": 3180480}, "done": false, "episodes_total": 1263, "training_iteration": 384, "trial_id": "09673_00000", "date": "2023-07-27_04-05-55", "timestamp": 1690419955, "time_this_iter_s": 45.66617774963379, "time_total_s": 6682.342521905899, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2014.7977640628815, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.607692307692307, "ram_util_percent": 70.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1739.5234793170896, "policy_loss": -4.0079950296564965e+21, "vf_loss": 322550431.0087463}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30527.5, "diff_num_grad_updates_vs_sampler_policy": 30526.5}}, "num_env_steps_sampled": 3224400, "num_env_steps_trained": 3224400, "num_agent_steps_sampled": 3224400, "num_agent_steps_trained": 3224400}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396376.5813014149, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1347014325904211, "mean_inference_ms": 0.23465420931395525, "mean_action_processing_ms": 0.05693992752785821, "mean_env_wait_ms": 0.599033414572942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026199552747938368, "StateBufferConnector_ms": 0.0018570158216688368, "ViewRequirementAgentConnector_ms": 0.04520840115017361}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396376.5813014149, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1347014325904211, "mean_inference_ms": 0.23465420931395525, "mean_action_processing_ms": 0.05693992752785821, "mean_env_wait_ms": 0.599033414572942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026199552747938368, "StateBufferConnector_ms": 0.0018570158216688368, "ViewRequirementAgentConnector_ms": 0.04520840115017361}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3224400, "num_agent_steps_trained": 3224400, "num_env_steps_sampled": 3224400, "num_env_steps_trained": 3224400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 961.1324357851303, "num_env_steps_trained_throughput_per_sec": 961.1324357851303, "timesteps_total": 3224400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3224400, "timers": {"training_iteration_time_ms": 45560.402, "sample_time_ms": 44819.314, "load_time_ms": 12.764, "load_throughput": 3440830.961, "learn_time_ms": 727.531, "learn_throughput": 60368.571, "synch_weights_time_ms": 0.674}, "counters": {"num_env_steps_sampled": 3224400, "num_env_steps_trained": 3224400, "num_agent_steps_sampled": 3224400, "num_agent_steps_trained": 3224400}, "done": false, "episodes_total": 1264, "training_iteration": 385, "trial_id": "09673_00000", "date": "2023-07-27_04-06-41", "timestamp": 1690420001, "time_this_iter_s": 45.69807410240173, "time_total_s": 6728.040596008301, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2060.495838165283, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.995312499999997, "ram_util_percent": 70.828125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.9110828099376, "policy_loss": -4.49909557331626e+21, "vf_loss": 323413890.2623907}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31213.5, "diff_num_grad_updates_vs_sampler_policy": 31212.5}}, "num_env_steps_sampled": 3268320, "num_env_steps_trained": 3268320, "num_agent_steps_sampled": 3268320, "num_agent_steps_trained": 3268320}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396386.2233180595, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13469386429733934, "mean_inference_ms": 0.23463385864188097, "mean_action_processing_ms": 0.05693664459261375, "mean_env_wait_ms": 0.5987979687687714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002650074336839759, "StateBufferConnector_ms": 0.0018710675446883492, "ViewRequirementAgentConnector_ms": 0.04520105279010275}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396386.2233180595, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13469386429733934, "mean_inference_ms": 0.23463385864188097, "mean_action_processing_ms": 0.05693664459261375, "mean_env_wait_ms": 0.5987979687687714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002650074336839759, "StateBufferConnector_ms": 0.0018710675446883492, "ViewRequirementAgentConnector_ms": 0.04520105279010275}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3268320, "num_agent_steps_trained": 3268320, "num_env_steps_sampled": 3268320, "num_env_steps_trained": 3268320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 961.090163793988, "num_env_steps_trained_throughput_per_sec": 961.090163793988, "timesteps_total": 3268320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3268320, "timers": {"training_iteration_time_ms": 45577.47, "sample_time_ms": 44842.547, "load_time_ms": 12.733, "load_throughput": 3449283.825, "learn_time_ms": 721.409, "learn_throughput": 60880.863, "synch_weights_time_ms": 0.667}, "counters": {"num_env_steps_sampled": 3268320, "num_env_steps_trained": 3268320, "num_agent_steps_sampled": 3268320, "num_agent_steps_trained": 3268320}, "done": false, "episodes_total": 1265, "training_iteration": 386, "trial_id": "09673_00000", "date": "2023-07-27_04-07-26", "timestamp": 1690420046, "time_this_iter_s": 45.70026206970215, "time_total_s": 6773.740858078003, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2106.1961002349854, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.832307692307694, "ram_util_percent": 70.85076923076922}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1750.7230785136321, "policy_loss": -5.636075944339012e+21, "vf_loss": 322726048.0408163}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31899.5, "diff_num_grad_updates_vs_sampler_policy": 31898.5}}, "num_env_steps_sampled": 3312240, "num_env_steps_trained": 3312240, "num_agent_steps_sampled": 3312240, "num_agent_steps_trained": 3312240}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396364.8061952696, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13468629418042566, "mean_inference_ms": 0.23461396925887507, "mean_action_processing_ms": 0.05693351411286332, "mean_env_wait_ms": 0.5985734509633401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002649489869462683, "StateBufferConnector_ms": 0.0018693031148707612, "ViewRequirementAgentConnector_ms": 0.04524829539846867}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396364.8061952696, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13468629418042566, "mean_inference_ms": 0.23461396925887507, "mean_action_processing_ms": 0.05693351411286332, "mean_env_wait_ms": 0.5985734509633401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002649489869462683, "StateBufferConnector_ms": 0.0018693031148707612, "ViewRequirementAgentConnector_ms": 0.04524829539846867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3312240, "num_agent_steps_trained": 3312240, "num_env_steps_sampled": 3312240, "num_env_steps_trained": 3312240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 958.8972572564033, "num_env_steps_trained_throughput_per_sec": 958.8972572564033, "timesteps_total": 3312240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3312240, "timers": {"training_iteration_time_ms": 45614.417, "sample_time_ms": 44879.538, "load_time_ms": 12.718, "load_throughput": 3453240.998, "learn_time_ms": 721.374, "learn_throughput": 60883.78, "synch_weights_time_ms": 0.67}, "counters": {"num_env_steps_sampled": 3312240, "num_env_steps_trained": 3312240, "num_agent_steps_sampled": 3312240, "num_agent_steps_trained": 3312240}, "done": false, "episodes_total": 1266, "training_iteration": 387, "trial_id": "09673_00000", "date": "2023-07-27_04-08-12", "timestamp": 1690420092, "time_this_iter_s": 45.80479288101196, "time_total_s": 6819.545650959015, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2152.0008931159973, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.681538461538462, "ram_util_percent": 71.13076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1761.6474942132265, "policy_loss": -8.243194403795066e+21, "vf_loss": 323161474.56559765}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32585.5, "diff_num_grad_updates_vs_sampler_policy": 32584.5}}, "num_env_steps_sampled": 3356160, "num_env_steps_trained": 3356160, "num_agent_steps_sampled": 3356160, "num_agent_steps_trained": 3356160}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396363.1641104978, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935, -1396285.9861262282], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13467896017283307, "mean_inference_ms": 0.2345951795127693, "mean_action_processing_ms": 0.05693053614505136, "mean_env_wait_ms": 0.5983597307444297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002691646416982015, "StateBufferConnector_ms": 0.001870592435201009, "ViewRequirementAgentConnector_ms": 0.045268734296162925}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396363.1641104978, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935, -1396285.9861262282], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13467896017283307, "mean_inference_ms": 0.2345951795127693, "mean_action_processing_ms": 0.05693053614505136, "mean_env_wait_ms": 0.5983597307444297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002691646416982015, "StateBufferConnector_ms": 0.001870592435201009, "ViewRequirementAgentConnector_ms": 0.045268734296162925}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3356160, "num_agent_steps_trained": 3356160, "num_env_steps_sampled": 3356160, "num_env_steps_trained": 3356160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 955.4933726494002, "num_env_steps_trained_throughput_per_sec": 955.4933726494002, "timesteps_total": 3356160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3356160, "timers": {"training_iteration_time_ms": 45630.554, "sample_time_ms": 44894.725, "load_time_ms": 12.742, "load_throughput": 3446831.318, "learn_time_ms": 722.301, "learn_throughput": 60805.661, "synch_weights_time_ms": 0.671}, "counters": {"num_env_steps_sampled": 3356160, "num_env_steps_trained": 3356160, "num_agent_steps_sampled": 3356160, "num_agent_steps_trained": 3356160}, "done": false, "episodes_total": 1267, "training_iteration": 388, "trial_id": "09673_00000", "date": "2023-07-27_04-08-58", "timestamp": 1690420138, "time_this_iter_s": 45.96802306175232, "time_total_s": 6865.513674020767, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2197.9689161777496, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 18.235384615384614, "ram_util_percent": 71.13538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1767.1970431936725, "policy_loss": -9.274844866464028e+21, "vf_loss": 321929243.941691}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33271.5, "diff_num_grad_updates_vs_sampler_policy": 33270.5}}, "num_env_steps_sampled": 3400080, "num_env_steps_trained": 3400080, "num_agent_steps_sampled": 3400080, "num_agent_steps_trained": 3400080}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396309.5837685836, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935, -1396285.9861262282, -1393737.727356708], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13467186897568192, "mean_inference_ms": 0.23457768221147748, "mean_action_processing_ms": 0.056927654809768045, "mean_env_wait_ms": 0.5981512266988648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026853717103296395, "StateBufferConnector_ms": 0.0018713425616828762, "ViewRequirementAgentConnector_ms": 0.04525719856729313}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396309.5837685836, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935, -1396285.9861262282, -1393737.727356708], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13467186897568192, "mean_inference_ms": 0.23457768221147748, "mean_action_processing_ms": 0.056927654809768045, "mean_env_wait_ms": 0.5981512266988648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026853717103296395, "StateBufferConnector_ms": 0.0018713425616828762, "ViewRequirementAgentConnector_ms": 0.04525719856729313}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3400080, "num_agent_steps_trained": 3400080, "num_env_steps_sampled": 3400080, "num_env_steps_trained": 3400080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 965.0378965815423, "num_env_steps_trained_throughput_per_sec": 965.0378965815423, "timesteps_total": 3400080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3400080, "timers": {"training_iteration_time_ms": 45616.192, "sample_time_ms": 44876.706, "load_time_ms": 12.672, "load_throughput": 3465779.999, "learn_time_ms": 726.015, "learn_throughput": 60494.62, "synch_weights_time_ms": 0.685}, "counters": {"num_env_steps_sampled": 3400080, "num_env_steps_trained": 3400080, "num_agent_steps_sampled": 3400080, "num_agent_steps_trained": 3400080}, "done": false, "episodes_total": 1268, "training_iteration": 389, "trial_id": "09673_00000", "date": "2023-07-27_04-09-44", "timestamp": 1690420184, "time_this_iter_s": 45.513206005096436, "time_total_s": 6911.026880025864, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2243.482122182846, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 17.909230769230767, "ram_util_percent": 71.14153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1767.5831555069014, "policy_loss": -9.69483989226731e+21, "vf_loss": 322887092.9912537}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33957.5, "diff_num_grad_updates_vs_sampler_policy": 33956.5}}, "num_env_steps_sampled": 3444000, "num_env_steps_trained": 3444000, "num_agent_steps_sampled": 3444000, "num_agent_steps_trained": 3444000}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396299.1609325656, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935, -1396285.9861262282, -1393737.727356708, -1395788.4419676857], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13466533627260924, "mean_inference_ms": 0.23456093368038872, "mean_action_processing_ms": 0.056924898436404664, "mean_env_wait_ms": 0.5979509970706975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026831626892089844, "StateBufferConnector_ms": 0.0018734931945800781, "ViewRequirementAgentConnector_ms": 0.04527616500854492}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396299.1609325656, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935, -1396285.9861262282, -1393737.727356708, -1395788.4419676857], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13466533627260924, "mean_inference_ms": 0.23456093368038872, "mean_action_processing_ms": 0.056924898436404664, "mean_env_wait_ms": 0.5979509970706975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026831626892089844, "StateBufferConnector_ms": 0.0018734931945800781, "ViewRequirementAgentConnector_ms": 0.04527616500854492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3444000, "num_agent_steps_trained": 3444000, "num_env_steps_sampled": 3444000, "num_env_steps_trained": 3444000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 958.8877337698301, "num_env_steps_trained_throughput_per_sec": 958.8877337698301, "timesteps_total": 3444000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3444000, "timers": {"training_iteration_time_ms": 45638.794, "sample_time_ms": 44900.457, "load_time_ms": 12.688, "load_throughput": 3461572.881, "learn_time_ms": 724.854, "learn_throughput": 60591.489, "synch_weights_time_ms": 0.681}, "counters": {"num_env_steps_sampled": 3444000, "num_env_steps_trained": 3444000, "num_agent_steps_sampled": 3444000, "num_agent_steps_trained": 3444000}, "done": false, "episodes_total": 1269, "training_iteration": 390, "trial_id": "09673_00000", "date": "2023-07-27_04-10-29", "timestamp": 1690420229, "time_this_iter_s": 45.80521869659424, "time_total_s": 6956.832098722458, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2289.2873408794403, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 19.621538461538464, "ram_util_percent": 71.0923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1781.2777185023006, "policy_loss": -1.5552109295752582e+22, "vf_loss": 323763540.303207}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34643.5, "diff_num_grad_updates_vs_sampler_policy": 34642.5}}, "num_env_steps_sampled": 3487920, "num_env_steps_trained": 3487920, "num_agent_steps_sampled": 3487920, "num_agent_steps_trained": 3487920}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396327.888863189, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935, -1396285.9861262282, -1393737.727356708, -1395788.4419676857, -1397764.2853943552], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13465894521073576, "mean_inference_ms": 0.2345447145844387, "mean_action_processing_ms": 0.05692227041882665, "mean_env_wait_ms": 0.5977598907257322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002677767884497549, "StateBufferConnector_ms": 0.001878831900802313, "ViewRequirementAgentConnector_ms": 0.045223329581466375}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396327.888863189, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935, -1396285.9861262282, -1393737.727356708, -1395788.4419676857, -1397764.2853943552], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13465894521073576, "mean_inference_ms": 0.2345447145844387, "mean_action_processing_ms": 0.05692227041882665, "mean_env_wait_ms": 0.5977598907257322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002677767884497549, "StateBufferConnector_ms": 0.001878831900802313, "ViewRequirementAgentConnector_ms": 0.045223329581466375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3487920, "num_agent_steps_trained": 3487920, "num_env_steps_sampled": 3487920, "num_env_steps_trained": 3487920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 956.9553724331697, "num_env_steps_trained_throughput_per_sec": 956.9553724331697, "timesteps_total": 3487920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3487920, "timers": {"training_iteration_time_ms": 45666.714, "sample_time_ms": 44929.683, "load_time_ms": 12.656, "load_throughput": 3470245.756, "learn_time_ms": 723.587, "learn_throughput": 60697.645, "synch_weights_time_ms": 0.675}, "counters": {"num_env_steps_sampled": 3487920, "num_env_steps_trained": 3487920, "num_agent_steps_sampled": 3487920, "num_agent_steps_trained": 3487920}, "done": false, "episodes_total": 1270, "training_iteration": 391, "trial_id": "09673_00000", "date": "2023-07-27_04-11-15", "timestamp": 1690420275, "time_this_iter_s": 45.897786140441895, "time_total_s": 7002.7298848629, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2335.185127019882, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 17.64615384615385, "ram_util_percent": 71.08307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1783.2177027933103, "policy_loss": -1.6192941433501832e+22, "vf_loss": 322462043.6268222}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35329.5, "diff_num_grad_updates_vs_sampler_policy": 35328.5}}, "num_env_steps_sampled": 3531840, "num_env_steps_trained": 3531840, "num_agent_steps_sampled": 3531840, "num_agent_steps_trained": 3531840}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396299.3442840567, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935, -1396285.9861262282, -1393737.727356708, -1395788.4419676857, -1397764.2853943552, -1394843.5707483122], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13465299701171746, "mean_inference_ms": 0.23452912176821325, "mean_action_processing_ms": 0.056919859992876305, "mean_env_wait_ms": 0.5975763690924356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002671663577740009, "StateBufferConnector_ms": 0.0018793802994948167, "ViewRequirementAgentConnector_ms": 0.04520232860858624}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396299.3442840567, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935, -1396285.9861262282, -1393737.727356708, -1395788.4419676857, -1397764.2853943552, -1394843.5707483122], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13465299701171746, "mean_inference_ms": 0.23452912176821325, "mean_action_processing_ms": 0.056919859992876305, "mean_env_wait_ms": 0.5975763690924356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002671663577740009, "StateBufferConnector_ms": 0.0018793802994948167, "ViewRequirementAgentConnector_ms": 0.04520232860858624}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3531840, "num_agent_steps_trained": 3531840, "num_env_steps_sampled": 3531840, "num_env_steps_trained": 3531840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 957.9864100953578, "num_env_steps_trained_throughput_per_sec": 957.9864100953578, "timesteps_total": 3531840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3531840, "timers": {"training_iteration_time_ms": 45731.933, "sample_time_ms": 44995.889, "load_time_ms": 12.588, "load_throughput": 3488931.366, "learn_time_ms": 722.657, "learn_throughput": 60775.758, "synch_weights_time_ms": 0.685}, "counters": {"num_env_steps_sampled": 3531840, "num_env_steps_trained": 3531840, "num_agent_steps_sampled": 3531840, "num_agent_steps_trained": 3531840}, "done": false, "episodes_total": 1271, "training_iteration": 392, "trial_id": "09673_00000", "date": "2023-07-27_04-12-01", "timestamp": 1690420321, "time_this_iter_s": 45.84824085235596, "time_total_s": 7048.578125715256, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2381.033367872238, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 17.875384615384615, "ram_util_percent": 71.10923076923078}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3500000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1786.3371574913447, "policy_loss": -1.8152145084056768e+22, "vf_loss": 322897059.00291544}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36015.5, "diff_num_grad_updates_vs_sampler_policy": 36014.5}}, "num_env_steps_sampled": 3575760, "num_env_steps_trained": 3575760, "num_agent_steps_sampled": 3575760, "num_agent_steps_trained": 3575760}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396290.143505478, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935, -1396285.9861262282, -1393737.727356708, -1395788.4419676857, -1397764.2853943552, -1394843.5707483122, -1395811.7030193778], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13464769684889827, "mean_inference_ms": 0.2345139795397196, "mean_action_processing_ms": 0.056917552232136154, "mean_env_wait_ms": 0.597401259354171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026639902366782132, "StateBufferConnector_ms": 0.0018799080038970372, "ViewRequirementAgentConnector_ms": 0.04521540875704783}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396290.143505478, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935, -1396285.9861262282, -1393737.727356708, -1395788.4419676857, -1397764.2853943552, -1394843.5707483122, -1395811.7030193778], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13464769684889827, "mean_inference_ms": 0.2345139795397196, "mean_action_processing_ms": 0.056917552232136154, "mean_env_wait_ms": 0.597401259354171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026639902366782132, "StateBufferConnector_ms": 0.0018799080038970372, "ViewRequirementAgentConnector_ms": 0.04521540875704783}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3575760, "num_agent_steps_trained": 3575760, "num_env_steps_sampled": 3575760, "num_env_steps_trained": 3575760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 954.5554009612034, "num_env_steps_trained_throughput_per_sec": 954.5554009612034, "timesteps_total": 3575760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3575760, "timers": {"training_iteration_time_ms": 45789.345, "sample_time_ms": 45053.384, "load_time_ms": 12.522, "load_throughput": 3507465.307, "learn_time_ms": 722.639, "learn_throughput": 60777.256, "synch_weights_time_ms": 0.684}, "counters": {"num_env_steps_sampled": 3575760, "num_env_steps_trained": 3575760, "num_agent_steps_sampled": 3575760, "num_agent_steps_trained": 3575760}, "done": false, "episodes_total": 1272, "training_iteration": 393, "trial_id": "09673_00000", "date": "2023-07-27_04-12-47", "timestamp": 1690420367, "time_this_iter_s": 46.01307201385498, "time_total_s": 7094.591197729111, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2427.046439886093, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 18.87575757575757, "ram_util_percent": 71.11515151515151}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1999999999999996e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1789.6635606949253, "policy_loss": -1.9727064555126247e+22, "vf_loss": 322786254.851312}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36701.5, "diff_num_grad_updates_vs_sampler_policy": 36700.5}}, "num_env_steps_sampled": 3619680, "num_env_steps_trained": 3619680, "num_agent_steps_sampled": 3619680, "num_agent_steps_trained": 3619680}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396276.9948776218, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935, -1396285.9861262282, -1393737.727356708, -1395788.4419676857, -1397764.2853943552, -1394843.5707483122, -1395811.7030193778, -1395580.1176012452], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1346429851279645, "mean_inference_ms": 0.23449982650246629, "mean_action_processing_ms": 0.056915338993197964, "mean_env_wait_ms": 0.5972316233252196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026579256410951967, "StateBufferConnector_ms": 0.0018835067749023438, "ViewRequirementAgentConnector_ms": 0.04520063047055845}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396276.9948776218, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935, -1396285.9861262282, -1393737.727356708, -1395788.4419676857, -1397764.2853943552, -1394843.5707483122, -1395811.7030193778, -1395580.1176012452], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1346429851279645, "mean_inference_ms": 0.23449982650246629, "mean_action_processing_ms": 0.056915338993197964, "mean_env_wait_ms": 0.5972316233252196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026579256410951967, "StateBufferConnector_ms": 0.0018835067749023438, "ViewRequirementAgentConnector_ms": 0.04520063047055845}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3619680, "num_agent_steps_trained": 3619680, "num_env_steps_sampled": 3619680, "num_env_steps_trained": 3619680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 959.5426744198838, "num_env_steps_trained_throughput_per_sec": 959.5426744198838, "timesteps_total": 3619680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3619680, "timers": {"training_iteration_time_ms": 45800.115, "sample_time_ms": 45063.475, "load_time_ms": 12.502, "load_throughput": 3513084.048, "learn_time_ms": 723.333, "learn_throughput": 60718.962, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 3619680, "num_env_steps_trained": 3619680, "num_agent_steps_sampled": 3619680, "num_agent_steps_trained": 3619680}, "done": false, "episodes_total": 1273, "training_iteration": 394, "trial_id": "09673_00000", "date": "2023-07-27_04-13-33", "timestamp": 1690420413, "time_this_iter_s": 45.77374887466431, "time_total_s": 7140.364946603775, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2472.8201887607574, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 18.712307692307697, "ram_util_percent": 71.19538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0500000000000004e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1793.7209798295714, "policy_loss": -2.3418040513795937e+22, "vf_loss": 323255331.81341106}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37387.5, "diff_num_grad_updates_vs_sampler_policy": 37386.5}}, "num_env_steps_sampled": 3663600, "num_env_steps_trained": 3663600, "num_agent_steps_sampled": 3663600, "num_agent_steps_trained": 3663600}, "sampler_results": {"episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396281.1233951973, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935, -1396285.9861262282, -1393737.727356708, -1395788.4419676857, -1397764.2853943552, -1394843.5707483122, -1395811.7030193778, -1395580.1176012452, -1396504.0633442756], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13463827409254261, "mean_inference_ms": 0.234486154913668, "mean_action_processing_ms": 0.056913260764291804, "mean_env_wait_ms": 0.5970681760664498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002657283436168324, "StateBufferConnector_ms": 0.0018830732865767045, "ViewRequirementAgentConnector_ms": 0.04517121748490767}}, "episode_reward_max": -1391237.0711043037, "episode_reward_min": -1401603.4386268943, "episode_reward_mean": -1396281.1233951973, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1401603.4386268943, -1400921.5368220464, -1399929.7374350629, -1398724.0960677818, -1397023.776841265, -1395627.2890960537, -1391237.0711043037, -1397962.088098205, -1392708.1631475869, -1397011.9962129623, -1394568.3660051273, -1394954.6292284818, -1396853.4611824306, -1397961.7908793648, -1395505.626973352, -1396827.2911829161, -1395465.8595296536, -1396035.9281666228, -1396204.79840064, -1392016.243234946, -1395444.0235235323, -1394411.3287369614, -1397977.4912737643, -1395883.1506493152, -1395379.885373024, -1399028.8808671664, -1396229.897742009, -1398543.5681112173, -1396774.9487248124, -1396195.0511972278, -1395478.329022624, -1399403.4044313498, -1397492.5533410236, -1395371.6062964122, -1396180.5293780982, -1394146.3720014335, -1396254.1500550585, -1398927.1631770297, -1396239.7366073807, -1395278.5009818494, -1397880.1603100982, -1394433.2990749334, -1394395.4704996645, -1395322.6940792317, -1395130.7748727533, -1396820.1140670702, -1395379.618546935, -1396285.9861262282, -1393737.727356708, -1395788.4419676857, -1397764.2853943552, -1394843.5707483122, -1395811.7030193778, -1395580.1176012452, -1396504.0633442756], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13463827409254261, "mean_inference_ms": 0.234486154913668, "mean_action_processing_ms": 0.056913260764291804, "mean_env_wait_ms": 0.5970681760664498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002657283436168324, "StateBufferConnector_ms": 0.0018830732865767045, "ViewRequirementAgentConnector_ms": 0.04517121748490767}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3663600, "num_agent_steps_trained": 3663600, "num_env_steps_sampled": 3663600, "num_env_steps_trained": 3663600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 959.4638306170358, "num_env_steps_trained_throughput_per_sec": 959.4638306170358, "timesteps_total": 3663600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3663600, "timers": {"training_iteration_time_ms": 45808.062, "sample_time_ms": 45071.639, "load_time_ms": 12.56, "load_throughput": 3496905.446, "learn_time_ms": 723.042, "learn_throughput": 60743.322, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 3663600, "num_env_steps_trained": 3663600, "num_agent_steps_sampled": 3663600, "num_agent_steps_trained": 3663600}, "done": false, "episodes_total": 1274, "training_iteration": 395, "trial_id": "09673_00000", "date": "2023-07-27_04-14-19", "timestamp": 1690420459, "time_this_iter_s": 45.777525901794434, "time_total_s": 7186.1424725055695, "pid": 18060, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-05], [1731120, 8e-05], [2170320, 2.5e-05], [2609520, 2.5e-05], [3048720, 2.5e-05], [3487920, 2.5e-05], [3927120, 1e-05], [4366320, 1e-05], [4805520, 1e-05], [5244720, 5e-06], [5683920, 5e-06], [6123120, 5e-06], [6562320, 5e-06], [7001520, 1e-06], [7440720, 1e-06], [7879920, 1e-06], [8319120, 1e-06], [8758320, 5e-07], [9197520, 5e-07], [9636720, 2.5e-07], [10075920, 2.5e-07], [10515120, 1e-08], [10954320, 1e-08], [11393520, 5e-09], [11832720, 5e-09], [12271920, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 1482240}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f4f89d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2518.597714662552, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 17.99076923076923, "ram_util_percent": 71.20307692307694}}
