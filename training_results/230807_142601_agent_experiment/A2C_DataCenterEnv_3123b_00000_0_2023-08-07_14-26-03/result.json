{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.8383099080522, "policy_loss": -6752778.545485605, "vf_loss": 6216146.6179846935}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.5, "diff_num_grad_updates_vs_sampler_policy": 342.5}}, "num_env_steps_sampled": 44793840, "num_env_steps_trained": 44793840, "num_agent_steps_sampled": 44793840, "num_agent_steps_trained": 44793840}, "sampler_results": {"episode_reward_max": -180386.77221123342, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -180386.77221123342, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21637586108680817, "mean_inference_ms": 0.37421198404323036, "mean_action_processing_ms": 0.09206596862281576, "mean_env_wait_ms": 0.8073491136688089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032663345336914062, "StateBufferConnector_ms": 0.0026226043701171875, "ViewRequirementAgentConnector_ms": 0.06473064422607422}}, "episode_reward_max": -180386.77221123342, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -180386.77221123342, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21637586108680817, "mean_inference_ms": 0.37421198404323036, "mean_action_processing_ms": 0.09206596862281576, "mean_env_wait_ms": 0.8073491136688089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032663345336914062, "StateBufferConnector_ms": 0.0026226043701171875, "ViewRequirementAgentConnector_ms": 0.06473064422607422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44793840, "num_agent_steps_trained": 44793840, "num_env_steps_sampled": 44793840, "num_env_steps_trained": 44793840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 651.3290741236705, "num_env_steps_trained_throughput_per_sec": 651.3290741236705, "timesteps_total": 44793840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44793840, "timers": {"training_iteration_time_ms": 67431.327, "sample_time_ms": 66295.006, "load_time_ms": 0.593, "load_throughput": 74040929.132, "learn_time_ms": 1134.652, "learn_throughput": 38707.907, "synch_weights_time_ms": 0.901}, "counters": {"num_env_steps_sampled": 44793840, "num_env_steps_trained": 44793840, "num_agent_steps_sampled": 44793840, "num_agent_steps_trained": 44793840}, "done": false, "episodes_total": 9193, "training_iteration": 2930, "trial_id": "3123b_00000", "date": "2023-08-07_14-27-16", "timestamp": 1691407636, "time_this_iter_s": 67.43388390541077, "time_total_s": 77362.55273032188, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 67.43388390541077, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.87291666666667, "ram_util_percent": 72.32604166666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.805842007562, "policy_loss": -7073862.270556213, "vf_loss": 6195386.104409621}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1029.5, "diff_num_grad_updates_vs_sampler_policy": 1028.5}}, "num_env_steps_sampled": 44837760, "num_env_steps_trained": 44837760, "num_agent_steps_sampled": 44837760, "num_agent_steps_trained": 44837760}, "sampler_results": {"episode_reward_max": -179990.9442370681, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -180188.85822415075, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21731933208650342, "mean_inference_ms": 0.37409788771927033, "mean_action_processing_ms": 0.09207991306389315, "mean_env_wait_ms": 0.7901643785963992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033020973205566406, "StateBufferConnector_ms": 0.0028133392333984375, "ViewRequirementAgentConnector_ms": 0.06723403930664062}}, "episode_reward_max": -179990.9442370681, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -180188.85822415075, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21731933208650342, "mean_inference_ms": 0.37409788771927033, "mean_action_processing_ms": 0.09207991306389315, "mean_env_wait_ms": 0.7901643785963992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033020973205566406, "StateBufferConnector_ms": 0.0028133392333984375, "ViewRequirementAgentConnector_ms": 0.06723403930664062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44837760, "num_agent_steps_trained": 44837760, "num_env_steps_sampled": 44837760, "num_env_steps_trained": 44837760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 680.0691902570074, "num_env_steps_trained_throughput_per_sec": 680.0691902570074, "timesteps_total": 44837760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44837760, "timers": {"training_iteration_time_ms": 66006.486, "sample_time_ms": 64868.065, "load_time_ms": 11.19, "load_throughput": 3924871.241, "learn_time_ms": 1126.103, "learn_throughput": 39001.764, "synch_weights_time_ms": 0.955}, "counters": {"num_env_steps_sampled": 44837760, "num_env_steps_trained": 44837760, "num_agent_steps_sampled": 44837760, "num_agent_steps_trained": 44837760}, "done": false, "episodes_total": 9194, "training_iteration": 2931, "trial_id": "3123b_00000", "date": "2023-08-07_14-28-21", "timestamp": 1691407701, "time_this_iter_s": 64.58417701721191, "time_total_s": 77427.1369073391, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 132.01806092262268, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.20108695652174, "ram_util_percent": 73.23586956521739}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.9989347318866, "policy_loss": -6398408.19309744, "vf_loss": 5966889.568330904}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1715.5, "diff_num_grad_updates_vs_sampler_policy": 1714.5}}, "num_env_steps_sampled": 44881680, "num_env_steps_trained": 44881680, "num_agent_steps_sampled": 44881680, "num_agent_steps_trained": 44881680}, "sampler_results": {"episode_reward_max": -176810.0701395744, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -179062.59552929198, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2177124223453817, "mean_inference_ms": 0.37418764079984185, "mean_action_processing_ms": 0.09208956962467456, "mean_env_wait_ms": 0.7800553201600767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032345453898111978, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.06655057271321614}}, "episode_reward_max": -176810.0701395744, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -179062.59552929198, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2177124223453817, "mean_inference_ms": 0.37418764079984185, "mean_action_processing_ms": 0.09208956962467456, "mean_env_wait_ms": 0.7800553201600767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032345453898111978, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.06655057271321614}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44881680, "num_agent_steps_trained": 44881680, "num_env_steps_sampled": 44881680, "num_env_steps_trained": 44881680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 682.4202974047379, "num_env_steps_trained_throughput_per_sec": 682.4202974047379, "timesteps_total": 44881680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44881680, "timers": {"training_iteration_time_ms": 65457.371, "sample_time_ms": 64319.119, "load_time_ms": 14.776, "load_throughput": 2972309.445, "learn_time_ms": 1122.365, "learn_throughput": 39131.669, "synch_weights_time_ms": 0.941}, "counters": {"num_env_steps_sampled": 44881680, "num_env_steps_trained": 44881680, "num_agent_steps_sampled": 44881680, "num_agent_steps_trained": 44881680}, "done": false, "episodes_total": 9195, "training_iteration": 2932, "trial_id": "3123b_00000", "date": "2023-08-07_14-29-25", "timestamp": 1691407765, "time_this_iter_s": 64.36170697212219, "time_total_s": 77491.49861431122, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 196.37976789474487, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.22826086956522, "ram_util_percent": 73.88260869565217}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.97746539324436, "policy_loss": -6651779.527272572, "vf_loss": 6062740.967383382}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2401.5, "diff_num_grad_updates_vs_sampler_policy": 2400.5}}, "num_env_steps_sampled": 44925600, "num_env_steps_trained": 44925600, "num_agent_steps_sampled": 44925600, "num_agent_steps_trained": 44925600}, "sampler_results": {"episode_reward_max": -176810.0701395744, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178802.29341759876, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21797646885879507, "mean_inference_ms": 0.37421784303805283, "mean_action_processing_ms": 0.09208862162683226, "mean_env_wait_ms": 0.7737880446284713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031948089599609375, "StateBufferConnector_ms": 0.002688169479370117, "ViewRequirementAgentConnector_ms": 0.06743669509887695}}, "episode_reward_max": -176810.0701395744, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178802.29341759876, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21797646885879507, "mean_inference_ms": 0.37421784303805283, "mean_action_processing_ms": 0.09208862162683226, "mean_env_wait_ms": 0.7737880446284713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031948089599609375, "StateBufferConnector_ms": 0.002688169479370117, "ViewRequirementAgentConnector_ms": 0.06743669509887695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44925600, "num_agent_steps_trained": 44925600, "num_env_steps_sampled": 44925600, "num_env_steps_trained": 44925600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 679.4007480326574, "num_env_steps_trained_throughput_per_sec": 679.4007480326574, "timesteps_total": 44925600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44925600, "timers": {"training_iteration_time_ms": 65254.324, "sample_time_ms": 64116.307, "load_time_ms": 16.057, "load_throughput": 2735192.268, "learn_time_ms": 1120.848, "learn_throughput": 39184.619, "synch_weights_time_ms": 0.939}, "counters": {"num_env_steps_sampled": 44925600, "num_env_steps_trained": 44925600, "num_agent_steps_sampled": 44925600, "num_agent_steps_trained": 44925600}, "done": false, "episodes_total": 9196, "training_iteration": 2933, "trial_id": "3123b_00000", "date": "2023-08-07_14-30-30", "timestamp": 1691407830, "time_this_iter_s": 64.6478841304779, "time_total_s": 77556.1464984417, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 261.0276520252228, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.920652173913048, "ram_util_percent": 74.2695652173913}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.9571828591928, "policy_loss": -6726533.69082259, "vf_loss": 6127464.573615161}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3087.5, "diff_num_grad_updates_vs_sampler_policy": 3086.5}}, "num_env_steps_sampled": 44969520, "num_env_steps_trained": 44969520, "num_agent_steps_sampled": 44969520, "num_agent_steps_trained": 44969520}, "sampler_results": {"episode_reward_max": -176810.0701395744, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178826.55112559078, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21814067445988655, "mean_inference_ms": 0.3743761930042397, "mean_action_processing_ms": 0.09211556205061486, "mean_env_wait_ms": 0.7690972391709474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038433074951171875, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.06739616394042969}}, "episode_reward_max": -176810.0701395744, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178826.55112559078, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21814067445988655, "mean_inference_ms": 0.3743761930042397, "mean_action_processing_ms": 0.09211556205061486, "mean_env_wait_ms": 0.7690972391709474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038433074951171875, "StateBufferConnector_ms": 0.0027036666870117188, "ViewRequirementAgentConnector_ms": 0.06739616394042969}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44969520, "num_agent_steps_trained": 44969520, "num_env_steps_sampled": 44969520, "num_env_steps_trained": 44969520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 681.7776341949542, "num_env_steps_trained_throughput_per_sec": 681.7776341949542, "timesteps_total": 44969520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 44969520, "timers": {"training_iteration_time_ms": 65087.421, "sample_time_ms": 63949.098, "load_time_ms": 17.892, "load_throughput": 2454691.97, "learn_time_ms": 1119.333, "learn_throughput": 39237.669, "synch_weights_time_ms": 0.928}, "counters": {"num_env_steps_sampled": 44969520, "num_env_steps_trained": 44969520, "num_agent_steps_sampled": 44969520, "num_agent_steps_trained": 44969520}, "done": false, "episodes_total": 9197, "training_iteration": 2934, "trial_id": "3123b_00000", "date": "2023-08-07_14-31-34", "timestamp": 1691407894, "time_this_iter_s": 64.42239999771118, "time_total_s": 77620.56889843941, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 325.45005202293396, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.151648351648355, "ram_util_percent": 74.69010989010988}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.9861415940888, "policy_loss": -6655406.67853584, "vf_loss": 6059681.126457726}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3773.5, "diff_num_grad_updates_vs_sampler_policy": 3772.5}}, "num_env_steps_sampled": 45013440, "num_env_steps_trained": 45013440, "num_agent_steps_sampled": 45013440, "num_agent_steps_trained": 45013440}, "sampler_results": {"episode_reward_max": -176810.0701395744, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178680.24348365798, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21820551856144388, "mean_inference_ms": 0.37444642870715983, "mean_action_processing_ms": 0.09211981189378149, "mean_env_wait_ms": 0.7652560899564168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037431716918945312, "StateBufferConnector_ms": 0.0027457873026529946, "ViewRequirementAgentConnector_ms": 0.06747643152872722}}, "episode_reward_max": -176810.0701395744, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178680.24348365798, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21820551856144388, "mean_inference_ms": 0.37444642870715983, "mean_action_processing_ms": 0.09211981189378149, "mean_env_wait_ms": 0.7652560899564168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037431716918945312, "StateBufferConnector_ms": 0.0027457873026529946, "ViewRequirementAgentConnector_ms": 0.06747643152872722}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45013440, "num_agent_steps_trained": 45013440, "num_env_steps_sampled": 45013440, "num_env_steps_trained": 45013440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 688.3043092928098, "num_env_steps_trained_throughput_per_sec": 688.3043092928098, "timesteps_total": 45013440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45013440, "timers": {"training_iteration_time_ms": 64874.345, "sample_time_ms": 63736.129, "load_time_ms": 18.009, "load_throughput": 2438771.593, "learn_time_ms": 1119.105, "learn_throughput": 39245.656, "synch_weights_time_ms": 0.935}, "counters": {"num_env_steps_sampled": 45013440, "num_env_steps_trained": 45013440, "num_agent_steps_sampled": 45013440, "num_agent_steps_trained": 45013440}, "done": false, "episodes_total": 9198, "training_iteration": 2935, "trial_id": "3123b_00000", "date": "2023-08-07_14-32-38", "timestamp": 1691407958, "time_this_iter_s": 63.8115918636322, "time_total_s": 77684.38049030304, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 389.26164388656616, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 21.655555555555555, "ram_util_percent": 74.39444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.0162120852456, "policy_loss": -6336537.7589086415, "vf_loss": 6250121.124088922}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4459.5, "diff_num_grad_updates_vs_sampler_policy": 4458.5}}, "num_env_steps_sampled": 45057360, "num_env_steps_trained": 45057360, "num_agent_steps_sampled": 45057360, "num_agent_steps_trained": 45057360}, "sampler_results": {"episode_reward_max": -176810.0701395744, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178887.23756100578, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21823253101501078, "mean_inference_ms": 0.3744679477419494, "mean_action_processing_ms": 0.09211492506035786, "mean_env_wait_ms": 0.7621836290141639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036648341587611605, "StateBufferConnector_ms": 0.0027009419032505582, "ViewRequirementAgentConnector_ms": 0.0684431621006557}}, "episode_reward_max": -176810.0701395744, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178887.23756100578, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21823253101501078, "mean_inference_ms": 0.3744679477419494, "mean_action_processing_ms": 0.09211492506035786, "mean_env_wait_ms": 0.7621836290141639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036648341587611605, "StateBufferConnector_ms": 0.0027009419032505582, "ViewRequirementAgentConnector_ms": 0.0684431621006557}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45057360, "num_agent_steps_trained": 45057360, "num_env_steps_sampled": 45057360, "num_env_steps_trained": 45057360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 685.7478403561606, "num_env_steps_trained_throughput_per_sec": 685.7478403561606, "timesteps_total": 45057360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45057360, "timers": {"training_iteration_time_ms": 64756.131, "sample_time_ms": 63616.938, "load_time_ms": 17.85, "load_throughput": 2460519.624, "learn_time_ms": 1120.25, "learn_throughput": 39205.552, "synch_weights_time_ms": 0.928}, "counters": {"num_env_steps_sampled": 45057360, "num_env_steps_trained": 45057360, "num_agent_steps_sampled": 45057360, "num_agent_steps_trained": 45057360}, "done": false, "episodes_total": 9199, "training_iteration": 2936, "trial_id": "3123b_00000", "date": "2023-08-07_14-33-42", "timestamp": 1691408022, "time_this_iter_s": 64.04972505569458, "time_total_s": 77748.43021535873, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 453.31136894226074, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.7978021978022, "ram_util_percent": 74.45164835164836}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.8684741317704, "policy_loss": -6683679.902440552, "vf_loss": 5992317.7487244895}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5145.5, "diff_num_grad_updates_vs_sampler_policy": 5144.5}}, "num_env_steps_sampled": 45101280, "num_env_steps_trained": 45101280, "num_agent_steps_sampled": 45101280, "num_agent_steps_trained": 45101280}, "sampler_results": {"episode_reward_max": -176810.0701395744, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178640.28920218896, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21823929680679094, "mean_inference_ms": 0.37447896245831935, "mean_action_processing_ms": 0.09210825070605555, "mean_env_wait_ms": 0.7597790788879154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003567337989807129, "StateBufferConnector_ms": 0.002720952033996582, "ViewRequirementAgentConnector_ms": 0.06882250308990479}}, "episode_reward_max": -176810.0701395744, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178640.28920218896, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21823929680679094, "mean_inference_ms": 0.37447896245831935, "mean_action_processing_ms": 0.09210825070605555, "mean_env_wait_ms": 0.7597790788879154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003567337989807129, "StateBufferConnector_ms": 0.002720952033996582, "ViewRequirementAgentConnector_ms": 0.06882250308990479}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45101280, "num_agent_steps_trained": 45101280, "num_env_steps_sampled": 45101280, "num_env_steps_trained": 45101280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 681.1293652399771, "num_env_steps_trained_throughput_per_sec": 681.1293652399771, "timesteps_total": 45101280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45101280, "timers": {"training_iteration_time_ms": 64721.755, "sample_time_ms": 63574.618, "load_time_ms": 17.902, "load_throughput": 2453403.898, "learn_time_ms": 1128.137, "learn_throughput": 38931.435, "synch_weights_time_ms": 0.927}, "counters": {"num_env_steps_sampled": 45101280, "num_env_steps_trained": 45101280, "num_agent_steps_sampled": 45101280, "num_agent_steps_trained": 45101280}, "done": false, "episodes_total": 9200, "training_iteration": 2937, "trial_id": "3123b_00000", "date": "2023-08-07_14-34-47", "timestamp": 1691408087, "time_this_iter_s": 64.48389983177185, "time_total_s": 77812.9141151905, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 517.7952687740326, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.182608695652174, "ram_util_percent": 74.61847826086957}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.0327130198131, "policy_loss": -5973625.159023096, "vf_loss": 6046518.736333819}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5831.5, "diff_num_grad_updates_vs_sampler_policy": 5830.5}}, "num_env_steps_sampled": 45145200, "num_env_steps_trained": 45145200, "num_agent_steps_sampled": 45145200, "num_agent_steps_trained": 45145200}, "sampler_results": {"episode_reward_max": -176810.0701395744, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178501.10497378177, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21823056099653143, "mean_inference_ms": 0.3744970212903195, "mean_action_processing_ms": 0.09210147086360643, "mean_env_wait_ms": 0.757644398407122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528594970703125, "StateBufferConnector_ms": 0.0026755862765842015, "ViewRequirementAgentConnector_ms": 0.06839699215359157}}, "episode_reward_max": -176810.0701395744, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178501.10497378177, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21823056099653143, "mean_inference_ms": 0.3744970212903195, "mean_action_processing_ms": 0.09210147086360643, "mean_env_wait_ms": 0.757644398407122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528594970703125, "StateBufferConnector_ms": 0.0026755862765842015, "ViewRequirementAgentConnector_ms": 0.06839699215359157}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45145200, "num_agent_steps_trained": 45145200, "num_env_steps_sampled": 45145200, "num_env_steps_trained": 45145200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 688.8163771184678, "num_env_steps_trained_throughput_per_sec": 688.8163771184678, "timesteps_total": 45145200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45145200, "timers": {"training_iteration_time_ms": 64615.063, "sample_time_ms": 63468.55, "load_time_ms": 17.887, "load_throughput": 2455442.333, "learn_time_ms": 1127.528, "learn_throughput": 38952.478, "synch_weights_time_ms": 0.93}, "counters": {"num_env_steps_sampled": 45145200, "num_env_steps_trained": 45145200, "num_agent_steps_sampled": 45145200, "num_agent_steps_trained": 45145200}, "done": false, "episodes_total": 9201, "training_iteration": 2938, "trial_id": "3123b_00000", "date": "2023-08-07_14-35-51", "timestamp": 1691408151, "time_this_iter_s": 63.76414680480957, "time_total_s": 77876.67826199532, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 581.5594155788422, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.13111111111111, "ram_util_percent": 74.69666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.864579537172, "policy_loss": -6314203.842010409, "vf_loss": 5956231.483782799}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6517.5, "diff_num_grad_updates_vs_sampler_policy": 6516.5}}, "num_env_steps_sampled": 45189120, "num_env_steps_trained": 45189120, "num_agent_steps_sampled": 45189120, "num_agent_steps_trained": 45189120}, "sampler_results": {"episode_reward_max": -176661.35587604702, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178317.1300640083, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21822796311751302, "mean_inference_ms": 0.37449997468827617, "mean_action_processing_ms": 0.09209448873207857, "mean_env_wait_ms": 0.75586000179245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004022121429443359, "StateBufferConnector_ms": 0.0026869773864746094, "ViewRequirementAgentConnector_ms": 0.06815910339355469}}, "episode_reward_max": -176661.35587604702, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178317.1300640083, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21822796311751302, "mean_inference_ms": 0.37449997468827617, "mean_action_processing_ms": 0.09209448873207857, "mean_env_wait_ms": 0.75586000179245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004022121429443359, "StateBufferConnector_ms": 0.0026869773864746094, "ViewRequirementAgentConnector_ms": 0.06815910339355469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45189120, "num_agent_steps_trained": 45189120, "num_env_steps_sampled": 45189120, "num_env_steps_trained": 45189120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 683.7715206262325, "num_env_steps_trained_throughput_per_sec": 683.7715206262325, "timesteps_total": 45189120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45189120, "timers": {"training_iteration_time_ms": 64576.753, "sample_time_ms": 63430.937, "load_time_ms": 17.762, "load_throughput": 2472705.391, "learn_time_ms": 1126.958, "learn_throughput": 38972.188, "synch_weights_time_ms": 0.929}, "counters": {"num_env_steps_sampled": 45189120, "num_env_steps_trained": 45189120, "num_agent_steps_sampled": 45189120, "num_agent_steps_trained": 45189120}, "done": false, "episodes_total": 9202, "training_iteration": 2939, "trial_id": "3123b_00000", "date": "2023-08-07_14-36-55", "timestamp": 1691408215, "time_this_iter_s": 64.235032081604, "time_total_s": 77940.91329407692, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 645.7944476604462, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.508791208791212, "ram_util_percent": 74.50549450549451}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.77290882522095, "policy_loss": -6984436.854258724, "vf_loss": 6075134.1840379005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7203.5, "diff_num_grad_updates_vs_sampler_policy": 7202.5}}, "num_env_steps_sampled": 45233040, "num_env_steps_trained": 45233040, "num_agent_steps_sampled": 45233040, "num_agent_steps_trained": 45233040}, "sampler_results": {"episode_reward_max": -176661.35587604702, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178315.73485791287, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21823444522985264, "mean_inference_ms": 0.3744996331400735, "mean_action_processing_ms": 0.09209028080407065, "mean_env_wait_ms": 0.7544047627775655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003936073996803977, "StateBufferConnector_ms": 0.0026681206443093038, "ViewRequirementAgentConnector_ms": 0.06809017874977806}}, "episode_reward_max": -176661.35587604702, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178315.73485791287, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21823444522985264, "mean_inference_ms": 0.3744996331400735, "mean_action_processing_ms": 0.09209028080407065, "mean_env_wait_ms": 0.7544047627775655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003936073996803977, "StateBufferConnector_ms": 0.0026681206443093038, "ViewRequirementAgentConnector_ms": 0.06809017874977806}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45233040, "num_agent_steps_trained": 45233040, "num_env_steps_sampled": 45233040, "num_env_steps_trained": 45233040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 679.6403703236529, "num_env_steps_trained_throughput_per_sec": 679.6403703236529, "timesteps_total": 45233040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45233040, "timers": {"training_iteration_time_ms": 64295.859, "sample_time_ms": 63150.226, "load_time_ms": 19.441, "load_throughput": 2259191.923, "learn_time_ms": 1125.093, "learn_throughput": 39036.779, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 45233040, "num_env_steps_trained": 45233040, "num_agent_steps_sampled": 45233040, "num_agent_steps_trained": 45233040}, "done": false, "episodes_total": 9203, "training_iteration": 2940, "trial_id": "3123b_00000", "date": "2023-08-07_14-38-00", "timestamp": 1691408280, "time_this_iter_s": 64.62517809867859, "time_total_s": 78005.5384721756, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 710.4196257591248, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.42857142857143, "ram_util_percent": 74.51648351648352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.9743965527059, "policy_loss": -6369457.367130558, "vf_loss": 6131995.990069242}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7889.5, "diff_num_grad_updates_vs_sampler_policy": 7888.5}}, "num_env_steps_sampled": 45276960, "num_env_steps_trained": 45276960, "num_agent_steps_sampled": 45276960, "num_agent_steps_trained": 45276960}, "sampler_results": {"episode_reward_max": -176661.35587604702, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178347.97023776968, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21823204680392674, "mean_inference_ms": 0.37449457575832096, "mean_action_processing_ms": 0.09208672006724566, "mean_env_wait_ms": 0.7531113905039772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038663546244303384, "StateBufferConnector_ms": 0.002672274907430013, "ViewRequirementAgentConnector_ms": 0.06821552912394206}}, "episode_reward_max": -176661.35587604702, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178347.97023776968, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21823204680392674, "mean_inference_ms": 0.37449457575832096, "mean_action_processing_ms": 0.09208672006724566, "mean_env_wait_ms": 0.7531113905039772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038663546244303384, "StateBufferConnector_ms": 0.002672274907430013, "ViewRequirementAgentConnector_ms": 0.06821552912394206}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45276960, "num_agent_steps_trained": 45276960, "num_env_steps_sampled": 45276960, "num_env_steps_trained": 45276960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 686.4074334981501, "num_env_steps_trained_throughput_per_sec": 686.4074334981501, "timesteps_total": 45276960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45276960, "timers": {"training_iteration_time_ms": 64236.225, "sample_time_ms": 63091.34, "load_time_ms": 19.09, "load_throughput": 2300633.959, "learn_time_ms": 1124.694, "learn_throughput": 39050.627, "synch_weights_time_ms": 0.933}, "counters": {"num_env_steps_sampled": 45276960, "num_env_steps_trained": 45276960, "num_agent_steps_sampled": 45276960, "num_agent_steps_trained": 45276960}, "done": false, "episodes_total": 9204, "training_iteration": 2941, "trial_id": "3123b_00000", "date": "2023-08-07_14-39-04", "timestamp": 1691408344, "time_this_iter_s": 63.9879469871521, "time_total_s": 78069.52641916275, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 774.4075727462769, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.24615384615385, "ram_util_percent": 74.45604395604396}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.819702059465, "policy_loss": -5971612.17412992, "vf_loss": 5869237.751822158}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8575.5, "diff_num_grad_updates_vs_sampler_policy": 8574.5}}, "num_env_steps_sampled": 45320880, "num_env_steps_trained": 45320880, "num_agent_steps_sampled": 45320880, "num_agent_steps_trained": 45320880}, "sampler_results": {"episode_reward_max": -175785.24261507037, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178150.8373437159, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182288823844776, "mean_inference_ms": 0.37448230128009824, "mean_action_processing_ms": 0.0920826309431977, "mean_env_wait_ms": 0.7519534443583507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038312031672551082, "StateBufferConnector_ms": 0.0027014659001277043, "ViewRequirementAgentConnector_ms": 0.06821522345909706}}, "episode_reward_max": -175785.24261507037, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -178150.8373437159, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182288823844776, "mean_inference_ms": 0.37448230128009824, "mean_action_processing_ms": 0.0920826309431977, "mean_env_wait_ms": 0.7519534443583507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038312031672551082, "StateBufferConnector_ms": 0.0027014659001277043, "ViewRequirementAgentConnector_ms": 0.06821522345909706}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45320880, "num_agent_steps_trained": 45320880, "num_env_steps_sampled": 45320880, "num_env_steps_trained": 45320880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 686.3208090320459, "num_env_steps_trained_throughput_per_sec": 686.3208090320459, "timesteps_total": 45320880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45320880, "timers": {"training_iteration_time_ms": 64199.648, "sample_time_ms": 63053.73, "load_time_ms": 18.781, "load_throughput": 2338507.602, "learn_time_ms": 1126.038, "learn_throughput": 39004.011, "synch_weights_time_ms": 0.932}, "counters": {"num_env_steps_sampled": 45320880, "num_env_steps_trained": 45320880, "num_agent_steps_sampled": 45320880, "num_agent_steps_trained": 45320880}, "done": false, "episodes_total": 9205, "training_iteration": 2942, "trial_id": "3123b_00000", "date": "2023-08-07_14-40-08", "timestamp": 1691408408, "time_this_iter_s": 63.99616622924805, "time_total_s": 78133.522585392, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 838.4037389755249, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.97, "ram_util_percent": 74.47777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.04122955945076, "policy_loss": -6011109.048011001, "vf_loss": 5796784.834548105}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9261.5, "diff_num_grad_updates_vs_sampler_policy": 9260.5}}, "num_env_steps_sampled": 45364800, "num_env_steps_trained": 45364800, "num_agent_steps_sampled": 45364800, "num_agent_steps_trained": 45364800}, "sampler_results": {"episode_reward_max": -174564.1035742647, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177894.6420744694, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21822818189587403, "mean_inference_ms": 0.37446855260339884, "mean_action_processing_ms": 0.09207870535679984, "mean_env_wait_ms": 0.7509042004402874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037823404584612164, "StateBufferConnector_ms": 0.002697535923549107, "ViewRequirementAgentConnector_ms": 0.06798676082066127}}, "episode_reward_max": -174564.1035742647, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177894.6420744694, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21822818189587403, "mean_inference_ms": 0.37446855260339884, "mean_action_processing_ms": 0.09207870535679984, "mean_env_wait_ms": 0.7509042004402874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037823404584612164, "StateBufferConnector_ms": 0.002697535923549107, "ViewRequirementAgentConnector_ms": 0.06798676082066127}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45364800, "num_agent_steps_trained": 45364800, "num_env_steps_sampled": 45364800, "num_env_steps_trained": 45364800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 686.438674100684, "num_env_steps_trained_throughput_per_sec": 686.438674100684, "timesteps_total": 45364800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45364800, "timers": {"training_iteration_time_ms": 64133.369, "sample_time_ms": 62987.185, "load_time_ms": 18.544, "load_throughput": 2368435.467, "learn_time_ms": 1126.549, "learn_throughput": 38986.318, "synch_weights_time_ms": 0.926}, "counters": {"num_env_steps_sampled": 45364800, "num_env_steps_trained": 45364800, "num_agent_steps_sampled": 45364800, "num_agent_steps_trained": 45364800}, "done": false, "episodes_total": 9206, "training_iteration": 2943, "trial_id": "3123b_00000", "date": "2023-08-07_14-41-12", "timestamp": 1691408472, "time_this_iter_s": 63.985008001327515, "time_total_s": 78197.50759339333, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 902.3887469768524, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.675824175824175, "ram_util_percent": 74.44285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.8955115493463, "policy_loss": -6038237.68152674, "vf_loss": 5979441.028425656}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9947.5, "diff_num_grad_updates_vs_sampler_policy": 9946.5}}, "num_env_steps_sampled": 45408720, "num_env_steps_trained": 45408720, "num_agent_steps_sampled": 45408720, "num_agent_steps_trained": 45408720}, "sampler_results": {"episode_reward_max": -174564.1035742647, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177807.0897596785, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21823496268104467, "mean_inference_ms": 0.37445383196936954, "mean_action_processing_ms": 0.09207513342258132, "mean_env_wait_ms": 0.7499341480484779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037431716918945312, "StateBufferConnector_ms": 0.002689361572265625, "ViewRequirementAgentConnector_ms": 0.06786505381266277}}, "episode_reward_max": -174564.1035742647, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177807.0897596785, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21823496268104467, "mean_inference_ms": 0.37445383196936954, "mean_action_processing_ms": 0.09207513342258132, "mean_env_wait_ms": 0.7499341480484779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037431716918945312, "StateBufferConnector_ms": 0.002689361572265625, "ViewRequirementAgentConnector_ms": 0.06786505381266277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45408720, "num_agent_steps_trained": 45408720, "num_env_steps_sampled": 45408720, "num_env_steps_trained": 45408720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 687.2757490239514, "num_env_steps_trained_throughput_per_sec": 687.2757490239514, "timesteps_total": 45408720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45408720, "timers": {"training_iteration_time_ms": 64081.834, "sample_time_ms": 62934.71, "load_time_ms": 17.911, "load_throughput": 2452123.706, "learn_time_ms": 1128.127, "learn_throughput": 38931.775, "synch_weights_time_ms": 0.92}, "counters": {"num_env_steps_sampled": 45408720, "num_env_steps_trained": 45408720, "num_agent_steps_sampled": 45408720, "num_agent_steps_trained": 45408720}, "done": false, "episodes_total": 9207, "training_iteration": 2944, "trial_id": "3123b_00000", "date": "2023-08-07_14-42-16", "timestamp": 1691408536, "time_this_iter_s": 63.90740895271301, "time_total_s": 78261.41500234604, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 966.2961559295654, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.96777777777778, "ram_util_percent": 74.49555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.0461175323575, "policy_loss": -5885452.844851836, "vf_loss": 5926048.908163265}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10633.5, "diff_num_grad_updates_vs_sampler_policy": 10632.5}}, "num_env_steps_sampled": 45452640, "num_env_steps_trained": 45452640, "num_agent_steps_sampled": 45452640, "num_agent_steps_trained": 45452640}, "sampler_results": {"episode_reward_max": -174564.1035742647, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177705.89116550563, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182464687764433, "mean_inference_ms": 0.374438492642678, "mean_action_processing_ms": 0.09207162461305904, "mean_env_wait_ms": 0.7490361498389012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037148594856262207, "StateBufferConnector_ms": 0.0026717782020568848, "ViewRequirementAgentConnector_ms": 0.06774961948394775}}, "episode_reward_max": -174564.1035742647, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177705.89116550563, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182464687764433, "mean_inference_ms": 0.374438492642678, "mean_action_processing_ms": 0.09207162461305904, "mean_env_wait_ms": 0.7490361498389012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037148594856262207, "StateBufferConnector_ms": 0.0026717782020568848, "ViewRequirementAgentConnector_ms": 0.06774961948394775}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45452640, "num_agent_steps_trained": 45452640, "num_env_steps_sampled": 45452640, "num_env_steps_trained": 45452640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 687.3703681376278, "num_env_steps_trained_throughput_per_sec": 687.3703681376278, "timesteps_total": 45452640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45452640, "timers": {"training_iteration_time_ms": 64090.504, "sample_time_ms": 62943.344, "load_time_ms": 17.795, "load_throughput": 2468136.786, "learn_time_ms": 1128.283, "learn_throughput": 38926.402, "synch_weights_time_ms": 0.917}, "counters": {"num_env_steps_sampled": 45452640, "num_env_steps_trained": 45452640, "num_agent_steps_sampled": 45452640, "num_agent_steps_trained": 45452640}, "done": false, "episodes_total": 9208, "training_iteration": 2945, "trial_id": "3123b_00000", "date": "2023-08-07_14-43-19", "timestamp": 1691408599, "time_this_iter_s": 63.89829397201538, "time_total_s": 78325.31329631805, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1030.1944499015808, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.252747252747252, "ram_util_percent": 74.45054945054943}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.96957673275784, "policy_loss": -6064335.138153699, "vf_loss": 6086456.695153061}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11319.5, "diff_num_grad_updates_vs_sampler_policy": 11318.5}}, "num_env_steps_sampled": 45496560, "num_env_steps_trained": 45496560, "num_agent_steps_sampled": 45496560, "num_agent_steps_trained": 45496560}, "sampler_results": {"episode_reward_max": -174564.1035742647, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177715.23254965036, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21825171575811353, "mean_inference_ms": 0.37442732958688535, "mean_action_processing_ms": 0.09206959021383018, "mean_env_wait_ms": 0.7481849446589373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038343317368451286, "StateBufferConnector_ms": 0.0026801053215475645, "ViewRequirementAgentConnector_ms": 0.06782307344324448}}, "episode_reward_max": -174564.1035742647, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177715.23254965036, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21825171575811353, "mean_inference_ms": 0.37442732958688535, "mean_action_processing_ms": 0.09206959021383018, "mean_env_wait_ms": 0.7481849446589373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038343317368451286, "StateBufferConnector_ms": 0.0026801053215475645, "ViewRequirementAgentConnector_ms": 0.06782307344324448}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45496560, "num_agent_steps_trained": 45496560, "num_env_steps_sampled": 45496560, "num_env_steps_trained": 45496560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 690.3014132185681, "num_env_steps_trained_throughput_per_sec": 690.3014132185681, "timesteps_total": 45496560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45496560, "timers": {"training_iteration_time_ms": 64048.255, "sample_time_ms": 62901.521, "load_time_ms": 17.878, "load_throughput": 2456633.167, "learn_time_ms": 1127.77, "learn_throughput": 38944.098, "synch_weights_time_ms": 0.92}, "counters": {"num_env_steps_sampled": 45496560, "num_env_steps_trained": 45496560, "num_agent_steps_sampled": 45496560, "num_agent_steps_trained": 45496560}, "done": false, "episodes_total": 9209, "training_iteration": 2946, "trial_id": "3123b_00000", "date": "2023-08-07_14-44-23", "timestamp": 1691408663, "time_this_iter_s": 63.627463817596436, "time_total_s": 78388.94076013565, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1093.8219137191772, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.202222222222222, "ram_util_percent": 74.43111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-15, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.99336109216983, "policy_loss": -6180596.857151398, "vf_loss": 5781722.648323615}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12005.5, "diff_num_grad_updates_vs_sampler_policy": 12004.5}}, "num_env_steps_sampled": 45540480, "num_env_steps_trained": 45540480, "num_agent_steps_sampled": 45540480, "num_agent_steps_trained": 45540480}, "sampler_results": {"episode_reward_max": -173968.69105125053, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177507.0913552948, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182603581398058, "mean_inference_ms": 0.3744181462673857, "mean_action_processing_ms": 0.09206878495654021, "mean_env_wait_ms": 0.7473919846295316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038120481703016493, "StateBufferConnector_ms": 0.0026782353719075522, "ViewRequirementAgentConnector_ms": 0.0679228040907118}}, "episode_reward_max": -173968.69105125053, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177507.0913552948, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182603581398058, "mean_inference_ms": 0.3744181462673857, "mean_action_processing_ms": 0.09206878495654021, "mean_env_wait_ms": 0.7473919846295316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038120481703016493, "StateBufferConnector_ms": 0.0026782353719075522, "ViewRequirementAgentConnector_ms": 0.0679228040907118}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45540480, "num_agent_steps_trained": 45540480, "num_env_steps_sampled": 45540480, "num_env_steps_trained": 45540480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 687.2420862283859, "num_env_steps_trained_throughput_per_sec": 687.2420862283859, "timesteps_total": 45540480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45540480, "timers": {"training_iteration_time_ms": 63990.902, "sample_time_ms": 62850.078, "load_time_ms": 17.833, "load_throughput": 2462847.245, "learn_time_ms": 1121.907, "learn_throughput": 39147.638, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 45540480, "num_env_steps_trained": 45540480, "num_agent_steps_sampled": 45540480, "num_agent_steps_trained": 45540480}, "done": false, "episodes_total": 9210, "training_iteration": 2947, "trial_id": "3123b_00000", "date": "2023-08-07_14-45-27", "timestamp": 1691408727, "time_this_iter_s": 63.910555839538574, "time_total_s": 78452.85131597519, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1157.7324695587158, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.982417582417582, "ram_util_percent": 74.47692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.333333333333334e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.9545905555303, "policy_loss": -6539016.61948228, "vf_loss": 6061505.560951166}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12691.5, "diff_num_grad_updates_vs_sampler_policy": 12690.5}}, "num_env_steps_sampled": 45584400, "num_env_steps_trained": 45584400, "num_agent_steps_sampled": 45584400, "num_agent_steps_trained": 45584400}, "sampler_results": {"episode_reward_max": -173968.69105125053, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177508.87219533845, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21826713403853665, "mean_inference_ms": 0.37441314218967114, "mean_action_processing_ms": 0.0920678543787316, "mean_env_wait_ms": 0.7466598671000415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037745425575657896, "StateBufferConnector_ms": 0.002674052589818051, "ViewRequirementAgentConnector_ms": 0.06803211412931744}}, "episode_reward_max": -173968.69105125053, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177508.87219533845, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21826713403853665, "mean_inference_ms": 0.37441314218967114, "mean_action_processing_ms": 0.0920678543787316, "mean_env_wait_ms": 0.7466598671000415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037745425575657896, "StateBufferConnector_ms": 0.002674052589818051, "ViewRequirementAgentConnector_ms": 0.06803211412931744}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45584400, "num_agent_steps_trained": 45584400, "num_env_steps_sampled": 45584400, "num_env_steps_trained": 45584400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 686.3858501383364, "num_env_steps_trained_throughput_per_sec": 686.3858501383364, "timesteps_total": 45584400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45584400, "timers": {"training_iteration_time_ms": 64013.481, "sample_time_ms": 62872.464, "load_time_ms": 17.748, "load_throughput": 2474638.628, "learn_time_ms": 1122.18, "learn_throughput": 39138.098, "synch_weights_time_ms": 0.927}, "counters": {"num_env_steps_sampled": 45584400, "num_env_steps_trained": 45584400, "num_agent_steps_sampled": 45584400, "num_agent_steps_trained": 45584400}, "done": false, "episodes_total": 9211, "training_iteration": 2948, "trial_id": "3123b_00000", "date": "2023-08-07_14-46-31", "timestamp": 1691408791, "time_this_iter_s": 63.9899697303772, "time_total_s": 78516.84128570557, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1221.722439289093, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.392222222222223, "ram_util_percent": 74.45888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.666666666666669e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.0675256578985, "policy_loss": -6258324.7116763275, "vf_loss": 6127153.650510204}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13377.5, "diff_num_grad_updates_vs_sampler_policy": 13376.5}}, "num_env_steps_sampled": 45628320, "num_env_steps_trained": 45628320, "num_agent_steps_sampled": 45628320, "num_agent_steps_trained": 45628320}, "sampler_results": {"episode_reward_max": -173968.69105125053, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177528.74314961024, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21827461253605093, "mean_inference_ms": 0.3744101618728202, "mean_action_processing_ms": 0.09206772266030036, "mean_env_wait_ms": 0.7459870723317035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003745555877685547, "StateBufferConnector_ms": 0.0026679039001464844, "ViewRequirementAgentConnector_ms": 0.0679171085357666}}, "episode_reward_max": -173968.69105125053, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177528.74314961024, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21827461253605093, "mean_inference_ms": 0.3744101618728202, "mean_action_processing_ms": 0.09206772266030036, "mean_env_wait_ms": 0.7459870723317035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003745555877685547, "StateBufferConnector_ms": 0.0026679039001464844, "ViewRequirementAgentConnector_ms": 0.0679171085357666}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45628320, "num_agent_steps_trained": 45628320, "num_env_steps_sampled": 45628320, "num_env_steps_trained": 45628320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 684.9498898243037, "num_env_steps_trained_throughput_per_sec": 684.9498898243037, "timesteps_total": 45628320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45628320, "timers": {"training_iteration_time_ms": 64002.431, "sample_time_ms": 62862.022, "load_time_ms": 17.772, "load_throughput": 2471265.733, "learn_time_ms": 1121.54, "learn_throughput": 39160.444, "synch_weights_time_ms": 0.935}, "counters": {"num_env_steps_sampled": 45628320, "num_env_steps_trained": 45628320, "num_agent_steps_sampled": 45628320, "num_agent_steps_trained": 45628320}, "done": false, "episodes_total": 9212, "training_iteration": 2949, "trial_id": "3123b_00000", "date": "2023-08-07_14-47-35", "timestamp": 1691408855, "time_this_iter_s": 64.12416386604309, "time_total_s": 78580.96544957161, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1285.846603155136, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.046153846153846, "ram_util_percent": 74.51428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.93225546967534, "policy_loss": -6233091.874859068, "vf_loss": 6255547.27268586}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14063.5, "diff_num_grad_updates_vs_sampler_policy": 14062.5}}, "num_env_steps_sampled": 45672240, "num_env_steps_trained": 45672240, "num_agent_steps_sampled": 45672240, "num_agent_steps_trained": 45672240}, "sampler_results": {"episode_reward_max": -173968.69105125053, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177649.65591682674, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828462814693442, "mean_inference_ms": 0.37440976762941097, "mean_action_processing_ms": 0.09206753065216425, "mean_env_wait_ms": 0.7453714203381476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037204651605515253, "StateBufferConnector_ms": 0.0027849560692196802, "ViewRequirementAgentConnector_ms": 0.06800719669886998}}, "episode_reward_max": -173968.69105125053, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177649.65591682674, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828462814693442, "mean_inference_ms": 0.37440976762941097, "mean_action_processing_ms": 0.09206753065216425, "mean_env_wait_ms": 0.7453714203381476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037204651605515253, "StateBufferConnector_ms": 0.0027849560692196802, "ViewRequirementAgentConnector_ms": 0.06800719669886998}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45672240, "num_agent_steps_trained": 45672240, "num_env_steps_sampled": 45672240, "num_env_steps_trained": 45672240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 683.4754739198683, "num_env_steps_trained_throughput_per_sec": 683.4754739198683, "timesteps_total": 45672240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45672240, "timers": {"training_iteration_time_ms": 63966.17, "sample_time_ms": 62826.138, "load_time_ms": 17.767, "load_throughput": 2472018.525, "learn_time_ms": 1121.166, "learn_throughput": 39173.514, "synch_weights_time_ms": 0.941}, "counters": {"num_env_steps_sampled": 45672240, "num_env_steps_trained": 45672240, "num_agent_steps_sampled": 45672240, "num_agent_steps_trained": 45672240}, "done": false, "episodes_total": 9213, "training_iteration": 2950, "trial_id": "3123b_00000", "date": "2023-08-07_14-48-39", "timestamp": 1691408919, "time_this_iter_s": 64.26256990432739, "time_total_s": 78645.22801947594, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1350.1091730594635, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.86923076923077, "ram_util_percent": 74.47802197802196}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.92146866245105, "policy_loss": -6357212.817980708, "vf_loss": 6232678.809766764}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14749.5, "diff_num_grad_updates_vs_sampler_policy": 14748.5}}, "num_env_steps_sampled": 45716160, "num_env_steps_trained": 45716160, "num_agent_steps_sampled": 45716160, "num_agent_steps_trained": 45716160}, "sampler_results": {"episode_reward_max": -173968.69105125053, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177757.11952787774, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21829156367701766, "mean_inference_ms": 0.37441076318714384, "mean_action_processing_ms": 0.09206707746204548, "mean_env_wait_ms": 0.7447955172839915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037009065801447086, "StateBufferConnector_ms": 0.002774325284090909, "ViewRequirementAgentConnector_ms": 0.06804357875477184}}, "episode_reward_max": -173968.69105125053, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177757.11952787774, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21829156367701766, "mean_inference_ms": 0.37441076318714384, "mean_action_processing_ms": 0.09206707746204548, "mean_env_wait_ms": 0.7447955172839915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037009065801447086, "StateBufferConnector_ms": 0.002774325284090909, "ViewRequirementAgentConnector_ms": 0.06804357875477184}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45716160, "num_agent_steps_trained": 45716160, "num_env_steps_sampled": 45716160, "num_env_steps_trained": 45716160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 687.14129704318, "num_env_steps_trained_throughput_per_sec": 687.14129704318, "timesteps_total": 45716160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45716160, "timers": {"training_iteration_time_ms": 63959.336, "sample_time_ms": 62819.099, "load_time_ms": 17.698, "load_throughput": 2481575.907, "learn_time_ms": 1121.45, "learn_throughput": 39163.6, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 45716160, "num_env_steps_trained": 45716160, "num_agent_steps_sampled": 45716160, "num_agent_steps_trained": 45716160}, "done": false, "episodes_total": 9214, "training_iteration": 2951, "trial_id": "3123b_00000", "date": "2023-08-07_14-49-43", "timestamp": 1691408983, "time_this_iter_s": 63.91948080062866, "time_total_s": 78709.14750027657, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1414.0286538600922, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.697802197802194, "ram_util_percent": 74.4175824175824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.17515692975013, "policy_loss": -4723457.9045018675, "vf_loss": 5735757.144041545}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15435.5, "diff_num_grad_updates_vs_sampler_policy": 15434.5}}, "num_env_steps_sampled": 45760080, "num_env_steps_trained": 45760080, "num_agent_steps_sampled": 45760080, "num_agent_steps_trained": 45760080}, "sampler_results": {"episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177537.71946261745, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182973097977589, "mean_inference_ms": 0.37441028904788215, "mean_action_processing_ms": 0.0920668396796526, "mean_env_wait_ms": 0.7442090012599133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036851219508958898, "StateBufferConnector_ms": 0.002776021542756454, "ViewRequirementAgentConnector_ms": 0.06805088209069293}}, "episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177537.71946261745, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182973097977589, "mean_inference_ms": 0.37441028904788215, "mean_action_processing_ms": 0.0920668396796526, "mean_env_wait_ms": 0.7442090012599133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036851219508958898, "StateBufferConnector_ms": 0.002776021542756454, "ViewRequirementAgentConnector_ms": 0.06805088209069293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45760080, "num_agent_steps_trained": 45760080, "num_env_steps_sampled": 45760080, "num_env_steps_trained": 45760080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 699.0467379773112, "num_env_steps_trained_throughput_per_sec": 699.0467379773112, "timesteps_total": 45760080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45760080, "timers": {"training_iteration_time_ms": 63842.838, "sample_time_ms": 62702.654, "load_time_ms": 17.504, "load_throughput": 2509079.156, "learn_time_ms": 1121.586, "learn_throughput": 39158.84, "synch_weights_time_ms": 0.936}, "counters": {"num_env_steps_sampled": 45760080, "num_env_steps_trained": 45760080, "num_agent_steps_sampled": 45760080, "num_agent_steps_trained": 45760080}, "done": false, "episodes_total": 9215, "training_iteration": 2952, "trial_id": "3123b_00000", "date": "2023-08-07_14-50-46", "timestamp": 1691409046, "time_this_iter_s": 62.831223011016846, "time_total_s": 78771.97872328758, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1476.859876871109, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.5314606741573, "ram_util_percent": 74.40449438202246}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.8591956758638, "policy_loss": -5861774.0307460595, "vf_loss": 5943433.522412537}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16121.5, "diff_num_grad_updates_vs_sampler_policy": 16120.5}}, "num_env_steps_sampled": 45804000, "num_env_steps_trained": 45804000, "num_agent_steps_sampled": 45804000, "num_agent_steps_trained": 45804000}, "sampler_results": {"episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177479.80120913932, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21830346643726214, "mean_inference_ms": 0.3744097995943891, "mean_action_processing_ms": 0.09206665947003927, "mean_env_wait_ms": 0.74365318928455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037888685862223306, "StateBufferConnector_ms": 0.002769629160563151, "ViewRequirementAgentConnector_ms": 0.0680704911549886}}, "episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177479.80120913932, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21830346643726214, "mean_inference_ms": 0.3744097995943891, "mean_action_processing_ms": 0.09206665947003927, "mean_env_wait_ms": 0.74365318928455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037888685862223306, "StateBufferConnector_ms": 0.002769629160563151, "ViewRequirementAgentConnector_ms": 0.0680704911549886}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45804000, "num_agent_steps_trained": 45804000, "num_env_steps_sampled": 45804000, "num_env_steps_trained": 45804000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 688.8041842676979, "num_env_steps_trained_throughput_per_sec": 688.8041842676979, "timesteps_total": 45804000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45804000, "timers": {"training_iteration_time_ms": 63820.865, "sample_time_ms": 62681.447, "load_time_ms": 17.462, "load_throughput": 2515173.628, "learn_time_ms": 1120.848, "learn_throughput": 39184.621, "synch_weights_time_ms": 0.949}, "counters": {"num_env_steps_sampled": 45804000, "num_env_steps_trained": 45804000, "num_agent_steps_sampled": 45804000, "num_agent_steps_trained": 45804000}, "done": false, "episodes_total": 9216, "training_iteration": 2953, "trial_id": "3123b_00000", "date": "2023-08-07_14-51-50", "timestamp": 1691409110, "time_this_iter_s": 63.765604972839355, "time_total_s": 78835.74432826042, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1540.6254818439484, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.72888888888889, "ram_util_percent": 74.43555555555554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.01923795205164, "policy_loss": -5606756.50353043, "vf_loss": 5911651.631104227}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16807.5, "diff_num_grad_updates_vs_sampler_policy": 16806.5}}, "num_env_steps_sampled": 45847920, "num_env_steps_trained": 45847920, "num_agent_steps_sampled": 45847920, "num_agent_steps_trained": 45847920}, "sampler_results": {"episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177413.57466018383, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21830637540908002, "mean_inference_ms": 0.37440981478164653, "mean_action_processing_ms": 0.09206660284086303, "mean_env_wait_ms": 0.7431370020391657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00376129150390625, "StateBufferConnector_ms": 0.0027589797973632812, "ViewRequirementAgentConnector_ms": 0.068023681640625}}, "episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177413.57466018383, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21830637540908002, "mean_inference_ms": 0.37440981478164653, "mean_action_processing_ms": 0.09206660284086303, "mean_env_wait_ms": 0.7431370020391657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00376129150390625, "StateBufferConnector_ms": 0.0027589797973632812, "ViewRequirementAgentConnector_ms": 0.068023681640625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45847920, "num_agent_steps_trained": 45847920, "num_env_steps_sampled": 45847920, "num_env_steps_trained": 45847920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 686.3242073125878, "num_env_steps_trained_throughput_per_sec": 686.3242073125878, "timesteps_total": 45847920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45847920, "timers": {"training_iteration_time_ms": 63829.725, "sample_time_ms": 62691.485, "load_time_ms": 17.345, "load_throughput": 2532068.837, "learn_time_ms": 1119.784, "learn_throughput": 39221.845, "synch_weights_time_ms": 0.952}, "counters": {"num_env_steps_sampled": 45847920, "num_env_steps_trained": 45847920, "num_agent_steps_sampled": 45847920, "num_agent_steps_trained": 45847920}, "done": false, "episodes_total": 9217, "training_iteration": 2954, "trial_id": "3123b_00000", "date": "2023-08-07_14-52-54", "timestamp": 1691409174, "time_this_iter_s": 63.99589204788208, "time_total_s": 78899.7402203083, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1604.6213738918304, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 19.135164835164833, "ram_util_percent": 74.48021978021978}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.0025276206325, "policy_loss": -5712641.476477087, "vf_loss": 5997418.259293003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17493.5, "diff_num_grad_updates_vs_sampler_policy": 17492.5}}, "num_env_steps_sampled": 45891840, "num_env_steps_trained": 45891840, "num_agent_steps_sampled": 45891840, "num_agent_steps_trained": 45891840}, "sampler_results": {"episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177375.66207410602, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2183079567085704, "mean_inference_ms": 0.37441088715345655, "mean_action_processing_ms": 0.09206661137053568, "mean_env_wait_ms": 0.7426297283228708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037523416372445915, "StateBufferConnector_ms": 0.002754651583158053, "ViewRequirementAgentConnector_ms": 0.06793737411499023}}, "episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177375.66207410602, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2183079567085704, "mean_inference_ms": 0.37441088715345655, "mean_action_processing_ms": 0.09206661137053568, "mean_env_wait_ms": 0.7426297283228708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037523416372445915, "StateBufferConnector_ms": 0.002754651583158053, "ViewRequirementAgentConnector_ms": 0.06793737411499023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45891840, "num_agent_steps_trained": 45891840, "num_env_steps_sampled": 45891840, "num_env_steps_trained": 45891840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 694.2223413257185, "num_env_steps_trained_throughput_per_sec": 694.2223413257185, "timesteps_total": 45891840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45891840, "timers": {"training_iteration_time_ms": 63766.66, "sample_time_ms": 62628.854, "load_time_ms": 17.464, "load_throughput": 2514857.73, "learn_time_ms": 1119.234, "learn_throughput": 39241.12, "synch_weights_time_ms": 0.949}, "counters": {"num_env_steps_sampled": 45891840, "num_env_steps_trained": 45891840, "num_agent_steps_sampled": 45891840, "num_agent_steps_trained": 45891840}, "done": false, "episodes_total": 9218, "training_iteration": 2955, "trial_id": "3123b_00000", "date": "2023-08-07_14-53-57", "timestamp": 1691409237, "time_this_iter_s": 63.26754808425903, "time_total_s": 78963.00776839256, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1667.8889219760895, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 18.447191011235958, "ram_util_percent": 74.1438202247191}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.9933302631879, "policy_loss": -5262312.291436999, "vf_loss": 6031993.827259475}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18179.5, "diff_num_grad_updates_vs_sampler_policy": 18178.5}}, "num_env_steps_sampled": 45935760, "num_env_steps_trained": 45935760, "num_agent_steps_sampled": 45935760, "num_agent_steps_trained": 45935760}, "sampler_results": {"episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177357.02298207508, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21830951872406276, "mean_inference_ms": 0.3744131641445889, "mean_action_processing_ms": 0.092067113701923, "mean_env_wait_ms": 0.7421366089977132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00373875653302228, "StateBufferConnector_ms": 0.00274622881854022, "ViewRequirementAgentConnector_ms": 0.06789366404215495}}, "episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177357.02298207508, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21830951872406276, "mean_inference_ms": 0.3744131641445889, "mean_action_processing_ms": 0.092067113701923, "mean_env_wait_ms": 0.7421366089977132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00373875653302228, "StateBufferConnector_ms": 0.00274622881854022, "ViewRequirementAgentConnector_ms": 0.06789366404215495}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45935760, "num_agent_steps_trained": 45935760, "num_env_steps_sampled": 45935760, "num_env_steps_trained": 45935760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 692.2010233810729, "num_env_steps_trained_throughput_per_sec": 692.2010233810729, "timesteps_total": 45935760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45935760, "timers": {"training_iteration_time_ms": 63749.2, "sample_time_ms": 62612.033, "load_time_ms": 17.481, "load_throughput": 2512412.208, "learn_time_ms": 1118.576, "learn_throughput": 39264.222, "synch_weights_time_ms": 0.953}, "counters": {"num_env_steps_sampled": 45935760, "num_env_steps_trained": 45935760, "num_agent_steps_sampled": 45935760, "num_agent_steps_trained": 45935760}, "done": false, "episodes_total": 9219, "training_iteration": 2956, "trial_id": "3123b_00000", "date": "2023-08-07_14-55-01", "timestamp": 1691409301, "time_this_iter_s": 63.45238280296326, "time_total_s": 79026.46015119553, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1731.3413047790527, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 18.3, "ram_util_percent": 73.17777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.9836536107188, "policy_loss": -6134698.311566144, "vf_loss": 6021834.625819971}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18865.5, "diff_num_grad_updates_vs_sampler_policy": 18864.5}}, "num_env_steps_sampled": 45979680, "num_env_steps_trained": 45979680, "num_agent_steps_sampled": 45979680, "num_agent_steps_trained": 45979680}, "sampler_results": {"episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177359.09537185394, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2183119793934245, "mean_inference_ms": 0.37441469421025747, "mean_action_processing_ms": 0.09206740698339634, "mean_env_wait_ms": 0.7416731602859574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037269932883126394, "StateBufferConnector_ms": 0.002750328608921596, "ViewRequirementAgentConnector_ms": 0.06785733359200614}}, "episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177359.09537185394, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2183119793934245, "mean_inference_ms": 0.37441469421025747, "mean_action_processing_ms": 0.09206740698339634, "mean_env_wait_ms": 0.7416731602859574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037269932883126394, "StateBufferConnector_ms": 0.002750328608921596, "ViewRequirementAgentConnector_ms": 0.06785733359200614}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45979680, "num_agent_steps_trained": 45979680, "num_env_steps_sampled": 45979680, "num_env_steps_trained": 45979680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 686.959342824529, "num_env_steps_trained_throughput_per_sec": 686.959342824529, "timesteps_total": 45979680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 45979680, "timers": {"training_iteration_time_ms": 63751.83, "sample_time_ms": 62615.409, "load_time_ms": 17.411, "load_throughput": 2522582.148, "learn_time_ms": 1117.893, "learn_throughput": 39288.204, "synch_weights_time_ms": 0.961}, "counters": {"num_env_steps_sampled": 45979680, "num_env_steps_trained": 45979680, "num_agent_steps_sampled": 45979680, "num_agent_steps_trained": 45979680}, "done": false, "episodes_total": 9220, "training_iteration": 2957, "trial_id": "3123b_00000", "date": "2023-08-07_14-56-05", "timestamp": 1691409365, "time_this_iter_s": 63.93651294708252, "time_total_s": 79090.39666414261, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1795.2778177261353, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 18.196703296703294, "ram_util_percent": 73.1054945054945}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.9580964736271, "policy_loss": -6326127.0179026965, "vf_loss": 6129565.250728863}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19551.5, "diff_num_grad_updates_vs_sampler_policy": 19550.5}}, "num_env_steps_sampled": 46023600, "num_env_steps_trained": 46023600, "num_agent_steps_sampled": 46023600, "num_agent_steps_trained": 46023600}, "sampler_results": {"episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177389.41668858222, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21831391280513895, "mean_inference_ms": 0.37441629774095214, "mean_action_processing_ms": 0.09206760266170276, "mean_env_wait_ms": 0.7412344968796977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00380072100409146, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.0677297855245656}}, "episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177389.41668858222, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21831391280513895, "mean_inference_ms": 0.37441629774095214, "mean_action_processing_ms": 0.09206760266170276, "mean_env_wait_ms": 0.7412344968796977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00380072100409146, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.0677297855245656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46023600, "num_agent_steps_trained": 46023600, "num_env_steps_sampled": 46023600, "num_env_steps_trained": 46023600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 687.9803110486963, "num_env_steps_trained_throughput_per_sec": 687.9803110486963, "timesteps_total": 46023600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46023600, "timers": {"training_iteration_time_ms": 63737.0, "sample_time_ms": 62601.345, "load_time_ms": 17.531, "load_throughput": 2505230.148, "learn_time_ms": 1117.009, "learn_throughput": 39319.295, "synch_weights_time_ms": 0.958}, "counters": {"num_env_steps_sampled": 46023600, "num_env_steps_trained": 46023600, "num_agent_steps_sampled": 46023600, "num_agent_steps_trained": 46023600}, "done": false, "episodes_total": 9221, "training_iteration": 2958, "trial_id": "3123b_00000", "date": "2023-08-07_14-57-09", "timestamp": 1691409429, "time_this_iter_s": 63.84180927276611, "time_total_s": 79154.23847341537, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1859.1196269989014, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.227777777777778, "ram_util_percent": 73.23666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.0892446534627, "policy_loss": -6036977.519200984, "vf_loss": 6009441.759930758}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20237.5, "diff_num_grad_updates_vs_sampler_policy": 20236.5}}, "num_env_steps_sampled": 46067520, "num_env_steps_trained": 46067520, "num_agent_steps_sampled": 46067520, "num_agent_steps_trained": 46067520}, "sampler_results": {"episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177372.2363327755, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21831534816326273, "mean_inference_ms": 0.374417526909846, "mean_action_processing_ms": 0.09206789225273876, "mean_env_wait_ms": 0.7408265307899027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037757555643717446, "StateBufferConnector_ms": 0.002739429473876953, "ViewRequirementAgentConnector_ms": 0.06766955057779948}}, "episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177372.2363327755, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21831534816326273, "mean_inference_ms": 0.374417526909846, "mean_action_processing_ms": 0.09206789225273876, "mean_env_wait_ms": 0.7408265307899027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037757555643717446, "StateBufferConnector_ms": 0.002739429473876953, "ViewRequirementAgentConnector_ms": 0.06766955057779948}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46067520, "num_agent_steps_trained": 46067520, "num_env_steps_sampled": 46067520, "num_env_steps_trained": 46067520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 684.8262852192595, "num_env_steps_trained_throughput_per_sec": 684.8262852192595, "timesteps_total": 46067520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46067520, "timers": {"training_iteration_time_ms": 63738.158, "sample_time_ms": 62602.443, "load_time_ms": 17.509, "load_throughput": 2508440.25, "learn_time_ms": 1117.105, "learn_throughput": 39315.927, "synch_weights_time_ms": 0.943}, "counters": {"num_env_steps_sampled": 46067520, "num_env_steps_trained": 46067520, "num_agent_steps_sampled": 46067520, "num_agent_steps_trained": 46067520}, "done": false, "episodes_total": 9222, "training_iteration": 2959, "trial_id": "3123b_00000", "date": "2023-08-07_14-58-13", "timestamp": 1691409493, "time_this_iter_s": 64.13588809967041, "time_total_s": 79218.37436151505, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1923.2555150985718, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.94945054945055, "ram_util_percent": 73.25714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.8538791222753, "policy_loss": -5741849.439535691, "vf_loss": 6076106.399599126}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20923.5, "diff_num_grad_updates_vs_sampler_policy": 20922.5}}, "num_env_steps_sampled": 46111440, "num_env_steps_trained": 46111440, "num_agent_steps_sampled": 46111440, "num_agent_steps_trained": 46111440}, "sampler_results": {"episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177387.4099800956, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21831575421693442, "mean_inference_ms": 0.37441771475915653, "mean_action_processing_ms": 0.09206809242508782, "mean_env_wait_ms": 0.7404462056971503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037554771669449346, "StateBufferConnector_ms": 0.002735660922142767, "ViewRequirementAgentConnector_ms": 0.06764627272082914}}, "episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177387.4099800956, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21831575421693442, "mean_inference_ms": 0.37441771475915653, "mean_action_processing_ms": 0.09206809242508782, "mean_env_wait_ms": 0.7404462056971503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037554771669449346, "StateBufferConnector_ms": 0.002735660922142767, "ViewRequirementAgentConnector_ms": 0.06764627272082914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46111440, "num_agent_steps_trained": 46111440, "num_env_steps_sampled": 46111440, "num_env_steps_trained": 46111440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 685.4568723216654, "num_env_steps_trained_throughput_per_sec": 685.4568723216654, "timesteps_total": 46111440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46111440, "timers": {"training_iteration_time_ms": 63719.583, "sample_time_ms": 62583.254, "load_time_ms": 17.37, "load_throughput": 2528551.568, "learn_time_ms": 1117.868, "learn_throughput": 39289.089, "synch_weights_time_ms": 0.934}, "counters": {"num_env_steps_sampled": 46111440, "num_env_steps_trained": 46111440, "num_agent_steps_sampled": 46111440, "num_agent_steps_trained": 46111440}, "done": false, "episodes_total": 9223, "training_iteration": 2960, "trial_id": "3123b_00000", "date": "2023-08-07_14-59-17", "timestamp": 1691409557, "time_this_iter_s": 64.07708168029785, "time_total_s": 79282.45144319534, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1987.3325967788696, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 18.25054945054945, "ram_util_percent": 73.34945054945054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.95852247410545, "policy_loss": -5904744.842024645, "vf_loss": 6038841.638119534}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21609.5, "diff_num_grad_updates_vs_sampler_policy": 21608.5}}, "num_env_steps_sampled": 46155360, "num_env_steps_trained": 46155360, "num_agent_steps_sampled": 46155360, "num_agent_steps_trained": 46155360}, "sampler_results": {"episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177395.1907023452, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21831595131230336, "mean_inference_ms": 0.37441750170373317, "mean_action_processing_ms": 0.09206807969279887, "mean_env_wait_ms": 0.7400848603114244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737211227416992, "StateBufferConnector_ms": 0.002742558717727661, "ViewRequirementAgentConnector_ms": 0.0676274299621582}}, "episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177395.1907023452, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21831595131230336, "mean_inference_ms": 0.37441750170373317, "mean_action_processing_ms": 0.09206807969279887, "mean_env_wait_ms": 0.7400848603114244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737211227416992, "StateBufferConnector_ms": 0.002742558717727661, "ViewRequirementAgentConnector_ms": 0.0676274299621582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46155360, "num_agent_steps_trained": 46155360, "num_env_steps_sampled": 46155360, "num_env_steps_trained": 46155360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 687.7804295990838, "num_env_steps_trained_throughput_per_sec": 687.7804295990838, "timesteps_total": 46155360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46155360, "timers": {"training_iteration_time_ms": 63713.643, "sample_time_ms": 62576.833, "load_time_ms": 17.256, "load_throughput": 2545212.564, "learn_time_ms": 1118.461, "learn_throughput": 39268.256, "synch_weights_time_ms": 0.935}, "counters": {"num_env_steps_sampled": 46155360, "num_env_steps_trained": 46155360, "num_agent_steps_sampled": 46155360, "num_agent_steps_trained": 46155360}, "done": false, "episodes_total": 9224, "training_iteration": 2961, "trial_id": "3123b_00000", "date": "2023-08-07_15-00-21", "timestamp": 1691409621, "time_this_iter_s": 63.86019015312195, "time_total_s": 79346.31163334846, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2051.1927869319916, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 18.093333333333334, "ram_util_percent": 73.33666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.0399875029183, "policy_loss": -5179596.8207566505, "vf_loss": 5780117.03680758}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22295.5, "diff_num_grad_updates_vs_sampler_policy": 22294.5}}, "num_env_steps_sampled": 46199280, "num_env_steps_trained": 46199280, "num_agent_steps_sampled": 46199280, "num_agent_steps_trained": 46199280}, "sampler_results": {"episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177276.7666546055, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2183161215755962, "mean_inference_ms": 0.3744170875775575, "mean_action_processing_ms": 0.09206799681796667, "mean_env_wait_ms": 0.7397308328301245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037200523145271072, "StateBufferConnector_ms": 0.0027353113347833805, "ViewRequirementAgentConnector_ms": 0.06765307802142519}}, "episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177276.7666546055, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2183161215755962, "mean_inference_ms": 0.3744170875775575, "mean_action_processing_ms": 0.09206799681796667, "mean_env_wait_ms": 0.7397308328301245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037200523145271072, "StateBufferConnector_ms": 0.0027353113347833805, "ViewRequirementAgentConnector_ms": 0.06765307802142519}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46199280, "num_agent_steps_trained": 46199280, "num_env_steps_sampled": 46199280, "num_env_steps_trained": 46199280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 692.9293177144799, "num_env_steps_trained_throughput_per_sec": 692.9293177144799, "timesteps_total": 46199280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46199280, "timers": {"training_iteration_time_ms": 63769.11, "sample_time_ms": 62633.633, "load_time_ms": 17.254, "load_throughput": 2545553.722, "learn_time_ms": 1117.136, "learn_throughput": 39314.834, "synch_weights_time_ms": 0.929}, "counters": {"num_env_steps_sampled": 46199280, "num_env_steps_trained": 46199280, "num_agent_steps_sampled": 46199280, "num_agent_steps_trained": 46199280}, "done": false, "episodes_total": 9225, "training_iteration": 2962, "trial_id": "3123b_00000", "date": "2023-08-07_15-01-24", "timestamp": 1691409684, "time_this_iter_s": 63.385730028152466, "time_total_s": 79409.69736337662, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2114.578516960144, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 18.17888888888889, "ram_util_percent": 73.1711111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.90427040567204, "policy_loss": -5321051.54326058, "vf_loss": 5918786.9919825075}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22981.5, "diff_num_grad_updates_vs_sampler_policy": 22980.5}}, "num_env_steps_sampled": 46243200, "num_env_steps_trained": 46243200, "num_agent_steps_sampled": 46243200, "num_agent_steps_trained": 46243200}, "sampler_results": {"episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177218.4069008821, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2183153877742941, "mean_inference_ms": 0.3744162894736536, "mean_action_processing_ms": 0.09206793676149745, "mean_env_wait_ms": 0.7393835683857759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036996953627642464, "StateBufferConnector_ms": 0.002730593961827895, "ViewRequirementAgentConnector_ms": 0.067595173330868}}, "episode_reward_max": -172710.91802689058, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177218.4069008821, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2183153877742941, "mean_inference_ms": 0.3744162894736536, "mean_action_processing_ms": 0.09206793676149745, "mean_env_wait_ms": 0.7393835683857759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036996953627642464, "StateBufferConnector_ms": 0.002730593961827895, "ViewRequirementAgentConnector_ms": 0.067595173330868}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46243200, "num_agent_steps_trained": 46243200, "num_env_steps_sampled": 46243200, "num_env_steps_trained": 46243200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 693.8920824947865, "num_env_steps_trained_throughput_per_sec": 693.8920824947865, "timesteps_total": 46243200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46243200, "timers": {"training_iteration_time_ms": 63722.357, "sample_time_ms": 62586.321, "load_time_ms": 17.17, "load_throughput": 2557885.969, "learn_time_ms": 1117.787, "learn_throughput": 39291.921, "synch_weights_time_ms": 0.921}, "counters": {"num_env_steps_sampled": 46243200, "num_env_steps_trained": 46243200, "num_agent_steps_sampled": 46243200, "num_agent_steps_trained": 46243200}, "done": false, "episodes_total": 9226, "training_iteration": 2963, "trial_id": "3123b_00000", "date": "2023-08-07_15-02-28", "timestamp": 1691409748, "time_this_iter_s": 63.297807931900024, "time_total_s": 79472.99517130852, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2177.876324892044, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 17.90555555555556, "ram_util_percent": 73.24777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.9982282455044, "policy_loss": -5012654.291476859, "vf_loss": 5633965.099580904}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23667.5, "diff_num_grad_updates_vs_sampler_policy": 23666.5}}, "num_env_steps_sampled": 46287120, "num_env_steps_trained": 46287120, "num_agent_steps_sampled": 46287120, "num_agent_steps_trained": 46287120}, "sampler_results": {"episode_reward_max": -172094.5415887457, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177072.0107491068, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21831444987169024, "mean_inference_ms": 0.3744151944608744, "mean_action_processing_ms": 0.09206796711501987, "mean_env_wait_ms": 0.7390393187004829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036791392735072543, "StateBufferConnector_ms": 0.0027329581124441965, "ViewRequirementAgentConnector_ms": 0.06753104073660714}}, "episode_reward_max": -172094.5415887457, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -177072.0107491068, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21831444987169024, "mean_inference_ms": 0.3744151944608744, "mean_action_processing_ms": 0.09206796711501987, "mean_env_wait_ms": 0.7390393187004829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036791392735072543, "StateBufferConnector_ms": 0.0027329581124441965, "ViewRequirementAgentConnector_ms": 0.06753104073660714}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46287120, "num_agent_steps_trained": 46287120, "num_env_steps_sampled": 46287120, "num_env_steps_trained": 46287120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 695.6510601668175, "num_env_steps_trained_throughput_per_sec": 695.6510601668175, "timesteps_total": 46287120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46287120, "timers": {"training_iteration_time_ms": 63636.559, "sample_time_ms": 62498.814, "load_time_ms": 17.061, "load_throughput": 2574289.387, "learn_time_ms": 1119.599, "learn_throughput": 39228.327, "synch_weights_time_ms": 0.926}, "counters": {"num_env_steps_sampled": 46287120, "num_env_steps_trained": 46287120, "num_agent_steps_sampled": 46287120, "num_agent_steps_trained": 46287120}, "done": false, "episodes_total": 9227, "training_iteration": 2964, "trial_id": "3123b_00000", "date": "2023-08-07_15-03-31", "timestamp": 1691409811, "time_this_iter_s": 63.137986183166504, "time_total_s": 79536.13315749168, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2241.0143110752106, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 18.56179775280899, "ram_util_percent": 73.32808988764044}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.85256526491037, "policy_loss": -5175050.796675702, "vf_loss": 5453073.631696428}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24353.5, "diff_num_grad_updates_vs_sampler_policy": 24352.5}}, "num_env_steps_sampled": 46331040, "num_env_steps_trained": 46331040, "num_agent_steps_sampled": 46331040, "num_agent_steps_trained": 46331040}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176846.60991439046, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21831222982296106, "mean_inference_ms": 0.37441378226099764, "mean_action_processing_ms": 0.09206799528751769, "mean_env_wait_ms": 0.7386991776759143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003670983844333225, "StateBufferConnector_ms": 0.0027265813615587023, "ViewRequirementAgentConnector_ms": 0.06746119923061794}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176846.60991439046, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21831222982296106, "mean_inference_ms": 0.37441378226099764, "mean_action_processing_ms": 0.09206799528751769, "mean_env_wait_ms": 0.7386991776759143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003670983844333225, "StateBufferConnector_ms": 0.0027265813615587023, "ViewRequirementAgentConnector_ms": 0.06746119923061794}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46331040, "num_agent_steps_trained": 46331040, "num_env_steps_sampled": 46331040, "num_env_steps_trained": 46331040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 696.3236263758985, "num_env_steps_trained_throughput_per_sec": 696.3236263758985, "timesteps_total": 46331040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46331040, "timers": {"training_iteration_time_ms": 63617.467, "sample_time_ms": 62479.341, "load_time_ms": 16.843, "load_throughput": 2607551.021, "learn_time_ms": 1120.193, "learn_throughput": 39207.545, "synch_weights_time_ms": 0.932}, "counters": {"num_env_steps_sampled": 46331040, "num_env_steps_trained": 46331040, "num_agent_steps_sampled": 46331040, "num_agent_steps_trained": 46331040}, "done": false, "episodes_total": 9228, "training_iteration": 2965, "trial_id": "3123b_00000", "date": "2023-08-07_15-04-34", "timestamp": 1691409874, "time_this_iter_s": 63.07682776451111, "time_total_s": 79599.2099852562, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2304.0911388397217, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.86966292134831, "ram_util_percent": 73.31123595505616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.166666666666667e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.96741465576883, "policy_loss": -5017305.222969433, "vf_loss": 5678964.038903061}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25039.5, "diff_num_grad_updates_vs_sampler_policy": 25038.5}}, "num_env_steps_sampled": 46374960, "num_env_steps_trained": 46374960, "num_agent_steps_sampled": 46374960, "num_agent_steps_trained": 46374960}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176722.08263630938, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21830949964748578, "mean_inference_ms": 0.37441160591780004, "mean_action_processing_ms": 0.09206801382092517, "mean_env_wait_ms": 0.7383617579851464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003658758627401816, "StateBufferConnector_ms": 0.0027244155471389357, "ViewRequirementAgentConnector_ms": 0.06754269471039644}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176722.08263630938, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21830949964748578, "mean_inference_ms": 0.37441160591780004, "mean_action_processing_ms": 0.09206801382092517, "mean_env_wait_ms": 0.7383617579851464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003658758627401816, "StateBufferConnector_ms": 0.0027244155471389357, "ViewRequirementAgentConnector_ms": 0.06754269471039644}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46374960, "num_agent_steps_trained": 46374960, "num_env_steps_sampled": 46374960, "num_env_steps_trained": 46374960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 696.597036306532, "num_env_steps_trained_throughput_per_sec": 696.597036306532, "timesteps_total": 46374960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46374960, "timers": {"training_iteration_time_ms": 63577.426, "sample_time_ms": 62430.83, "load_time_ms": 16.716, "load_throughput": 2627407.301, "learn_time_ms": 1128.788, "learn_throughput": 38908.995, "synch_weights_time_ms": 0.929}, "counters": {"num_env_steps_sampled": 46374960, "num_env_steps_trained": 46374960, "num_agent_steps_sampled": 46374960, "num_agent_steps_trained": 46374960}, "done": false, "episodes_total": 9229, "training_iteration": 2966, "trial_id": "3123b_00000", "date": "2023-08-07_15-05-37", "timestamp": 1691409937, "time_this_iter_s": 63.05227708816528, "time_total_s": 79662.26226234436, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2367.143415927887, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.852222222222224, "ram_util_percent": 73.32666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.3333333333333346e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.8963051843226, "policy_loss": -5326485.382294324, "vf_loss": 5926543.808673469}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25725.5, "diff_num_grad_updates_vs_sampler_policy": 25724.5}}, "num_env_steps_sampled": 46418880, "num_env_steps_trained": 46418880, "num_agent_steps_sampled": 46418880, "num_agent_steps_trained": 46418880}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176692.78859398526, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2183060136305456, "mean_inference_ms": 0.3744106774750303, "mean_action_processing_ms": 0.09206794229592138, "mean_env_wait_ms": 0.7380356278298815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036409026698062293, "StateBufferConnector_ms": 0.0027342846519068666, "ViewRequirementAgentConnector_ms": 0.06750320133410002}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176692.78859398526, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2183060136305456, "mean_inference_ms": 0.3744106774750303, "mean_action_processing_ms": 0.09206794229592138, "mean_env_wait_ms": 0.7380356278298815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036409026698062293, "StateBufferConnector_ms": 0.0027342846519068666, "ViewRequirementAgentConnector_ms": 0.06750320133410002}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46418880, "num_agent_steps_trained": 46418880, "num_env_steps_sampled": 46418880, "num_env_steps_trained": 46418880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 690.9261024951744, "num_env_steps_trained_throughput_per_sec": 690.9261024951744, "timesteps_total": 46418880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46418880, "timers": {"training_iteration_time_ms": 63540.72, "sample_time_ms": 62394.063, "load_time_ms": 16.623, "load_throughput": 2642088.839, "learn_time_ms": 1128.949, "learn_throughput": 38903.435, "synch_weights_time_ms": 0.922}, "counters": {"num_env_steps_sampled": 46418880, "num_env_steps_trained": 46418880, "num_agent_steps_sampled": 46418880, "num_agent_steps_trained": 46418880}, "done": false, "episodes_total": 9230, "training_iteration": 2967, "trial_id": "3123b_00000", "date": "2023-08-07_15-06-40", "timestamp": 1691410000, "time_this_iter_s": 63.569881200790405, "time_total_s": 79725.83214354515, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2430.7132971286774, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 18.154444444444444, "ram_util_percent": 73.30222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.8702872140067, "policy_loss": -4883756.437742005, "vf_loss": 5502486.222394315}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26411.5, "diff_num_grad_updates_vs_sampler_policy": 26410.5}}, "num_env_steps_sampled": 46462800, "num_env_steps_trained": 46462800, "num_agent_steps_sampled": 46462800, "num_agent_steps_trained": 46462800}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176526.90238194095, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21830250698692025, "mean_inference_ms": 0.37440885763583237, "mean_action_processing_ms": 0.09206783587596211, "mean_env_wait_ms": 0.7377169276439195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003631298358623798, "StateBufferConnector_ms": 0.0027326437143179085, "ViewRequirementAgentConnector_ms": 0.06749018644675231}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176526.90238194095, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21830250698692025, "mean_inference_ms": 0.37440885763583237, "mean_action_processing_ms": 0.09206783587596211, "mean_env_wait_ms": 0.7377169276439195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003631298358623798, "StateBufferConnector_ms": 0.0027326437143179085, "ViewRequirementAgentConnector_ms": 0.06749018644675231}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46462800, "num_agent_steps_trained": 46462800, "num_env_steps_sampled": 46462800, "num_env_steps_trained": 46462800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 693.9928226412648, "num_env_steps_trained_throughput_per_sec": 693.9928226412648, "timesteps_total": 46462800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46462800, "timers": {"training_iteration_time_ms": 63485.413, "sample_time_ms": 62336.004, "load_time_ms": 16.437, "load_throughput": 2672081.48, "learn_time_ms": 1131.889, "learn_throughput": 38802.39, "synch_weights_time_ms": 0.921}, "counters": {"num_env_steps_sampled": 46462800, "num_env_steps_trained": 46462800, "num_agent_steps_sampled": 46462800, "num_agent_steps_trained": 46462800}, "done": false, "episodes_total": 9231, "training_iteration": 2968, "trial_id": "3123b_00000", "date": "2023-08-07_15-07-44", "timestamp": 1691410064, "time_this_iter_s": 63.28860592842102, "time_total_s": 79789.12074947357, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2494.0019030570984, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 17.844943820224717, "ram_util_percent": 73.29550561797751}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.9275562075067, "policy_loss": -5298685.34621276, "vf_loss": 5678171.772959184}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27097.5, "diff_num_grad_updates_vs_sampler_policy": 27096.5}}, "num_env_steps_sampled": 46506720, "num_env_steps_trained": 46506720, "num_agent_steps_sampled": 46506720, "num_agent_steps_trained": 46506720}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176422.46235181874, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21829883653402246, "mean_inference_ms": 0.3744077843267506, "mean_action_processing_ms": 0.09206775829969134, "mean_env_wait_ms": 0.7374087827894386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003623366355895996, "StateBufferConnector_ms": 0.002733469009399414, "ViewRequirementAgentConnector_ms": 0.06752610206604004}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176422.46235181874, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21829883653402246, "mean_inference_ms": 0.3744077843267506, "mean_action_processing_ms": 0.09206775829969134, "mean_env_wait_ms": 0.7374087827894386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003623366355895996, "StateBufferConnector_ms": 0.002733469009399414, "ViewRequirementAgentConnector_ms": 0.06752610206604004}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46506720, "num_agent_steps_trained": 46506720, "num_env_steps_sampled": 46506720, "num_env_steps_trained": 46506720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 690.4922339568726, "num_env_steps_trained_throughput_per_sec": 690.4922339568726, "timesteps_total": 46506720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46506720, "timers": {"training_iteration_time_ms": 63432.787, "sample_time_ms": 62281.417, "load_time_ms": 16.358, "load_throughput": 2685004.047, "learn_time_ms": 1133.915, "learn_throughput": 38733.065, "synch_weights_time_ms": 0.934}, "counters": {"num_env_steps_sampled": 46506720, "num_env_steps_trained": 46506720, "num_agent_steps_sampled": 46506720, "num_agent_steps_trained": 46506720}, "done": false, "episodes_total": 9232, "training_iteration": 2969, "trial_id": "3123b_00000", "date": "2023-08-07_15-08-47", "timestamp": 1691410127, "time_this_iter_s": 63.60948085784912, "time_total_s": 79852.73023033142, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2557.6113839149475, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 18.67666666666667, "ram_util_percent": 73.38888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.01860451211735, "policy_loss": -5559815.841409666, "vf_loss": 5837866.770590379}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27783.5, "diff_num_grad_updates_vs_sampler_policy": 27782.5}}, "num_env_steps_sampled": 46550640, "num_env_steps_trained": 46550640, "num_agent_steps_sampled": 46550640, "num_agent_steps_trained": 46550640}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176378.31913915818, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21829474061246326, "mean_inference_ms": 0.3744068280942916, "mean_action_processing_ms": 0.09206756110858082, "mean_env_wait_ms": 0.7371095675019274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003611169210294398, "StateBufferConnector_ms": 0.0027336725374547447, "ViewRequirementAgentConnector_ms": 0.06746547978098799}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176378.31913915818, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21829474061246326, "mean_inference_ms": 0.3744068280942916, "mean_action_processing_ms": 0.09206756110858082, "mean_env_wait_ms": 0.7371095675019274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003611169210294398, "StateBufferConnector_ms": 0.0027336725374547447, "ViewRequirementAgentConnector_ms": 0.06746547978098799}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46550640, "num_agent_steps_trained": 46550640, "num_env_steps_sampled": 46550640, "num_env_steps_trained": 46550640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 692.3966643059041, "num_env_steps_trained_throughput_per_sec": 692.3966643059041, "timesteps_total": 46550640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46550640, "timers": {"training_iteration_time_ms": 63368.566, "sample_time_ms": 62217.014, "load_time_ms": 16.464, "load_throughput": 2667569.764, "learn_time_ms": 1133.992, "learn_throughput": 38730.424, "synch_weights_time_ms": 0.933}, "counters": {"num_env_steps_sampled": 46550640, "num_env_steps_trained": 46550640, "num_agent_steps_sampled": 46550640, "num_agent_steps_trained": 46550640}, "done": false, "episodes_total": 9233, "training_iteration": 2970, "trial_id": "3123b_00000", "date": "2023-08-07_15-09-51", "timestamp": 1691410191, "time_this_iter_s": 63.434629917144775, "time_total_s": 79916.16486024857, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2621.0460138320923, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 18.27111111111111, "ram_util_percent": 73.44333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.0722759458136, "policy_loss": -5012730.280179483, "vf_loss": 6019195.008928572}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28469.5, "diff_num_grad_updates_vs_sampler_policy": 28468.5}}, "num_env_steps_sampled": 46594560, "num_env_steps_trained": 46594560, "num_agent_steps_sampled": 46594560, "num_agent_steps_trained": 46594560}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176381.54036654724, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182919746311775, "mean_inference_ms": 0.3744060321812999, "mean_action_processing_ms": 0.09206755661938419, "mean_env_wait_ms": 0.7368176077889809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035984175545828684, "StateBufferConnector_ms": 0.0027866590590704056, "ViewRequirementAgentConnector_ms": 0.06750084104992095}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176381.54036654724, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182919746311775, "mean_inference_ms": 0.3744060321812999, "mean_action_processing_ms": 0.09206755661938419, "mean_env_wait_ms": 0.7368176077889809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035984175545828684, "StateBufferConnector_ms": 0.0027866590590704056, "ViewRequirementAgentConnector_ms": 0.06750084104992095}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46594560, "num_agent_steps_trained": 46594560, "num_env_steps_sampled": 46594560, "num_env_steps_trained": 46594560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 691.6327064212427, "num_env_steps_trained_throughput_per_sec": 691.6327064212427, "timesteps_total": 46594560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46594560, "timers": {"training_iteration_time_ms": 63332.998, "sample_time_ms": 62180.398, "load_time_ms": 16.564, "load_throughput": 2651497.245, "learn_time_ms": 1134.94, "learn_throughput": 38698.083, "synch_weights_time_ms": 0.933}, "counters": {"num_env_steps_sampled": 46594560, "num_env_steps_trained": 46594560, "num_agent_steps_sampled": 46594560, "num_agent_steps_trained": 46594560}, "done": false, "episodes_total": 9234, "training_iteration": 2971, "trial_id": "3123b_00000", "date": "2023-08-07_15-10-54", "timestamp": 1691410254, "time_this_iter_s": 63.50464105606079, "time_total_s": 79979.66950130463, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2684.550654888153, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 18.843333333333334, "ram_util_percent": 73.41444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.7989759528602, "policy_loss": -5207460.557924677, "vf_loss": 5679423.608600583}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29155.5, "diff_num_grad_updates_vs_sampler_policy": 29154.5}}, "num_env_steps_sampled": 46638480, "num_env_steps_trained": 46638480, "num_agent_steps_sampled": 46638480, "num_agent_steps_trained": 46638480}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176290.56367802614, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828920838424248, "mean_inference_ms": 0.3744050634870988, "mean_action_processing_ms": 0.09206753745260923, "mean_env_wait_ms": 0.7365332665664878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036677648854810136, "StateBufferConnector_ms": 0.002788942913676417, "ViewRequirementAgentConnector_ms": 0.06752845852874047}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176290.56367802614, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828920838424248, "mean_inference_ms": 0.3744050634870988, "mean_action_processing_ms": 0.09206753745260923, "mean_env_wait_ms": 0.7365332665664878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036677648854810136, "StateBufferConnector_ms": 0.002788942913676417, "ViewRequirementAgentConnector_ms": 0.06752845852874047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46638480, "num_agent_steps_trained": 46638480, "num_env_steps_sampled": 46638480, "num_env_steps_trained": 46638480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 692.5654737934123, "num_env_steps_trained_throughput_per_sec": 692.5654737934123, "timesteps_total": 46638480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46638480, "timers": {"training_iteration_time_ms": 63336.328, "sample_time_ms": 62181.52, "load_time_ms": 16.565, "load_throughput": 2651317.884, "learn_time_ms": 1137.143, "learn_throughput": 38623.107, "synch_weights_time_ms": 0.938}, "counters": {"num_env_steps_sampled": 46638480, "num_env_steps_trained": 46638480, "num_agent_steps_sampled": 46638480, "num_agent_steps_trained": 46638480}, "done": false, "episodes_total": 9235, "training_iteration": 2972, "trial_id": "3123b_00000", "date": "2023-08-07_15-11-58", "timestamp": 1691410318, "time_this_iter_s": 63.41914105415344, "time_total_s": 80043.08864235878, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2747.9697959423065, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 18.314444444444444, "ram_util_percent": 73.42555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.1493225542519, "policy_loss": -4987598.063581906, "vf_loss": 5743693.991800291}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29841.5, "diff_num_grad_updates_vs_sampler_policy": 29840.5}}, "num_env_steps_sampled": 46682400, "num_env_steps_trained": 46682400, "num_agent_steps_sampled": 46682400, "num_agent_steps_trained": 46682400}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176223.90490762162, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828641617557515, "mean_inference_ms": 0.37440376541916165, "mean_action_processing_ms": 0.09206747450519917, "mean_env_wait_ms": 0.7362518969283486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036553903059525924, "StateBufferConnector_ms": 0.002780285748568448, "ViewRequirementAgentConnector_ms": 0.06748708811673251}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176223.90490762162, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828641617557515, "mean_inference_ms": 0.37440376541916165, "mean_action_processing_ms": 0.09206747450519917, "mean_env_wait_ms": 0.7362518969283486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036553903059525924, "StateBufferConnector_ms": 0.002780285748568448, "ViewRequirementAgentConnector_ms": 0.06748708811673251}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46682400, "num_agent_steps_trained": 46682400, "num_env_steps_sampled": 46682400, "num_env_steps_trained": 46682400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 696.8071602067923, "num_env_steps_trained_throughput_per_sec": 696.8071602067923, "timesteps_total": 46682400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46682400, "timers": {"training_iteration_time_ms": 63309.849, "sample_time_ms": 62153.179, "load_time_ms": 16.64, "load_throughput": 2639385.962, "learn_time_ms": 1138.926, "learn_throughput": 38562.634, "synch_weights_time_ms": 0.941}, "counters": {"num_env_steps_sampled": 46682400, "num_env_steps_trained": 46682400, "num_agent_steps_sampled": 46682400, "num_agent_steps_trained": 46682400}, "done": false, "episodes_total": 9236, "training_iteration": 2973, "trial_id": "3123b_00000", "date": "2023-08-07_15-13-01", "timestamp": 1691410381, "time_this_iter_s": 63.032992124557495, "time_total_s": 80106.12163448334, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2811.002788066864, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.697752808988763, "ram_util_percent": 73.44943820224718}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.0095592532144, "policy_loss": -5212360.677238976, "vf_loss": 5979135.6492346935}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30527.5, "diff_num_grad_updates_vs_sampler_policy": 30526.5}}, "num_env_steps_sampled": 46726320, "num_env_steps_trained": 46726320, "num_agent_steps_sampled": 46726320, "num_agent_steps_trained": 46726320}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176232.92871979703, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828419801028273, "mean_inference_ms": 0.37440157320566536, "mean_action_processing_ms": 0.09206732805848628, "mean_env_wait_ms": 0.7359756373774202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003650453355577257, "StateBufferConnector_ms": 0.002780490451388889, "ViewRequirementAgentConnector_ms": 0.06759113735622829}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176232.92871979703, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828419801028273, "mean_inference_ms": 0.37440157320566536, "mean_action_processing_ms": 0.09206732805848628, "mean_env_wait_ms": 0.7359756373774202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003650453355577257, "StateBufferConnector_ms": 0.002780490451388889, "ViewRequirementAgentConnector_ms": 0.06759113735622829}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46726320, "num_agent_steps_trained": 46726320, "num_env_steps_sampled": 46726320, "num_env_steps_trained": 46726320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 695.36760381089, "num_env_steps_trained_throughput_per_sec": 695.36760381089, "timesteps_total": 46726320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46726320, "timers": {"training_iteration_time_ms": 63312.422, "sample_time_ms": 62157.645, "load_time_ms": 16.739, "load_throughput": 2623769.85, "learn_time_ms": 1136.931, "learn_throughput": 38630.319, "synch_weights_time_ms": 0.946}, "counters": {"num_env_steps_sampled": 46726320, "num_env_steps_trained": 46726320, "num_agent_steps_sampled": 46726320, "num_agent_steps_trained": 46726320}, "done": false, "episodes_total": 9237, "training_iteration": 2974, "trial_id": "3123b_00000", "date": "2023-08-07_15-14-04", "timestamp": 1691410444, "time_this_iter_s": 63.16374611854553, "time_total_s": 80169.28538060188, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2874.1665341854095, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 18.06067415730337, "ram_util_percent": 73.43483146067415}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.98423718154953, "policy_loss": -5021732.2355878735, "vf_loss": 5893517.352268586}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31213.5, "diff_num_grad_updates_vs_sampler_policy": 31212.5}}, "num_env_steps_sampled": 46770240, "num_env_steps_trained": 46770240, "num_agent_steps_sampled": 46770240, "num_agent_steps_trained": 46770240}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176201.79689712418, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828309315720307, "mean_inference_ms": 0.37439968730144696, "mean_action_processing_ms": 0.09206714285738396, "mean_env_wait_ms": 0.7357025690058798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003637956536334494, "StateBufferConnector_ms": 0.0027729117352029552, "ViewRequirementAgentConnector_ms": 0.06755901419598123}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176201.79689712418, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828309315720307, "mean_inference_ms": 0.37439968730144696, "mean_action_processing_ms": 0.09206714285738396, "mean_env_wait_ms": 0.7357025690058798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003637956536334494, "StateBufferConnector_ms": 0.0027729117352029552, "ViewRequirementAgentConnector_ms": 0.06755901419598123}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46770240, "num_agent_steps_trained": 46770240, "num_env_steps_sampled": 46770240, "num_env_steps_trained": 46770240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 695.4203570631599, "num_env_steps_trained_throughput_per_sec": 695.4203570631599, "timesteps_total": 46770240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46770240, "timers": {"training_iteration_time_ms": 63320.615, "sample_time_ms": 62165.512, "load_time_ms": 16.737, "load_throughput": 2624188.467, "learn_time_ms": 1137.26, "learn_throughput": 38619.148, "synch_weights_time_ms": 0.945}, "counters": {"num_env_steps_sampled": 46770240, "num_env_steps_trained": 46770240, "num_agent_steps_sampled": 46770240, "num_agent_steps_trained": 46770240}, "done": false, "episodes_total": 9238, "training_iteration": 2975, "trial_id": "3123b_00000", "date": "2023-08-07_15-15-07", "timestamp": 1691410507, "time_this_iter_s": 63.15875482559204, "time_total_s": 80232.44413542747, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2937.3252890110016, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.405555555555555, "ram_util_percent": 73.46222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.0858375393614, "policy_loss": -5036029.015978043, "vf_loss": 5757582.997175656}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31899.5, "diff_num_grad_updates_vs_sampler_policy": 31898.5}}, "num_env_steps_sampled": 46814160, "num_env_steps_trained": 46814160, "num_agent_steps_sampled": 46814160, "num_agent_steps_trained": 46814160}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176141.74561604578, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828227994399213, "mean_inference_ms": 0.37439951123542076, "mean_action_processing_ms": 0.09206699139206148, "mean_env_wait_ms": 0.7354318091453735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003631064232359541, "StateBufferConnector_ms": 0.00277072825330369, "ViewRequirementAgentConnector_ms": 0.06751405431869183}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176141.74561604578, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828227994399213, "mean_inference_ms": 0.37439951123542076, "mean_action_processing_ms": 0.09206699139206148, "mean_env_wait_ms": 0.7354318091453735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003631064232359541, "StateBufferConnector_ms": 0.00277072825330369, "ViewRequirementAgentConnector_ms": 0.06751405431869183}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46814160, "num_agent_steps_trained": 46814160, "num_env_steps_sampled": 46814160, "num_env_steps_trained": 46814160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 695.4239011841953, "num_env_steps_trained_throughput_per_sec": 695.4239011841953, "timesteps_total": 46814160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46814160, "timers": {"training_iteration_time_ms": 63331.251, "sample_time_ms": 62181.149, "load_time_ms": 16.825, "load_throughput": 2610370.294, "learn_time_ms": 1132.176, "learn_throughput": 38792.541, "synch_weights_time_ms": 0.941}, "counters": {"num_env_steps_sampled": 46814160, "num_env_steps_trained": 46814160, "num_agent_steps_sampled": 46814160, "num_agent_steps_trained": 46814160}, "done": false, "episodes_total": 9239, "training_iteration": 2976, "trial_id": "3123b_00000", "date": "2023-08-07_15-16-10", "timestamp": 1691410570, "time_this_iter_s": 63.15875220298767, "time_total_s": 80295.60288763046, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3000.4840412139893, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 18.083146067415733, "ram_util_percent": 73.4314606741573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.9815423815313, "policy_loss": -4706977.920496994, "vf_loss": 5729898.8646137025}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32585.5, "diff_num_grad_updates_vs_sampler_policy": 32584.5}}, "num_env_steps_sampled": 46858080, "num_env_steps_trained": 46858080, "num_agent_steps_sampled": 46858080, "num_agent_steps_trained": 46858080}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176073.2462666002, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.218281752145291, "mean_inference_ms": 0.3743993704663735, "mean_action_processing_ms": 0.09206681611316274, "mean_env_wait_ms": 0.735164786556051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036850571632385254, "StateBufferConnector_ms": 0.002767642339070638, "ViewRequirementAgentConnector_ms": 0.0675007700920105}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176073.2462666002, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.218281752145291, "mean_inference_ms": 0.3743993704663735, "mean_action_processing_ms": 0.09206681611316274, "mean_env_wait_ms": 0.735164786556051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036850571632385254, "StateBufferConnector_ms": 0.002767642339070638, "ViewRequirementAgentConnector_ms": 0.0675007700920105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46858080, "num_agent_steps_trained": 46858080, "num_env_steps_sampled": 46858080, "num_env_steps_trained": 46858080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 695.8591653256613, "num_env_steps_trained_throughput_per_sec": 695.8591653256613, "timesteps_total": 46858080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46858080, "timers": {"training_iteration_time_ms": 63286.187, "sample_time_ms": 62134.292, "load_time_ms": 16.944, "load_throughput": 2592144.109, "learn_time_ms": 1133.852, "learn_throughput": 38735.22, "synch_weights_time_ms": 0.941}, "counters": {"num_env_steps_sampled": 46858080, "num_env_steps_trained": 46858080, "num_agent_steps_sampled": 46858080, "num_agent_steps_trained": 46858080}, "done": false, "episodes_total": 9240, "training_iteration": 2977, "trial_id": "3123b_00000", "date": "2023-08-07_15-17-14", "timestamp": 1691410634, "time_this_iter_s": 63.11901307106018, "time_total_s": 80358.72190070152, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3063.6030542850494, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.517777777777777, "ram_util_percent": 73.43666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0000000000000002e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.1636212852189, "policy_loss": -5078839.44456086, "vf_loss": 5959260.516217201}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33271.5, "diff_num_grad_updates_vs_sampler_policy": 33270.5}}, "num_env_steps_sampled": 46902000, "num_env_steps_trained": 46902000, "num_agent_steps_sampled": 46902000, "num_agent_steps_trained": 46902000}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176054.95291061042, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828146913445717, "mean_inference_ms": 0.37439925456626383, "mean_action_processing_ms": 0.09206677775770247, "mean_env_wait_ms": 0.7348981939642294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036696998440489477, "StateBufferConnector_ms": 0.0027695480658083546, "ViewRequirementAgentConnector_ms": 0.06749289376395089}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -176054.95291061042, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828146913445717, "mean_inference_ms": 0.37439925456626383, "mean_action_processing_ms": 0.09206677775770247, "mean_env_wait_ms": 0.7348981939642294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036696998440489477, "StateBufferConnector_ms": 0.0027695480658083546, "ViewRequirementAgentConnector_ms": 0.06749289376395089}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46902000, "num_agent_steps_trained": 46902000, "num_env_steps_sampled": 46902000, "num_env_steps_trained": 46902000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 699.772503566606, "num_env_steps_trained_throughput_per_sec": 699.772503566606, "timesteps_total": 46902000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46902000, "timers": {"training_iteration_time_ms": 63233.916, "sample_time_ms": 62083.668, "load_time_ms": 17.003, "load_throughput": 2582999.359, "learn_time_ms": 1132.149, "learn_throughput": 38793.47, "synch_weights_time_ms": 0.936}, "counters": {"num_env_steps_sampled": 46902000, "num_env_steps_trained": 46902000, "num_agent_steps_sampled": 46902000, "num_agent_steps_trained": 46902000}, "done": false, "episodes_total": 9241, "training_iteration": 2978, "trial_id": "3123b_00000", "date": "2023-08-07_15-18-16", "timestamp": 1691410696, "time_this_iter_s": 62.766040086746216, "time_total_s": 80421.48794078827, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3126.3690943717957, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 18.365168539325843, "ram_util_percent": 73.42247191011235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5000000000000005e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.95112423020964, "policy_loss": -4716103.801057421, "vf_loss": 5768154.231049563}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33957.5, "diff_num_grad_updates_vs_sampler_policy": 33956.5}}, "num_env_steps_sampled": 46945920, "num_env_steps_trained": 46945920, "num_agent_steps_sampled": 46945920, "num_agent_steps_trained": 46945920}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175998.936307019, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828157845032747, "mean_inference_ms": 0.37439905086301295, "mean_action_processing_ms": 0.09206670675065651, "mean_env_wait_ms": 0.7346343763079872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036559104919433594, "StateBufferConnector_ms": 0.0027718544006347656, "ViewRequirementAgentConnector_ms": 0.06745147705078125}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175998.936307019, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828157845032747, "mean_inference_ms": 0.37439905086301295, "mean_action_processing_ms": 0.09206670675065651, "mean_env_wait_ms": 0.7346343763079872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036559104919433594, "StateBufferConnector_ms": 0.0027718544006347656, "ViewRequirementAgentConnector_ms": 0.06745147705078125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46945920, "num_agent_steps_trained": 46945920, "num_env_steps_sampled": 46945920, "num_env_steps_trained": 46945920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 697.3824137139336, "num_env_steps_trained_throughput_per_sec": 697.3824137139336, "timesteps_total": 46945920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46945920, "timers": {"training_iteration_time_ms": 63171.073, "sample_time_ms": 62020.599, "load_time_ms": 17.141, "load_throughput": 2562219.306, "learn_time_ms": 1132.239, "learn_throughput": 38790.41, "synch_weights_time_ms": 0.935}, "counters": {"num_env_steps_sampled": 46945920, "num_env_steps_trained": 46945920, "num_agent_steps_sampled": 46945920, "num_agent_steps_trained": 46945920}, "done": false, "episodes_total": 9242, "training_iteration": 2979, "trial_id": "3123b_00000", "date": "2023-08-07_15-19-19", "timestamp": 1691410759, "time_this_iter_s": 62.981181144714355, "time_total_s": 80484.46912193298, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3189.35027551651, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.83820224719101, "ram_util_percent": 73.42471910112359}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000001e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.12600227556146, "policy_loss": -4380610.624746607, "vf_loss": 5731112.822704081}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34643.5, "diff_num_grad_updates_vs_sampler_policy": 34642.5}}, "num_env_steps_sampled": 46989840, "num_env_steps_trained": 46989840, "num_agent_steps_sampled": 46989840, "num_agent_steps_trained": 46989840}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175927.54513518364, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828192125785933, "mean_inference_ms": 0.3743989142831646, "mean_action_processing_ms": 0.09206664451417648, "mean_env_wait_ms": 0.7343711888551997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036482717476639093, "StateBufferConnector_ms": 0.002772200341318168, "ViewRequirementAgentConnector_ms": 0.06743879879222196}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175927.54513518364, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828192125785933, "mean_inference_ms": 0.3743989142831646, "mean_action_processing_ms": 0.09206664451417648, "mean_env_wait_ms": 0.7343711888551997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036482717476639093, "StateBufferConnector_ms": 0.002772200341318168, "ViewRequirementAgentConnector_ms": 0.06743879879222196}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46989840, "num_agent_steps_trained": 46989840, "num_env_steps_sampled": 46989840, "num_env_steps_trained": 46989840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 700.3084181407334, "num_env_steps_trained_throughput_per_sec": 700.3084181407334, "timesteps_total": 46989840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 46989840, "timers": {"training_iteration_time_ms": 63099.411, "sample_time_ms": 61947.64, "load_time_ms": 17.073, "load_throughput": 2572502.705, "learn_time_ms": 1133.595, "learn_throughput": 38743.982, "synch_weights_time_ms": 0.945}, "counters": {"num_env_steps_sampled": 46989840, "num_env_steps_trained": 46989840, "num_agent_steps_sampled": 46989840, "num_agent_steps_trained": 46989840}, "done": false, "episodes_total": 9243, "training_iteration": 2980, "trial_id": "3123b_00000", "date": "2023-08-07_15-20-22", "timestamp": 1691410822, "time_this_iter_s": 62.718194007873535, "time_total_s": 80547.18731594086, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3252.0684695243835, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 18.37415730337079, "ram_util_percent": 73.45393258426967}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000001e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.016946242085, "policy_loss": -5472110.121626162, "vf_loss": 5810079.118895773}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35329.5, "diff_num_grad_updates_vs_sampler_policy": 35328.5}}, "num_env_steps_sampled": 47033760, "num_env_steps_trained": 47033760, "num_agent_steps_sampled": 47033760, "num_agent_steps_trained": 47033760}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175881.45685404848, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828216826975602, "mean_inference_ms": 0.37439860589148277, "mean_action_processing_ms": 0.09206650920056472, "mean_env_wait_ms": 0.7341121364344462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036427607903113733, "StateBufferConnector_ms": 0.0027711574847881612, "ViewRequirementAgentConnector_ms": 0.06737938294043908}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175881.45685404848, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828216826975602, "mean_inference_ms": 0.37439860589148277, "mean_action_processing_ms": 0.09206650920056472, "mean_env_wait_ms": 0.7341121364344462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036427607903113733, "StateBufferConnector_ms": 0.0027711574847881612, "ViewRequirementAgentConnector_ms": 0.06737938294043908}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47033760, "num_agent_steps_trained": 47033760, "num_env_steps_sampled": 47033760, "num_env_steps_trained": 47033760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 696.9189467966511, "num_env_steps_trained_throughput_per_sec": 696.9189467966511, "timesteps_total": 47033760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47033760, "timers": {"training_iteration_time_ms": 63051.244, "sample_time_ms": 61900.002, "load_time_ms": 17.019, "load_throughput": 2580622.016, "learn_time_ms": 1133.129, "learn_throughput": 38759.946, "synch_weights_time_ms": 0.937}, "counters": {"num_env_steps_sampled": 47033760, "num_env_steps_trained": 47033760, "num_agent_steps_sampled": 47033760, "num_agent_steps_trained": 47033760}, "done": false, "episodes_total": 9244, "training_iteration": 2981, "trial_id": "3123b_00000", "date": "2023-08-07_15-21-25", "timestamp": 1691410885, "time_this_iter_s": 63.02307105064392, "time_total_s": 80610.2103869915, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3315.0915405750275, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 18.09887640449438, "ram_util_percent": 73.47865168539326}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000001e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.156564517897, "policy_loss": -4691321.544460641, "vf_loss": 5786062.759384111}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36015.5, "diff_num_grad_updates_vs_sampler_policy": 36014.5}}, "num_env_steps_sampled": 47077680, "num_env_steps_trained": 47077680, "num_agent_steps_sampled": 47077680, "num_agent_steps_trained": 47077680}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175825.45750516414, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828225411734575, "mean_inference_ms": 0.3743979811070734, "mean_action_processing_ms": 0.09206643519071703, "mean_env_wait_ms": 0.7338539197775724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036343088689840064, "StateBufferConnector_ms": 0.0027701539813347583, "ViewRequirementAgentConnector_ms": 0.0673595464454507}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175825.45750516414, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828225411734575, "mean_inference_ms": 0.3743979811070734, "mean_action_processing_ms": 0.09206643519071703, "mean_env_wait_ms": 0.7338539197775724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036343088689840064, "StateBufferConnector_ms": 0.0027701539813347583, "ViewRequirementAgentConnector_ms": 0.0673595464454507}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47077680, "num_agent_steps_trained": 47077680, "num_env_steps_sampled": 47077680, "num_env_steps_trained": 47077680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 701.5100327424072, "num_env_steps_trained_throughput_per_sec": 701.5100327424072, "timesteps_total": 47077680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47077680, "timers": {"training_iteration_time_ms": 62970.385, "sample_time_ms": 61818.854, "load_time_ms": 16.965, "load_throughput": 2588883.697, "learn_time_ms": 1133.475, "learn_throughput": 38748.084, "synch_weights_time_ms": 0.933}, "counters": {"num_env_steps_sampled": 47077680, "num_env_steps_trained": 47077680, "num_agent_steps_sampled": 47077680, "num_agent_steps_trained": 47077680}, "done": false, "episodes_total": 9245, "training_iteration": 2982, "trial_id": "3123b_00000", "date": "2023-08-07_15-22-28", "timestamp": 1691410948, "time_this_iter_s": 62.610735177993774, "time_total_s": 80672.8211221695, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3377.7022757530212, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 18.387640449438205, "ram_util_percent": 73.50337078651684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000001e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.9674053136531, "policy_loss": -4834748.418330334, "vf_loss": 5693749.711188046}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36701.5, "diff_num_grad_updates_vs_sampler_policy": 36700.5}}, "num_env_steps_sampled": 47121600, "num_env_steps_trained": 47121600, "num_agent_steps_sampled": 47121600, "num_agent_steps_trained": 47121600}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175752.26957790568, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828214719701947, "mean_inference_ms": 0.37439725491739917, "mean_action_processing_ms": 0.09206634120868602, "mean_env_wait_ms": 0.7336017641219678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003612482989275897, "StateBufferConnector_ms": 0.0027683046129014757, "ViewRequirementAgentConnector_ms": 0.0673161612616645}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175752.26957790568, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828214719701947, "mean_inference_ms": 0.37439725491739917, "mean_action_processing_ms": 0.09206634120868602, "mean_env_wait_ms": 0.7336017641219678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003612482989275897, "StateBufferConnector_ms": 0.0027683046129014757, "ViewRequirementAgentConnector_ms": 0.0673161612616645}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47121600, "num_agent_steps_trained": 47121600, "num_env_steps_sampled": 47121600, "num_env_steps_trained": 47121600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 694.2346953555866, "num_env_steps_trained_throughput_per_sec": 694.2346953555866, "timesteps_total": 47121600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47121600, "timers": {"training_iteration_time_ms": 62993.741, "sample_time_ms": 61840.759, "load_time_ms": 16.929, "load_throughput": 2594312.54, "learn_time_ms": 1134.963, "learn_throughput": 38697.3, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 47121600, "num_env_steps_trained": 47121600, "num_agent_steps_sampled": 47121600, "num_agent_steps_trained": 47121600}, "done": false, "episodes_total": 9246, "training_iteration": 2983, "trial_id": "3123b_00000", "date": "2023-08-07_15-23-31", "timestamp": 1691411011, "time_this_iter_s": 63.26673769950867, "time_total_s": 80736.087859869, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3440.96901345253, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 17.742696629213484, "ram_util_percent": 73.50224719101122}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000001e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.17161457740184, "policy_loss": -4313079.629171032, "vf_loss": 5953245.682215744}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37387.5, "diff_num_grad_updates_vs_sampler_policy": 37386.5}}, "num_env_steps_sampled": 47165520, "num_env_steps_trained": 47165520, "num_agent_steps_sampled": 47165520, "num_agent_steps_trained": 47165520}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175745.26515665525, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182819534673711, "mean_inference_ms": 0.37439639568853134, "mean_action_processing_ms": 0.09206619814878879, "mean_env_wait_ms": 0.7333502949112759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036057558926669035, "StateBufferConnector_ms": 0.0027652220292524858, "ViewRequirementAgentConnector_ms": 0.06728605790571733}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175745.26515665525, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182819534673711, "mean_inference_ms": 0.37439639568853134, "mean_action_processing_ms": 0.09206619814878879, "mean_env_wait_ms": 0.7333502949112759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036057558926669035, "StateBufferConnector_ms": 0.0027652220292524858, "ViewRequirementAgentConnector_ms": 0.06728605790571733}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47165520, "num_agent_steps_trained": 47165520, "num_env_steps_sampled": 47165520, "num_env_steps_trained": 47165520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 701.8897029088919, "num_env_steps_trained_throughput_per_sec": 701.8897029088919, "timesteps_total": 47165520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47165520, "timers": {"training_iteration_time_ms": 62935.05, "sample_time_ms": 61779.936, "load_time_ms": 16.884, "load_throughput": 2601247.314, "learn_time_ms": 1137.145, "learn_throughput": 38623.045, "synch_weights_time_ms": 0.927}, "counters": {"num_env_steps_sampled": 47165520, "num_env_steps_trained": 47165520, "num_agent_steps_sampled": 47165520, "num_agent_steps_trained": 47165520}, "done": false, "episodes_total": 9247, "training_iteration": 2984, "trial_id": "3123b_00000", "date": "2023-08-07_15-24-34", "timestamp": 1691411074, "time_this_iter_s": 62.57673907279968, "time_total_s": 80798.6645989418, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3503.5457525253296, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 17.897752808988763, "ram_util_percent": 73.5247191011236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000001e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.1569561304921, "policy_loss": -4601256.152585755, "vf_loss": 5466682.542274052}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38073.5, "diff_num_grad_updates_vs_sampler_policy": 38072.5}}, "num_env_steps_sampled": 47209440, "num_env_steps_trained": 47209440, "num_agent_steps_sampled": 47209440, "num_agent_steps_trained": 47209440}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175630.65602405468, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182815371100035, "mean_inference_ms": 0.37439564505363887, "mean_action_processing_ms": 0.09206607175438929, "mean_env_wait_ms": 0.7331034443417881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003602675029209682, "StateBufferConnector_ms": 0.0027639525277273996, "ViewRequirementAgentConnector_ms": 0.0672370195388794}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175630.65602405468, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182815371100035, "mean_inference_ms": 0.37439564505363887, "mean_action_processing_ms": 0.09206607175438929, "mean_env_wait_ms": 0.7331034443417881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003602675029209682, "StateBufferConnector_ms": 0.0027639525277273996, "ViewRequirementAgentConnector_ms": 0.0672370195388794}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47209440, "num_agent_steps_trained": 47209440, "num_env_steps_sampled": 47209440, "num_env_steps_trained": 47209440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 695.493092288141, "num_env_steps_trained_throughput_per_sec": 695.493092288141, "timesteps_total": 47209440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47209440, "timers": {"training_iteration_time_ms": 62934.39, "sample_time_ms": 61772.114, "load_time_ms": 16.99, "load_throughput": 2585018.287, "learn_time_ms": 1144.198, "learn_throughput": 38384.98, "synch_weights_time_ms": 0.926}, "counters": {"num_env_steps_sampled": 47209440, "num_env_steps_trained": 47209440, "num_agent_steps_sampled": 47209440, "num_agent_steps_trained": 47209440}, "done": false, "episodes_total": 9248, "training_iteration": 2985, "trial_id": "3123b_00000", "date": "2023-08-07_15-25-37", "timestamp": 1691411137, "time_this_iter_s": 63.15204977989197, "time_total_s": 80861.8166487217, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3566.6978023052216, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 19.288888888888888, "ram_util_percent": 73.56555555555558}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000001e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.14374593395536, "policy_loss": -5089427.560054323, "vf_loss": 5887189.816599854}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38759.5, "diff_num_grad_updates_vs_sampler_policy": 38758.5}}, "num_env_steps_sampled": 47253360, "num_env_steps_trained": 47253360, "num_agent_steps_sampled": 47253360, "num_agent_steps_trained": 47253360}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175609.82978313955, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828124714591032, "mean_inference_ms": 0.3743950598785942, "mean_action_processing_ms": 0.09206587098054089, "mean_env_wait_ms": 0.7328583910333271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035942646495082924, "StateBufferConnector_ms": 0.0027572899533991227, "ViewRequirementAgentConnector_ms": 0.06725035215678968}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175609.82978313955, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828124714591032, "mean_inference_ms": 0.3743950598785942, "mean_action_processing_ms": 0.09206587098054089, "mean_env_wait_ms": 0.7328583910333271, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035942646495082924, "StateBufferConnector_ms": 0.0027572899533991227, "ViewRequirementAgentConnector_ms": 0.06725035215678968}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47253360, "num_agent_steps_trained": 47253360, "num_env_steps_sampled": 47253360, "num_env_steps_trained": 47253360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 700.0287757105548, "num_env_steps_trained_throughput_per_sec": 700.0287757105548, "timesteps_total": 47253360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47253360, "timers": {"training_iteration_time_ms": 62892.845, "sample_time_ms": 61732.428, "load_time_ms": 16.976, "load_throughput": 2587243.847, "learn_time_ms": 1142.342, "learn_throughput": 38447.323, "synch_weights_time_ms": 0.938}, "counters": {"num_env_steps_sampled": 47253360, "num_env_steps_trained": 47253360, "num_agent_steps_sampled": 47253360, "num_agent_steps_trained": 47253360}, "done": false, "episodes_total": 9249, "training_iteration": 2986, "trial_id": "3123b_00000", "date": "2023-08-07_15-26-40", "timestamp": 1691411200, "time_this_iter_s": 62.74314594268799, "time_total_s": 80924.55979466438, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3629.4409482479095, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 19.654545454545453, "ram_util_percent": 73.2590909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000001e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.8669298355503, "policy_loss": -4750031.471367928, "vf_loss": 5729720.328671647}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39445.5, "diff_num_grad_updates_vs_sampler_policy": 39444.5}}, "num_env_steps_sampled": 47297280, "num_env_steps_trained": 47297280, "num_agent_steps_sampled": 47297280, "num_agent_steps_trained": 47297280}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175564.99474872838, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182809409133937, "mean_inference_ms": 0.3743943004980201, "mean_action_processing_ms": 0.09206559838371117, "mean_env_wait_ms": 0.7326155480338595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035894328150255926, "StateBufferConnector_ms": 0.002783331377752896, "ViewRequirementAgentConnector_ms": 0.06723568357270339}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175564.99474872838, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182809409133937, "mean_inference_ms": 0.3743943004980201, "mean_action_processing_ms": 0.09206559838371117, "mean_env_wait_ms": 0.7326155480338595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035894328150255926, "StateBufferConnector_ms": 0.002783331377752896, "ViewRequirementAgentConnector_ms": 0.06723568357270339}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47297280, "num_agent_steps_trained": 47297280, "num_env_steps_sampled": 47297280, "num_env_steps_trained": 47297280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 700.21401783873, "num_env_steps_trained_throughput_per_sec": 700.21401783873, "timesteps_total": 47297280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47297280, "timers": {"training_iteration_time_ms": 62853.59, "sample_time_ms": 61692.382, "load_time_ms": 16.948, "load_throughput": 2591433.04, "learn_time_ms": 1143.162, "learn_throughput": 38419.749, "synch_weights_time_ms": 0.937}, "counters": {"num_env_steps_sampled": 47297280, "num_env_steps_trained": 47297280, "num_agent_steps_sampled": 47297280, "num_agent_steps_trained": 47297280}, "done": false, "episodes_total": 9250, "training_iteration": 2987, "trial_id": "3123b_00000", "date": "2023-08-07_15-27-42", "timestamp": 1691411262, "time_this_iter_s": 62.72659206390381, "time_total_s": 80987.28638672829, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3692.1675403118134, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 17.830337078651684, "ram_util_percent": 73.25280898876403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000001e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.9625235243372, "policy_loss": -4725179.078415406, "vf_loss": 5654355.311133382}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40131.5, "diff_num_grad_updates_vs_sampler_policy": 40130.5}}, "num_env_steps_sampled": 47341200, "num_env_steps_trained": 47341200, "num_agent_steps_sampled": 47341200, "num_agent_steps_trained": 47341200}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175502.13288017942, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828071155533882, "mean_inference_ms": 0.37439359201162903, "mean_action_processing_ms": 0.09206532226122344, "mean_env_wait_ms": 0.732376359273484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035807237786761783, "StateBufferConnector_ms": 0.002783435886189089, "ViewRequirementAgentConnector_ms": 0.06720373186014467}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175502.13288017942, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828071155533882, "mean_inference_ms": 0.37439359201162903, "mean_action_processing_ms": 0.09206532226122344, "mean_env_wait_ms": 0.732376359273484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035807237786761783, "StateBufferConnector_ms": 0.002783435886189089, "ViewRequirementAgentConnector_ms": 0.06720373186014467}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47341200, "num_agent_steps_trained": 47341200, "num_env_steps_sampled": 47341200, "num_env_steps_trained": 47341200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 697.4759727913926, "num_env_steps_trained_throughput_per_sec": 697.4759727913926, "timesteps_total": 47341200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47341200, "timers": {"training_iteration_time_ms": 62874.256, "sample_time_ms": 61712.689, "load_time_ms": 16.938, "load_throughput": 2592950.459, "learn_time_ms": 1143.535, "learn_throughput": 38407.214, "synch_weights_time_ms": 0.933}, "counters": {"num_env_steps_sampled": 47341200, "num_env_steps_trained": 47341200, "num_agent_steps_sampled": 47341200, "num_agent_steps_trained": 47341200}, "done": false, "episodes_total": 9251, "training_iteration": 2988, "trial_id": "3123b_00000", "date": "2023-08-07_15-28-45", "timestamp": 1691411325, "time_this_iter_s": 62.97264289855957, "time_total_s": 81050.25902962685, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3755.140183210373, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 18.38314606741573, "ram_util_percent": 73.3269662921348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000001e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.2683294980241, "policy_loss": -4728602.482937204, "vf_loss": 5637319.3125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40817.5, "diff_num_grad_updates_vs_sampler_policy": 40816.5}}, "num_env_steps_sampled": 47385120, "num_env_steps_trained": 47385120, "num_agent_steps_sampled": 47385120, "num_agent_steps_trained": 47385120}, "sampler_results": {"episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175430.956149253, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828005576277817, "mean_inference_ms": 0.3743926179782287, "mean_action_processing_ms": 0.0920650481808925, "mean_env_wait_ms": 0.7321398192288276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035782655080159507, "StateBufferConnector_ms": 0.002778768539428711, "ViewRequirementAgentConnector_ms": 0.06719350814819336}}, "episode_reward_max": -168957.58069931838, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175430.956149253, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828005576277817, "mean_inference_ms": 0.3743926179782287, "mean_action_processing_ms": 0.0920650481808925, "mean_env_wait_ms": 0.7321398192288276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035782655080159507, "StateBufferConnector_ms": 0.002778768539428711, "ViewRequirementAgentConnector_ms": 0.06719350814819336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47385120, "num_agent_steps_trained": 47385120, "num_env_steps_sampled": 47385120, "num_env_steps_trained": 47385120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 700.5290376061804, "num_env_steps_trained_throughput_per_sec": 700.5290376061804, "timesteps_total": 47385120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47385120, "timers": {"training_iteration_time_ms": 62845.967, "sample_time_ms": 61684.482, "load_time_ms": 16.853, "load_throughput": 2606068.085, "learn_time_ms": 1143.54, "learn_throughput": 38407.045, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 47385120, "num_env_steps_trained": 47385120, "num_agent_steps_sampled": 47385120, "num_agent_steps_trained": 47385120}, "done": false, "episodes_total": 9252, "training_iteration": 2989, "trial_id": "3123b_00000", "date": "2023-08-07_15-29-48", "timestamp": 1691411388, "time_this_iter_s": 62.69845509529114, "time_total_s": 81112.95748472214, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3817.838638305664, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 17.693258426966292, "ram_util_percent": 73.31573033707865}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000001e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.9891599427159, "policy_loss": -4011065.1778681898, "vf_loss": 5106182.4142674925}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 41503.5, "diff_num_grad_updates_vs_sampler_policy": 41502.5}}, "num_env_steps_sampled": 47429040, "num_env_steps_trained": 47429040, "num_agent_steps_sampled": 47429040, "num_agent_steps_trained": 47429040}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175246.98182279157, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828021094607766, "mean_inference_ms": 0.37439150358681167, "mean_action_processing_ms": 0.09206475754713912, "mean_env_wait_ms": 0.7319022550267634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00357315188548604, "StateBufferConnector_ms": 0.0027801169723760885, "ViewRequirementAgentConnector_ms": 0.06717697518770813}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175246.98182279157, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828021094607766, "mean_inference_ms": 0.37439150358681167, "mean_action_processing_ms": 0.09206475754713912, "mean_env_wait_ms": 0.7319022550267634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00357315188548604, "StateBufferConnector_ms": 0.0027801169723760885, "ViewRequirementAgentConnector_ms": 0.06717697518770813}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47429040, "num_agent_steps_trained": 47429040, "num_env_steps_sampled": 47429040, "num_env_steps_trained": 47429040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 705.0401718144979, "num_env_steps_trained_throughput_per_sec": 705.0401718144979, "timesteps_total": 47429040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47429040, "timers": {"training_iteration_time_ms": 62803.877, "sample_time_ms": 61642.245, "load_time_ms": 16.945, "load_throughput": 2591979.982, "learn_time_ms": 1143.6, "learn_throughput": 38405.053, "synch_weights_time_ms": 0.927}, "counters": {"num_env_steps_sampled": 47429040, "num_env_steps_trained": 47429040, "num_agent_steps_sampled": 47429040, "num_agent_steps_trained": 47429040}, "done": false, "episodes_total": 9253, "training_iteration": 2990, "trial_id": "3123b_00000", "date": "2023-08-07_15-30-50", "timestamp": 1691411450, "time_this_iter_s": 62.29722213745117, "time_total_s": 81175.25470685959, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3880.1358604431152, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 18.19090909090909, "ram_util_percent": 73.42500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000001e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.9980021663032, "policy_loss": -4340271.087546123, "vf_loss": 5434190.499498907}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 42189.5, "diff_num_grad_updates_vs_sampler_policy": 42188.5}}, "num_env_steps_sampled": 47472960, "num_env_steps_trained": 47472960, "num_agent_steps_sampled": 47472960, "num_agent_steps_trained": 47472960}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175149.1662702346, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21827985407642292, "mean_inference_ms": 0.3743906479406991, "mean_action_processing_ms": 0.09206452361491056, "mean_env_wait_ms": 0.7316682866914207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036293460476783013, "StateBufferConnector_ms": 0.0027745000777706025, "ViewRequirementAgentConnector_ms": 0.06719750742758474}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175149.1662702346, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21827985407642292, "mean_inference_ms": 0.3743906479406991, "mean_action_processing_ms": 0.09206452361491056, "mean_env_wait_ms": 0.7316682866914207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036293460476783013, "StateBufferConnector_ms": 0.0027745000777706025, "ViewRequirementAgentConnector_ms": 0.06719750742758474}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47472960, "num_agent_steps_trained": 47472960, "num_env_steps_sampled": 47472960, "num_env_steps_trained": 47472960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 698.6532996487881, "num_env_steps_trained_throughput_per_sec": 698.6532996487881, "timesteps_total": 47472960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47472960, "timers": {"training_iteration_time_ms": 62788.233, "sample_time_ms": 61626.228, "load_time_ms": 16.906, "load_throughput": 2597956.649, "learn_time_ms": 1143.999, "learn_throughput": 38391.651, "synch_weights_time_ms": 0.939}, "counters": {"num_env_steps_sampled": 47472960, "num_env_steps_trained": 47472960, "num_agent_steps_sampled": 47472960, "num_agent_steps_trained": 47472960}, "done": false, "episodes_total": 9254, "training_iteration": 2991, "trial_id": "3123b_00000", "date": "2023-08-07_15-31-53", "timestamp": 1691411513, "time_this_iter_s": 62.86662817001343, "time_total_s": 81238.1213350296, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3943.0024886131287, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 18.103333333333335, "ram_util_percent": 73.44333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000001e-16, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.9611589971159, "policy_loss": -4145371.9377961005, "vf_loss": 5418521.861333819}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 42875.5, "diff_num_grad_updates_vs_sampler_policy": 42874.5}}, "num_env_steps_sampled": 47516880, "num_env_steps_trained": 47516880, "num_agent_steps_sampled": 47516880, "num_agent_steps_trained": 47516880}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175045.1800804204, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21827927660639174, "mean_inference_ms": 0.3743899179557008, "mean_action_processing_ms": 0.0920643044319313, "mean_env_wait_ms": 0.7314382714441316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036213133070203993, "StateBufferConnector_ms": 0.0027698183816576762, "ViewRequirementAgentConnector_ms": 0.06716099996415395}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -175045.1800804204, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21827927660639174, "mean_inference_ms": 0.3743899179557008, "mean_action_processing_ms": 0.0920643044319313, "mean_env_wait_ms": 0.7314382714441316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036213133070203993, "StateBufferConnector_ms": 0.0027698183816576762, "ViewRequirementAgentConnector_ms": 0.06716099996415395}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47516880, "num_agent_steps_trained": 47516880, "num_env_steps_sampled": 47516880, "num_env_steps_trained": 47516880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 697.4459930255413, "num_env_steps_trained_throughput_per_sec": 697.4459930255413, "timesteps_total": 47516880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47516880, "timers": {"training_iteration_time_ms": 62824.715, "sample_time_ms": 61663.285, "load_time_ms": 16.895, "load_throughput": 2599511.064, "learn_time_ms": 1143.436, "learn_throughput": 38410.539, "synch_weights_time_ms": 0.937}, "counters": {"num_env_steps_sampled": 47516880, "num_env_steps_trained": 47516880, "num_agent_steps_sampled": 47516880, "num_agent_steps_trained": 47516880}, "done": false, "episodes_total": 9255, "training_iteration": 2992, "trial_id": "3123b_00000", "date": "2023-08-07_15-32-56", "timestamp": 1691411576, "time_this_iter_s": 62.97572684288025, "time_total_s": 81301.09706187248, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4005.978215456009, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 18.09438202247191, "ram_util_percent": 73.41123595505617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.333333333333336e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -358.97094045922637, "policy_loss": -4409129.076932056, "vf_loss": 5407022.698979592}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43561.5, "diff_num_grad_updates_vs_sampler_policy": 43560.5}}, "num_env_steps_sampled": 47560800, "num_env_steps_trained": 47560800, "num_agent_steps_sampled": 47560800, "num_agent_steps_trained": 47560800}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174942.5240003316, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182784197461797, "mean_inference_ms": 0.3743893195191882, "mean_action_processing_ms": 0.09206405527210137, "mean_env_wait_ms": 0.731210534560002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036153942346572876, "StateBufferConnector_ms": 0.002767890691757202, "ViewRequirementAgentConnector_ms": 0.06720349192619324}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174942.5240003316, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182784197461797, "mean_inference_ms": 0.3743893195191882, "mean_action_processing_ms": 0.09206405527210137, "mean_env_wait_ms": 0.731210534560002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036153942346572876, "StateBufferConnector_ms": 0.002767890691757202, "ViewRequirementAgentConnector_ms": 0.06720349192619324}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47560800, "num_agent_steps_trained": 47560800, "num_env_steps_sampled": 47560800, "num_env_steps_trained": 47560800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 700.7176258225472, "num_env_steps_trained_throughput_per_sec": 700.7176258225472, "timesteps_total": 47560800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47560800, "timers": {"training_iteration_time_ms": 62766.184, "sample_time_ms": 61605.466, "load_time_ms": 16.924, "load_throughput": 2595182.391, "learn_time_ms": 1142.7, "learn_throughput": 38435.294, "synch_weights_time_ms": 0.933}, "counters": {"num_env_steps_sampled": 47560800, "num_env_steps_trained": 47560800, "num_agent_steps_sampled": 47560800, "num_agent_steps_trained": 47560800}, "done": false, "episodes_total": 9256, "training_iteration": 2993, "trial_id": "3123b_00000", "date": "2023-08-07_15-33-59", "timestamp": 1691411639, "time_this_iter_s": 62.68154215812683, "time_total_s": 81363.77860403061, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4068.6597576141357, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 18.092134831460676, "ram_util_percent": 73.42808988764044}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.666666666666666e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.1338900018364, "policy_loss": -4384668.112011434, "vf_loss": 5581644.248360058}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 44247.5, "diff_num_grad_updates_vs_sampler_policy": 44246.5}}, "num_env_steps_sampled": 47604720, "num_env_steps_trained": 47604720, "num_agent_steps_sampled": 47604720, "num_agent_steps_trained": 47604720}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174874.11338358634, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21827723012912553, "mean_inference_ms": 0.374388676103179, "mean_action_processing_ms": 0.09206382826437833, "mean_env_wait_ms": 0.7309850100402343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00360562251164363, "StateBufferConnector_ms": 0.0027601535503680888, "ViewRequirementAgentConnector_ms": 0.0671856219951923}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174874.11338358634, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21827723012912553, "mean_inference_ms": 0.374388676103179, "mean_action_processing_ms": 0.09206382826437833, "mean_env_wait_ms": 0.7309850100402343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00360562251164363, "StateBufferConnector_ms": 0.0027601535503680888, "ViewRequirementAgentConnector_ms": 0.0671856219951923}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47604720, "num_agent_steps_trained": 47604720, "num_env_steps_sampled": 47604720, "num_env_steps_trained": 47604720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 701.1980884735082, "num_env_steps_trained_throughput_per_sec": 701.1980884735082, "timesteps_total": 47604720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47604720, "timers": {"training_iteration_time_ms": 62772.356, "sample_time_ms": 61610.154, "load_time_ms": 16.99, "load_throughput": 2585069.073, "learn_time_ms": 1144.119, "learn_throughput": 38387.618, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 47604720, "num_env_steps_trained": 47604720, "num_agent_steps_sampled": 47604720, "num_agent_steps_trained": 47604720}, "done": false, "episodes_total": 9257, "training_iteration": 2994, "trial_id": "3123b_00000", "date": "2023-08-07_15-35-02", "timestamp": 1691411702, "time_this_iter_s": 62.63863801956177, "time_total_s": 81426.41724205017, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4131.2983956336975, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 18.47159090909091, "ram_util_percent": 73.43295454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.23855346145854, "policy_loss": -4140711.2743400373, "vf_loss": 5311667.845845481}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 44933.5, "diff_num_grad_updates_vs_sampler_policy": 44932.5}}, "num_env_steps_sampled": 47648640, "num_env_steps_trained": 47648640, "num_agent_steps_sampled": 47648640, "num_agent_steps_trained": 47648640}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174749.71271604009, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21827748831187252, "mean_inference_ms": 0.37438861080146363, "mean_action_processing_ms": 0.09206368721713344, "mean_env_wait_ms": 0.7307587352330026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035972306222626657, "StateBufferConnector_ms": 0.002755902030251243, "ViewRequirementAgentConnector_ms": 0.0672130873709014}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174749.71271604009, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21827748831187252, "mean_inference_ms": 0.37438861080146363, "mean_action_processing_ms": 0.09206368721713344, "mean_env_wait_ms": 0.7307587352330026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035972306222626657, "StateBufferConnector_ms": 0.002755902030251243, "ViewRequirementAgentConnector_ms": 0.0672130873709014}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47648640, "num_agent_steps_trained": 47648640, "num_env_steps_sampled": 47648640, "num_env_steps_trained": 47648640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 702.5814182380949, "num_env_steps_trained_throughput_per_sec": 702.5814182380949, "timesteps_total": 47648640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47648640, "timers": {"training_iteration_time_ms": 62708.643, "sample_time_ms": 61552.008, "load_time_ms": 16.912, "load_throughput": 2597011.711, "learn_time_ms": 1138.635, "learn_throughput": 38572.498, "synch_weights_time_ms": 0.924}, "counters": {"num_env_steps_sampled": 47648640, "num_env_steps_trained": 47648640, "num_agent_steps_sampled": 47648640, "num_agent_steps_trained": 47648640}, "done": false, "episodes_total": 9258, "training_iteration": 2995, "trial_id": "3123b_00000", "date": "2023-08-07_15-36-04", "timestamp": 1691411764, "time_this_iter_s": 62.515559911727905, "time_total_s": 81488.9328019619, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4193.813955545425, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 18.352808988764046, "ram_util_percent": 73.4258426966292}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.15270755867914, "policy_loss": -4634513.269124112, "vf_loss": 5658622.842930029}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 45619.5, "diff_num_grad_updates_vs_sampler_policy": 45618.5}}, "num_env_steps_sampled": 47692560, "num_env_steps_trained": 47692560, "num_agent_steps_sampled": 47692560, "num_agent_steps_trained": 47692560}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174704.9206178086, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21827803463886672, "mean_inference_ms": 0.37438822362524893, "mean_action_processing_ms": 0.09206354423383606, "mean_env_wait_ms": 0.7305336137906634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003637128801488165, "StateBufferConnector_ms": 0.0027546242101868586, "ViewRequirementAgentConnector_ms": 0.06730093884823928}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174704.9206178086, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21827803463886672, "mean_inference_ms": 0.37438822362524893, "mean_action_processing_ms": 0.09206354423383606, "mean_env_wait_ms": 0.7305336137906634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003637128801488165, "StateBufferConnector_ms": 0.0027546242101868586, "ViewRequirementAgentConnector_ms": 0.06730093884823928}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47692560, "num_agent_steps_trained": 47692560, "num_env_steps_sampled": 47692560, "num_env_steps_trained": 47692560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 703.6106387336647, "num_env_steps_trained_throughput_per_sec": 703.6106387336647, "timesteps_total": 47692560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47692560, "timers": {"training_iteration_time_ms": 62676.705, "sample_time_ms": 61520.779, "load_time_ms": 16.838, "load_throughput": 2608348.519, "learn_time_ms": 1138.015, "learn_throughput": 38593.518, "synch_weights_time_ms": 0.909}, "counters": {"num_env_steps_sampled": 47692560, "num_env_steps_trained": 47692560, "num_agent_steps_sampled": 47692560, "num_agent_steps_trained": 47692560}, "done": false, "episodes_total": 9259, "training_iteration": 2996, "trial_id": "3123b_00000", "date": "2023-08-07_15-37-07", "timestamp": 1691411827, "time_this_iter_s": 62.42376112937927, "time_total_s": 81551.35656309128, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4256.237716674805, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 18.553409090909092, "ram_util_percent": 73.42272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.0462307499032, "policy_loss": -4143218.8544181623, "vf_loss": 5593009.96574344}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 46304.5}}, "num_env_steps_sampled": 47736480, "num_env_steps_trained": 47736480, "num_agent_steps_sampled": 47736480, "num_agent_steps_trained": 47736480}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174645.70572490932, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21827911279692608, "mean_inference_ms": 0.37438779950523154, "mean_action_processing_ms": 0.09206337536942757, "mean_env_wait_ms": 0.7303099044430229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036327277912813075, "StateBufferConnector_ms": 0.0027498778174905214, "ViewRequirementAgentConnector_ms": 0.06733326350941378}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174645.70572490932, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21827911279692608, "mean_inference_ms": 0.37438779950523154, "mean_action_processing_ms": 0.09206337536942757, "mean_env_wait_ms": 0.7303099044430229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036327277912813075, "StateBufferConnector_ms": 0.0027498778174905214, "ViewRequirementAgentConnector_ms": 0.06733326350941378}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47736480, "num_agent_steps_trained": 47736480, "num_env_steps_sampled": 47736480, "num_env_steps_trained": 47736480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 700.3798122427274, "num_env_steps_trained_throughput_per_sec": 700.3798122427274, "timesteps_total": 47736480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47736480, "timers": {"training_iteration_time_ms": 62675.221, "sample_time_ms": 61508.154, "load_time_ms": 17.414, "load_throughput": 2522160.786, "learn_time_ms": 1148.573, "learn_throughput": 38238.769, "synch_weights_time_ms": 0.911}, "counters": {"num_env_steps_sampled": 47736480, "num_env_steps_trained": 47736480, "num_agent_steps_sampled": 47736480, "num_agent_steps_trained": 47736480}, "done": false, "episodes_total": 9260, "training_iteration": 2997, "trial_id": "3123b_00000", "date": "2023-08-07_15-38-09", "timestamp": 1691411889, "time_this_iter_s": 62.71247315406799, "time_total_s": 81614.06903624535, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4318.950189828873, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 18.791011235955057, "ram_util_percent": 73.438202247191}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.15374947150315, "policy_loss": -4518759.334587964, "vf_loss": 5631125.206632653}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 46991.5, "diff_num_grad_updates_vs_sampler_policy": 46990.5}}, "num_env_steps_sampled": 47780400, "num_env_steps_trained": 47780400, "num_agent_steps_sampled": 47780400, "num_agent_steps_trained": 47780400}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174596.89463121237, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828037283772433, "mean_inference_ms": 0.37438724811122337, "mean_action_processing_ms": 0.09206320221883489, "mean_env_wait_ms": 0.7300904580960256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003626035607379416, "StateBufferConnector_ms": 0.0027466511380845222, "ViewRequirementAgentConnector_ms": 0.06730763808540675}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174596.89463121237, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828037283772433, "mean_inference_ms": 0.37438724811122337, "mean_action_processing_ms": 0.09206320221883489, "mean_env_wait_ms": 0.7300904580960256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003626035607379416, "StateBufferConnector_ms": 0.0027466511380845222, "ViewRequirementAgentConnector_ms": 0.06730763808540675}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47780400, "num_agent_steps_trained": 47780400, "num_env_steps_sampled": 47780400, "num_env_steps_trained": 47780400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 696.1407128956914, "num_env_steps_trained_throughput_per_sec": 696.1407128956914, "timesteps_total": 47780400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47780400, "timers": {"training_iteration_time_ms": 62687.299, "sample_time_ms": 61518.018, "load_time_ms": 17.465, "load_throughput": 2514809.665, "learn_time_ms": 1150.733, "learn_throughput": 38166.969, "synch_weights_time_ms": 0.912}, "counters": {"num_env_steps_sampled": 47780400, "num_env_steps_trained": 47780400, "num_agent_steps_sampled": 47780400, "num_agent_steps_trained": 47780400}, "done": false, "episodes_total": 9261, "training_iteration": 2998, "trial_id": "3123b_00000", "date": "2023-08-07_15-39-13", "timestamp": 1691411953, "time_this_iter_s": 63.09348487854004, "time_total_s": 81677.16252112389, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4382.043674707413, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 17.692134831460674, "ram_util_percent": 73.45505617977526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.0176292842053, "policy_loss": -3785238.796968955, "vf_loss": 5254889.547922741}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 47677.5, "diff_num_grad_updates_vs_sampler_policy": 47676.5}}, "num_env_steps_sampled": 47824320, "num_env_steps_trained": 47824320, "num_agent_steps_sampled": 47824320, "num_agent_steps_trained": 47824320}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174484.67955100312, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828136703937215, "mean_inference_ms": 0.37438657449347146, "mean_action_processing_ms": 0.09206301767873651, "mean_env_wait_ms": 0.729872434392062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036219188145228793, "StateBufferConnector_ms": 0.002742494855608259, "ViewRequirementAgentConnector_ms": 0.06728546960013253}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174484.67955100312, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828136703937215, "mean_inference_ms": 0.37438657449347146, "mean_action_processing_ms": 0.09206301767873651, "mean_env_wait_ms": 0.729872434392062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036219188145228793, "StateBufferConnector_ms": 0.002742494855608259, "ViewRequirementAgentConnector_ms": 0.06728546960013253}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47824320, "num_agent_steps_trained": 47824320, "num_env_steps_sampled": 47824320, "num_env_steps_trained": 47824320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 703.8290521637203, "num_env_steps_trained_throughput_per_sec": 703.8290521637203, "timesteps_total": 47824320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47824320, "timers": {"training_iteration_time_ms": 62657.903, "sample_time_ms": 61487.304, "load_time_ms": 17.582, "load_throughput": 2498065.32, "learn_time_ms": 1151.941, "learn_throughput": 38126.942, "synch_weights_time_ms": 0.904}, "counters": {"num_env_steps_sampled": 47824320, "num_env_steps_trained": 47824320, "num_agent_steps_sampled": 47824320, "num_agent_steps_trained": 47824320}, "done": false, "episodes_total": 9262, "training_iteration": 2999, "trial_id": "3123b_00000", "date": "2023-08-07_15-40-15", "timestamp": 1691412015, "time_this_iter_s": 62.40464901924133, "time_total_s": 81739.56717014313, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4444.448323726654, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 18.653932584269665, "ram_util_percent": 73.45280898876403}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.072839364366, "policy_loss": -4130958.524049631, "vf_loss": 5443402.212281341}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 48363.5, "diff_num_grad_updates_vs_sampler_policy": 48362.5}}, "num_env_steps_sampled": 47868240, "num_env_steps_trained": 47868240, "num_agent_steps_sampled": 47868240, "num_agent_steps_trained": 47868240}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174404.77503620338, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687, -168811.45900022122], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828224100185933, "mean_inference_ms": 0.3743856947547822, "mean_action_processing_ms": 0.09206280360205218, "mean_env_wait_ms": 0.7296553723162086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003610194568902674, "StateBufferConnector_ms": 0.002739798854774153, "ViewRequirementAgentConnector_ms": 0.06731798951054963}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174404.77503620338, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687, -168811.45900022122], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828224100185933, "mean_inference_ms": 0.3743856947547822, "mean_action_processing_ms": 0.09206280360205218, "mean_env_wait_ms": 0.7296553723162086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003610194568902674, "StateBufferConnector_ms": 0.002739798854774153, "ViewRequirementAgentConnector_ms": 0.06731798951054963}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47868240, "num_agent_steps_trained": 47868240, "num_env_steps_sampled": 47868240, "num_env_steps_trained": 47868240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 705.412360799219, "num_env_steps_trained_throughput_per_sec": 705.412360799219, "timesteps_total": 47868240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47868240, "timers": {"training_iteration_time_ms": 62654.616, "sample_time_ms": 61484.753, "load_time_ms": 17.587, "load_throughput": 2497323.668, "learn_time_ms": 1151.203, "learn_throughput": 38151.401, "synch_weights_time_ms": 0.901}, "counters": {"num_env_steps_sampled": 47868240, "num_env_steps_trained": 47868240, "num_agent_steps_sampled": 47868240, "num_agent_steps_trained": 47868240}, "done": false, "episodes_total": 9263, "training_iteration": 3000, "trial_id": "3123b_00000", "date": "2023-08-07_15-41-17", "timestamp": 1691412077, "time_this_iter_s": 62.26468515396118, "time_total_s": 81801.83185529709, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4506.713008880615, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 17.570454545454545, "ram_util_percent": 73.46590909090911}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.01853115426553, "policy_loss": -3923352.877163812, "vf_loss": 5287251.166727405}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 49049.5, "diff_num_grad_updates_vs_sampler_policy": 49048.5}}, "num_env_steps_sampled": 47912160, "num_env_steps_trained": 47912160, "num_agent_steps_sampled": 47912160, "num_agent_steps_trained": 47912160}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174299.12112139922, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687, -168811.45900022122, -166797.69317030694], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182838478320362, "mean_inference_ms": 0.3743849045591812, "mean_action_processing_ms": 0.09206260835064246, "mean_env_wait_ms": 0.7294398590345381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036047564612494577, "StateBufferConnector_ms": 0.002743800481160482, "ViewRequirementAgentConnector_ms": 0.06735655996534559}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174299.12112139922, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687, -168811.45900022122, -166797.69317030694], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182838478320362, "mean_inference_ms": 0.3743849045591812, "mean_action_processing_ms": 0.09206260835064246, "mean_env_wait_ms": 0.7294398590345381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036047564612494577, "StateBufferConnector_ms": 0.002743800481160482, "ViewRequirementAgentConnector_ms": 0.06735655996534559}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47912160, "num_agent_steps_trained": 47912160, "num_env_steps_sampled": 47912160, "num_env_steps_trained": 47912160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 701.26389244787, "num_env_steps_trained_throughput_per_sec": 701.26389244787, "timesteps_total": 47912160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47912160, "timers": {"training_iteration_time_ms": 62631.213, "sample_time_ms": 61462.964, "load_time_ms": 17.572, "load_throughput": 2499383.772, "learn_time_ms": 1149.615, "learn_throughput": 38204.091, "synch_weights_time_ms": 0.89}, "counters": {"num_env_steps_sampled": 47912160, "num_env_steps_trained": 47912160, "num_agent_steps_sampled": 47912160, "num_agent_steps_trained": 47912160}, "done": false, "episodes_total": 9264, "training_iteration": 3001, "trial_id": "3123b_00000", "date": "2023-08-07_15-42-20", "timestamp": 1691412140, "time_this_iter_s": 62.63262414932251, "time_total_s": 81864.46447944641, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4569.345633029938, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 17.80898876404494, "ram_util_percent": 73.49101123595507}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.1822960856357, "policy_loss": -3796261.1834172285, "vf_loss": 5401742.825437318}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 49735.5, "diff_num_grad_updates_vs_sampler_policy": 49734.5}}, "num_env_steps_sampled": 47956080, "num_env_steps_trained": 47956080, "num_agent_steps_sampled": 47956080, "num_agent_steps_trained": 47956080}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174207.45408363626, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687, -168811.45900022122, -166797.69317030694, -167607.42736470338], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.218285335199057, "mean_inference_ms": 0.3743840257577617, "mean_action_processing_ms": 0.09206240319802231, "mean_env_wait_ms": 0.7292245102275722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035984875404671446, "StateBufferConnector_ms": 0.0027440998652209976, "ViewRequirementAgentConnector_ms": 0.06734345057239272}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174207.45408363626, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687, -168811.45900022122, -166797.69317030694, -167607.42736470338], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.218285335199057, "mean_inference_ms": 0.3743840257577617, "mean_action_processing_ms": 0.09206240319802231, "mean_env_wait_ms": 0.7292245102275722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035984875404671446, "StateBufferConnector_ms": 0.0027440998652209976, "ViewRequirementAgentConnector_ms": 0.06734345057239272}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47956080, "num_agent_steps_trained": 47956080, "num_env_steps_sampled": 47956080, "num_env_steps_trained": 47956080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 707.6932278785686, "num_env_steps_trained_throughput_per_sec": 707.6932278785686, "timesteps_total": 47956080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 47956080, "timers": {"training_iteration_time_ms": 62540.031, "sample_time_ms": 61373.328, "load_time_ms": 17.628, "load_throughput": 2491456.807, "learn_time_ms": 1148.011, "learn_throughput": 38257.474, "synch_weights_time_ms": 0.891}, "counters": {"num_env_steps_sampled": 47956080, "num_env_steps_trained": 47956080, "num_agent_steps_sampled": 47956080, "num_agent_steps_trained": 47956080}, "done": false, "episodes_total": 9265, "training_iteration": 3002, "trial_id": "3123b_00000", "date": "2023-08-07_15-43-22", "timestamp": 1691412202, "time_this_iter_s": 62.063716173172, "time_total_s": 81926.52819561958, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4631.40934920311, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 18.732954545454547, "ram_util_percent": 73.38977272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.34045846121654, "policy_loss": -4135770.057489067, "vf_loss": 5888275.254828718}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 50421.5, "diff_num_grad_updates_vs_sampler_policy": 50420.5}}, "num_env_steps_sampled": 48000000, "num_env_steps_trained": 48000000, "num_agent_steps_sampled": 48000000, "num_agent_steps_trained": 48000000}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174202.5122464558, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687, -168811.45900022122, -166797.69317030694, -167607.42736470338, -173841.75813228343], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182867514035277, "mean_inference_ms": 0.3743829853713849, "mean_action_processing_ms": 0.09206222489748934, "mean_env_wait_ms": 0.729010086723323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035936767990524705, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.06733875016908387}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174202.5122464558, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687, -168811.45900022122, -166797.69317030694, -167607.42736470338, -173841.75813228343], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182867514035277, "mean_inference_ms": 0.3743829853713849, "mean_action_processing_ms": 0.09206222489748934, "mean_env_wait_ms": 0.729010086723323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035936767990524705, "StateBufferConnector_ms": 0.0027418136596679688, "ViewRequirementAgentConnector_ms": 0.06733875016908387}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000000, "num_agent_steps_trained": 48000000, "num_env_steps_sampled": 48000000, "num_env_steps_trained": 48000000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 706.0713664046893, "num_env_steps_trained_throughput_per_sec": 706.0713664046893, "timesteps_total": 48000000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 48000000, "timers": {"training_iteration_time_ms": 62492.505, "sample_time_ms": 61328.496, "load_time_ms": 17.584, "load_throughput": 2497733.385, "learn_time_ms": 1145.358, "learn_throughput": 38346.101, "synch_weights_time_ms": 0.895}, "counters": {"num_env_steps_sampled": 48000000, "num_env_steps_trained": 48000000, "num_agent_steps_sampled": 48000000, "num_agent_steps_trained": 48000000}, "done": false, "episodes_total": 9266, "training_iteration": 3003, "trial_id": "3123b_00000", "date": "2023-08-07_15-44-24", "timestamp": 1691412264, "time_this_iter_s": 62.20624303817749, "time_total_s": 81988.73443865776, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4693.615592241287, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 17.571590909090908, "ram_util_percent": 73.42386363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.1161884719359, "policy_loss": -4268093.127330368, "vf_loss": 5703176.9896137025}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51107.5, "diff_num_grad_updates_vs_sampler_policy": 51106.5}}, "num_env_steps_sampled": 48043920, "num_env_steps_trained": 48043920, "num_agent_steps_sampled": 48043920, "num_agent_steps_trained": 48043920}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174174.5408599054, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687, -168811.45900022122, -166797.69317030694, -167607.42736470338, -173841.75813228343, -172104.6582551749], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828794768574397, "mean_inference_ms": 0.3743819366106864, "mean_action_processing_ms": 0.09206206038028661, "mean_env_wait_ms": 0.7287969202528195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035877227783203125, "StateBufferConnector_ms": 0.0027386347452799478, "ViewRequirementAgentConnector_ms": 0.06735674540201823}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174174.5408599054, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687, -168811.45900022122, -166797.69317030694, -167607.42736470338, -173841.75813228343, -172104.6582551749], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828794768574397, "mean_inference_ms": 0.3743819366106864, "mean_action_processing_ms": 0.09206206038028661, "mean_env_wait_ms": 0.7287969202528195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035877227783203125, "StateBufferConnector_ms": 0.0027386347452799478, "ViewRequirementAgentConnector_ms": 0.06735674540201823}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48043920, "num_agent_steps_trained": 48043920, "num_env_steps_sampled": 48043920, "num_env_steps_trained": 48043920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 704.6680653825791, "num_env_steps_trained_throughput_per_sec": 704.6680653825791, "timesteps_total": 48043920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 48043920, "timers": {"training_iteration_time_ms": 62461.661, "sample_time_ms": 61294.44, "load_time_ms": 17.437, "load_throughput": 2518801.836, "learn_time_ms": 1148.703, "learn_throughput": 38234.431, "synch_weights_time_ms": 0.907}, "counters": {"num_env_steps_sampled": 48043920, "num_env_steps_trained": 48043920, "num_agent_steps_sampled": 48043920, "num_agent_steps_trained": 48043920}, "done": false, "episodes_total": 9267, "training_iteration": 3004, "trial_id": "3123b_00000", "date": "2023-08-07_15-45-27", "timestamp": 1691412327, "time_this_iter_s": 62.330076932907104, "time_total_s": 82051.06451559067, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4755.945669174194, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 18.17159090909091, "ram_util_percent": 73.45681818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.27356526455446, "policy_loss": -4157581.6191520137, "vf_loss": 5708243.442237609}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51793.5, "diff_num_grad_updates_vs_sampler_policy": 51792.5}}, "num_env_steps_sampled": 48087840, "num_env_steps_trained": 48087840, "num_agent_steps_sampled": 48087840, "num_agent_steps_trained": 48087840}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174145.44439223464, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687, -168811.45900022122, -166797.69317030694, -167607.42736470338, -173841.75813228343, -172104.6582551749, -171963.20931692742], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828895306141105, "mean_inference_ms": 0.3743812220584598, "mean_action_processing_ms": 0.09206188646789831, "mean_env_wait_ms": 0.728585596018046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035838076942845396, "StateBufferConnector_ms": 0.002737735447130705, "ViewRequirementAgentConnector_ms": 0.0673679929030569}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174145.44439223464, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687, -168811.45900022122, -166797.69317030694, -167607.42736470338, -173841.75813228343, -172104.6582551749, -171963.20931692742], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828895306141105, "mean_inference_ms": 0.3743812220584598, "mean_action_processing_ms": 0.09206188646789831, "mean_env_wait_ms": 0.728585596018046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035838076942845396, "StateBufferConnector_ms": 0.002737735447130705, "ViewRequirementAgentConnector_ms": 0.0673679929030569}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48087840, "num_agent_steps_trained": 48087840, "num_env_steps_sampled": 48087840, "num_env_steps_trained": 48087840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 702.9862586198649, "num_env_steps_trained_throughput_per_sec": 702.9862586198649, "timesteps_total": 48087840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 48087840, "timers": {"training_iteration_time_ms": 62458.062, "sample_time_ms": 61292.562, "load_time_ms": 17.386, "load_throughput": 2526103.602, "learn_time_ms": 1147.028, "learn_throughput": 38290.244, "synch_weights_time_ms": 0.916}, "counters": {"num_env_steps_sampled": 48087840, "num_env_steps_trained": 48087840, "num_agent_steps_sampled": 48087840, "num_agent_steps_trained": 48087840}, "done": false, "episodes_total": 9268, "training_iteration": 3005, "trial_id": "3123b_00000", "date": "2023-08-07_15-46-29", "timestamp": 1691412389, "time_this_iter_s": 62.47920894622803, "time_total_s": 82113.5437245369, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4818.424878120422, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 18.37752808988764, "ram_util_percent": 73.43820224719101}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.1915857965675, "policy_loss": -3503696.511693126, "vf_loss": 5288144.406158892}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 52479.5, "diff_num_grad_updates_vs_sampler_policy": 52478.5}}, "num_env_steps_sampled": 48131760, "num_env_steps_trained": 48131760, "num_agent_steps_sampled": 48131760, "num_agent_steps_trained": 48131760}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174045.77998408268, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687, -168811.45900022122, -166797.69317030694, -167607.42736470338, -173841.75813228343, -172104.6582551749, -171963.20931692742, -166471.28496453262], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21829045691971471, "mean_inference_ms": 0.37438027101284455, "mean_action_processing_ms": 0.09206168524800659, "mean_env_wait_ms": 0.7283747514448803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035840195494812803, "StateBufferConnector_ms": 0.002734692065746753, "ViewRequirementAgentConnector_ms": 0.06746998080959568}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174045.77998408268, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687, -168811.45900022122, -166797.69317030694, -167607.42736470338, -173841.75813228343, -172104.6582551749, -171963.20931692742, -166471.28496453262], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21829045691971471, "mean_inference_ms": 0.37438027101284455, "mean_action_processing_ms": 0.09206168524800659, "mean_env_wait_ms": 0.7283747514448803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035840195494812803, "StateBufferConnector_ms": 0.002734692065746753, "ViewRequirementAgentConnector_ms": 0.06746998080959568}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48131760, "num_agent_steps_trained": 48131760, "num_env_steps_sampled": 48131760, "num_env_steps_trained": 48131760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 706.6503327359658, "num_env_steps_trained_throughput_per_sec": 706.6503327359658, "timesteps_total": 48131760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 48131760, "timers": {"training_iteration_time_ms": 62431.212, "sample_time_ms": 61265.524, "load_time_ms": 17.53, "load_throughput": 2505482.292, "learn_time_ms": 1147.071, "learn_throughput": 38288.826, "synch_weights_time_ms": 0.919}, "counters": {"num_env_steps_sampled": 48131760, "num_env_steps_trained": 48131760, "num_agent_steps_sampled": 48131760, "num_agent_steps_trained": 48131760}, "done": false, "episodes_total": 9269, "training_iteration": 3006, "trial_id": "3123b_00000", "date": "2023-08-07_15-47-31", "timestamp": 1691412451, "time_this_iter_s": 62.15545415878296, "time_total_s": 82175.69917869568, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4880.580332279205, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 18.362499999999997, "ram_util_percent": 73.45795454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0000000000000005e-17, "entropy_coeff": 0.12000000000000001, "policy_entropy": -359.3434053649013, "policy_loss": -3604247.9683542503, "vf_loss": 5649282.047558309}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53165.5, "diff_num_grad_updates_vs_sampler_policy": 53164.5}}, "num_env_steps_sampled": 48175680, "num_env_steps_trained": 48175680, "num_agent_steps_sampled": 48175680, "num_agent_steps_trained": 48175680}, "sampler_results": {"episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174007.19607634886, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687, -168811.45900022122, -166797.69317030694, -167607.42736470338, -173841.75813228343, -172104.6582551749, -171963.20931692742, -166471.28496453262, -171036.23518084476], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21829227262358694, "mean_inference_ms": 0.3743794489962328, "mean_action_processing_ms": 0.0920614993827939, "mean_env_wait_ms": 0.7281636827623723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035768900162134417, "StateBufferConnector_ms": 0.002734172038542919, "ViewRequirementAgentConnector_ms": 0.06745289533566205}}, "episode_reward_max": -164208.52223510484, "episode_reward_min": -180386.77221123342, "episode_reward_mean": -174007.19607634886, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180386.77221123342, -179990.9442370681, -176810.0701395744, -178021.38708251918, -178923.58195755884, -177948.70527399404, -180129.20202509253, -176911.6506904711, -177387.6311465243, -176661.35587604702, -178301.78279695875, -178702.55941619468, -175785.24261507037, -174564.1035742647, -176581.35735260585, -176187.91225291273, -177864.69469596574, -173968.69105125053, -177540.927316124, -177906.29128077446, -180067.9112611568, -180013.85535994938, -172710.91802689058, -176147.68137914164, -175824.13748525153, -176427.84742216073, -176872.40658927022, -177415.0498958826, -178238.4135569748, -176874.00601438078, -177842.61939969825, -177636.39309208406, -173487.19712693492, -175292.53502801023, -172094.5415887457, -168957.58069931838, -172239.1006253914, -175608.9090279923, -170223.22632425788, -172349.3011770524, -174612.5906327357, -176513.61068949947, -172469.54276013892, -173357.57778022744, -176629.97645551502, -174800.8648768457, -173379.3866864399, -172853.77684265908, -175176.87182310037, -173254.12273103904, -172357.98654341564, -173530.95451615626, -172913.49136317876, -171873.30943320598, -175367.02640913188, -169327.1537310234, -174443.56029189102, -173009.39778729095, -171856.14450433876, -171231.52902459467, -164208.52223510484, -169182.41756426042, -168598.03631193945, -168475.19095474057, -170495.83391188824, -166663.66932553364, -171748.64213452954, -170678.30790065706, -171277.74025981824, -166741.83901656687, -168811.45900022122, -166797.69317030694, -167607.42736470338, -173841.75813228343, -172104.6582551749, -171963.20931692742, -166471.28496453262, -171036.23518084476], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21829227262358694, "mean_inference_ms": 0.3743794489962328, "mean_action_processing_ms": 0.0920614993827939, "mean_env_wait_ms": 0.7281636827623723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035768900162134417, "StateBufferConnector_ms": 0.002734172038542919, "ViewRequirementAgentConnector_ms": 0.06745289533566205}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48175680, "num_agent_steps_trained": 48175680, "num_env_steps_sampled": 48175680, "num_env_steps_trained": 48175680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 708.4382204534355, "num_env_steps_trained_throughput_per_sec": 708.4382204534355, "timesteps_total": 48175680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 48175680, "timers": {"training_iteration_time_ms": 62359.881, "sample_time_ms": 61207.468, "load_time_ms": 17.098, "load_throughput": 2568682.438, "learn_time_ms": 1134.23, "learn_throughput": 38722.306, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 48175680, "num_env_steps_trained": 48175680, "num_agent_steps_sampled": 48175680, "num_agent_steps_trained": 48175680}, "done": true, "episodes_total": 9270, "training_iteration": 3007, "trial_id": "3123b_00000", "date": "2023-08-07_15-48-33", "timestamp": 1691412513, "time_this_iter_s": 61.998636960983276, "time_total_s": 82237.69781565666, "pid": 99558, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[44969520, 1e-15], [45101280, 1e-15], [45233040, 1e-15], [45364800, 1e-15], [45496560, 1e-15], [45628320, 5e-16], [45760080, 5e-16], [45891840, 5e-16], [46023600, 5e-16], [46155360, 5e-16], [46287120, 5e-16], [46418880, 2.5e-16], [46550640, 2.5e-16], [46682400, 2.5e-16], [46814160, 2.5e-16], [46945920, 1e-16], [47077680, 1e-16], [47209440, 1e-16], [47341200, 1e-16], [47472960, 1e-16], [47604720, 5e-17], [47736480, 5e-17], [47868240, 5e-17], [48000000, 5e-17], [48131760, 5e-17], [48263520, 5e-17]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.12, "final_epsilon": 0.01, "epsilon_timesteps": 48395280}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.12, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17b8a98b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4942.578969240189, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 17.97241379310345, "ram_util_percent": 73.49540229885056}}
