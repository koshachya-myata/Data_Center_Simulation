{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00033611111111111114, "entropy_coeff": 0.1, "policy_entropy": -926.6506958007812, "policy_loss": -284806160056320.0, "vf_loss": 569246656.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 9000, "num_env_steps_trained": 9000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 9000}, "sampler_results": {"episode_reward_max": -8469.636999014867, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8609.947581299519, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094], "episode_lengths": [120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.95202478741675, "mean_inference_ms": 0.41111222264509123, "mean_action_processing_ms": 0.0964142278951291, "mean_env_wait_ms": 10.932358348138445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034332275390625, "StateBufferConnector_ms": 0.0028053919474283853, "ViewRequirementAgentConnector_ms": 0.07146994272867839}}, "episode_reward_max": -8469.636999014867, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8609.947581299519, "episode_len_mean": 120.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094], "episode_lengths": [120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.95202478741675, "mean_inference_ms": 0.41111222264509123, "mean_action_processing_ms": 0.0964142278951291, "mean_env_wait_ms": 10.932358348138445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034332275390625, "StateBufferConnector_ms": 0.0028053919474283853, "ViewRequirementAgentConnector_ms": 0.07146994272867839}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 9000, "num_env_steps_sampled": 9000, "num_env_steps_trained": 9000, "num_env_steps_sampled_this_iter": 360, "num_env_steps_trained_this_iter": 360, "num_env_steps_sampled_throughput_per_sec": 29.716821484682434, "num_env_steps_trained_throughput_per_sec": 29.716821484682434, "timesteps_total": 9000, "num_steps_trained_this_iter": 360, "agent_timesteps_total": 9000, "timers": {"training_iteration_time_ms": 4038.103, "sample_time_ms": 4023.843, "load_time_ms": 0.331, "load_throughput": 363055.888, "learn_time_ms": 13.146, "learn_throughput": 9127.974, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 9000, "num_env_steps_trained": 9000, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 9000}, "done": false, "episodes_total": 27, "training_iteration": 6, "trial_id": "b894a_00000", "date": "2023-07-25_17-44-31", "timestamp": 1690296271, "time_this_iter_s": 12.116744995117188, "time_total_s": 67.48034882545471, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12.116744995117188, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.32222222222222, "ram_util_percent": 76.00555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00026944444444444444, "entropy_coeff": 0.1, "policy_entropy": -926.65966796875, "policy_loss": -2.6794512105865216e+16, "vf_loss": 587976064.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 9480, "num_env_steps_trained": 9480, "num_agent_steps_sampled": 9480, "num_agent_steps_trained": 9480}, "sampler_results": {"episode_reward_max": -8464.665493229266, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8605.594757493898, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752], "episode_lengths": [120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.870739015655044, "mean_inference_ms": 0.40390592658341323, "mean_action_processing_ms": 0.09599717086873034, "mean_env_wait_ms": 8.281378564701914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004318782261439732, "StateBufferConnector_ms": 0.0028201511928013395, "ViewRequirementAgentConnector_ms": 0.07311957223074776}}, "episode_reward_max": -8464.665493229266, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8605.594757493898, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752], "episode_lengths": [120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.870739015655044, "mean_inference_ms": 0.40390592658341323, "mean_action_processing_ms": 0.09599717086873034, "mean_env_wait_ms": 8.281378564701914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004318782261439732, "StateBufferConnector_ms": 0.0028201511928013395, "ViewRequirementAgentConnector_ms": 0.07311957223074776}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9480, "num_agent_steps_trained": 9480, "num_env_steps_sampled": 9480, "num_env_steps_trained": 9480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.89197261961087, "num_env_steps_trained_throughput_per_sec": 39.89197261961087, "timesteps_total": 9480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 9480, "timers": {"training_iteration_time_ms": 3449.537, "sample_time_ms": 3441.242, "load_time_ms": 0.266, "load_throughput": 451000.43, "learn_time_ms": 7.278, "learn_throughput": 16488.587, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 9480, "num_env_steps_trained": 9480, "num_agent_steps_sampled": 9480, "num_agent_steps_trained": 9480}, "done": false, "episodes_total": 31, "training_iteration": 7, "trial_id": "b894a_00000", "date": "2023-07-25_17-44-43", "timestamp": 1690296283, "time_this_iter_s": 12.035179853439331, "time_total_s": 79.51552867889404, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 24.15192484855652, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.776470588235295, "ram_util_percent": 76.71176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00022166666666666667, "entropy_coeff": 0.1, "policy_entropy": -926.6646118164062, "policy_loss": -7656262925811712.0, "vf_loss": 558977216.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 9960, "num_env_steps_trained": 9960, "num_agent_steps_sampled": 9960, "num_agent_steps_trained": 9960}, "sampler_results": {"episode_reward_max": -8464.665493229266, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8582.881748254522, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.85684870637499, "mean_inference_ms": 0.40191268716747586, "mean_action_processing_ms": 0.09593284128222938, "mean_env_wait_ms": 7.124411020480647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042178414084694605, "StateBufferConnector_ms": 0.002756985751065341, "ViewRequirementAgentConnector_ms": 0.07138035514137962}}, "episode_reward_max": -8464.665493229266, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8582.881748254522, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.85684870637499, "mean_inference_ms": 0.40191268716747586, "mean_action_processing_ms": 0.09593284128222938, "mean_env_wait_ms": 7.124411020480647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042178414084694605, "StateBufferConnector_ms": 0.002756985751065341, "ViewRequirementAgentConnector_ms": 0.07138035514137962}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9960, "num_agent_steps_trained": 9960, "num_env_steps_sampled": 9960, "num_env_steps_trained": 9960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.28773274663076, "num_env_steps_trained_throughput_per_sec": 39.28773274663076, "timesteps_total": 9960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 9960, "timers": {"training_iteration_time_ms": 3049.433, "sample_time_ms": 3045.488, "load_time_ms": 0.222, "load_throughput": 540619.205, "learn_time_ms": 2.984, "learn_throughput": 40216.094, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 9960, "num_env_steps_trained": 9960, "num_agent_steps_sampled": 9960, "num_agent_steps_trained": 9960}, "done": false, "episodes_total": 35, "training_iteration": 8, "trial_id": "b894a_00000", "date": "2023-07-25_17-44-55", "timestamp": 1690296295, "time_this_iter_s": 12.21995210647583, "time_total_s": 91.73548078536987, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 36.37187695503235, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.576470588235292, "ram_util_percent": 76.89411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00018166666666666667, "entropy_coeff": 0.1, "policy_entropy": -926.666748046875, "policy_loss": -2364599613521920.0, "vf_loss": 582183552.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 10440, "num_env_steps_trained": 10440, "num_agent_steps_sampled": 10440, "num_agent_steps_trained": 10440}, "sampler_results": {"episode_reward_max": -8464.665493229266, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8586.656905065793, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.87624751197334, "mean_inference_ms": 0.40050997827058094, "mean_action_processing_ms": 0.09582262698392964, "mean_env_wait_ms": 6.423790782647476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039768218994140625, "StateBufferConnector_ms": 0.002689361572265625, "ViewRequirementAgentConnector_ms": 0.07041613260904948}}, "episode_reward_max": -8464.665493229266, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8586.656905065793, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.87624751197334, "mean_inference_ms": 0.40050997827058094, "mean_action_processing_ms": 0.09582262698392964, "mean_env_wait_ms": 6.423790782647476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039768218994140625, "StateBufferConnector_ms": 0.002689361572265625, "ViewRequirementAgentConnector_ms": 0.07041613260904948}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10440, "num_agent_steps_trained": 10440, "num_env_steps_sampled": 10440, "num_env_steps_trained": 10440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.06473866153593, "num_env_steps_trained_throughput_per_sec": 39.06473866153593, "timesteps_total": 10440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 10440, "timers": {"training_iteration_time_ms": 3063.102, "sample_time_ms": 3059.295, "load_time_ms": 0.22, "load_throughput": 545482.259, "learn_time_ms": 2.844, "learn_throughput": 42188.436, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 10440, "num_env_steps_trained": 10440, "num_agent_steps_sampled": 10440, "num_agent_steps_trained": 10440}, "done": false, "episodes_total": 39, "training_iteration": 9, "trial_id": "b894a_00000", "date": "2023-07-25_17-45-07", "timestamp": 1690296307, "time_this_iter_s": 12.289751052856445, "time_total_s": 104.02523183822632, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 48.661628007888794, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.883333333333333, "ram_util_percent": 77.1277777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00014166666666666668, "entropy_coeff": 0.1, "policy_entropy": -926.6759033203125, "policy_loss": -1.3815364676747264e+16, "vf_loss": 557862464.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 10920, "num_env_steps_trained": 10920, "num_agent_steps_sampled": 10920, "num_agent_steps_trained": 10920}, "sampler_results": {"episode_reward_max": -8464.665493229266, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8575.979237782441, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.900439632003536, "mean_inference_ms": 0.3994929287542258, "mean_action_processing_ms": 0.09572708245022565, "mean_env_wait_ms": 5.946882529266956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038385391235351562, "StateBufferConnector_ms": 0.002651465566534745, "ViewRequirementAgentConnector_ms": 0.06950027064273231}}, "episode_reward_max": -8464.665493229266, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8575.979237782441, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.900439632003536, "mean_inference_ms": 0.3994929287542258, "mean_action_processing_ms": 0.09572708245022565, "mean_env_wait_ms": 5.946882529266956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038385391235351562, "StateBufferConnector_ms": 0.002651465566534745, "ViewRequirementAgentConnector_ms": 0.06950027064273231}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10920, "num_agent_steps_trained": 10920, "num_env_steps_sampled": 10920, "num_env_steps_trained": 10920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.94950292256805, "num_env_steps_trained_throughput_per_sec": 38.94950292256805, "timesteps_total": 10920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 10920, "timers": {"training_iteration_time_ms": 3073.959, "sample_time_ms": 3070.136, "load_time_ms": 0.218, "load_throughput": 549532.132, "learn_time_ms": 2.862, "learn_throughput": 41930.81, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 10920, "num_env_steps_trained": 10920, "num_agent_steps_sampled": 10920, "num_agent_steps_trained": 10920}, "done": false, "episodes_total": 43, "training_iteration": 10, "trial_id": "b894a_00000", "date": "2023-07-25_17-45-20", "timestamp": 1690296320, "time_this_iter_s": 12.32608699798584, "time_total_s": 116.35131883621216, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 60.987715005874634, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 26.352941176470583, "ram_util_percent": 77.19411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 0.00010166666666666665, "entropy_coeff": 0.1, "policy_entropy": -926.6819458007812, "policy_loss": -3413973672132608.0, "vf_loss": 572604160.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 11400, "num_env_steps_trained": 11400, "num_agent_steps_sampled": 11400, "num_agent_steps_trained": 11400}, "sampler_results": {"episode_reward_max": -8464.665493229266, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8584.662851784797, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.92008443416459, "mean_inference_ms": 0.3988495937452614, "mean_action_processing_ms": 0.09565645491572405, "mean_env_wait_ms": 5.597572596347378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037970750228218412, "StateBufferConnector_ms": 0.0026640684708305025, "ViewRequirementAgentConnector_ms": 0.06964103035304857}}, "episode_reward_max": -8464.665493229266, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8584.662851784797, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.92008443416459, "mean_inference_ms": 0.3988495937452614, "mean_action_processing_ms": 0.09565645491572405, "mean_env_wait_ms": 5.597572596347378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037970750228218412, "StateBufferConnector_ms": 0.0026640684708305025, "ViewRequirementAgentConnector_ms": 0.06964103035304857}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11400, "num_agent_steps_trained": 11400, "num_env_steps_sampled": 11400, "num_env_steps_trained": 11400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.0947823049045, "num_env_steps_trained_throughput_per_sec": 39.0947823049045, "timesteps_total": 11400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 11400, "timers": {"training_iteration_time_ms": 3055.911, "sample_time_ms": 3052.105, "load_time_ms": 0.218, "load_throughput": 549412.16, "learn_time_ms": 2.845, "learn_throughput": 42183.486, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 11400, "num_env_steps_trained": 11400, "num_agent_steps_sampled": 11400, "num_agent_steps_trained": 11400}, "done": false, "episodes_total": 47, "training_iteration": 11, "trial_id": "b894a_00000", "date": "2023-07-25_17-45-32", "timestamp": 1690296332, "time_this_iter_s": 12.28025197982788, "time_total_s": 128.63157081604004, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 73.26796698570251, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 28.46111111111111, "ram_util_percent": 77.32222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.722222222222223e-05, "entropy_coeff": 0.1, "policy_entropy": -926.6893310546875, "policy_loss": -8721073365319680.0, "vf_loss": 564575680.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 11880, "num_env_steps_trained": 11880, "num_agent_steps_sampled": 11880, "num_agent_steps_trained": 11880}, "sampler_results": {"episode_reward_max": -8464.665493229266, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8585.91374066447, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.934393565542972, "mean_inference_ms": 0.39845502885174083, "mean_action_processing_ms": 0.09561518420611848, "mean_env_wait_ms": 5.327472892742923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003860614917896412, "StateBufferConnector_ms": 0.0027003111662688077, "ViewRequirementAgentConnector_ms": 0.06987430431224682}}, "episode_reward_max": -8464.665493229266, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8585.91374066447, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.934393565542972, "mean_inference_ms": 0.39845502885174083, "mean_action_processing_ms": 0.09561518420611848, "mean_env_wait_ms": 5.327472892742923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003860614917896412, "StateBufferConnector_ms": 0.0027003111662688077, "ViewRequirementAgentConnector_ms": 0.06987430431224682}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11880, "num_agent_steps_trained": 11880, "num_env_steps_sampled": 11880, "num_env_steps_trained": 11880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.313104683784736, "num_env_steps_trained_throughput_per_sec": 39.313104683784736, "timesteps_total": 11880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 11880, "timers": {"training_iteration_time_ms": 3060.639, "sample_time_ms": 3056.848, "load_time_ms": 0.223, "load_throughput": 537444.186, "learn_time_ms": 2.823, "learn_throughput": 42506.607, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 11880, "num_env_steps_trained": 11880, "num_agent_steps_sampled": 11880, "num_agent_steps_trained": 11880}, "done": false, "episodes_total": 51, "training_iteration": 12, "trial_id": "b894a_00000", "date": "2023-07-25_17-45-44", "timestamp": 1690296344, "time_this_iter_s": 12.212126016616821, "time_total_s": 140.84369683265686, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 85.48009300231934, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.405882352941177, "ram_util_percent": 77.17647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.38888888888889e-05, "entropy_coeff": 0.1, "policy_entropy": -926.6953125, "policy_loss": -2786908983787520.0, "vf_loss": 555249216.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 12360, "num_env_steps_trained": 12360, "num_agent_steps_sampled": 12360, "num_agent_steps_trained": 12360}, "sampler_results": {"episode_reward_max": -8464.665493229266, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8580.115951802623, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.94008362344561, "mean_inference_ms": 0.3982503176269966, "mean_action_processing_ms": 0.09559140931090955, "mean_env_wait_ms": 5.1121492029691975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003962362966229839, "StateBufferConnector_ms": 0.0027141263408045615, "ViewRequirementAgentConnector_ms": 0.07057266850625316}}, "episode_reward_max": -8464.665493229266, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8580.115951802623, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.94008362344561, "mean_inference_ms": 0.3982503176269966, "mean_action_processing_ms": 0.09559140931090955, "mean_env_wait_ms": 5.1121492029691975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003962362966229839, "StateBufferConnector_ms": 0.0027141263408045615, "ViewRequirementAgentConnector_ms": 0.07057266850625316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12360, "num_agent_steps_trained": 12360, "num_env_steps_sampled": 12360, "num_env_steps_trained": 12360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.72497766480423, "num_env_steps_trained_throughput_per_sec": 39.72497766480423, "timesteps_total": 12360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 12360, "timers": {"training_iteration_time_ms": 3060.425, "sample_time_ms": 3056.625, "load_time_ms": 0.226, "load_throughput": 531316.88, "learn_time_ms": 2.832, "learn_throughput": 42376.338, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 12360, "num_env_steps_trained": 12360, "num_agent_steps_sampled": 12360, "num_agent_steps_trained": 12360}, "done": false, "episodes_total": 55, "training_iteration": 13, "trial_id": "b894a_00000", "date": "2023-07-25_17-45-56", "timestamp": 1690296356, "time_this_iter_s": 12.085608959197998, "time_total_s": 152.92930579185486, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 97.56570196151733, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 24.976470588235294, "ram_util_percent": 77.27058823529414}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.055555555555556e-05, "entropy_coeff": 0.1, "policy_entropy": -926.7028198242188, "policy_loss": -4622291048595456.0, "vf_loss": 546490368.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 12840, "num_env_steps_trained": 12840, "num_agent_steps_sampled": 12840, "num_agent_steps_trained": 12840}, "sampler_results": {"episode_reward_max": -8450.047191155703, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8572.233352036601, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.94745922269554, "mean_inference_ms": 0.39808613293836737, "mean_action_processing_ms": 0.09557447072105636, "mean_env_wait_ms": 4.935416142217989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038923536028180805, "StateBufferConnector_ms": 0.0027091162545340402, "ViewRequirementAgentConnector_ms": 0.07040977478027344}}, "episode_reward_max": -8450.047191155703, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8572.233352036601, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.94745922269554, "mean_inference_ms": 0.39808613293836737, "mean_action_processing_ms": 0.09557447072105636, "mean_env_wait_ms": 4.935416142217989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038923536028180805, "StateBufferConnector_ms": 0.0027091162545340402, "ViewRequirementAgentConnector_ms": 0.07040977478027344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12840, "num_agent_steps_trained": 12840, "num_env_steps_sampled": 12840, "num_env_steps_trained": 12840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.03063802825658, "num_env_steps_trained_throughput_per_sec": 39.03063802825658, "timesteps_total": 12840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 12840, "timers": {"training_iteration_time_ms": 3054.962, "sample_time_ms": 3051.157, "load_time_ms": 0.225, "load_throughput": 532722.777, "learn_time_ms": 2.835, "learn_throughput": 42331.431, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 12840, "num_env_steps_trained": 12840, "num_agent_steps_sampled": 12840, "num_agent_steps_trained": 12840}, "done": false, "episodes_total": 59, "training_iteration": 14, "trial_id": "b894a_00000", "date": "2023-07-25_17-46-09", "timestamp": 1690296369, "time_this_iter_s": 12.300509929656982, "time_total_s": 165.22981572151184, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 109.86621189117432, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 23.827777777777776, "ram_util_percent": 77.14444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.8611111111111115e-05, "entropy_coeff": 0.1, "policy_entropy": -926.7078247070312, "policy_loss": -5565113142607872.0, "vf_loss": 564167232.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 13320, "num_env_steps_trained": 13320, "num_agent_steps_sampled": 13320, "num_agent_steps_trained": 13320}, "sampler_results": {"episode_reward_max": -8450.047191155703, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8572.455713370104, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.955184125017308, "mean_inference_ms": 0.39796093204433863, "mean_action_processing_ms": 0.09555928002348511, "mean_env_wait_ms": 4.787365116854967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038177539140750202, "StateBufferConnector_ms": 0.0026947412735376605, "ViewRequirementAgentConnector_ms": 0.06999541551638873}}, "episode_reward_max": -8450.047191155703, "episode_reward_min": -8758.426256122595, "episode_reward_mean": -8572.455713370104, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.955184125017308, "mean_inference_ms": 0.39796093204433863, "mean_action_processing_ms": 0.09555928002348511, "mean_env_wait_ms": 4.787365116854967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038177539140750202, "StateBufferConnector_ms": 0.0026947412735376605, "ViewRequirementAgentConnector_ms": 0.06999541551638873}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13320, "num_agent_steps_trained": 13320, "num_env_steps_sampled": 13320, "num_env_steps_trained": 13320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.0679141779847, "num_env_steps_trained_throughput_per_sec": 39.0679141779847, "timesteps_total": 13320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 13320, "timers": {"training_iteration_time_ms": 3056.598, "sample_time_ms": 3052.788, "load_time_ms": 0.221, "load_throughput": 541841.404, "learn_time_ms": 2.842, "learn_throughput": 42219.578, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 13320, "num_env_steps_trained": 13320, "num_agent_steps_sampled": 13320, "num_agent_steps_trained": 13320}, "done": false, "episodes_total": 63, "training_iteration": 15, "trial_id": "b894a_00000", "date": "2023-07-25_17-46-21", "timestamp": 1690296381, "time_this_iter_s": 12.288789987564087, "time_total_s": 177.51860570907593, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 122.1550018787384, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 25.541176470588233, "ram_util_percent": 77.3529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.194444444444445e-05, "entropy_coeff": 0.1, "policy_entropy": -926.71435546875, "policy_loss": -1822228593246208.0, "vf_loss": 562759040.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 13800, "num_env_steps_trained": 13800, "num_agent_steps_sampled": 13800, "num_agent_steps_trained": 13800}, "sampler_results": {"episode_reward_max": -8450.047191155703, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8578.294225942222, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.961054353908683, "mean_inference_ms": 0.397881019602926, "mean_action_processing_ms": 0.09555258091235642, "mean_env_wait_ms": 4.660579894427588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038235686546148257, "StateBufferConnector_ms": 0.0026847040930459668, "ViewRequirementAgentConnector_ms": 0.06962598756302235}}, "episode_reward_max": -8450.047191155703, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8578.294225942222, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.961054353908683, "mean_inference_ms": 0.397881019602926, "mean_action_processing_ms": 0.09555258091235642, "mean_env_wait_ms": 4.660579894427588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038235686546148257, "StateBufferConnector_ms": 0.0026847040930459668, "ViewRequirementAgentConnector_ms": 0.06962598756302235}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13800, "num_agent_steps_trained": 13800, "num_env_steps_sampled": 13800, "num_env_steps_trained": 13800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.50485856371733, "num_env_steps_trained_throughput_per_sec": 39.50485856371733, "timesteps_total": 13800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 13800, "timers": {"training_iteration_time_ms": 3046.381, "sample_time_ms": 3042.604, "load_time_ms": 0.219, "load_throughput": 548753.249, "learn_time_ms": 2.809, "learn_throughput": 42719.466, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 13800, "num_env_steps_trained": 13800, "num_agent_steps_sampled": 13800, "num_agent_steps_trained": 13800}, "done": false, "episodes_total": 67, "training_iteration": 16, "trial_id": "b894a_00000", "date": "2023-07-25_17-46-33", "timestamp": 1690296393, "time_this_iter_s": 12.15302586555481, "time_total_s": 189.67163157463074, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 134.3080277442932, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.222222222222218, "ram_util_percent": 77.42222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.527777777777778e-05, "entropy_coeff": 0.1, "policy_entropy": -926.7198486328125, "policy_loss": -1980291442802688.0, "vf_loss": 565585024.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 14280, "num_env_steps_trained": 14280, "num_agent_steps_sampled": 14280, "num_agent_steps_trained": 14280}, "sampler_results": {"episode_reward_max": -8450.047191155703, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8580.728914618074, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.965134400523297, "mean_inference_ms": 0.3978327424697082, "mean_action_processing_ms": 0.0955492729076709, "mean_env_wait_ms": 4.551155831163866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003785275398416722, "StateBufferConnector_ms": 0.0026748535480905088, "ViewRequirementAgentConnector_ms": 0.06963242875768784}}, "episode_reward_max": -8450.047191155703, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8580.728914618074, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.965134400523297, "mean_inference_ms": 0.3978327424697082, "mean_action_processing_ms": 0.0955492729076709, "mean_env_wait_ms": 4.551155831163866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003785275398416722, "StateBufferConnector_ms": 0.0026748535480905088, "ViewRequirementAgentConnector_ms": 0.06963242875768784}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14280, "num_agent_steps_trained": 14280, "num_env_steps_sampled": 14280, "num_env_steps_trained": 14280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.489561755144884, "num_env_steps_trained_throughput_per_sec": 39.489561755144884, "timesteps_total": 14280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 14280, "timers": {"training_iteration_time_ms": 3053.006, "sample_time_ms": 3049.226, "load_time_ms": 0.219, "load_throughput": 547202.087, "learn_time_ms": 2.814, "learn_throughput": 42638.762, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 14280, "num_env_steps_trained": 14280, "num_agent_steps_sampled": 14280, "num_agent_steps_trained": 14280}, "done": false, "episodes_total": 71, "training_iteration": 17, "trial_id": "b894a_00000", "date": "2023-07-25_17-46-45", "timestamp": 1690296405, "time_this_iter_s": 12.15755581855774, "time_total_s": 201.82918739318848, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 146.46558356285095, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 23.982352941176472, "ram_util_percent": 77.25882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8611111111111113e-05, "entropy_coeff": 0.1, "policy_entropy": -926.724853515625, "policy_loss": -1817814306390016.0, "vf_loss": 566330688.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 14760, "num_env_steps_trained": 14760, "num_agent_steps_sampled": 14760, "num_agent_steps_trained": 14760}, "sampler_results": {"episode_reward_max": -8450.047191155703, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8582.06323476453, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225, -8699.451627564682, -8621.788247231507, -8528.325509169708, -8541.400601975636], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.967978410199034, "mean_inference_ms": 0.3977757727463116, "mean_action_processing_ms": 0.09554059228517144, "mean_env_wait_ms": 4.4548729450478834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037838430965647977, "StateBufferConnector_ms": 0.002677767884497549, "ViewRequirementAgentConnector_ms": 0.06943310008329504}}, "episode_reward_max": -8450.047191155703, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8582.06323476453, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225, -8699.451627564682, -8621.788247231507, -8528.325509169708, -8541.400601975636], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.967978410199034, "mean_inference_ms": 0.3977757727463116, "mean_action_processing_ms": 0.09554059228517144, "mean_env_wait_ms": 4.4548729450478834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037838430965647977, "StateBufferConnector_ms": 0.002677767884497549, "ViewRequirementAgentConnector_ms": 0.06943310008329504}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14760, "num_agent_steps_trained": 14760, "num_env_steps_sampled": 14760, "num_env_steps_trained": 14760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.68337597730813, "num_env_steps_trained_throughput_per_sec": 39.68337597730813, "timesteps_total": 14760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 14760, "timers": {"training_iteration_time_ms": 3046.916, "sample_time_ms": 3043.131, "load_time_ms": 0.22, "load_throughput": 545245.889, "learn_time_ms": 2.817, "learn_throughput": 42600.147, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 14760, "num_env_steps_trained": 14760, "num_agent_steps_sampled": 14760, "num_agent_steps_trained": 14760}, "done": false, "episodes_total": 75, "training_iteration": 18, "trial_id": "b894a_00000", "date": "2023-07-25_17-46-58", "timestamp": 1690296418, "time_this_iter_s": 12.098376274108887, "time_total_s": 213.92756366729736, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 158.56395983695984, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 26.976470588235294, "ram_util_percent": 76.82352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.316666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": -926.7303466796875, "policy_loss": -2868005482528768.0, "vf_loss": 563560704.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 15240, "num_env_steps_trained": 15240, "num_agent_steps_sampled": 15240, "num_agent_steps_trained": 15240}, "sampler_results": {"episode_reward_max": -8450.047191155703, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8579.686465064775, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225, -8699.451627564682, -8621.788247231507, -8528.325509169708, -8541.400601975636, -8646.418214878375, -8464.0225866508, -8489.209652500482, -8597.880151542004], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.969382036289613, "mean_inference_ms": 0.3977010533342197, "mean_action_processing_ms": 0.09552969832592036, "mean_env_wait_ms": 4.3707945543785165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037397037852894177, "StateBufferConnector_ms": 0.0026785243641246448, "ViewRequirementAgentConnector_ms": 0.06928227164528587}}, "episode_reward_max": -8450.047191155703, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8579.686465064775, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225, -8699.451627564682, -8621.788247231507, -8528.325509169708, -8541.400601975636, -8646.418214878375, -8464.0225866508, -8489.209652500482, -8597.880151542004], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.969382036289613, "mean_inference_ms": 0.3977010533342197, "mean_action_processing_ms": 0.09552969832592036, "mean_env_wait_ms": 4.3707945543785165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037397037852894177, "StateBufferConnector_ms": 0.0026785243641246448, "ViewRequirementAgentConnector_ms": 0.06928227164528587}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15240, "num_agent_steps_trained": 15240, "num_env_steps_sampled": 15240, "num_env_steps_trained": 15240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.44149907582339, "num_env_steps_trained_throughput_per_sec": 39.44149907582339, "timesteps_total": 15240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 15240, "timers": {"training_iteration_time_ms": 3037.888, "sample_time_ms": 3034.092, "load_time_ms": 0.22, "load_throughput": 546370.473, "learn_time_ms": 2.827, "learn_throughput": 42447.099, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 15240, "num_env_steps_trained": 15240, "num_agent_steps_sampled": 15240, "num_agent_steps_trained": 15240}, "done": false, "episodes_total": 79, "training_iteration": 19, "trial_id": "b894a_00000", "date": "2023-07-25_17-47-10", "timestamp": 1690296430, "time_this_iter_s": 12.172484874725342, "time_total_s": 226.1000485420227, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 170.73644471168518, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 27.583333333333336, "ram_util_percent": 75.6722222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9166666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": -926.7352294921875, "policy_loss": -1837378553511936.0, "vf_loss": 556609344.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 15720, "num_env_steps_trained": 15720, "num_agent_steps_sampled": 15720, "num_agent_steps_trained": 15720}, "sampler_results": {"episode_reward_max": -8359.897703805382, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8570.964110762872, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225, -8699.451627564682, -8621.788247231507, -8528.325509169708, -8541.400601975636, -8646.418214878375, -8464.0225866508, -8489.209652500482, -8597.880151542004, -8432.750116766956, -8359.897703805382, -8499.96295692942, -8511.516178945134], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.967884575271622, "mean_inference_ms": 0.39763255507477313, "mean_action_processing_ms": 0.09552239977368797, "mean_env_wait_ms": 4.295932506597303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003699528968940347, "StateBufferConnector_ms": 0.0026715003837973384, "ViewRequirementAgentConnector_ms": 0.06918947575456005}}, "episode_reward_max": -8359.897703805382, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8570.964110762872, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225, -8699.451627564682, -8621.788247231507, -8528.325509169708, -8541.400601975636, -8646.418214878375, -8464.0225866508, -8489.209652500482, -8597.880151542004, -8432.750116766956, -8359.897703805382, -8499.96295692942, -8511.516178945134], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.967884575271622, "mean_inference_ms": 0.39763255507477313, "mean_action_processing_ms": 0.09552239977368797, "mean_env_wait_ms": 4.295932506597303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003699528968940347, "StateBufferConnector_ms": 0.0026715003837973384, "ViewRequirementAgentConnector_ms": 0.06918947575456005}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15720, "num_agent_steps_trained": 15720, "num_env_steps_sampled": 15720, "num_env_steps_trained": 15720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.33833077870946, "num_env_steps_trained_throughput_per_sec": 40.33833077870946, "timesteps_total": 15720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 15720, "timers": {"training_iteration_time_ms": 3010.482, "sample_time_ms": 3006.681, "load_time_ms": 0.223, "load_throughput": 538940.443, "learn_time_ms": 2.824, "learn_throughput": 42493.329, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 15720, "num_env_steps_trained": 15720, "num_agent_steps_sampled": 15720, "num_agent_steps_trained": 15720}, "done": false, "episodes_total": 83, "training_iteration": 20, "trial_id": "b894a_00000", "date": "2023-07-25_17-47-22", "timestamp": 1690296442, "time_this_iter_s": 11.901890993118286, "time_total_s": 238.001939535141, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 182.63833570480347, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 30.43125, "ram_util_percent": 76.5125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5166666666666668e-05, "entropy_coeff": 0.1, "policy_entropy": -926.7402954101562, "policy_loss": -1763173732450304.0, "vf_loss": 570771392.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 16200, "num_env_steps_trained": 16200, "num_agent_steps_sampled": 16200, "num_agent_steps_trained": 16200}, "sampler_results": {"episode_reward_max": -8359.897703805382, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8572.314504509088, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225, -8699.451627564682, -8621.788247231507, -8528.325509169708, -8541.400601975636, -8646.418214878375, -8464.0225866508, -8489.209652500482, -8597.880151542004, -8432.750116766956, -8359.897703805382, -8499.96295692942, -8511.516178945134, -8515.788428936086, -8588.769466283664, -8608.927264277712, -8655.44608956549], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.96691326017987, "mean_inference_ms": 0.3975340131074911, "mean_action_processing_ms": 0.09550880463481967, "mean_env_wait_ms": 4.229251979945994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719329833984375, "StateBufferConnector_ms": 0.0026676389906141493, "ViewRequirementAgentConnector_ms": 0.06906305040631976}}, "episode_reward_max": -8359.897703805382, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8572.314504509088, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225, -8699.451627564682, -8621.788247231507, -8528.325509169708, -8541.400601975636, -8646.418214878375, -8464.0225866508, -8489.209652500482, -8597.880151542004, -8432.750116766956, -8359.897703805382, -8499.96295692942, -8511.516178945134, -8515.788428936086, -8588.769466283664, -8608.927264277712, -8655.44608956549], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.96691326017987, "mean_inference_ms": 0.3975340131074911, "mean_action_processing_ms": 0.09550880463481967, "mean_env_wait_ms": 4.229251979945994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719329833984375, "StateBufferConnector_ms": 0.0026676389906141493, "ViewRequirementAgentConnector_ms": 0.06906305040631976}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16200, "num_agent_steps_trained": 16200, "num_env_steps_sampled": 16200, "num_env_steps_trained": 16200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.17405993166401, "num_env_steps_trained_throughput_per_sec": 39.17405993166401, "timesteps_total": 16200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 16200, "timers": {"training_iteration_time_ms": 3018.664, "sample_time_ms": 3014.83, "load_time_ms": 0.222, "load_throughput": 541375.153, "learn_time_ms": 2.831, "learn_throughput": 42394.185, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 16200, "num_env_steps_trained": 16200, "num_agent_steps_sampled": 16200, "num_agent_steps_trained": 16200}, "done": false, "episodes_total": 87, "training_iteration": 21, "trial_id": "b894a_00000", "date": "2023-07-25_17-47-34", "timestamp": 1690296454, "time_this_iter_s": 12.255865097045898, "time_total_s": 250.2578046321869, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 194.89420080184937, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 23.844444444444445, "ram_util_percent": 76.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1166666666666666e-05, "entropy_coeff": 0.1, "policy_entropy": -926.7455444335938, "policy_loss": -1835526617300992.0, "vf_loss": 555780608.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 16680, "num_env_steps_trained": 16680, "num_agent_steps_sampled": 16680, "num_agent_steps_trained": 16680}, "sampler_results": {"episode_reward_max": -8359.897703805382, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8569.280129522003, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225, -8699.451627564682, -8621.788247231507, -8528.325509169708, -8541.400601975636, -8646.418214878375, -8464.0225866508, -8489.209652500482, -8597.880151542004, -8432.750116766956, -8359.897703805382, -8499.96295692942, -8511.516178945134, -8515.788428936086, -8588.769466283664, -8608.927264277712, -8655.44608956549, -8565.581405805728, -8543.514147471036, -8451.487551684455, -8525.37178894053], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.96661224501395, "mean_inference_ms": 0.3974687176434192, "mean_action_processing_ms": 0.09549815174231026, "mean_env_wait_ms": 4.1694535191825155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037342754762564132, "StateBufferConnector_ms": 0.0026653062051801538, "ViewRequirementAgentConnector_ms": 0.06894531534678901}}, "episode_reward_max": -8359.897703805382, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8569.280129522003, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225, -8699.451627564682, -8621.788247231507, -8528.325509169708, -8541.400601975636, -8646.418214878375, -8464.0225866508, -8489.209652500482, -8597.880151542004, -8432.750116766956, -8359.897703805382, -8499.96295692942, -8511.516178945134, -8515.788428936086, -8588.769466283664, -8608.927264277712, -8655.44608956549, -8565.581405805728, -8543.514147471036, -8451.487551684455, -8525.37178894053], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.96661224501395, "mean_inference_ms": 0.3974687176434192, "mean_action_processing_ms": 0.09549815174231026, "mean_env_wait_ms": 4.1694535191825155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037342754762564132, "StateBufferConnector_ms": 0.0026653062051801538, "ViewRequirementAgentConnector_ms": 0.06894531534678901}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16680, "num_agent_steps_trained": 16680, "num_env_steps_sampled": 16680, "num_env_steps_trained": 16680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.02101169650059, "num_env_steps_trained_throughput_per_sec": 39.02101169650059, "timesteps_total": 16680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 16680, "timers": {"training_iteration_time_ms": 3064.332, "sample_time_ms": 3060.463, "load_time_ms": 0.221, "load_throughput": 542951.974, "learn_time_ms": 2.861, "learn_throughput": 41947.235, "synch_weights_time_ms": 0.745}, "counters": {"num_env_steps_sampled": 16680, "num_env_steps_trained": 16680, "num_agent_steps_sampled": 16680, "num_agent_steps_trained": 16680}, "done": false, "episodes_total": 91, "training_iteration": 22, "trial_id": "b894a_00000", "date": "2023-07-25_17-47-46", "timestamp": 1690296466, "time_this_iter_s": 12.303620100021362, "time_total_s": 262.56142473220825, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 207.19782090187073, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 27.835294117647063, "ram_util_percent": 76.86470588235295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.52777777777778e-06, "entropy_coeff": 0.1, "policy_entropy": -926.7493286132812, "policy_loss": -1620059113914368.0, "vf_loss": 562131136.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 17160, "num_env_steps_trained": 17160, "num_agent_steps_sampled": 17160, "num_agent_steps_trained": 17160}, "sampler_results": {"episode_reward_max": -8359.897703805382, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8567.979994714846, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225, -8699.451627564682, -8621.788247231507, -8528.325509169708, -8541.400601975636, -8646.418214878375, -8464.0225866508, -8489.209652500482, -8597.880151542004, -8432.750116766956, -8359.897703805382, -8499.96295692942, -8511.516178945134, -8515.788428936086, -8588.769466283664, -8608.927264277712, -8655.44608956549, -8565.581405805728, -8543.514147471036, -8451.487551684455, -8525.37178894053, -8598.96650544453, -8400.241742580136, -8612.14979546565, -8573.452903289584], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.967832035797553, "mean_inference_ms": 0.397383014037144, "mean_action_processing_ms": 0.09548444717142175, "mean_env_wait_ms": 4.114995221999626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037032113948338467, "StateBufferConnector_ms": 0.002667265878596776, "ViewRequirementAgentConnector_ms": 0.06882741417683347}}, "episode_reward_max": -8359.897703805382, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8567.979994714846, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225, -8699.451627564682, -8621.788247231507, -8528.325509169708, -8541.400601975636, -8646.418214878375, -8464.0225866508, -8489.209652500482, -8597.880151542004, -8432.750116766956, -8359.897703805382, -8499.96295692942, -8511.516178945134, -8515.788428936086, -8588.769466283664, -8608.927264277712, -8655.44608956549, -8565.581405805728, -8543.514147471036, -8451.487551684455, -8525.37178894053, -8598.96650544453, -8400.241742580136, -8612.14979546565, -8573.452903289584], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.967832035797553, "mean_inference_ms": 0.397383014037144, "mean_action_processing_ms": 0.09548444717142175, "mean_env_wait_ms": 4.114995221999626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037032113948338467, "StateBufferConnector_ms": 0.002667265878596776, "ViewRequirementAgentConnector_ms": 0.06882741417683347}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17160, "num_agent_steps_trained": 17160, "num_env_steps_sampled": 17160, "num_env_steps_trained": 17160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.79320697153457, "num_env_steps_trained_throughput_per_sec": 38.79320697153457, "timesteps_total": 17160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 17160, "timers": {"training_iteration_time_ms": 3090.248, "sample_time_ms": 3086.436, "load_time_ms": 0.219, "load_throughput": 548334.764, "learn_time_ms": 2.838, "learn_throughput": 42288.751, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 17160, "num_env_steps_trained": 17160, "num_agent_steps_sampled": 17160, "num_agent_steps_trained": 17160}, "done": false, "episodes_total": 95, "training_iteration": 23, "trial_id": "b894a_00000", "date": "2023-07-25_17-47-59", "timestamp": 1690296479, "time_this_iter_s": 12.375982284545898, "time_total_s": 274.93740701675415, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 219.57380318641663, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 24.516666666666666, "ram_util_percent": 76.94444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.861111111111111e-06, "entropy_coeff": 0.1, "policy_entropy": -926.7555541992188, "policy_loss": -1550771493535744.0, "vf_loss": 554696704.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}}, "num_env_steps_sampled": 17640, "num_env_steps_trained": 17640, "num_agent_steps_sampled": 17640, "num_agent_steps_trained": 17640}, "sampler_results": {"episode_reward_max": -8359.897703805382, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8568.73688800855, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225, -8699.451627564682, -8621.788247231507, -8528.325509169708, -8541.400601975636, -8646.418214878375, -8464.0225866508, -8489.209652500482, -8597.880151542004, -8432.750116766956, -8359.897703805382, -8499.96295692942, -8511.516178945134, -8515.788428936086, -8588.769466283664, -8608.927264277712, -8655.44608956549, -8565.581405805728, -8543.514147471036, -8451.487551684455, -8525.37178894053, -8598.96650544453, -8400.241742580136, -8612.14979546565, -8573.452903289584, -8559.720473649633, -8676.115322077221, -8570.349404386865, -8522.50177577346], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.96866155300193, "mean_inference_ms": 0.39727596400444987, "mean_action_processing_ms": 0.0954668468716787, "mean_env_wait_ms": 4.06527986334666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036757787068684897, "StateBufferConnector_ms": 0.0026712417602539062, "ViewRequirementAgentConnector_ms": 0.06868839263916016}}, "episode_reward_max": -8359.897703805382, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8568.73688800855, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225, -8699.451627564682, -8621.788247231507, -8528.325509169708, -8541.400601975636, -8646.418214878375, -8464.0225866508, -8489.209652500482, -8597.880151542004, -8432.750116766956, -8359.897703805382, -8499.96295692942, -8511.516178945134, -8515.788428936086, -8588.769466283664, -8608.927264277712, -8655.44608956549, -8565.581405805728, -8543.514147471036, -8451.487551684455, -8525.37178894053, -8598.96650544453, -8400.241742580136, -8612.14979546565, -8573.452903289584, -8559.720473649633, -8676.115322077221, -8570.349404386865, -8522.50177577346], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.96866155300193, "mean_inference_ms": 0.39727596400444987, "mean_action_processing_ms": 0.0954668468716787, "mean_env_wait_ms": 4.06527986334666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036757787068684897, "StateBufferConnector_ms": 0.0026712417602539062, "ViewRequirementAgentConnector_ms": 0.06868839263916016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17640, "num_agent_steps_trained": 17640, "num_env_steps_sampled": 17640, "num_env_steps_trained": 17640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.55656444764069, "num_env_steps_trained_throughput_per_sec": 39.55656444764069, "timesteps_total": 17640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 17640, "timers": {"training_iteration_time_ms": 3068.622, "sample_time_ms": 3064.785, "load_time_ms": 0.218, "load_throughput": 549952.448, "learn_time_ms": 2.859, "learn_throughput": 41969.971, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 17640, "num_env_steps_trained": 17640, "num_agent_steps_sampled": 17640, "num_agent_steps_trained": 17640}, "done": false, "episodes_total": 99, "training_iteration": 24, "trial_id": "b894a_00000", "date": "2023-07-25_17-48-11", "timestamp": 1690296491, "time_this_iter_s": 12.137261867523193, "time_total_s": 287.07466888427734, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 231.71106505393982, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 25.50588235294117, "ram_util_percent": 76.8529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.194444444444445e-06, "entropy_coeff": 0.1, "policy_entropy": -926.7591552734375, "policy_loss": -1787475999588352.0, "vf_loss": 557269888.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 18120, "num_env_steps_trained": 18120, "num_agent_steps_sampled": 18120, "num_agent_steps_trained": 18120}, "sampler_results": {"episode_reward_max": -8359.897703805382, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8570.93932288381, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225, -8699.451627564682, -8621.788247231507, -8528.325509169708, -8541.400601975636, -8646.418214878375, -8464.0225866508, -8489.209652500482, -8597.880151542004, -8432.750116766956, -8359.897703805382, -8499.96295692942, -8511.516178945134, -8515.788428936086, -8588.769466283664, -8608.927264277712, -8655.44608956549, -8565.581405805728, -8543.514147471036, -8451.487551684455, -8525.37178894053, -8598.96650544453, -8400.241742580136, -8612.14979546565, -8573.452903289584, -8559.720473649633, -8676.115322077221, -8570.349404386865, -8522.50177577346, -8590.192034624506, -8684.101953326717, -8624.043411256836, -8550.602507971538], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.969294262520535, "mean_inference_ms": 0.39717868025825104, "mean_action_processing_ms": 0.09545006986470979, "mean_env_wait_ms": 4.019633746406535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036541419693186315, "StateBufferConnector_ms": 0.002669684494598002, "ViewRequirementAgentConnector_ms": 0.0686256191398524}}, "episode_reward_max": -8359.897703805382, "episode_reward_min": -8790.928969891173, "episode_reward_mean": -8570.93932288381, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8469.636999014867, -8758.426256122595, -8601.779488761094, -8582.614474720825, -8464.665493229266, -8623.071644189886, -8738.968946418752, -8623.667570252474, -8508.938871350292, -8488.35260827849, -8551.57687846119, -8498.541141611806, -8554.078210908721, -8645.857487840676, -8689.677504825942, -8510.446660683478, -8611.957083426427, -8495.866211967204, -8525.481985802404, -8657.129535969307, -8576.68801054461, -8603.414485432091, -8666.40804123794, -8638.86669486618, -8577.023982174276, -8550.613757638988, -8605.92097221089, -8491.138489010187, -8511.820223683364, -8615.836078399145, -8545.128716847927, -8528.960910092565, -8584.262119081865, -8481.302595069545, -8450.047191155703, -8545.142656297678, -8622.278303425002, -8525.150717328885, -8605.03382310144, -8582.618516314267, -8580.142324348526, -8790.928969891173, -8587.18908352759, -8587.140117846582, -8652.309442255502, -8623.733518757588, -8564.424192674225, -8699.451627564682, -8621.788247231507, -8528.325509169708, -8541.400601975636, -8646.418214878375, -8464.0225866508, -8489.209652500482, -8597.880151542004, -8432.750116766956, -8359.897703805382, -8499.96295692942, -8511.516178945134, -8515.788428936086, -8588.769466283664, -8608.927264277712, -8655.44608956549, -8565.581405805728, -8543.514147471036, -8451.487551684455, -8525.37178894053, -8598.96650544453, -8400.241742580136, -8612.14979546565, -8573.452903289584, -8559.720473649633, -8676.115322077221, -8570.349404386865, -8522.50177577346, -8590.192034624506, -8684.101953326717, -8624.043411256836, -8550.602507971538], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.969294262520535, "mean_inference_ms": 0.39717868025825104, "mean_action_processing_ms": 0.09545006986470979, "mean_env_wait_ms": 4.019633746406535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036541419693186315, "StateBufferConnector_ms": 0.002669684494598002, "ViewRequirementAgentConnector_ms": 0.0686256191398524}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18120, "num_agent_steps_trained": 18120, "num_env_steps_sampled": 18120, "num_env_steps_trained": 18120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.50235645659611, "num_env_steps_trained_throughput_per_sec": 39.50235645659611, "timesteps_total": 18120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 18120, "timers": {"training_iteration_time_ms": 3035.277, "sample_time_ms": 3031.473, "load_time_ms": 0.222, "load_throughput": 539923.278, "learn_time_ms": 2.821, "learn_throughput": 42537.502, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 18120, "num_env_steps_trained": 18120, "num_agent_steps_sampled": 18120, "num_agent_steps_trained": 18120}, "done": false, "episodes_total": 103, "training_iteration": 25, "trial_id": "b894a_00000", "date": "2023-07-25_17-48-23", "timestamp": 1690296503, "time_this_iter_s": 12.153857707977295, "time_total_s": 299.22852659225464, "pid": 74499, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[500, 0.01], [2300, 0.005], [4100, 0.001], [5900, 0.00075], [7700, 0.0005], [9500, 0.00025], [11300, 0.0001], [13100, 5e-05], [14900, 2.5e-05], [16700, 1e-05], [18500, 7.5e-06], [20300, 5e-06], [22100, 2.5e-06], [23900, 1e-06], [25700, 5e-07], [27500, 1e-07]], "grad_clip": 100, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3082bb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 243.86492276191711, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 24.961111111111112, "ram_util_percent": 76.82777777777778}}
