{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -662.9462738037109, "policy_loss": -17922912459.42857, "vf_loss": 315682990.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28.5, "diff_num_grad_updates_vs_sampler_policy": 27.5}}, "num_env_steps_sampled": 139200, "num_env_steps_trained": 139200, "num_agent_steps_sampled": 139200, "num_agent_steps_trained": 139200}, "sampler_results": {"episode_reward_max": -115075.83093813392, "episode_reward_min": -115075.83093813392, "episode_reward_mean": -115075.83093813392, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392], "episode_lengths": [3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0040916028667641, "mean_inference_ms": 0.4085799913477878, "mean_action_processing_ms": 0.09733926783135056, "mean_env_wait_ms": 1.7978876241542538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010514259338378906, "StateBufferConnector_ms": 0.002574920654296875, "ViewRequirementAgentConnector_ms": 0.06899833679199219}}, "episode_reward_max": -115075.83093813392, "episode_reward_min": -115075.83093813392, "episode_reward_mean": -115075.83093813392, "episode_len_mean": 3600.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392], "episode_lengths": [3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0040916028667641, "mean_inference_ms": 0.4085799913477878, "mean_action_processing_ms": 0.09733926783135056, "mean_env_wait_ms": 1.7978876241542538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010514259338378906, "StateBufferConnector_ms": 0.002574920654296875, "ViewRequirementAgentConnector_ms": 0.06899833679199219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139200, "num_agent_steps_trained": 139200, "num_env_steps_sampled": 139200, "num_env_steps_trained": 139200, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 294.4783346400028, "num_env_steps_trained_throughput_per_sec": 294.4783346400028, "timesteps_total": 139200, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 139200, "timers": {"training_iteration_time_ms": 12224.963, "sample_time_ms": 12012.791, "load_time_ms": 0.824, "load_throughput": 4367802.835, "learn_time_ms": 209.79, "learn_throughput": 17160.018, "synch_weights_time_ms": 1.46}, "counters": {"num_env_steps_sampled": 139200, "num_env_steps_trained": 139200, "num_agent_steps_sampled": 139200, "num_agent_steps_trained": 139200}, "done": false, "episodes_total": 911, "training_iteration": 186, "trial_id": "5f82d_00000", "date": "2023-07-26_23-31-36", "timestamp": 1690403496, "time_this_iter_s": 12.229933977127075, "time_total_s": 2040.059888124466, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 12.229933977127075, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 41.06111111111111, "ram_util_percent": 66.62222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.200055555555556e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -979.4894027709961, "policy_loss": -488597752832.0, "vf_loss": 315971061.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 140.5, "diff_num_grad_updates_vs_sampler_policy": 139.5}}, "num_env_steps_sampled": 146400, "num_env_steps_trained": 146400, "num_agent_steps_sampled": 146400, "num_agent_steps_trained": 146400}, "sampler_results": {"episode_reward_max": -114994.55955142419, "episode_reward_min": -115133.8593173467, "episode_reward_mean": -115068.08326896827, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467], "episode_lengths": [3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.956716123880808, "mean_inference_ms": 0.3989988566557165, "mean_action_processing_ms": 0.09599957572696934, "mean_env_wait_ms": 1.4705668350238688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007812182108561198, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.06744861602783203}}, "episode_reward_max": -114994.55955142419, "episode_reward_min": -115133.8593173467, "episode_reward_mean": -115068.08326896827, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467], "episode_lengths": [3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.956716123880808, "mean_inference_ms": 0.3989988566557165, "mean_action_processing_ms": 0.09599957572696934, "mean_env_wait_ms": 1.4705668350238688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007812182108561198, "StateBufferConnector_ms": 0.0025272369384765625, "ViewRequirementAgentConnector_ms": 0.06744861602783203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146400, "num_agent_steps_trained": 146400, "num_env_steps_sampled": 146400, "num_env_steps_trained": 146400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 401.980424202316, "num_env_steps_trained_throughput_per_sec": 401.980424202316, "timesteps_total": 146400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 146400, "timers": {"training_iteration_time_ms": 10045.415, "sample_time_ms": 9909.981, "load_time_ms": 1.485, "load_throughput": 2423674.864, "learn_time_ms": 132.853, "learn_throughput": 27097.678, "synch_weights_time_ms": 1.024}, "counters": {"num_env_steps_sampled": 146400, "num_env_steps_trained": 146400, "num_agent_steps_sampled": 146400, "num_agent_steps_trained": 146400}, "done": false, "episodes_total": 913, "training_iteration": 187, "trial_id": "5f82d_00000", "date": "2023-07-26_23-31-54", "timestamp": 1690403514, "time_this_iter_s": 17.914001941680908, "time_total_s": 2057.973890066147, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 30.143935918807983, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 23.53076923076923, "ram_util_percent": 66.71153846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.600055555555556e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1188.0469578334264, "policy_loss": -56881294816987.43, "vf_loss": 309917066.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 252.5, "diff_num_grad_updates_vs_sampler_policy": 251.5}}, "num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600}, "sampler_results": {"episode_reward_max": -114095.31087407623, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114953.98021777786, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623], "episode_lengths": [3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9430347912198451, "mean_inference_ms": 0.3927875896027385, "mean_action_processing_ms": 0.09489748120616433, "mean_env_wait_ms": 1.355597528951471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0079345703125, "StateBufferConnector_ms": 0.0028228759765625, "ViewRequirementAgentConnector_ms": 0.07153987884521484}}, "episode_reward_max": -114095.31087407623, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114953.98021777786, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623], "episode_lengths": [3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9430347912198451, "mean_inference_ms": 0.3927875896027385, "mean_action_processing_ms": 0.09489748120616433, "mean_env_wait_ms": 1.355597528951471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0079345703125, "StateBufferConnector_ms": 0.0028228759765625, "ViewRequirementAgentConnector_ms": 0.07153987884521484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600, "num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 415.1298222465926, "num_env_steps_trained_throughput_per_sec": 415.1298222465926, "timesteps_total": 153600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 153600, "timers": {"training_iteration_time_ms": 9496.037, "sample_time_ms": 9375.513, "load_time_ms": 1.609, "load_throughput": 2237956.781, "learn_time_ms": 117.919, "learn_throughput": 30529.328, "synch_weights_time_ms": 0.931}, "counters": {"num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600}, "done": false, "episodes_total": 915, "training_iteration": 188, "trial_id": "5f82d_00000", "date": "2023-07-26_23-32-12", "timestamp": 1690403532, "time_this_iter_s": 17.346458911895752, "time_total_s": 2075.3203489780426, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 47.490394830703735, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 19.570833333333336, "ram_util_percent": 66.85416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.0000555555555554e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1348.7643389020648, "policy_loss": -1.0958295644616412e+16, "vf_loss": 314093395.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 364.5, "diff_num_grad_updates_vs_sampler_policy": 363.5}}, "num_env_steps_sampled": 160800, "num_env_steps_trained": 160800, "num_agent_steps_sampled": 160800, "num_agent_steps_trained": 160800}, "sampler_results": {"episode_reward_max": -114095.31087407623, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114900.93028519473, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9348894160568123, "mean_inference_ms": 0.38872596445075447, "mean_action_processing_ms": 0.09414914165927883, "mean_env_wait_ms": 1.2917538055224698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007520403180803571, "StateBufferConnector_ms": 0.002792903355189732, "ViewRequirementAgentConnector_ms": 0.06947176797049386}}, "episode_reward_max": -114095.31087407623, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114900.93028519473, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9348894160568123, "mean_inference_ms": 0.38872596445075447, "mean_action_processing_ms": 0.09414914165927883, "mean_env_wait_ms": 1.2917538055224698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007520403180803571, "StateBufferConnector_ms": 0.002792903355189732, "ViewRequirementAgentConnector_ms": 0.06947176797049386}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160800, "num_agent_steps_trained": 160800, "num_env_steps_sampled": 160800, "num_env_steps_trained": 160800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 416.31549852920597, "num_env_steps_trained_throughput_per_sec": 416.31549852920597, "timesteps_total": 160800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 160800, "timers": {"training_iteration_time_ms": 9253.532, "sample_time_ms": 9139.633, "load_time_ms": 1.53, "load_throughput": 2352940.959, "learn_time_ms": 111.414, "learn_throughput": 32311.97, "synch_weights_time_ms": 0.893}, "counters": {"num_env_steps_sampled": 160800, "num_env_steps_trained": 160800, "num_agent_steps_sampled": 160800, "num_agent_steps_trained": 160800}, "done": false, "episodes_total": 917, "training_iteration": 189, "trial_id": "5f82d_00000", "date": "2023-07-26_23-32-29", "timestamp": 1690403549, "time_this_iter_s": 17.29711103439331, "time_total_s": 2092.617460012436, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 64.78750586509705, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.535999999999998, "ram_util_percent": 66.828}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.400055555555558e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1488.1390991210938, "policy_loss": -7.573189687401138e+17, "vf_loss": 312134837.35714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 476.5, "diff_num_grad_updates_vs_sampler_policy": 475.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": -114095.31087407623, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114795.39897995483, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9300243559183651, "mean_inference_ms": 0.3857759262325677, "mean_action_processing_ms": 0.09360894921224278, "mean_env_wait_ms": 1.2471140692551452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072638193766276045, "StateBufferConnector_ms": 0.0027312172783745658, "ViewRequirementAgentConnector_ms": 0.06824599372016059}}, "episode_reward_max": -114095.31087407623, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114795.39897995483, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9300243559183651, "mean_inference_ms": 0.3857759262325677, "mean_action_processing_ms": 0.09360894921224278, "mean_env_wait_ms": 1.2471140692551452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072638193766276045, "StateBufferConnector_ms": 0.0027312172783745658, "ViewRequirementAgentConnector_ms": 0.06824599372016059}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.677019148442, "num_env_steps_trained_throughput_per_sec": 424.677019148442, "timesteps_total": 168000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 9080.973, "sample_time_ms": 8971.07, "load_time_ms": 1.534, "load_throughput": 2346625.85, "learn_time_ms": 107.437, "learn_throughput": 33507.885, "synch_weights_time_ms": 0.871}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 919, "training_iteration": 190, "trial_id": "5f82d_00000", "date": "2023-07-26_23-32-46", "timestamp": 1690403566, "time_this_iter_s": 16.956601858139038, "time_total_s": 2109.574061870575, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 81.74410772323608, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.34583333333333, "ram_util_percent": 67.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.800055555555557e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1523.3482426234655, "policy_loss": -2.1826224421739092e+18, "vf_loss": 308078051.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 588.5, "diff_num_grad_updates_vs_sampler_policy": 587.5}}, "num_env_steps_sampled": 175200, "num_env_steps_trained": 175200, "num_agent_steps_sampled": 175200, "num_agent_steps_trained": 175200}, "sampler_results": {"episode_reward_max": -113696.8670304221, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114636.49406778465, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9266104491015791, "mean_inference_ms": 0.38352540485819575, "mean_action_processing_ms": 0.09319715175202568, "mean_env_wait_ms": 1.2131671106708588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007588213140314276, "StateBufferConnector_ms": 0.0027938322587446733, "ViewRequirementAgentConnector_ms": 0.06984797391024503}}, "episode_reward_max": -113696.8670304221, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114636.49406778465, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9266104491015791, "mean_inference_ms": 0.38352540485819575, "mean_action_processing_ms": 0.09319715175202568, "mean_env_wait_ms": 1.2131671106708588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007588213140314276, "StateBufferConnector_ms": 0.0027938322587446733, "ViewRequirementAgentConnector_ms": 0.06984797391024503}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175200, "num_agent_steps_trained": 175200, "num_env_steps_sampled": 175200, "num_env_steps_trained": 175200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 429.74660452170895, "num_env_steps_trained_throughput_per_sec": 429.74660452170895, "timesteps_total": 175200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 175200, "timers": {"training_iteration_time_ms": 8625.782, "sample_time_ms": 8528.714, "load_time_ms": 1.558, "load_throughput": 2311123.519, "learn_time_ms": 94.661, "learn_throughput": 38030.542, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 175200, "num_env_steps_trained": 175200, "num_agent_steps_sampled": 175200, "num_agent_steps_trained": 175200}, "done": false, "episodes_total": 921, "training_iteration": 191, "trial_id": "5f82d_00000", "date": "2023-07-26_23-33-03", "timestamp": 1690403583, "time_this_iter_s": 16.756869792938232, "time_total_s": 2126.330931663513, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 98.50097751617432, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 19.3125, "ram_util_percent": 67.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.200055555555557e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1529.1761060442243, "policy_loss": -3.093883233399322e+18, "vf_loss": 310148530.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 700.5, "diff_num_grad_updates_vs_sampler_policy": 699.5}}, "num_env_steps_sampled": 182400, "num_env_steps_trained": 182400, "num_agent_steps_sampled": 182400, "num_agent_steps_trained": 182400}, "sampler_results": {"episode_reward_max": -113696.8670304221, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114543.01826681264, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9253015596818392, "mean_inference_ms": 0.3831367691213581, "mean_action_processing_ms": 0.09316041772029532, "mean_env_wait_ms": 1.188757528250559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007299276498647837, "StateBufferConnector_ms": 0.0029930701622596155, "ViewRequirementAgentConnector_ms": 0.07640581864577073}}, "episode_reward_max": -113696.8670304221, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114543.01826681264, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9253015596818392, "mean_inference_ms": 0.3831367691213581, "mean_action_processing_ms": 0.09316041772029532, "mean_env_wait_ms": 1.188757528250559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007299276498647837, "StateBufferConnector_ms": 0.0029930701622596155, "ViewRequirementAgentConnector_ms": 0.07640581864577073}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182400, "num_agent_steps_trained": 182400, "num_env_steps_sampled": 182400, "num_env_steps_trained": 182400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 392.02377301375054, "num_env_steps_trained_throughput_per_sec": 392.02377301375054, "timesteps_total": 182400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 182400, "timers": {"training_iteration_time_ms": 8671.274, "sample_time_ms": 8573.926, "load_time_ms": 1.479, "load_throughput": 2434538.454, "learn_time_ms": 95.008, "learn_throughput": 37891.53, "synch_weights_time_ms": 0.805}, "counters": {"num_env_steps_sampled": 182400, "num_env_steps_trained": 182400, "num_agent_steps_sampled": 182400, "num_agent_steps_trained": 182400}, "done": false, "episodes_total": 923, "training_iteration": 192, "trial_id": "5f82d_00000", "date": "2023-07-26_23-33-21", "timestamp": 1690403601, "time_this_iter_s": 18.368734121322632, "time_total_s": 2144.699665784836, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 116.86971163749695, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.72692307692308, "ram_util_percent": 65.92692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.600055555555556e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1529.1905103410993, "policy_loss": -3.412803995158034e+18, "vf_loss": 314436298.78571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 812.5, "diff_num_grad_updates_vs_sampler_policy": 811.5}}, "num_env_steps_sampled": 189600, "num_env_steps_trained": 189600, "num_agent_steps_sampled": 189600, "num_agent_steps_trained": 189600}, "sampler_results": {"episode_reward_max": -113696.8670304221, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114545.15716565527, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9239227076841295, "mean_inference_ms": 0.38252996122406824, "mean_action_processing_ms": 0.0930718631481395, "mean_env_wait_ms": 1.1693358320772214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006769498189290364, "StateBufferConnector_ms": 0.0029198328653971353, "ViewRequirementAgentConnector_ms": 0.07510662078857422}}, "episode_reward_max": -113696.8670304221, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114545.15716565527, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9239227076841295, "mean_inference_ms": 0.38252996122406824, "mean_action_processing_ms": 0.0930718631481395, "mean_env_wait_ms": 1.1693358320772214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006769498189290364, "StateBufferConnector_ms": 0.0029198328653971353, "ViewRequirementAgentConnector_ms": 0.07510662078857422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 189600, "num_agent_steps_trained": 189600, "num_env_steps_sampled": 189600, "num_env_steps_trained": 189600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.29393900015157, "num_env_steps_trained_throughput_per_sec": 423.29393900015157, "timesteps_total": 189600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 189600, "timers": {"training_iteration_time_ms": 8637.822, "sample_time_ms": 8540.704, "load_time_ms": 1.384, "load_throughput": 2600715.548, "learn_time_ms": 94.876, "learn_throughput": 37944.415, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 189600, "num_env_steps_trained": 189600, "num_agent_steps_sampled": 189600, "num_agent_steps_trained": 189600}, "done": false, "episodes_total": 925, "training_iteration": 193, "trial_id": "5f82d_00000", "date": "2023-07-26_23-33-38", "timestamp": 1690403618, "time_this_iter_s": 17.01209592819214, "time_total_s": 2161.711761713028, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 133.8818075656891, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.016666666666666, "ram_util_percent": 62.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.999898148148149e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1532.3492736816406, "policy_loss": -3.7730739998221363e+18, "vf_loss": 312562456.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 924.5, "diff_num_grad_updates_vs_sampler_policy": 923.5}}, "num_env_steps_sampled": 196800, "num_env_steps_trained": 196800, "num_agent_steps_sampled": 196800, "num_agent_steps_trained": 196800}, "sampler_results": {"episode_reward_max": -113696.8670304221, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114543.647524128, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.922622860942025, "mean_inference_ms": 0.3818663766347057, "mean_action_processing_ms": 0.0929665708136349, "mean_env_wait_ms": 1.153782076584314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00634614159079159, "StateBufferConnector_ms": 0.002862425411448759, "ViewRequirementAgentConnector_ms": 0.07389433243695427}}, "episode_reward_max": -113696.8670304221, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114543.647524128, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.922622860942025, "mean_inference_ms": 0.3818663766347057, "mean_action_processing_ms": 0.0929665708136349, "mean_env_wait_ms": 1.153782076584314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00634614159079159, "StateBufferConnector_ms": 0.002862425411448759, "ViewRequirementAgentConnector_ms": 0.07389433243695427}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196800, "num_agent_steps_trained": 196800, "num_env_steps_sampled": 196800, "num_env_steps_trained": 196800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 418.4209304482845, "num_env_steps_trained_throughput_per_sec": 418.4209304482845, "timesteps_total": 196800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 196800, "timers": {"training_iteration_time_ms": 8629.12, "sample_time_ms": 8532.212, "load_time_ms": 1.389, "load_throughput": 2591698.46, "learn_time_ms": 94.658, "learn_throughput": 38031.634, "synch_weights_time_ms": 0.803}, "counters": {"num_env_steps_sampled": 196800, "num_env_steps_trained": 196800, "num_agent_steps_sampled": 196800, "num_agent_steps_trained": 196800}, "done": false, "episodes_total": 927, "training_iteration": 194, "trial_id": "5f82d_00000", "date": "2023-07-26_23-33-55", "timestamp": 1690403635, "time_this_iter_s": 17.21023392677307, "time_total_s": 2178.921995639801, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 151.09204149246216, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.804, "ram_util_percent": 62.767999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.266564814814817e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1532.4002685546875, "policy_loss": -3.6026375418231194e+18, "vf_loss": 313985221.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1036.5, "diff_num_grad_updates_vs_sampler_policy": 1035.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": -113459.96274947462, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114495.99697894554, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.921500522997141, "mean_inference_ms": 0.3812083052018968, "mean_action_processing_ms": 0.09285903048173766, "mean_env_wait_ms": 1.140562198361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006234018426192434, "StateBufferConnector_ms": 0.002952625876978824, "ViewRequirementAgentConnector_ms": 0.07540301272743627}}, "episode_reward_max": -113459.96274947462, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114495.99697894554, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.921500522997141, "mean_inference_ms": 0.3812083052018968, "mean_action_processing_ms": 0.09285903048173766, "mean_env_wait_ms": 1.140562198361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006234018426192434, "StateBufferConnector_ms": 0.002952625876978824, "ViewRequirementAgentConnector_ms": 0.07540301272743627}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.03825290109097, "num_env_steps_trained_throughput_per_sec": 424.03825290109097, "timesteps_total": 204000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 8631.674, "sample_time_ms": 8534.279, "load_time_ms": 1.404, "load_throughput": 2563494.347, "learn_time_ms": 95.124, "learn_throughput": 37845.184, "synch_weights_time_ms": 0.808}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 929, "training_iteration": 195, "trial_id": "5f82d_00000", "date": "2023-07-26_23-34-12", "timestamp": 1690403652, "time_this_iter_s": 16.98213291168213, "time_total_s": 2195.904128551483, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 168.0741744041443, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 19.254166666666666, "ram_util_percent": 64.05416666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.533231481481482e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1532.408950805664, "policy_loss": -3.7287818796494316e+18, "vf_loss": 315279294.5714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1148.5, "diff_num_grad_updates_vs_sampler_policy": 1147.5}}, "num_env_steps_sampled": 211200, "num_env_steps_trained": 211200, "num_agent_steps_sampled": 211200, "num_agent_steps_trained": 211200}, "sampler_results": {"episode_reward_max": -113459.96274947462, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114479.74263614301, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9203566318043183, "mean_inference_ms": 0.3805649112419945, "mean_action_processing_ms": 0.09275204565788174, "mean_env_wait_ms": 1.1292782497874225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005945705232166108, "StateBufferConnector_ms": 0.0029189246041434152, "ViewRequirementAgentConnector_ms": 0.0743548075358073}}, "episode_reward_max": -113459.96274947462, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114479.74263614301, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9203566318043183, "mean_inference_ms": 0.3805649112419945, "mean_action_processing_ms": 0.09275204565788174, "mean_env_wait_ms": 1.1292782497874225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005945705232166108, "StateBufferConnector_ms": 0.0029189246041434152, "ViewRequirementAgentConnector_ms": 0.0743548075358073}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 211200, "num_agent_steps_trained": 211200, "num_env_steps_sampled": 211200, "num_env_steps_trained": 211200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 425.47493327709736, "num_env_steps_trained_throughput_per_sec": 425.47493327709736, "timesteps_total": 211200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 211200, "timers": {"training_iteration_time_ms": 8648.494, "sample_time_ms": 8550.752, "load_time_ms": 1.418, "load_throughput": 2539650.896, "learn_time_ms": 95.462, "learn_throughput": 37711.232, "synch_weights_time_ms": 0.804}, "counters": {"num_env_steps_sampled": 211200, "num_env_steps_trained": 211200, "num_agent_steps_sampled": 211200, "num_agent_steps_trained": 211200}, "done": false, "episodes_total": 931, "training_iteration": 196, "trial_id": "5f82d_00000", "date": "2023-07-26_23-34-29", "timestamp": 1690403669, "time_this_iter_s": 16.924808979034424, "time_total_s": 2212.8289375305176, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 184.9989833831787, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.7375, "ram_util_percent": 64.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.799898148148149e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1535.646715436663, "policy_loss": -3.8870511043765115e+18, "vf_loss": 309786864.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 1259.5}}, "num_env_steps_sampled": 218400, "num_env_steps_trained": 218400, "num_agent_steps_sampled": 218400, "num_agent_steps_trained": 218400}, "sampler_results": {"episode_reward_max": -113459.96274947462, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114432.43834739561, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9193682953610852, "mean_inference_ms": 0.3799521126946189, "mean_action_processing_ms": 0.09264955047009253, "mean_env_wait_ms": 1.1195569145982844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005725155705990998, "StateBufferConnector_ms": 0.0029035236524498982, "ViewRequirementAgentConnector_ms": 0.073620547419009}}, "episode_reward_max": -113459.96274947462, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114432.43834739561, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9193682953610852, "mean_inference_ms": 0.3799521126946189, "mean_action_processing_ms": 0.09264955047009253, "mean_env_wait_ms": 1.1195569145982844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005725155705990998, "StateBufferConnector_ms": 0.0029035236524498982, "ViewRequirementAgentConnector_ms": 0.073620547419009}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 218400, "num_agent_steps_trained": 218400, "num_env_steps_sampled": 218400, "num_env_steps_trained": 218400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.42222875184956, "num_env_steps_trained_throughput_per_sec": 421.42222875184956, "timesteps_total": 218400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 218400, "timers": {"training_iteration_time_ms": 8520.371, "sample_time_ms": 8423.022, "load_time_ms": 1.413, "load_throughput": 2546890.396, "learn_time_ms": 95.086, "learn_throughput": 37860.424, "synch_weights_time_ms": 0.791}, "counters": {"num_env_steps_sampled": 218400, "num_env_steps_trained": 218400, "num_agent_steps_sampled": 218400, "num_agent_steps_trained": 218400}, "done": false, "episodes_total": 933, "training_iteration": 197, "trial_id": "5f82d_00000", "date": "2023-07-26_23-34-46", "timestamp": 1690403686, "time_this_iter_s": 17.087573051452637, "time_total_s": 2229.91651058197, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 202.08655643463135, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.849999999999998, "ram_util_percent": 65.00416666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.0665648148148146e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1535.801258632115, "policy_loss": -3.6921347291649336e+18, "vf_loss": 308319072.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1372.5, "diff_num_grad_updates_vs_sampler_policy": 1371.5}}, "num_env_steps_sampled": 225600, "num_env_steps_trained": 225600, "num_agent_steps_sampled": 225600, "num_agent_steps_trained": 225600}, "sampler_results": {"episode_reward_max": -113459.96274947462, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114387.09369475953, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9184381140643372, "mean_inference_ms": 0.3793727529603921, "mean_action_processing_ms": 0.09255269727010726, "mean_env_wait_ms": 1.1109752595415174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005526542663574219, "StateBufferConnector_ms": 0.0028715133666992188, "ViewRequirementAgentConnector_ms": 0.07289981842041016}}, "episode_reward_max": -113459.96274947462, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114387.09369475953, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9184381140643372, "mean_inference_ms": 0.3793727529603921, "mean_action_processing_ms": 0.09255269727010726, "mean_env_wait_ms": 1.1109752595415174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005526542663574219, "StateBufferConnector_ms": 0.0028715133666992188, "ViewRequirementAgentConnector_ms": 0.07289981842041016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225600, "num_agent_steps_trained": 225600, "num_env_steps_sampled": 225600, "num_env_steps_trained": 225600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 426.339185043995, "num_env_steps_trained_throughput_per_sec": 426.339185043995, "timesteps_total": 225600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 225600, "timers": {"training_iteration_time_ms": 8508.222, "sample_time_ms": 8411.022, "load_time_ms": 1.42, "load_throughput": 2535812.31, "learn_time_ms": 94.937, "learn_throughput": 37919.792, "synch_weights_time_ms": 0.785}, "counters": {"num_env_steps_sampled": 225600, "num_env_steps_trained": 225600, "num_agent_steps_sampled": 225600, "num_agent_steps_trained": 225600}, "done": false, "episodes_total": 935, "training_iteration": 198, "trial_id": "5f82d_00000", "date": "2023-07-26_23-35-03", "timestamp": 1690403703, "time_this_iter_s": 16.8906512260437, "time_total_s": 2246.807161808014, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 218.97720766067505, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.42916666666667, "ram_util_percent": 64.83749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.333231481481482e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1537.0111519949776, "policy_loss": -2.87720579711534e+18, "vf_loss": 306522026.35714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1484.5, "diff_num_grad_updates_vs_sampler_policy": 1483.5}}, "num_env_steps_sampled": 232800, "num_env_steps_trained": 232800, "num_agent_steps_sampled": 232800, "num_agent_steps_trained": 232800}, "sampler_results": {"episode_reward_max": -113331.39617506192, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114314.72605566985, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9175794672466686, "mean_inference_ms": 0.37882042486730294, "mean_action_processing_ms": 0.09245962187906116, "mean_env_wait_ms": 1.1032326473407987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005368833188657407, "StateBufferConnector_ms": 0.002850426567925347, "ViewRequirementAgentConnector_ms": 0.07246158741138599}}, "episode_reward_max": -113331.39617506192, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114314.72605566985, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9175794672466686, "mean_inference_ms": 0.37882042486730294, "mean_action_processing_ms": 0.09245962187906116, "mean_env_wait_ms": 1.1032326473407987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005368833188657407, "StateBufferConnector_ms": 0.002850426567925347, "ViewRequirementAgentConnector_ms": 0.07246158741138599}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232800, "num_agent_steps_trained": 232800, "num_env_steps_sampled": 232800, "num_env_steps_trained": 232800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 429.713675036963, "num_env_steps_trained_throughput_per_sec": 429.713675036963, "timesteps_total": 232800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 232800, "timers": {"training_iteration_time_ms": 8463.001, "sample_time_ms": 8365.717, "load_time_ms": 1.461, "load_throughput": 2464016.71, "learn_time_ms": 94.975, "learn_throughput": 37904.657, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 232800, "num_env_steps_trained": 232800, "num_agent_steps_sampled": 232800, "num_agent_steps_trained": 232800}, "done": false, "episodes_total": 937, "training_iteration": 199, "trial_id": "5f82d_00000", "date": "2023-07-26_23-35-20", "timestamp": 1690403720, "time_this_iter_s": 16.75782299041748, "time_total_s": 2263.5649847984314, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 235.73503065109253, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.008333333333333, "ram_util_percent": 65.8875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.599898148148148e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1537.9940294538226, "policy_loss": -3.690550780874607e+18, "vf_loss": 309873700.35714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1596.5, "diff_num_grad_updates_vs_sampler_policy": 1595.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": -113331.39617506192, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114300.86094931532, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9167639618674213, "mean_inference_ms": 0.37830129700503207, "mean_action_processing_ms": 0.09237169850019127, "mean_env_wait_ms": 1.0964237771018166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005242742341140221, "StateBufferConnector_ms": 0.0028289597609947466, "ViewRequirementAgentConnector_ms": 0.07205256100358634}}, "episode_reward_max": -113331.39617506192, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114300.86094931532, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9167639618674213, "mean_inference_ms": 0.37830129700503207, "mean_action_processing_ms": 0.09237169850019127, "mean_env_wait_ms": 1.0964237771018166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005242742341140221, "StateBufferConnector_ms": 0.0028289597609947466, "ViewRequirementAgentConnector_ms": 0.07205256100358634}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.11802546815574, "num_env_steps_trained_throughput_per_sec": 422.11802546815574, "timesteps_total": 240000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 8470.724, "sample_time_ms": 8373.152, "load_time_ms": 1.408, "load_throughput": 2556160.282, "learn_time_ms": 95.318, "learn_throughput": 37768.423, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 939, "training_iteration": 200, "trial_id": "5f82d_00000", "date": "2023-07-26_23-35-37", "timestamp": 1690403737, "time_this_iter_s": 17.059656858444214, "time_total_s": 2280.6246416568756, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 252.79468750953674, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.666666666666668, "ram_util_percent": 66.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8665648148148146e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1538.5730525425502, "policy_loss": -4.3631997119666396e+18, "vf_loss": 312900255.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1708.5, "diff_num_grad_updates_vs_sampler_policy": 1707.5}}, "num_env_steps_sampled": 247200, "num_env_steps_trained": 247200, "num_agent_steps_sampled": 247200, "num_agent_steps_trained": 247200}, "sampler_results": {"episode_reward_max": -113331.39617506192, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114295.31970075097, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9160572434944495, "mean_inference_ms": 0.37781679125382694, "mean_action_processing_ms": 0.09228905288257029, "mean_env_wait_ms": 1.0903514620699088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005117539436586441, "StateBufferConnector_ms": 0.0028056483114919355, "ViewRequirementAgentConnector_ms": 0.0715432628508537}}, "episode_reward_max": -113331.39617506192, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114295.31970075097, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9160572434944495, "mean_inference_ms": 0.37781679125382694, "mean_action_processing_ms": 0.09228905288257029, "mean_env_wait_ms": 1.0903514620699088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005117539436586441, "StateBufferConnector_ms": 0.0028056483114919355, "ViewRequirementAgentConnector_ms": 0.0715432628508537}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247200, "num_agent_steps_trained": 247200, "num_env_steps_sampled": 247200, "num_env_steps_trained": 247200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.6755939152726, "num_env_steps_trained_throughput_per_sec": 420.6755939152726, "timesteps_total": 247200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 247200, "timers": {"training_iteration_time_ms": 8490.031, "sample_time_ms": 8392.671, "load_time_ms": 1.422, "load_throughput": 2532240.085, "learn_time_ms": 95.091, "learn_throughput": 37858.583, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 247200, "num_env_steps_trained": 247200, "num_agent_steps_sampled": 247200, "num_agent_steps_trained": 247200}, "done": false, "episodes_total": 941, "training_iteration": 201, "trial_id": "5f82d_00000", "date": "2023-07-26_23-35-54", "timestamp": 1690403754, "time_this_iter_s": 17.118017196655273, "time_total_s": 2297.742658853531, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 269.912704706192, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.532, "ram_util_percent": 66.86399999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1538.657457624163, "policy_loss": -3.7045741789774525e+18, "vf_loss": 306927807.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1820.5, "diff_num_grad_updates_vs_sampler_policy": 1819.5}}, "num_env_steps_sampled": 254400, "num_env_steps_trained": 254400, "num_agent_steps_sampled": 254400, "num_agent_steps_trained": 254400}, "sampler_results": {"episode_reward_max": -113331.39617506192, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114261.6160481975, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9154314046843056, "mean_inference_ms": 0.3773670033493903, "mean_action_processing_ms": 0.09221218204804882, "mean_env_wait_ms": 1.0847851175038954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00502051729144472, "StateBufferConnector_ms": 0.0027880524144028172, "ViewRequirementAgentConnector_ms": 0.0711202621459961}}, "episode_reward_max": -113331.39617506192, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114261.6160481975, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9154314046843056, "mean_inference_ms": 0.3773670033493903, "mean_action_processing_ms": 0.09221218204804882, "mean_env_wait_ms": 1.0847851175038954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00502051729144472, "StateBufferConnector_ms": 0.0027880524144028172, "ViewRequirementAgentConnector_ms": 0.0711202621459961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 254400, "num_agent_steps_trained": 254400, "num_env_steps_sampled": 254400, "num_env_steps_trained": 254400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 426.4647705426909, "num_env_steps_trained_throughput_per_sec": 426.4647705426909, "timesteps_total": 254400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 254400, "timers": {"training_iteration_time_ms": 8469.83, "sample_time_ms": 8372.484, "load_time_ms": 1.471, "load_throughput": 2447005.867, "learn_time_ms": 95.025, "learn_throughput": 37884.6, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 254400, "num_env_steps_trained": 254400, "num_agent_steps_sampled": 254400, "num_agent_steps_trained": 254400}, "done": false, "episodes_total": 943, "training_iteration": 202, "trial_id": "5f82d_00000", "date": "2023-07-26_23-36-11", "timestamp": 1690403771, "time_this_iter_s": 16.885627031326294, "time_total_s": 2314.628285884857, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 286.7983317375183, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.316666666666666, "ram_util_percent": 67.04583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1538.8689596993584, "policy_loss": -3.918544510162122e+18, "vf_loss": 308237770.78571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1932.5, "diff_num_grad_updates_vs_sampler_policy": 1931.5}}, "num_env_steps_sampled": 261600, "num_env_steps_trained": 261600, "num_agent_steps_sampled": 261600, "num_agent_steps_trained": 261600}, "sampler_results": {"episode_reward_max": -113331.39617506192, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114257.01578511663, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9148446718682859, "mean_inference_ms": 0.376940434573596, "mean_action_processing_ms": 0.09213958960651204, "mean_env_wait_ms": 1.0797736701985738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00492300306047712, "StateBufferConnector_ms": 0.0027785982404436383, "ViewRequirementAgentConnector_ms": 0.07079124450683594}}, "episode_reward_max": -113331.39617506192, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114257.01578511663, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9148446718682859, "mean_inference_ms": 0.376940434573596, "mean_action_processing_ms": 0.09213958960651204, "mean_env_wait_ms": 1.0797736701985738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00492300306047712, "StateBufferConnector_ms": 0.0027785982404436383, "ViewRequirementAgentConnector_ms": 0.07079124450683594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 261600, "num_agent_steps_trained": 261600, "num_env_steps_sampled": 261600, "num_env_steps_trained": 261600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.41322404680386, "num_env_steps_trained_throughput_per_sec": 422.41322404680386, "timesteps_total": 261600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 261600, "timers": {"training_iteration_time_ms": 8485.526, "sample_time_ms": 8388.125, "load_time_ms": 1.516, "load_throughput": 2375329.474, "learn_time_ms": 95.035, "learn_throughput": 37880.703, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 261600, "num_env_steps_trained": 261600, "num_agent_steps_sampled": 261600, "num_agent_steps_trained": 261600}, "done": false, "episodes_total": 945, "training_iteration": 203, "trial_id": "5f82d_00000", "date": "2023-07-26_23-36-28", "timestamp": 1690403788, "time_this_iter_s": 17.047700881958008, "time_total_s": 2331.675986766815, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 303.8460326194763, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.854166666666668, "ram_util_percent": 67.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1539.296367100307, "policy_loss": -3.9139457870975913e+18, "vf_loss": 308626004.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2044.5, "diff_num_grad_updates_vs_sampler_policy": 2043.5}}, "num_env_steps_sampled": 268800, "num_env_steps_trained": 268800, "num_agent_steps_sampled": 268800, "num_agent_steps_trained": 268800}, "sampler_results": {"episode_reward_max": -113331.39617506192, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114225.38414272507, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9143481612006962, "mean_inference_ms": 0.37654111264263473, "mean_action_processing_ms": 0.09207112759942573, "mean_env_wait_ms": 1.0750829603655188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004836030908533045, "StateBufferConnector_ms": 0.002769521764806799, "ViewRequirementAgentConnector_ms": 0.07054225818530933}}, "episode_reward_max": -113331.39617506192, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114225.38414272507, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9143481612006962, "mean_inference_ms": 0.37654111264263473, "mean_action_processing_ms": 0.09207112759942573, "mean_env_wait_ms": 1.0750829603655188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004836030908533045, "StateBufferConnector_ms": 0.002769521764806799, "ViewRequirementAgentConnector_ms": 0.07054225818530933}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268800, "num_agent_steps_trained": 268800, "num_env_steps_sampled": 268800, "num_env_steps_trained": 268800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 428.2138693616117, "num_env_steps_trained_throughput_per_sec": 428.2138693616117, "timesteps_total": 268800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 268800, "timers": {"training_iteration_time_ms": 8491.394, "sample_time_ms": 8394.082, "load_time_ms": 1.539, "load_throughput": 2338903.684, "learn_time_ms": 94.924, "learn_throughput": 37925.211, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 268800, "num_env_steps_trained": 268800, "num_agent_steps_sampled": 268800, "num_agent_steps_trained": 268800}, "done": false, "episodes_total": 947, "training_iteration": 204, "trial_id": "5f82d_00000", "date": "2023-07-26_23-36-45", "timestamp": 1690403805, "time_this_iter_s": 16.816753149032593, "time_total_s": 2348.492739915848, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 320.6627857685089, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.9375, "ram_util_percent": 67.02083333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1541.0589512416295, "policy_loss": -4.874839927153192e+18, "vf_loss": 310084183.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2156.5, "diff_num_grad_updates_vs_sampler_policy": 2155.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": -113331.39617506192, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114236.20185966407, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9139086571493297, "mean_inference_ms": 0.3761672590914449, "mean_action_processing_ms": 0.09200618980752008, "mean_env_wait_ms": 1.0708002990704621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004756756317921174, "StateBufferConnector_ms": 0.0027650441878881208, "ViewRequirementAgentConnector_ms": 0.07021304888603015}}, "episode_reward_max": -113331.39617506192, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114236.20185966407, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9139086571493297, "mean_inference_ms": 0.3761672590914449, "mean_action_processing_ms": 0.09200618980752008, "mean_env_wait_ms": 1.0708002990704621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004756756317921174, "StateBufferConnector_ms": 0.0027650441878881208, "ViewRequirementAgentConnector_ms": 0.07021304888603015}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.3822719463131, "num_env_steps_trained_throughput_per_sec": 421.3822719463131, "timesteps_total": 276000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 8494.372, "sample_time_ms": 8397.525, "load_time_ms": 1.533, "load_throughput": 2347959.757, "learn_time_ms": 94.469, "learn_throughput": 38107.922, "synch_weights_time_ms": 0.785}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 949, "training_iteration": 205, "trial_id": "5f82d_00000", "date": "2023-07-26_23-37-02", "timestamp": 1690403822, "time_this_iter_s": 17.089241981506348, "time_total_s": 2365.581981897354, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 337.75202775001526, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.108333333333334, "ram_util_percent": 66.89166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1541.256635393415, "policy_loss": -4.790628011176638e+18, "vf_loss": 305702935.9285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2268.5, "diff_num_grad_updates_vs_sampler_policy": 2267.5}}, "num_env_steps_sampled": 283200, "num_env_steps_trained": 283200, "num_agent_steps_sampled": 283200, "num_agent_steps_trained": 283200}, "sampler_results": {"episode_reward_max": -113235.91275171384, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114198.72301325721, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.913523328682188, "mean_inference_ms": 0.37581510451319144, "mean_action_processing_ms": 0.09194462430690506, "mean_env_wait_ms": 1.0668572807839958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004685215833710461, "StateBufferConnector_ms": 0.002752280816799257, "ViewRequirementAgentConnector_ms": 0.0699543371433165}}, "episode_reward_max": -113235.91275171384, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114198.72301325721, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.913523328682188, "mean_inference_ms": 0.37581510451319144, "mean_action_processing_ms": 0.09194462430690506, "mean_env_wait_ms": 1.0668572807839958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004685215833710461, "StateBufferConnector_ms": 0.002752280816799257, "ViewRequirementAgentConnector_ms": 0.0699543371433165}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283200, "num_agent_steps_trained": 283200, "num_env_steps_sampled": 283200, "num_env_steps_trained": 283200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.2856019867441, "num_env_steps_trained_throughput_per_sec": 422.2856019867441, "timesteps_total": 283200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 283200, "timers": {"training_iteration_time_ms": 8487.846, "sample_time_ms": 8391.446, "load_time_ms": 1.555, "load_throughput": 2315305.201, "learn_time_ms": 93.993, "learn_throughput": 38300.862, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 283200, "num_env_steps_trained": 283200, "num_agent_steps_sampled": 283200, "num_agent_steps_trained": 283200}, "done": false, "episodes_total": 951, "training_iteration": 206, "trial_id": "5f82d_00000", "date": "2023-07-26_23-37-19", "timestamp": 1690403839, "time_this_iter_s": 17.05279803276062, "time_total_s": 2382.6347799301147, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 354.8048257827759, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.433333333333334, "ram_util_percent": 67.01666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1541.3772909981865, "policy_loss": -5.154434710976781e+18, "vf_loss": 313971340.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2380.5, "diff_num_grad_updates_vs_sampler_policy": 2379.5}}, "num_env_steps_sampled": 290400, "num_env_steps_trained": 290400, "num_agent_steps_sampled": 290400, "num_agent_steps_trained": 290400}, "sampler_results": {"episode_reward_max": -113235.91275171384, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114204.81048531976, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9131567486821096, "mean_inference_ms": 0.375486347809511, "mean_action_processing_ms": 0.09188649607683645, "mean_env_wait_ms": 1.0632311987604741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00462365704913472, "StateBufferConnector_ms": 0.002742368121479833, "ViewRequirementAgentConnector_ms": 0.0697640485541765}}, "episode_reward_max": -113235.91275171384, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114204.81048531976, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9131567486821096, "mean_inference_ms": 0.375486347809511, "mean_action_processing_ms": 0.09188649607683645, "mean_env_wait_ms": 1.0632311987604741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00462365704913472, "StateBufferConnector_ms": 0.002742368121479833, "ViewRequirementAgentConnector_ms": 0.0697640485541765}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 290400, "num_agent_steps_trained": 290400, "num_env_steps_sampled": 290400, "num_env_steps_trained": 290400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.695310318436, "num_env_steps_trained_throughput_per_sec": 422.695310318436, "timesteps_total": 290400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 290400, "timers": {"training_iteration_time_ms": 8502.902, "sample_time_ms": 8406.465, "load_time_ms": 1.54, "load_throughput": 2337708.721, "learn_time_ms": 94.051, "learn_throughput": 38277.045, "synch_weights_time_ms": 0.785}, "counters": {"num_env_steps_sampled": 290400, "num_env_steps_trained": 290400, "num_agent_steps_sampled": 290400, "num_agent_steps_trained": 290400}, "done": false, "episodes_total": 953, "training_iteration": 207, "trial_id": "5f82d_00000", "date": "2023-07-26_23-37-36", "timestamp": 1690403856, "time_this_iter_s": 17.036311864852905, "time_total_s": 2399.6710917949677, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 371.8411376476288, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.787499999999998, "ram_util_percent": 67.01666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1541.6115417480469, "policy_loss": -6.477897623598905e+18, "vf_loss": 315760975.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2492.5, "diff_num_grad_updates_vs_sampler_policy": 2491.5}}, "num_env_steps_sampled": 297600, "num_env_steps_trained": 297600, "num_agent_steps_sampled": 297600, "num_agent_steps_trained": 297600}, "sampler_results": {"episode_reward_max": -113235.91275171384, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114216.5753381023, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9128386784374006, "mean_inference_ms": 0.3751770779666447, "mean_action_processing_ms": 0.0918314019136762, "mean_env_wait_ms": 1.0599216179676854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045680999755859375, "StateBufferConnector_ms": 0.0027280383639865452, "ViewRequirementAgentConnector_ms": 0.06950113508436415}}, "episode_reward_max": -113235.91275171384, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114216.5753381023, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9128386784374006, "mean_inference_ms": 0.3751770779666447, "mean_action_processing_ms": 0.0918314019136762, "mean_env_wait_ms": 1.0599216179676854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045680999755859375, "StateBufferConnector_ms": 0.0027280383639865452, "ViewRequirementAgentConnector_ms": 0.06950113508436415}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 297600, "num_agent_steps_trained": 297600, "num_env_steps_sampled": 297600, "num_env_steps_trained": 297600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 416.6215375935443, "num_env_steps_trained_throughput_per_sec": 416.6215375935443, "timesteps_total": 297600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 297600, "timers": {"training_iteration_time_ms": 8526.596, "sample_time_ms": 8429.727, "load_time_ms": 1.518, "load_throughput": 2371114.524, "learn_time_ms": 94.494, "learn_throughput": 38097.778, "synch_weights_time_ms": 0.799}, "counters": {"num_env_steps_sampled": 297600, "num_env_steps_trained": 297600, "num_agent_steps_sampled": 297600, "num_agent_steps_trained": 297600}, "done": false, "episodes_total": 955, "training_iteration": 208, "trial_id": "5f82d_00000", "date": "2023-07-26_23-37-54", "timestamp": 1690403874, "time_this_iter_s": 17.284538984298706, "time_total_s": 2416.9556307792664, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 389.1256766319275, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.587999999999997, "ram_util_percent": 66.956}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1541.8333805629186, "policy_loss": -5.299161714284635e+18, "vf_loss": 308365198.35714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2604.5, "diff_num_grad_updates_vs_sampler_policy": 2603.5}}, "num_env_steps_sampled": 304800, "num_env_steps_trained": 304800, "num_agent_steps_sampled": 304800, "num_agent_steps_trained": 304800}, "sampler_results": {"episode_reward_max": -113235.91275171384, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114188.73321280156, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9125406288626245, "mean_inference_ms": 0.37488553119350737, "mean_action_processing_ms": 0.09177916264432921, "mean_env_wait_ms": 1.0568406109712898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004512705701462766, "StateBufferConnector_ms": 0.002718479075330369, "ViewRequirementAgentConnector_ms": 0.06930473002981632}}, "episode_reward_max": -113235.91275171384, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114188.73321280156, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9125406288626245, "mean_inference_ms": 0.37488553119350737, "mean_action_processing_ms": 0.09177916264432921, "mean_env_wait_ms": 1.0568406109712898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004512705701462766, "StateBufferConnector_ms": 0.002718479075330369, "ViewRequirementAgentConnector_ms": 0.06930473002981632}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304800, "num_agent_steps_trained": 304800, "num_env_steps_sampled": 304800, "num_env_steps_trained": 304800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.47135184883126, "num_env_steps_trained_throughput_per_sec": 423.47135184883126, "timesteps_total": 304800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 304800, "timers": {"training_iteration_time_ms": 8545.427, "sample_time_ms": 8448.611, "load_time_ms": 1.474, "load_throughput": 2441703.493, "learn_time_ms": 94.489, "learn_throughput": 38099.874, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 304800, "num_env_steps_trained": 304800, "num_agent_steps_sampled": 304800, "num_agent_steps_trained": 304800}, "done": false, "episodes_total": 957, "training_iteration": 209, "trial_id": "5f82d_00000", "date": "2023-07-26_23-38-11", "timestamp": 1690403891, "time_this_iter_s": 17.00514578819275, "time_total_s": 2433.960776567459, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 406.13082242012024, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 19.175, "ram_util_percent": 66.98333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1542.1353541782923, "policy_loss": -5.205275104662445e+18, "vf_loss": 310828888.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2716.5, "diff_num_grad_updates_vs_sampler_policy": 2715.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": -113235.91275171384, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114192.1389898398, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9122601826618887, "mean_inference_ms": 0.37460814289710426, "mean_action_processing_ms": 0.09172942372784369, "mean_env_wait_ms": 1.053988542091337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004469618505361129, "StateBufferConnector_ms": 0.002707267294124681, "ViewRequirementAgentConnector_ms": 0.06913992823386679}}, "episode_reward_max": -113235.91275171384, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114192.1389898398, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9122601826618887, "mean_inference_ms": 0.37460814289710426, "mean_action_processing_ms": 0.09172942372784369, "mean_env_wait_ms": 1.053988542091337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004469618505361129, "StateBufferConnector_ms": 0.002707267294124681, "ViewRequirementAgentConnector_ms": 0.06913992823386679}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.15579926757994, "num_env_steps_trained_throughput_per_sec": 421.15579926757994, "timesteps_total": 312000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 8546.346, "sample_time_ms": 8449.762, "load_time_ms": 1.486, "load_throughput": 2422003.176, "learn_time_ms": 94.248, "learn_throughput": 38197.18, "synch_weights_time_ms": 0.791}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 959, "training_iteration": 210, "trial_id": "5f82d_00000", "date": "2023-07-26_23-38-28", "timestamp": 1690403908, "time_this_iter_s": 17.098446130752563, "time_total_s": 2451.0592226982117, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 423.2292685508728, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.6375, "ram_util_percent": 67.01666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1542.3169468470983, "policy_loss": -5.900036362761958e+18, "vf_loss": 311496353.14285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2828.5, "diff_num_grad_updates_vs_sampler_policy": 2827.5}}, "num_env_steps_sampled": 319200, "num_env_steps_trained": 319200, "num_agent_steps_sampled": 319200, "num_agent_steps_trained": 319200}, "sampler_results": {"episode_reward_max": -113093.20073918099, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114174.00383801384, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9120154801650847, "mean_inference_ms": 0.3743459808193273, "mean_action_processing_ms": 0.09168237154661077, "mean_env_wait_ms": 1.0513026793914082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004426170797909007, "StateBufferConnector_ms": 0.002699739792767693, "ViewRequirementAgentConnector_ms": 0.06899459689271216}}, "episode_reward_max": -113093.20073918099, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114174.00383801384, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9120154801650847, "mean_inference_ms": 0.3743459808193273, "mean_action_processing_ms": 0.09168237154661077, "mean_env_wait_ms": 1.0513026793914082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004426170797909007, "StateBufferConnector_ms": 0.002699739792767693, "ViewRequirementAgentConnector_ms": 0.06899459689271216}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 319200, "num_agent_steps_trained": 319200, "num_env_steps_sampled": 319200, "num_env_steps_trained": 319200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.04273844117483, "num_env_steps_trained_throughput_per_sec": 423.04273844117483, "timesteps_total": 319200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 319200, "timers": {"training_iteration_time_ms": 8543.295, "sample_time_ms": 8446.864, "load_time_ms": 1.45, "load_throughput": 2483510.321, "learn_time_ms": 94.134, "learn_throughput": 38243.366, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 319200, "num_env_steps_trained": 319200, "num_agent_steps_sampled": 319200, "num_agent_steps_trained": 319200}, "done": false, "episodes_total": 961, "training_iteration": 211, "trial_id": "5f82d_00000", "date": "2023-07-26_23-38-45", "timestamp": 1690403925, "time_this_iter_s": 17.022308826446533, "time_total_s": 2468.081531524658, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 440.25157737731934, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 18.7375, "ram_util_percent": 66.94583333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1542.6447339739118, "policy_loss": -4.754650019537214e+18, "vf_loss": 304603320.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2940.5, "diff_num_grad_updates_vs_sampler_policy": 2939.5}}, "num_env_steps_sampled": 326400, "num_env_steps_trained": 326400, "num_agent_steps_sampled": 326400, "num_agent_steps_trained": 326400}, "sampler_results": {"episode_reward_max": -113038.12673235995, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114156.5517368002, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9117819902802816, "mean_inference_ms": 0.37409815419129705, "mean_action_processing_ms": 0.09163791655094389, "mean_env_wait_ms": 1.0487690687973008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004381053852585127, "StateBufferConnector_ms": 0.002693680097471993, "ViewRequirementAgentConnector_ms": 0.06887777796331442}}, "episode_reward_max": -113038.12673235995, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114156.5517368002, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9117819902802816, "mean_inference_ms": 0.37409815419129705, "mean_action_processing_ms": 0.09163791655094389, "mean_env_wait_ms": 1.0487690687973008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004381053852585127, "StateBufferConnector_ms": 0.002693680097471993, "ViewRequirementAgentConnector_ms": 0.06887777796331442}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 326400, "num_agent_steps_trained": 326400, "num_env_steps_sampled": 326400, "num_env_steps_trained": 326400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 425.2237068408479, "num_env_steps_trained_throughput_per_sec": 425.2237068408479, "timesteps_total": 326400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 326400, "timers": {"training_iteration_time_ms": 8533.167, "sample_time_ms": 8436.539, "load_time_ms": 1.447, "load_throughput": 2487110.145, "learn_time_ms": 94.338, "learn_throughput": 38160.574, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 326400, "num_env_steps_trained": 326400, "num_agent_steps_sampled": 326400, "num_agent_steps_trained": 326400}, "done": false, "episodes_total": 963, "training_iteration": 212, "trial_id": "5f82d_00000", "date": "2023-07-26_23-39-02", "timestamp": 1690403942, "time_this_iter_s": 16.934900999069214, "time_total_s": 2485.0164325237274, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 457.18647837638855, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 18.566666666666666, "ram_util_percent": 66.85833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1543.2967529296875, "policy_loss": -6.131226797790109e+18, "vf_loss": 310970081.21428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3052.5, "diff_num_grad_updates_vs_sampler_policy": 3051.5}}, "num_env_steps_sampled": 333600, "num_env_steps_trained": 333600, "num_agent_steps_sampled": 333600, "num_agent_steps_trained": 333600}, "sampler_results": {"episode_reward_max": -113038.12673235995, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114165.4588843919, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9115475468616568, "mean_inference_ms": 0.3738628470042235, "mean_action_processing_ms": 0.09159571449563507, "mean_env_wait_ms": 1.0464062354683767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043530897660688924, "StateBufferConnector_ms": 0.002693696455522017, "ViewRequirementAgentConnector_ms": 0.06888172843239525}}, "episode_reward_max": -113038.12673235995, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114165.4588843919, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9115475468616568, "mean_inference_ms": 0.3738628470042235, "mean_action_processing_ms": 0.09159571449563507, "mean_env_wait_ms": 1.0464062354683767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043530897660688924, "StateBufferConnector_ms": 0.002693696455522017, "ViewRequirementAgentConnector_ms": 0.06888172843239525}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 333600, "num_agent_steps_trained": 333600, "num_env_steps_sampled": 333600, "num_env_steps_trained": 333600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.68203418313277, "num_env_steps_trained_throughput_per_sec": 422.68203418313277, "timesteps_total": 333600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 333600, "timers": {"training_iteration_time_ms": 8508.388, "sample_time_ms": 8412.592, "load_time_ms": 1.483, "load_throughput": 2427064.183, "learn_time_ms": 93.468, "learn_throughput": 38515.955, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 333600, "num_env_steps_trained": 333600, "num_agent_steps_sampled": 333600, "num_agent_steps_trained": 333600}, "done": false, "episodes_total": 965, "training_iteration": 213, "trial_id": "5f82d_00000", "date": "2023-07-26_23-39-19", "timestamp": 1690403959, "time_this_iter_s": 17.036859273910522, "time_total_s": 2502.053291797638, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 474.2233376502991, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 19.495833333333334, "ram_util_percent": 66.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1543.39329964774, "policy_loss": -6.133838863351826e+18, "vf_loss": 308987187.9285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3164.5, "diff_num_grad_updates_vs_sampler_policy": 3163.5}}, "num_env_steps_sampled": 340800, "num_env_steps_trained": 340800, "num_agent_steps_sampled": 340800, "num_agent_steps_trained": 340800}, "sampler_results": {"episode_reward_max": -113038.12673235995, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114159.81498369137, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9113363604942613, "mean_inference_ms": 0.3736385891696543, "mean_action_processing_ms": 0.09155561661233212, "mean_env_wait_ms": 1.044166307289727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004317467672783032, "StateBufferConnector_ms": 0.002689110605340255, "ViewRequirementAgentConnector_ms": 0.06875782682184588}}, "episode_reward_max": -113038.12673235995, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114159.81498369137, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9113363604942613, "mean_inference_ms": 0.3736385891696543, "mean_action_processing_ms": 0.09155561661233212, "mean_env_wait_ms": 1.044166307289727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004317467672783032, "StateBufferConnector_ms": 0.002689110605340255, "ViewRequirementAgentConnector_ms": 0.06875782682184588}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340800, "num_agent_steps_trained": 340800, "num_env_steps_sampled": 340800, "num_env_steps_trained": 340800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.80096517586645, "num_env_steps_trained_throughput_per_sec": 423.80096517586645, "timesteps_total": 340800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 340800, "timers": {"training_iteration_time_ms": 8507.066, "sample_time_ms": 8410.941, "load_time_ms": 1.524, "load_throughput": 2362211.855, "learn_time_ms": 93.758, "learn_throughput": 38396.69, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 340800, "num_env_steps_trained": 340800, "num_agent_steps_sampled": 340800, "num_agent_steps_trained": 340800}, "done": false, "episodes_total": 967, "training_iteration": 214, "trial_id": "5f82d_00000", "date": "2023-07-26_23-39-36", "timestamp": 1690403976, "time_this_iter_s": 16.991903066635132, "time_total_s": 2519.045194864273, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 491.2152407169342, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.591666666666665, "ram_util_percent": 66.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1543.631360735212, "policy_loss": -6.401951545508009e+18, "vf_loss": 307274746.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3276.5, "diff_num_grad_updates_vs_sampler_policy": 3275.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114130.02850754601, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9111474298436901, "mean_inference_ms": 0.3734265162576766, "mean_action_processing_ms": 0.09151751415920835, "mean_env_wait_ms": 1.0420505477210837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004286685232388772, "StateBufferConnector_ms": 0.002681198766676046, "ViewRequirementAgentConnector_ms": 0.06867626966056177}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114130.02850754601, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9111474298436901, "mean_inference_ms": 0.3734265162576766, "mean_action_processing_ms": 0.09151751415920835, "mean_env_wait_ms": 1.0420505477210837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004286685232388772, "StateBufferConnector_ms": 0.002681198766676046, "ViewRequirementAgentConnector_ms": 0.06867626966056177}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.5044536437538, "num_env_steps_trained_throughput_per_sec": 421.5044536437538, "timesteps_total": 348000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 8505.652, "sample_time_ms": 8409.295, "load_time_ms": 1.549, "load_throughput": 2324393.775, "learn_time_ms": 93.953, "learn_throughput": 38316.909, "synch_weights_time_ms": 0.797}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 969, "training_iteration": 215, "trial_id": "5f82d_00000", "date": "2023-07-26_23-39-53", "timestamp": 1690403993, "time_this_iter_s": 17.084551095962524, "time_total_s": 2536.1297459602356, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 508.29979181289673, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 18.464, "ram_util_percent": 66.82400000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1543.8378230503627, "policy_loss": -5.709581745477098e+18, "vf_loss": 307075539.78571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3388.5, "diff_num_grad_updates_vs_sampler_policy": 3387.5}}, "num_env_steps_sampled": 355200, "num_env_steps_trained": 355200, "num_agent_steps_sampled": 355200, "num_agent_steps_trained": 355200}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114126.24492096838, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9109704826858465, "mean_inference_ms": 0.3732237306670158, "mean_action_processing_ms": 0.09148121400844654, "mean_env_wait_ms": 1.0400456784497023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004254403661509029, "StateBufferConnector_ms": 0.0026851403908651384, "ViewRequirementAgentConnector_ms": 0.06865126187684106}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114126.24492096838, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9109704826858465, "mean_inference_ms": 0.3732237306670158, "mean_action_processing_ms": 0.09148121400844654, "mean_env_wait_ms": 1.0400456784497023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004254403661509029, "StateBufferConnector_ms": 0.0026851403908651384, "ViewRequirementAgentConnector_ms": 0.06865126187684106}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 355200, "num_agent_steps_trained": 355200, "num_env_steps_sampled": 355200, "num_env_steps_trained": 355200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.3717914528579, "num_env_steps_trained_throughput_per_sec": 423.3717914528579, "timesteps_total": 355200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 355200, "timers": {"training_iteration_time_ms": 8504.329, "sample_time_ms": 8406.566, "load_time_ms": 1.589, "load_throughput": 2265320.591, "learn_time_ms": 95.321, "learn_throughput": 37766.968, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 355200, "num_env_steps_trained": 355200, "num_agent_steps_sampled": 355200, "num_agent_steps_trained": 355200}, "done": false, "episodes_total": 971, "training_iteration": 216, "trial_id": "5f82d_00000", "date": "2023-07-26_23-40-10", "timestamp": 1690404010, "time_this_iter_s": 17.008962869644165, "time_total_s": 2553.1387088298798, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 525.3087546825409, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 19.5375, "ram_util_percent": 66.94166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1544.0439714704241, "policy_loss": -6.605338570205505e+18, "vf_loss": 309151318.35714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3500.5, "diff_num_grad_updates_vs_sampler_policy": 3499.5}}, "num_env_steps_sampled": 362400, "num_env_steps_trained": 362400, "num_agent_steps_sampled": 362400, "num_agent_steps_trained": 362400}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114120.15108246068, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9108080425953328, "mean_inference_ms": 0.37302964997650406, "mean_action_processing_ms": 0.09144656705617756, "mean_env_wait_ms": 1.0381384375820009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004227956136067708, "StateBufferConnector_ms": 0.0026858042156885542, "ViewRequirementAgentConnector_ms": 0.06858507792154948}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114120.15108246068, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9108080425953328, "mean_inference_ms": 0.37302964997650406, "mean_action_processing_ms": 0.09144656705617756, "mean_env_wait_ms": 1.0381384375820009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004227956136067708, "StateBufferConnector_ms": 0.0026858042156885542, "ViewRequirementAgentConnector_ms": 0.06858507792154948}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 362400, "num_agent_steps_trained": 362400, "num_env_steps_sampled": 362400, "num_env_steps_trained": 362400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.7301368269023, "num_env_steps_trained_throughput_per_sec": 423.7301368269023, "timesteps_total": 362400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 362400, "timers": {"training_iteration_time_ms": 8510.297, "sample_time_ms": 8412.591, "load_time_ms": 1.544, "load_throughput": 2331212.178, "learn_time_ms": 95.305, "learn_throughput": 37773.411, "synch_weights_time_ms": 0.797}, "counters": {"num_env_steps_sampled": 362400, "num_env_steps_trained": 362400, "num_agent_steps_sampled": 362400, "num_agent_steps_trained": 362400}, "done": false, "episodes_total": 973, "training_iteration": 217, "trial_id": "5f82d_00000", "date": "2023-07-26_23-40-27", "timestamp": 1690404027, "time_this_iter_s": 16.994812726974487, "time_total_s": 2570.1335215568542, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 542.3035674095154, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 18.245833333333334, "ram_util_percent": 67.00833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1544.3189762660436, "policy_loss": -7.211973551455207e+18, "vf_loss": 314223553.5714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3612.5, "diff_num_grad_updates_vs_sampler_policy": 3611.5}}, "num_env_steps_sampled": 369600, "num_env_steps_trained": 369600, "num_agent_steps_sampled": 369600, "num_agent_steps_trained": 369600}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114133.99880329864, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.910650918268499, "mean_inference_ms": 0.372845208371064, "mean_action_processing_ms": 0.09141362775567041, "mean_env_wait_ms": 1.0363523006132025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004201668959397536, "StateBufferConnector_ms": 0.0026779908400315503, "ViewRequirementAgentConnector_ms": 0.06847601670485276}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114133.99880329864, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.910650918268499, "mean_inference_ms": 0.372845208371064, "mean_action_processing_ms": 0.09141362775567041, "mean_env_wait_ms": 1.0363523006132025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004201668959397536, "StateBufferConnector_ms": 0.0026779908400315503, "ViewRequirementAgentConnector_ms": 0.06847601670485276}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 369600, "num_agent_steps_trained": 369600, "num_env_steps_sampled": 369600, "num_env_steps_trained": 369600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.03442410906206, "num_env_steps_trained_throughput_per_sec": 419.03442410906206, "timesteps_total": 369600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 369600, "timers": {"training_iteration_time_ms": 8525.124, "sample_time_ms": 8426.876, "load_time_ms": 1.55, "load_throughput": 2323034.877, "learn_time_ms": 95.848, "learn_throughput": 37559.38, "synch_weights_time_ms": 0.791}, "counters": {"num_env_steps_sampled": 369600, "num_env_steps_trained": 369600, "num_agent_steps_sampled": 369600, "num_agent_steps_trained": 369600}, "done": false, "episodes_total": 975, "training_iteration": 218, "trial_id": "5f82d_00000", "date": "2023-07-26_23-40-44", "timestamp": 1690404044, "time_this_iter_s": 17.18513011932373, "time_total_s": 2587.318651676178, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 559.4886975288391, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 18.845833333333335, "ram_util_percent": 66.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1544.9905678885323, "policy_loss": -7.404196028945644e+18, "vf_loss": 312957641.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3724.5, "diff_num_grad_updates_vs_sampler_policy": 3723.5}}, "num_env_steps_sampled": 376800, "num_env_steps_trained": 376800, "num_agent_steps_sampled": 376800, "num_agent_steps_trained": 376800}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114147.1538961944, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9105070315890661, "mean_inference_ms": 0.3726687525347679, "mean_action_processing_ms": 0.09138219078553067, "mean_env_wait_ms": 1.0346711145414165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004181577198540986, "StateBufferConnector_ms": 0.002678828452950093, "ViewRequirementAgentConnector_ms": 0.06842292956451872}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114147.1538961944, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9105070315890661, "mean_inference_ms": 0.3726687525347679, "mean_action_processing_ms": 0.09138219078553067, "mean_env_wait_ms": 1.0346711145414165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004181577198540986, "StateBufferConnector_ms": 0.002678828452950093, "ViewRequirementAgentConnector_ms": 0.06842292956451872}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376800, "num_agent_steps_trained": 376800, "num_env_steps_sampled": 376800, "num_env_steps_trained": 376800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 418.6486782555274, "num_env_steps_trained_throughput_per_sec": 418.6486782555274, "timesteps_total": 376800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 376800, "timers": {"training_iteration_time_ms": 8546.033, "sample_time_ms": 8447.654, "load_time_ms": 1.489, "load_throughput": 2417775.956, "learn_time_ms": 96.047, "learn_throughput": 37481.595, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 376800, "num_env_steps_trained": 376800, "num_agent_steps_sampled": 376800, "num_agent_steps_trained": 376800}, "done": false, "episodes_total": 977, "training_iteration": 219, "trial_id": "5f82d_00000", "date": "2023-07-26_23-41-01", "timestamp": 1690404061, "time_this_iter_s": 17.2011079788208, "time_total_s": 2604.519759654999, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 576.6898055076599, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 19.256, "ram_util_percent": 66.804}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1545.6638728550502, "policy_loss": -6.867338666508463e+18, "vf_loss": 308183210.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3836.5, "diff_num_grad_updates_vs_sampler_policy": 3835.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114152.5861634287, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.910371817855567, "mean_inference_ms": 0.3724998644773428, "mean_action_processing_ms": 0.09135208364436186, "mean_env_wait_ms": 1.0330909365992205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004157467164855072, "StateBufferConnector_ms": 0.0026720157568005548, "ViewRequirementAgentConnector_ms": 0.06833525671475175}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114152.5861634287, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.910371817855567, "mean_inference_ms": 0.3724998644773428, "mean_action_processing_ms": 0.09135208364436186, "mean_env_wait_ms": 1.0330909365992205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004157467164855072, "StateBufferConnector_ms": 0.0026720157568005548, "ViewRequirementAgentConnector_ms": 0.06833525671475175}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 418.2471961091737, "num_env_steps_trained_throughput_per_sec": 418.2471961091737, "timesteps_total": 384000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 8559.336, "sample_time_ms": 8460.97, "load_time_ms": 1.502, "load_throughput": 2396821.232, "learn_time_ms": 96.029, "learn_throughput": 37488.705, "synch_weights_time_ms": 0.776}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 979, "training_iteration": 220, "trial_id": "5f82d_00000", "date": "2023-07-26_23-41-19", "timestamp": 1690404079, "time_this_iter_s": 17.217469930648804, "time_total_s": 2621.7372295856476, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 593.9072754383087, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 19.154166666666665, "ram_util_percent": 66.88333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1545.9417506626673, "policy_loss": -6.801994490396541e+18, "vf_loss": 308476397.4285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3948.5, "diff_num_grad_updates_vs_sampler_policy": 3947.5}}, "num_env_steps_sampled": 391200, "num_env_steps_trained": 391200, "num_agent_steps_sampled": 391200, "num_agent_steps_trained": 391200}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114148.91846251373, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9102497214158757, "mean_inference_ms": 0.37233855548181743, "mean_action_processing_ms": 0.09132323894765033, "mean_env_wait_ms": 1.0315657627000763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004134715442926111, "StateBufferConnector_ms": 0.002666258476149868, "ViewRequirementAgentConnector_ms": 0.06823606894049845}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114148.91846251373, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9102497214158757, "mean_inference_ms": 0.37233855548181743, "mean_action_processing_ms": 0.09132323894765033, "mean_env_wait_ms": 1.0315657627000763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004134715442926111, "StateBufferConnector_ms": 0.002666258476149868, "ViewRequirementAgentConnector_ms": 0.06823606894049845}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 391200, "num_agent_steps_trained": 391200, "num_env_steps_sampled": 391200, "num_env_steps_trained": 391200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 425.33465944538784, "num_env_steps_trained_throughput_per_sec": 425.33465944538784, "timesteps_total": 391200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 391200, "timers": {"training_iteration_time_ms": 8551.488, "sample_time_ms": 8453.848, "load_time_ms": 1.474, "load_throughput": 2442374.909, "learn_time_ms": 95.334, "learn_throughput": 37762.047, "synch_weights_time_ms": 0.772}, "counters": {"num_env_steps_sampled": 391200, "num_env_steps_trained": 391200, "num_agent_steps_sampled": 391200, "num_agent_steps_trained": 391200}, "done": false, "episodes_total": 981, "training_iteration": 221, "trial_id": "5f82d_00000", "date": "2023-07-26_23-41-36", "timestamp": 1690404096, "time_this_iter_s": 16.930625200271606, "time_total_s": 2638.667854785919, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 610.8379006385803, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 19.095833333333335, "ram_util_percent": 66.48333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1546.1367797851562, "policy_loss": -7.129285166135559e+18, "vf_loss": 307745383.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4060.5, "diff_num_grad_updates_vs_sampler_policy": 4059.5}}, "num_env_steps_sampled": 398400, "num_env_steps_trained": 398400, "num_agent_steps_sampled": 398400, "num_agent_steps_trained": 398400}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114138.3604473543, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9101343576171594, "mean_inference_ms": 0.3721827743851471, "mean_action_processing_ms": 0.09129562021577813, "mean_env_wait_ms": 1.0301091733432475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004113536991485178, "StateBufferConnector_ms": 0.0026604900621388055, "ViewRequirementAgentConnector_ms": 0.06812141366200904}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114138.3604473543, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9101343576171594, "mean_inference_ms": 0.3721827743851471, "mean_action_processing_ms": 0.09129562021577813, "mean_env_wait_ms": 1.0301091733432475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004113536991485178, "StateBufferConnector_ms": 0.0026604900621388055, "ViewRequirementAgentConnector_ms": 0.06812141366200904}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 398400, "num_agent_steps_trained": 398400, "num_env_steps_sampled": 398400, "num_env_steps_trained": 398400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.97407681556075, "num_env_steps_trained_throughput_per_sec": 422.97407681556075, "timesteps_total": 398400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 398400, "timers": {"training_iteration_time_ms": 8554.526, "sample_time_ms": 8456.839, "load_time_ms": 1.48, "load_throughput": 2432263.918, "learn_time_ms": 95.363, "learn_throughput": 37750.576, "synch_weights_time_ms": 0.783}, "counters": {"num_env_steps_sampled": 398400, "num_env_steps_trained": 398400, "num_agent_steps_sampled": 398400, "num_agent_steps_trained": 398400}, "done": false, "episodes_total": 983, "training_iteration": 222, "trial_id": "5f82d_00000", "date": "2023-07-26_23-41-53", "timestamp": 1690404113, "time_this_iter_s": 17.025091886520386, "time_total_s": 2655.6929466724396, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 627.8629925251007, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 18.429166666666664, "ram_util_percent": 66.51249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1546.8118961879186, "policy_loss": -7.589242254024275e+18, "vf_loss": 310065952.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4172.5, "diff_num_grad_updates_vs_sampler_policy": 4171.5}}, "num_env_steps_sampled": 405600, "num_env_steps_trained": 405600, "num_agent_steps_sampled": 405600, "num_agent_steps_trained": 405600}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114141.88499670615, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9100208251568724, "mean_inference_ms": 0.3720334737890484, "mean_action_processing_ms": 0.09126903635100672, "mean_env_wait_ms": 1.0287156537773183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004094441731770833, "StateBufferConnector_ms": 0.0026553471883138022, "ViewRequirementAgentConnector_ms": 0.0680379867553711}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114141.88499670615, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9100208251568724, "mean_inference_ms": 0.3720334737890484, "mean_action_processing_ms": 0.09126903635100672, "mean_env_wait_ms": 1.0287156537773183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004094441731770833, "StateBufferConnector_ms": 0.0026553471883138022, "ViewRequirementAgentConnector_ms": 0.0680379867553711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 405600, "num_agent_steps_trained": 405600, "num_env_steps_sampled": 405600, "num_env_steps_trained": 405600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.98796440381113, "num_env_steps_trained_throughput_per_sec": 423.98796440381113, "timesteps_total": 405600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 405600, "timers": {"training_iteration_time_ms": 8534.451, "sample_time_ms": 8436.54, "load_time_ms": 1.476, "load_throughput": 2438785.154, "learn_time_ms": 95.59, "learn_throughput": 37660.779, "synch_weights_time_ms": 0.785}, "counters": {"num_env_steps_sampled": 405600, "num_env_steps_trained": 405600, "num_agent_steps_sampled": 405600, "num_agent_steps_trained": 405600}, "done": false, "episodes_total": 985, "training_iteration": 223, "trial_id": "5f82d_00000", "date": "2023-07-26_23-42-10", "timestamp": 1690404130, "time_this_iter_s": 16.98440718650818, "time_total_s": 2672.6773538589478, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 644.8473997116089, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 19.787499999999998, "ram_util_percent": 66.48333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.499972222222223e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1547.746113368443, "policy_loss": -8.705525161691382e+18, "vf_loss": 312121919.14285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4284.5, "diff_num_grad_updates_vs_sampler_policy": 4283.5}}, "num_env_steps_sampled": 412800, "num_env_steps_trained": 412800, "num_agent_steps_sampled": 412800, "num_agent_steps_trained": 412800}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114151.47505960439, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9099128485927888, "mean_inference_ms": 0.3718905635720021, "mean_action_processing_ms": 0.09124354927383957, "mean_env_wait_ms": 1.0273905431375718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004073861357453581, "StateBufferConnector_ms": 0.0026597605123148335, "ViewRequirementAgentConnector_ms": 0.0679443408916523}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114151.47505960439, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9099128485927888, "mean_inference_ms": 0.3718905635720021, "mean_action_processing_ms": 0.09124354927383957, "mean_env_wait_ms": 1.0273905431375718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004073861357453581, "StateBufferConnector_ms": 0.0026597605123148335, "ViewRequirementAgentConnector_ms": 0.0679443408916523}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412800, "num_agent_steps_trained": 412800, "num_env_steps_sampled": 412800, "num_env_steps_trained": 412800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.35849902102603, "num_env_steps_trained_throughput_per_sec": 420.35849902102603, "timesteps_total": 412800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 412800, "timers": {"training_iteration_time_ms": 8527.455, "sample_time_ms": 8429.475, "load_time_ms": 1.545, "load_throughput": 2329665.566, "learn_time_ms": 95.588, "learn_throughput": 37661.653, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 412800, "num_env_steps_trained": 412800, "num_agent_steps_sampled": 412800, "num_agent_steps_trained": 412800}, "done": false, "episodes_total": 987, "training_iteration": 224, "trial_id": "5f82d_00000", "date": "2023-07-26_23-42-27", "timestamp": 1690404147, "time_this_iter_s": 17.13092017173767, "time_total_s": 2689.8082740306854, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 661.9783198833466, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.82916666666667, "ram_util_percent": 66.54166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.299972222222222e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1548.0916530064173, "policy_loss": -7.014271763239455e+18, "vf_loss": 308481923.5714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4396.5, "diff_num_grad_updates_vs_sampler_policy": 4395.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114141.53273563938, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9098087044001709, "mean_inference_ms": 0.3717541512436485, "mean_action_processing_ms": 0.09121914435896751, "mean_env_wait_ms": 1.026106895368703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040531158447265625, "StateBufferConnector_ms": 0.0026551983024500595, "ViewRequirementAgentConnector_ms": 0.0678626796867274}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114141.53273563938, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9098087044001709, "mean_inference_ms": 0.3717541512436485, "mean_action_processing_ms": 0.09121914435896751, "mean_env_wait_ms": 1.026106895368703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040531158447265625, "StateBufferConnector_ms": 0.0026551983024500595, "ViewRequirementAgentConnector_ms": 0.0678626796867274}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 426.74814682651396, "num_env_steps_trained_throughput_per_sec": 426.74814682651396, "timesteps_total": 420000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 8493.163, "sample_time_ms": 8395.096, "load_time_ms": 1.507, "load_throughput": 2388404.682, "learn_time_ms": 95.71, "learn_throughput": 37613.637, "synch_weights_time_ms": 0.791}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 989, "training_iteration": 225, "trial_id": "5f82d_00000", "date": "2023-07-26_23-42-44", "timestamp": 1690404164, "time_this_iter_s": 16.874809980392456, "time_total_s": 2706.683084011078, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 678.853129863739, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 19.283333333333335, "ram_util_percent": 66.62916666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0999722222222223e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1548.3729204450335, "policy_loss": -8.54427018310849e+18, "vf_loss": 311860862.78571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4508.5, "diff_num_grad_updates_vs_sampler_policy": 4507.5}}, "num_env_steps_sampled": 427200, "num_env_steps_trained": 427200, "num_agent_steps_sampled": 427200, "num_agent_steps_trained": 427200}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114139.78444416057, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9097057606621484, "mean_inference_ms": 0.37162198427005083, "mean_action_processing_ms": 0.0911956188437048, "mean_env_wait_ms": 1.024879993914904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004034572177463108, "StateBufferConnector_ms": 0.002652627450448495, "ViewRequirementAgentConnector_ms": 0.0677994739862136}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114139.78444416057, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9097057606621484, "mean_inference_ms": 0.37162198427005083, "mean_action_processing_ms": 0.0911956188437048, "mean_env_wait_ms": 1.024879993914904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004034572177463108, "StateBufferConnector_ms": 0.002652627450448495, "ViewRequirementAgentConnector_ms": 0.0677994739862136}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 427200, "num_agent_steps_trained": 427200, "num_env_steps_sampled": 427200, "num_env_steps_trained": 427200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.0097558000572, "num_env_steps_trained_throughput_per_sec": 423.0097558000572, "timesteps_total": 427200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 427200, "timers": {"training_iteration_time_ms": 8502.467, "sample_time_ms": 8404.517, "load_time_ms": 1.53, "load_throughput": 2352752.407, "learn_time_ms": 95.574, "learn_throughput": 37667.055, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 427200, "num_env_steps_trained": 427200, "num_agent_steps_sampled": 427200, "num_agent_steps_trained": 427200}, "done": false, "episodes_total": 991, "training_iteration": 226, "trial_id": "5f82d_00000", "date": "2023-07-26_23-43-01", "timestamp": 1690404181, "time_this_iter_s": 17.0236599445343, "time_total_s": 2723.706743955612, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 695.8767898082733, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 18.895833333333332, "ram_util_percent": 66.39583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.8999722222222225e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1548.3289555140905, "policy_loss": -9.090217335046487e+18, "vf_loss": 313172522.5714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4620.5, "diff_num_grad_updates_vs_sampler_policy": 4619.5}}, "num_env_steps_sampled": 434400, "num_env_steps_trained": 434400, "num_agent_steps_sampled": 434400, "num_agent_steps_trained": 434400}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114153.91001422066, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9096084992202101, "mean_inference_ms": 0.37149445206942006, "mean_action_processing_ms": 0.09117305889440032, "mean_env_wait_ms": 1.0237333770039472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00401749668351139, "StateBufferConnector_ms": 0.002649031489728445, "ViewRequirementAgentConnector_ms": 0.06774189960525696}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115470.34040790828, "episode_reward_mean": -114153.91001422066, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9096084992202101, "mean_inference_ms": 0.37149445206942006, "mean_action_processing_ms": 0.09117305889440032, "mean_env_wait_ms": 1.0237333770039472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00401749668351139, "StateBufferConnector_ms": 0.002649031489728445, "ViewRequirementAgentConnector_ms": 0.06774189960525696}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 434400, "num_agent_steps_trained": 434400, "num_env_steps_sampled": 434400, "num_env_steps_trained": 434400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 413.2698664587293, "num_env_steps_trained_throughput_per_sec": 413.2698664587293, "timesteps_total": 434400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 434400, "timers": {"training_iteration_time_ms": 8542.438, "sample_time_ms": 8444.629, "load_time_ms": 1.558, "load_throughput": 2310946.663, "learn_time_ms": 95.411, "learn_throughput": 37731.625, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 434400, "num_env_steps_trained": 434400, "num_agent_steps_sampled": 434400, "num_agent_steps_trained": 434400}, "done": false, "episodes_total": 993, "training_iteration": 227, "trial_id": "5f82d_00000", "date": "2023-07-26_23-43-18", "timestamp": 1690404198, "time_this_iter_s": 17.424840927124023, "time_total_s": 2741.131584882736, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 713.3016307353973, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 18.376, "ram_util_percent": 66.556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.6999722222222227e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1548.4452187674385, "policy_loss": -7.948583525159389e+18, "vf_loss": 309996392.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4732.5, "diff_num_grad_updates_vs_sampler_policy": 4731.5}}, "num_env_steps_sampled": 441600, "num_env_steps_trained": 441600, "num_agent_steps_sampled": 441600, "num_agent_steps_trained": 441600}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114169.26650084082, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9095172914304893, "mean_inference_ms": 0.3713717698401526, "mean_action_processing_ms": 0.09115138827934322, "mean_env_wait_ms": 1.0226374742278228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400234671200023, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.06767805884866153}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114169.26650084082, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9095172914304893, "mean_inference_ms": 0.3713717698401526, "mean_action_processing_ms": 0.09115138827934322, "mean_env_wait_ms": 1.0226374742278228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400234671200023, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.06767805884866153}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 441600, "num_agent_steps_trained": 441600, "num_env_steps_sampled": 441600, "num_env_steps_trained": 441600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.89413808433596, "num_env_steps_trained_throughput_per_sec": 419.89413808433596, "timesteps_total": 441600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 441600, "timers": {"training_iteration_time_ms": 8558.994, "sample_time_ms": 8460.866, "load_time_ms": 1.538, "load_throughput": 2340970.59, "learn_time_ms": 95.76, "learn_throughput": 37594.177, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 441600, "num_env_steps_trained": 441600, "num_agent_steps_sampled": 441600, "num_agent_steps_trained": 441600}, "done": false, "episodes_total": 995, "training_iteration": 228, "trial_id": "5f82d_00000", "date": "2023-07-26_23-43-35", "timestamp": 1690404215, "time_this_iter_s": 17.149990797042847, "time_total_s": 2758.281575679779, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 730.4516215324402, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 18.808333333333334, "ram_util_percent": 66.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4999722222222224e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1548.5590209960938, "policy_loss": -9.525645628895498e+18, "vf_loss": 313962657.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4844.5, "diff_num_grad_updates_vs_sampler_policy": 4843.5}}, "num_env_steps_sampled": 448800, "num_env_steps_trained": 448800, "num_agent_steps_sampled": 448800, "num_agent_steps_trained": 448800}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114168.63489685676, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9094276829011568, "mean_inference_ms": 0.3712530986394888, "mean_action_processing_ms": 0.09113043713807956, "mean_env_wait_ms": 1.0215885892447774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039895375569661455, "StateBufferConnector_ms": 0.00264288365155801, "ViewRequirementAgentConnector_ms": 0.06761934565401626}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114168.63489685676, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9094276829011568, "mean_inference_ms": 0.3712530986394888, "mean_action_processing_ms": 0.09113043713807956, "mean_env_wait_ms": 1.0215885892447774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039895375569661455, "StateBufferConnector_ms": 0.00264288365155801, "ViewRequirementAgentConnector_ms": 0.06761934565401626}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448800, "num_agent_steps_trained": 448800, "num_env_steps_sampled": 448800, "num_env_steps_trained": 448800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.68370200195596, "num_env_steps_trained_throughput_per_sec": 421.68370200195596, "timesteps_total": 448800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 448800, "timers": {"training_iteration_time_ms": 8553.612, "sample_time_ms": 8455.597, "load_time_ms": 1.481, "load_throughput": 2431558.891, "learn_time_ms": 95.693, "learn_throughput": 37620.178, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 448800, "num_env_steps_trained": 448800, "num_agent_steps_sampled": 448800, "num_agent_steps_trained": 448800}, "done": false, "episodes_total": 997, "training_iteration": 229, "trial_id": "5f82d_00000", "date": "2023-07-26_23-43-53", "timestamp": 1690404233, "time_this_iter_s": 17.077304124832153, "time_total_s": 2775.358879804611, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 747.5289256572723, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.476, "ram_util_percent": 66.528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.2999722222222225e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1548.6024584089007, "policy_loss": -8.915299327637437e+18, "vf_loss": 309766920.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4956.5, "diff_num_grad_updates_vs_sampler_policy": 4955.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114171.52552659441, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9093445546818602, "mean_inference_ms": 0.37113833769309984, "mean_action_processing_ms": 0.09111017451542137, "mean_env_wait_ms": 1.0205816454516765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003978375638468882, "StateBufferConnector_ms": 0.0026429637094561973, "ViewRequirementAgentConnector_ms": 0.06755416312914216}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114171.52552659441, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9093445546818602, "mean_inference_ms": 0.37113833769309984, "mean_action_processing_ms": 0.09111017451542137, "mean_env_wait_ms": 1.0205816454516765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003978375638468882, "StateBufferConnector_ms": 0.0026429637094561973, "ViewRequirementAgentConnector_ms": 0.06755416312914216}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.6642960186176, "num_env_steps_trained_throughput_per_sec": 420.6642960186176, "timesteps_total": 456000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 8578.013, "sample_time_ms": 8479.896, "load_time_ms": 1.472, "load_throughput": 2445222.652, "learn_time_ms": 95.804, "learn_throughput": 37576.906, "synch_weights_time_ms": 0.783}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 999, "training_iteration": 230, "trial_id": "5f82d_00000", "date": "2023-07-26_23-44-10", "timestamp": 1690404250, "time_this_iter_s": 17.119633197784424, "time_total_s": 2792.4785130023956, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 764.6485588550568, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 19.620833333333334, "ram_util_percent": 66.62500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0999722222222222e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1548.9618770054408, "policy_loss": -8.632686995884961e+18, "vf_loss": 315666067.5714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5068.5, "diff_num_grad_updates_vs_sampler_policy": 5067.5}}, "num_env_steps_sampled": 463200, "num_env_steps_trained": 463200, "num_agent_steps_sampled": 463200, "num_agent_steps_trained": 463200}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114176.4385850458, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9092634157713375, "mean_inference_ms": 0.3710278392361908, "mean_action_processing_ms": 0.09109060645876202, "mean_env_wait_ms": 1.0196181475339374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003962726383418828, "StateBufferConnector_ms": 0.00263780027955443, "ViewRequirementAgentConnector_ms": 0.06749629974365234}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114176.4385850458, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9092634157713375, "mean_inference_ms": 0.3710278392361908, "mean_action_processing_ms": 0.09109060645876202, "mean_env_wait_ms": 1.0196181475339374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003962726383418828, "StateBufferConnector_ms": 0.00263780027955443, "ViewRequirementAgentConnector_ms": 0.06749629974365234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 463200, "num_agent_steps_trained": 463200, "num_env_steps_sampled": 463200, "num_env_steps_trained": 463200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.5327975250454, "num_env_steps_trained_throughput_per_sec": 420.5327975250454, "timesteps_total": 463200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 463200, "timers": {"training_iteration_time_ms": 8588.038, "sample_time_ms": 8490.24, "load_time_ms": 1.467, "load_throughput": 2453247.721, "learn_time_ms": 95.486, "learn_throughput": 37701.948, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 463200, "num_env_steps_trained": 463200, "num_agent_steps_sampled": 463200, "num_agent_steps_trained": 463200}, "done": false, "episodes_total": 1001, "training_iteration": 231, "trial_id": "5f82d_00000", "date": "2023-07-26_23-44-27", "timestamp": 1690404267, "time_this_iter_s": 17.123950719833374, "time_total_s": 2809.602463722229, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 781.7725095748901, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 17.583333333333332, "ram_util_percent": 66.69583333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1548.9969395228795, "policy_loss": -8.485752242043805e+18, "vf_loss": 307764646.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5180.5, "diff_num_grad_updates_vs_sampler_policy": 5179.5}}, "num_env_steps_sampled": 470400, "num_env_steps_trained": 470400, "num_agent_steps_sampled": 470400, "num_agent_steps_trained": 470400}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114173.21559616619, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9091876099068019, "mean_inference_ms": 0.3709215323014971, "mean_action_processing_ms": 0.09107175475825648, "mean_env_wait_ms": 1.0186850084397652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003960568417784988, "StateBufferConnector_ms": 0.0026420880389469927, "ViewRequirementAgentConnector_ms": 0.06763396724577873}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114173.21559616619, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9091876099068019, "mean_inference_ms": 0.3709215323014971, "mean_action_processing_ms": 0.09107175475825648, "mean_env_wait_ms": 1.0186850084397652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003960568417784988, "StateBufferConnector_ms": 0.0026420880389469927, "ViewRequirementAgentConnector_ms": 0.06763396724577873}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 470400, "num_agent_steps_trained": 470400, "num_env_steps_sampled": 470400, "num_env_steps_trained": 470400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.11486662881765, "num_env_steps_trained_throughput_per_sec": 423.11486662881765, "timesteps_total": 470400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 470400, "timers": {"training_iteration_time_ms": 8547.501, "sample_time_ms": 8450.037, "load_time_ms": 1.466, "load_throughput": 2455961.094, "learn_time_ms": 95.144, "learn_throughput": 37837.313, "synch_weights_time_ms": 0.795}, "counters": {"num_env_steps_sampled": 470400, "num_env_steps_trained": 470400, "num_agent_steps_sampled": 470400, "num_agent_steps_trained": 470400}, "done": false, "episodes_total": 1003, "training_iteration": 232, "trial_id": "5f82d_00000", "date": "2023-07-26_23-44-44", "timestamp": 1690404284, "time_this_iter_s": 17.019686937332153, "time_total_s": 2826.622150659561, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 798.7921965122223, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 18.908333333333335, "ram_util_percent": 66.62916666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1549.1146872384209, "policy_loss": -9.301110243581344e+18, "vf_loss": 316226796.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5292.5, "diff_num_grad_updates_vs_sampler_policy": 5291.5}}, "num_env_steps_sampled": 477600, "num_env_steps_trained": 477600, "num_agent_steps_sampled": 477600, "num_agent_steps_trained": 477600}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114178.39997777465, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9091161404046239, "mean_inference_ms": 0.3708189671339294, "mean_action_processing_ms": 0.09105348176565684, "mean_env_wait_ms": 1.0177907148992744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039474587691457645, "StateBufferConnector_ms": 0.002640172054893092, "ViewRequirementAgentConnector_ms": 0.06757158982126336}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114178.39997777465, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9091161404046239, "mean_inference_ms": 0.3708189671339294, "mean_action_processing_ms": 0.09105348176565684, "mean_env_wait_ms": 1.0177907148992744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039474587691457645, "StateBufferConnector_ms": 0.002640172054893092, "ViewRequirementAgentConnector_ms": 0.06757158982126336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 477600, "num_agent_steps_trained": 477600, "num_env_steps_sampled": 477600, "num_env_steps_trained": 477600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.43765277607923, "num_env_steps_trained_throughput_per_sec": 419.43765277607923, "timesteps_total": 477600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 477600, "timers": {"training_iteration_time_ms": 8549.367, "sample_time_ms": 8452.64, "load_time_ms": 1.45, "load_throughput": 2482938.582, "learn_time_ms": 94.426, "learn_throughput": 38125.126, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 477600, "num_env_steps_trained": 477600, "num_agent_steps_sampled": 477600, "num_agent_steps_trained": 477600}, "done": false, "episodes_total": 1005, "training_iteration": 233, "trial_id": "5f82d_00000", "date": "2023-07-26_23-45-01", "timestamp": 1690404301, "time_this_iter_s": 17.168771982192993, "time_total_s": 2843.790922641754, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 815.9609684944153, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 18.483999999999998, "ram_util_percent": 66.484}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1549.240273611886, "policy_loss": -8.795932502251462e+18, "vf_loss": 310902250.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5404.5, "diff_num_grad_updates_vs_sampler_policy": 5403.5}}, "num_env_steps_sampled": 484800, "num_env_steps_trained": 484800, "num_agent_steps_sampled": 484800, "num_agent_steps_trained": 484800}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114170.56957782112, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9090476723262907, "mean_inference_ms": 0.37072026063911473, "mean_action_processing_ms": 0.09103580305240207, "mean_env_wait_ms": 1.016924471608882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039380850251187986, "StateBufferConnector_ms": 0.002638580872840488, "ViewRequirementAgentConnector_ms": 0.06752284531740799}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114170.56957782112, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9090476723262907, "mean_inference_ms": 0.37072026063911473, "mean_action_processing_ms": 0.09103580305240207, "mean_env_wait_ms": 1.016924471608882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039380850251187986, "StateBufferConnector_ms": 0.002638580872840488, "ViewRequirementAgentConnector_ms": 0.06752284531740799}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 484800, "num_agent_steps_trained": 484800, "num_env_steps_sampled": 484800, "num_env_steps_trained": 484800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.2183274695312, "num_env_steps_trained_throughput_per_sec": 423.2183274695312, "timesteps_total": 484800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 484800, "timers": {"training_iteration_time_ms": 8543.175, "sample_time_ms": 8446.94, "load_time_ms": 1.501, "load_throughput": 2398953.703, "learn_time_ms": 93.886, "learn_throughput": 38344.368, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 484800, "num_env_steps_trained": 484800, "num_agent_steps_sampled": 484800, "num_agent_steps_trained": 484800}, "done": false, "episodes_total": 1007, "training_iteration": 234, "trial_id": "5f82d_00000", "date": "2023-07-26_23-45-18", "timestamp": 1690404318, "time_this_iter_s": 17.015246868133545, "time_total_s": 2860.8061695098877, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 832.9762153625488, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 18.670833333333334, "ram_util_percent": 66.60833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1549.2853131975446, "policy_loss": -1.034011678439168e+19, "vf_loss": 314863891.4285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5516.5, "diff_num_grad_updates_vs_sampler_policy": 5515.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114179.13623642497, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9089769848128123, "mean_inference_ms": 0.3706250215188655, "mean_action_processing_ms": 0.09101874131449604, "mean_env_wait_ms": 1.0161030644675668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003924755134967843, "StateBufferConnector_ms": 0.0026392214226000237, "ViewRequirementAgentConnector_ms": 0.06746667804140033}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114179.13623642497, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115075.83093813392, -114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9089769848128123, "mean_inference_ms": 0.3706250215188655, "mean_action_processing_ms": 0.09101874131449604, "mean_env_wait_ms": 1.0161030644675668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003924755134967843, "StateBufferConnector_ms": 0.0026392214226000237, "ViewRequirementAgentConnector_ms": 0.06746667804140033}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 417.6237942679796, "num_env_steps_trained_throughput_per_sec": 417.6237942679796, "timesteps_total": 492000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 8555.636, "sample_time_ms": 8459.922, "load_time_ms": 1.559, "load_throughput": 2308967.719, "learn_time_ms": 93.314, "learn_throughput": 38579.29, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 1009, "training_iteration": 235, "trial_id": "5f82d_00000", "date": "2023-07-26_23-45-35", "timestamp": 1690404335, "time_this_iter_s": 17.24335503578186, "time_total_s": 2878.0495245456696, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 850.2195703983307, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 19.283333333333335, "ram_util_percent": 66.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1549.3030046735491, "policy_loss": -7.769720855486911e+18, "vf_loss": 307646043.9285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5628.5, "diff_num_grad_updates_vs_sampler_policy": 5627.5}}, "num_env_steps_sampled": 499200, "num_env_steps_trained": 499200, "num_agent_steps_sampled": 499200, "num_agent_steps_trained": 499200}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114162.90554256919, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.907956664693222, "mean_inference_ms": 0.3701524354599433, "mean_action_processing_ms": 0.09093876756843584, "mean_env_wait_ms": 1.0074794940287832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003913164138793945, "StateBufferConnector_ms": 0.0026390552520751953, "ViewRequirementAgentConnector_ms": 0.06738710403442383}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114162.90554256919, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114994.55955142419, -115133.8593173467, -115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.907956664693222, "mean_inference_ms": 0.3701524354599433, "mean_action_processing_ms": 0.09093876756843584, "mean_env_wait_ms": 1.0074794940287832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003913164138793945, "StateBufferConnector_ms": 0.0026390552520751953, "ViewRequirementAgentConnector_ms": 0.06738710403442383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 499200, "num_agent_steps_trained": 499200, "num_env_steps_sampled": 499200, "num_env_steps_trained": 499200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.0291909222645, "num_env_steps_trained_throughput_per_sec": 424.0291909222645, "timesteps_total": 499200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 499200, "timers": {"training_iteration_time_ms": 8541.519, "sample_time_ms": 8445.581, "load_time_ms": 1.579, "load_throughput": 2280304.816, "learn_time_ms": 93.51, "learn_throughput": 38498.465, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 499200, "num_env_steps_trained": 499200, "num_agent_steps_sampled": 499200, "num_agent_steps_trained": 499200}, "done": false, "episodes_total": 1011, "training_iteration": 236, "trial_id": "5f82d_00000", "date": "2023-07-26_23-45-52", "timestamp": 1690404352, "time_this_iter_s": 16.982728004455566, "time_total_s": 2895.032252550125, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 867.2022984027863, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 18.724999999999998, "ram_util_percent": 66.59166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1549.3439418247767, "policy_loss": -9.109596168886083e+18, "vf_loss": 312027155.14285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5740.5, "diff_num_grad_updates_vs_sampler_policy": 5739.5}}, "num_env_steps_sampled": 506400, "num_env_steps_trained": 506400, "num_agent_steps_sampled": 506400, "num_agent_steps_trained": 506400}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114150.69975479181, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9074063173118704, "mean_inference_ms": 0.36958672079295923, "mean_action_processing_ms": 0.09083551407213879, "mean_env_wait_ms": 1.000856522330413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003912210464477539, "StateBufferConnector_ms": 0.0026450157165527344, "ViewRequirementAgentConnector_ms": 0.06737112998962402}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114150.69975479181, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115470.34040790828, -114095.31087407623, -114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9074063173118704, "mean_inference_ms": 0.36958672079295923, "mean_action_processing_ms": 0.09083551407213879, "mean_env_wait_ms": 1.000856522330413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003912210464477539, "StateBufferConnector_ms": 0.0026450157165527344, "ViewRequirementAgentConnector_ms": 0.06737112998962402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 506400, "num_agent_steps_trained": 506400, "num_env_steps_sampled": 506400, "num_env_steps_trained": 506400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.62251430930496, "num_env_steps_trained_throughput_per_sec": 420.62251430930496, "timesteps_total": 506400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 506400, "timers": {"training_iteration_time_ms": 8551.602, "sample_time_ms": 8455.212, "load_time_ms": 1.549, "load_throughput": 2323857.178, "learn_time_ms": 93.991, "learn_throughput": 38301.581, "synch_weights_time_ms": 0.79}, "counters": {"num_env_steps_sampled": 506400, "num_env_steps_trained": 506400, "num_agent_steps_sampled": 506400, "num_agent_steps_trained": 506400}, "done": false, "episodes_total": 1013, "training_iteration": 237, "trial_id": "5f82d_00000", "date": "2023-07-26_23-46-10", "timestamp": 1690404370, "time_this_iter_s": 17.12044882774353, "time_total_s": 2912.1527013778687, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 884.3227472305298, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 19.504166666666666, "ram_util_percent": 66.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1549.331041608538, "policy_loss": -7.015088964245449e+18, "vf_loss": 306357459.64285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5852.5, "diff_num_grad_updates_vs_sampler_policy": 5851.5}}, "num_env_steps_sampled": 513600, "num_env_steps_trained": 513600, "num_agent_steps_sampled": 513600, "num_agent_steps_trained": 513600}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114132.05816189747, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9070657484742598, "mean_inference_ms": 0.36923547934456136, "mean_action_processing_ms": 0.09077381754831113, "mean_env_wait_ms": 0.9966992849938154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003877401351928711, "StateBufferConnector_ms": 0.002629518508911133, "ViewRequirementAgentConnector_ms": 0.06710267066955566}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114132.05816189747, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114824.71049274423, -114711.90041472955, -114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9070657484742598, "mean_inference_ms": 0.36923547934456136, "mean_action_processing_ms": 0.09077381754831113, "mean_env_wait_ms": 0.9966992849938154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003877401351928711, "StateBufferConnector_ms": 0.002629518508911133, "ViewRequirementAgentConnector_ms": 0.06710267066955566}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 513600, "num_agent_steps_trained": 513600, "num_env_steps_sampled": 513600, "num_env_steps_trained": 513600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.33862468061653, "num_env_steps_trained_throughput_per_sec": 424.33862468061653, "timesteps_total": 513600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 513600, "timers": {"training_iteration_time_ms": 8531.776, "sample_time_ms": 8435.124, "load_time_ms": 1.548, "load_throughput": 2325790.087, "learn_time_ms": 94.253, "learn_throughput": 38194.929, "synch_weights_time_ms": 0.791}, "counters": {"num_env_steps_sampled": 513600, "num_env_steps_trained": 513600, "num_agent_steps_sampled": 513600, "num_agent_steps_trained": 513600}, "done": false, "episodes_total": 1015, "training_iteration": 238, "trial_id": "5f82d_00000", "date": "2023-07-26_23-46-27", "timestamp": 1690404387, "time_this_iter_s": 16.970494270324707, "time_total_s": 2929.1231956481934, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 901.2932415008545, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 19.26, "ram_util_percent": 66.668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1549.5941074916295, "policy_loss": -9.453693097261287e+18, "vf_loss": 315531065.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5964.5, "diff_num_grad_updates_vs_sampler_policy": 5963.5}}, "num_env_steps_sampled": 520800, "num_env_steps_trained": 520800, "num_agent_steps_sampled": 520800, "num_agent_steps_trained": 520800}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114129.38009861192, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9068835366869863, "mean_inference_ms": 0.368981548015758, "mean_action_processing_ms": 0.09073135900439834, "mean_env_wait_ms": 0.9935701357190471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003876209259033203, "StateBufferConnector_ms": 0.0026254653930664062, "ViewRequirementAgentConnector_ms": 0.0670919418334961}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114129.38009861192, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114407.03056256192, -114445.04826066854, -114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9068835366869863, "mean_inference_ms": 0.368981548015758, "mean_action_processing_ms": 0.09073135900439834, "mean_env_wait_ms": 0.9935701357190471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003876209259033203, "StateBufferConnector_ms": 0.0026254653930664062, "ViewRequirementAgentConnector_ms": 0.0670919418334961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520800, "num_agent_steps_trained": 520800, "num_env_steps_sampled": 520800, "num_env_steps_trained": 520800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 416.8120848966438, "num_env_steps_trained_throughput_per_sec": 416.8120848966438, "timesteps_total": 520800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 520800, "timers": {"training_iteration_time_ms": 8557.923, "sample_time_ms": 8461.219, "load_time_ms": 1.483, "load_throughput": 2428078.923, "learn_time_ms": 94.368, "learn_throughput": 38148.436, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 520800, "num_env_steps_trained": 520800, "num_agent_steps_sampled": 520800, "num_agent_steps_trained": 520800}, "done": false, "episodes_total": 1017, "training_iteration": 239, "trial_id": "5f82d_00000", "date": "2023-07-26_23-46-44", "timestamp": 1690404404, "time_this_iter_s": 17.277032136917114, "time_total_s": 2946.4002277851105, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 918.5702736377716, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 18.879166666666666, "ram_util_percent": 66.75416666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1549.6432168143135, "policy_loss": -9.357435079775541e+18, "vf_loss": 312674546.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6076.5, "diff_num_grad_updates_vs_sampler_policy": 6075.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114124.56818296974, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9067326924982201, "mean_inference_ms": 0.36878976562221594, "mean_action_processing_ms": 0.09069987803840672, "mean_env_wait_ms": 0.991267051169967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003876209259033203, "StateBufferConnector_ms": 0.0026273727416992188, "ViewRequirementAgentConnector_ms": 0.06711149215698242}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114124.56818296974, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114145.97689561553, -113696.8670304221, -113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9067326924982201, "mean_inference_ms": 0.36878976562221594, "mean_action_processing_ms": 0.09069987803840672, "mean_env_wait_ms": 0.991267051169967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003876209259033203, "StateBufferConnector_ms": 0.0026273727416992188, "ViewRequirementAgentConnector_ms": 0.06711149215698242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 418.9889253356713, "num_env_steps_trained_throughput_per_sec": 418.9889253356713, "timesteps_total": 528000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 8552.306, "sample_time_ms": 8455.0, "load_time_ms": 1.464, "load_throughput": 2458560.375, "learn_time_ms": 94.988, "learn_throughput": 37899.481, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 1019, "training_iteration": 240, "trial_id": "5f82d_00000", "date": "2023-07-26_23-47-01", "timestamp": 1690404421, "time_this_iter_s": 17.187318086624146, "time_total_s": 2963.5875458717346, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 935.7575917243958, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 18.791666666666668, "ram_util_percent": 66.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1549.8548322405134, "policy_loss": -8.993140416837817e+18, "vf_loss": 309195095.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6188.5, "diff_num_grad_updates_vs_sampler_policy": 6187.5}}, "num_env_steps_sampled": 535200, "num_env_steps_trained": 535200, "num_agent_steps_sampled": 535200, "num_agent_steps_trained": 535200}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114126.08708623139, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.906617306050915, "mean_inference_ms": 0.3686390915121256, "mean_action_processing_ms": 0.09067577913479603, "mean_env_wait_ms": 0.9895673257535489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003793001174926758, "StateBufferConnector_ms": 0.0026178359985351562, "ViewRequirementAgentConnector_ms": 0.06688451766967773}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114126.08708623139, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113929.71624511434, -114128.08647781867, -114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.906617306050915, "mean_inference_ms": 0.3686390915121256, "mean_action_processing_ms": 0.09067577913479603, "mean_env_wait_ms": 0.9895673257535489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003793001174926758, "StateBufferConnector_ms": 0.0026178359985351562, "ViewRequirementAgentConnector_ms": 0.06688451766967773}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 535200, "num_agent_steps_trained": 535200, "num_env_steps_sampled": 535200, "num_env_steps_trained": 535200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.20507310082513, "num_env_steps_trained_throughput_per_sec": 422.20507310082513, "timesteps_total": 535200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 535200, "timers": {"training_iteration_time_ms": 8559.642, "sample_time_ms": 8462.169, "load_time_ms": 1.452, "load_throughput": 2478496.175, "learn_time_ms": 95.167, "learn_throughput": 37828.26, "synch_weights_time_ms": 0.795}, "counters": {"num_env_steps_sampled": 535200, "num_env_steps_trained": 535200, "num_agent_steps_sampled": 535200, "num_agent_steps_trained": 535200}, "done": false, "episodes_total": 1021, "training_iteration": 241, "trial_id": "5f82d_00000", "date": "2023-07-26_23-47-18", "timestamp": 1690404438, "time_this_iter_s": 17.056177139282227, "time_total_s": 2980.643723011017, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 952.813768863678, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 17.996, "ram_util_percent": 66.63600000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1549.8920484270368, "policy_loss": -8.123343163624679e+18, "vf_loss": 314264250.14285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6300.5, "diff_num_grad_updates_vs_sampler_policy": 6299.5}}, "num_env_steps_sampled": 542400, "num_env_steps_trained": 542400, "num_agent_steps_sampled": 542400, "num_agent_steps_trained": 542400}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114135.93065688135, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9063673076808201, "mean_inference_ms": 0.36833714400596684, "mean_action_processing_ms": 0.09061932225047872, "mean_env_wait_ms": 0.9879794585337294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003745555877685547, "StateBufferConnector_ms": 0.002588510513305664, "ViewRequirementAgentConnector_ms": 0.06595802307128906}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114135.93065688135, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114291.88041975306, -114826.23959651194, -114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9063673076808201, "mean_inference_ms": 0.36833714400596684, "mean_action_processing_ms": 0.09061932225047872, "mean_env_wait_ms": 0.9879794585337294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003745555877685547, "StateBufferConnector_ms": 0.002588510513305664, "ViewRequirementAgentConnector_ms": 0.06595802307128906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 542400, "num_agent_steps_trained": 542400, "num_env_steps_sampled": 542400, "num_env_steps_trained": 542400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.1236622095277, "num_env_steps_trained_throughput_per_sec": 421.1236622095277, "timesteps_total": 542400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 542400, "timers": {"training_iteration_time_ms": 8557.605, "sample_time_ms": 8460.649, "load_time_ms": 1.459, "load_throughput": 2468245.917, "learn_time_ms": 94.661, "learn_throughput": 38030.408, "synch_weights_time_ms": 0.778}, "counters": {"num_env_steps_sampled": 542400, "num_env_steps_trained": 542400, "num_agent_steps_sampled": 542400, "num_agent_steps_trained": 542400}, "done": false, "episodes_total": 1023, "training_iteration": 242, "trial_id": "5f82d_00000", "date": "2023-07-26_23-47-35", "timestamp": 1690404455, "time_this_iter_s": 17.10016393661499, "time_total_s": 2997.743886947632, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 969.913932800293, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 17.14166666666667, "ram_util_percent": 66.71666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1552.8737335205078, "policy_loss": -8.898138359510668e+18, "vf_loss": 309303480.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6412.5, "diff_num_grad_updates_vs_sampler_policy": 6411.5}}, "num_env_steps_sampled": 549600, "num_env_steps_trained": 549600, "num_agent_steps_sampled": 549600, "num_agent_steps_trained": 549600}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114121.48708115185, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9061789191517726, "mean_inference_ms": 0.36808413214142777, "mean_action_processing_ms": 0.0905719828169681, "mean_env_wait_ms": 0.9866147306678553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003742218017578125, "StateBufferConnector_ms": 0.002588987350463867, "ViewRequirementAgentConnector_ms": 0.06591963768005371}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114121.48708115185, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114546.44770807738, -114518.2027172693, -113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9061789191517726, "mean_inference_ms": 0.36808413214142777, "mean_action_processing_ms": 0.0905719828169681, "mean_env_wait_ms": 0.9866147306678553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003742218017578125, "StateBufferConnector_ms": 0.002588987350463867, "ViewRequirementAgentConnector_ms": 0.06591963768005371}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 549600, "num_agent_steps_trained": 549600, "num_env_steps_sampled": 549600, "num_env_steps_trained": 549600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.41198325010464, "num_env_steps_trained_throughput_per_sec": 422.41198325010464, "timesteps_total": 549600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 549600, "timers": {"training_iteration_time_ms": 8565.344, "sample_time_ms": 8468.078, "load_time_ms": 1.456, "load_throughput": 2473299.656, "learn_time_ms": 94.968, "learn_throughput": 37907.464, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 549600, "num_env_steps_trained": 549600, "num_agent_steps_sampled": 549600, "num_agent_steps_trained": 549600}, "done": false, "episodes_total": 1025, "training_iteration": 243, "trial_id": "5f82d_00000", "date": "2023-07-26_23-47-52", "timestamp": 1690404472, "time_this_iter_s": 17.04798674583435, "time_total_s": 3014.791873693466, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 986.9619195461273, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 18.90416666666667, "ram_util_percent": 66.65833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1553.7442779541016, "policy_loss": -1.0500271521793292e+19, "vf_loss": 312395783.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6524.5, "diff_num_grad_updates_vs_sampler_policy": 6523.5}}, "num_env_steps_sampled": 556800, "num_env_steps_trained": 556800, "num_agent_steps_sampled": 556800, "num_agent_steps_trained": 556800}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114114.58987629539, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9060318752072263, "mean_inference_ms": 0.367865150509204, "mean_action_processing_ms": 0.09053092368287972, "mean_env_wait_ms": 0.9853681864554052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003743886947631836, "StateBufferConnector_ms": 0.0025908946990966797, "ViewRequirementAgentConnector_ms": 0.06590604782104492}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114114.58987629539, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113459.96274947462, -114721.97194031483, -113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9060318752072263, "mean_inference_ms": 0.367865150509204, "mean_action_processing_ms": 0.09053092368287972, "mean_env_wait_ms": 0.9853681864554052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003743886947631836, "StateBufferConnector_ms": 0.0025908946990966797, "ViewRequirementAgentConnector_ms": 0.06590604782104492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 556800, "num_agent_steps_trained": 556800, "num_env_steps_sampled": 556800, "num_env_steps_trained": 556800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.3515478732207, "num_env_steps_trained_throughput_per_sec": 420.3515478732207, "timesteps_total": 556800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 556800, "timers": {"training_iteration_time_ms": 8550.799, "sample_time_ms": 8453.1, "load_time_ms": 1.49, "load_throughput": 2415996.416, "learn_time_ms": 95.369, "learn_throughput": 37748.066, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 556800, "num_env_steps_trained": 556800, "num_agent_steps_sampled": 556800, "num_agent_steps_trained": 556800}, "done": false, "episodes_total": 1027, "training_iteration": 244, "trial_id": "5f82d_00000", "date": "2023-07-26_23-48-10", "timestamp": 1690404490, "time_this_iter_s": 17.13139820098877, "time_total_s": 3031.923271894455, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1004.0933177471161, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 19.325, "ram_util_percent": 66.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1553.9332427978516, "policy_loss": -8.310992916302079e+18, "vf_loss": 308441144.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6636.5, "diff_num_grad_updates_vs_sampler_policy": 6635.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114110.56498844012, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9059044538251274, "mean_inference_ms": 0.3676717481251818, "mean_action_processing_ms": 0.09049459425104493, "mean_env_wait_ms": 0.9843030151707208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704547882080078, "StateBufferConnector_ms": 0.0025691986083984375, "ViewRequirementAgentConnector_ms": 0.0654592514038086}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114110.56498844012, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113598.77207101791, -115051.88068802006, -113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9059044538251274, "mean_inference_ms": 0.3676717481251818, "mean_action_processing_ms": 0.09049459425104493, "mean_env_wait_ms": 0.9843030151707208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704547882080078, "StateBufferConnector_ms": 0.0025691986083984375, "ViewRequirementAgentConnector_ms": 0.0654592514038086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 417.37170825221665, "num_env_steps_trained_throughput_per_sec": 417.37170825221665, "timesteps_total": 564000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 8557.457, "sample_time_ms": 8459.731, "load_time_ms": 1.513, "load_throughput": 2379934.494, "learn_time_ms": 95.377, "learn_throughput": 37744.877, "synch_weights_time_ms": 0.777}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 1029, "training_iteration": 245, "trial_id": "5f82d_00000", "date": "2023-07-26_23-48-27", "timestamp": 1690404507, "time_this_iter_s": 17.25358486175537, "time_total_s": 3049.1768567562103, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1021.3469026088715, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 19.136000000000003, "ram_util_percent": 66.652}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1553.9292667933873, "policy_loss": -1.0211553130159266e+19, "vf_loss": 314913556.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6748.5, "diff_num_grad_updates_vs_sampler_policy": 6747.5}}, "num_env_steps_sampled": 571200, "num_env_steps_trained": 571200, "num_agent_steps_sampled": 571200, "num_agent_steps_trained": 571200}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114123.34235703535, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905825617607259, "mean_inference_ms": 0.36750187838318, "mean_action_processing_ms": 0.09046243389727274, "mean_env_wait_ms": 0.9833658412048514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706216812133789, "StateBufferConnector_ms": 0.0025675296783447266, "ViewRequirementAgentConnector_ms": 0.06545639038085938}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114123.34235703535, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113813.38568284395, -114058.10094825193, -114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905825617607259, "mean_inference_ms": 0.36750187838318, "mean_action_processing_ms": 0.09046243389727274, "mean_env_wait_ms": 0.9833658412048514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706216812133789, "StateBufferConnector_ms": 0.0025675296783447266, "ViewRequirementAgentConnector_ms": 0.06545639038085938}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 571200, "num_agent_steps_trained": 571200, "num_env_steps_sampled": 571200, "num_env_steps_trained": 571200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 416.86307924926354, "num_env_steps_trained_throughput_per_sec": 416.86307924926354, "timesteps_total": 571200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 571200, "timers": {"training_iteration_time_ms": 8579.311, "sample_time_ms": 8481.821, "load_time_ms": 1.476, "load_throughput": 2438312.567, "learn_time_ms": 95.185, "learn_throughput": 37821.22, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 571200, "num_env_steps_trained": 571200, "num_agent_steps_sampled": 571200, "num_agent_steps_trained": 571200}, "done": false, "episodes_total": 1031, "training_iteration": 246, "trial_id": "5f82d_00000", "date": "2023-07-26_23-48-44", "timestamp": 1690404524, "time_this_iter_s": 17.27472424507141, "time_total_s": 3066.4515810012817, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1038.6216268539429, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 18.845833333333335, "ram_util_percent": 66.52499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.666574074074075e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1553.927993774414, "policy_loss": -9.729754826984253e+18, "vf_loss": 309854414.4285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6860.5, "diff_num_grad_updates_vs_sampler_policy": 6859.5}}, "num_env_steps_sampled": 578400, "num_env_steps_trained": 578400, "num_agent_steps_sampled": 578400, "num_agent_steps_trained": 578400}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114120.93409701936, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9057558187862587, "mean_inference_ms": 0.3673501590477121, "mean_action_processing_ms": 0.09043341145376965, "mean_env_wait_ms": 0.9825214080351076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037047863006591797, "StateBufferConnector_ms": 0.0025637149810791016, "ViewRequirementAgentConnector_ms": 0.06542825698852539}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114120.93409701936, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114013.37791046438, -113717.8824684246, -113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9057558187862587, "mean_inference_ms": 0.3673501590477121, "mean_action_processing_ms": 0.09043341145376965, "mean_env_wait_ms": 0.9825214080351076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037047863006591797, "StateBufferConnector_ms": 0.0025637149810791016, "ViewRequirementAgentConnector_ms": 0.06542825698852539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 578400, "num_agent_steps_trained": 578400, "num_env_steps_sampled": 578400, "num_env_steps_trained": 578400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.0136472844833, "num_env_steps_trained_throughput_per_sec": 420.0136472844833, "timesteps_total": 578400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 578400, "timers": {"training_iteration_time_ms": 8583.83, "sample_time_ms": 8485.924, "load_time_ms": 1.469, "load_throughput": 2449943.925, "learn_time_ms": 95.605, "learn_throughput": 37654.75, "synch_weights_time_ms": 0.771}, "counters": {"num_env_steps_sampled": 578400, "num_env_steps_trained": 578400, "num_agent_steps_sampled": 578400, "num_agent_steps_trained": 578400}, "done": false, "episodes_total": 1033, "training_iteration": 247, "trial_id": "5f82d_00000", "date": "2023-07-26_23-49-01", "timestamp": 1690404541, "time_this_iter_s": 17.14528799057007, "time_total_s": 3083.596868991852, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1055.766914844513, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 18.224999999999998, "ram_util_percent": 66.45416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.999907407407407e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1553.9104330880302, "policy_loss": -9.320183139616453e+18, "vf_loss": 311603427.9285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6972.5, "diff_num_grad_updates_vs_sampler_policy": 6971.5}}, "num_env_steps_sampled": 585600, "num_env_steps_trained": 585600, "num_agent_steps_sampled": 585600, "num_agent_steps_trained": 585600}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114125.25740734686, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9057103545662314, "mean_inference_ms": 0.36721450747502177, "mean_action_processing_ms": 0.09040703039160579, "mean_env_wait_ms": 0.981774695371051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003703594207763672, "StateBufferConnector_ms": 0.0025632381439208984, "ViewRequirementAgentConnector_ms": 0.06540703773498535}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114125.25740734686, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113488.8649590357, -113331.39617506192, -114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9057103545662314, "mean_inference_ms": 0.36721450747502177, "mean_action_processing_ms": 0.09040703039160579, "mean_env_wait_ms": 0.981774695371051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003703594207763672, "StateBufferConnector_ms": 0.0025632381439208984, "ViewRequirementAgentConnector_ms": 0.06540703773498535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 585600, "num_agent_steps_trained": 585600, "num_env_steps_sampled": 585600, "num_env_steps_trained": 585600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.48648889127594, "num_env_steps_trained_throughput_per_sec": 423.48648889127594, "timesteps_total": 585600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 585600, "timers": {"training_iteration_time_ms": 8579.505, "sample_time_ms": 8482.151, "load_time_ms": 1.491, "load_throughput": 2415069.0, "learn_time_ms": 95.025, "learn_throughput": 37884.733, "synch_weights_time_ms": 0.778}, "counters": {"num_env_steps_sampled": 585600, "num_env_steps_trained": 585600, "num_agent_steps_sampled": 585600, "num_agent_steps_trained": 585600}, "done": false, "episodes_total": 1035, "training_iteration": 248, "trial_id": "5f82d_00000", "date": "2023-07-26_23-49-18", "timestamp": 1690404558, "time_this_iter_s": 17.004639863967896, "time_total_s": 3100.6015088558197, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1072.7715547084808, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 17.756, "ram_util_percent": 66.496}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.33324074074074e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1554.087162562779, "policy_loss": -8.963822601390857e+18, "vf_loss": 306540414.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7084.5, "diff_num_grad_updates_vs_sampler_policy": 7083.5}}, "num_env_steps_sampled": 592800, "num_env_steps_trained": 592800, "num_agent_steps_sampled": 592800, "num_agent_steps_trained": 592800}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114133.46168572223, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056846156504011, "mean_inference_ms": 0.36709475461416774, "mean_action_processing_ms": 0.09038345103243021, "mean_env_wait_ms": 0.9811444625054798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036995410919189453, "StateBufferConnector_ms": 0.0025634765625, "ViewRequirementAgentConnector_ms": 0.06536436080932617}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114133.46168572223, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114307.03616189581, -113920.32786516279, -113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056846156504011, "mean_inference_ms": 0.36709475461416774, "mean_action_processing_ms": 0.09038345103243021, "mean_env_wait_ms": 0.9811444625054798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036995410919189453, "StateBufferConnector_ms": 0.0025634765625, "ViewRequirementAgentConnector_ms": 0.06536436080932617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592800, "num_agent_steps_trained": 592800, "num_env_steps_sampled": 592800, "num_env_steps_trained": 592800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 418.76667808005857, "num_env_steps_trained_throughput_per_sec": 418.76667808005857, "timesteps_total": 592800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 592800, "timers": {"training_iteration_time_ms": 8585.987, "sample_time_ms": 8488.941, "load_time_ms": 1.522, "load_throughput": 2365171.974, "learn_time_ms": 94.696, "learn_throughput": 38016.237, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 592800, "num_env_steps_trained": 592800, "num_agent_steps_sampled": 592800, "num_agent_steps_trained": 592800}, "done": false, "episodes_total": 1037, "training_iteration": 249, "trial_id": "5f82d_00000", "date": "2023-07-26_23-49-36", "timestamp": 1690404576, "time_this_iter_s": 17.196247100830078, "time_total_s": 3117.79775595665, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1089.967801809311, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 17.791666666666668, "ram_util_percent": 66.51249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.666574074074074e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1554.351069859096, "policy_loss": -8.306449894849867e+18, "vf_loss": 308655789.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7196.5, "diff_num_grad_updates_vs_sampler_policy": 7195.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114138.74960216806, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056811199475817, "mean_inference_ms": 0.3669870600400387, "mean_action_processing_ms": 0.09036190243023874, "mean_env_wait_ms": 0.9805480915762995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036933422088623047, "StateBufferConnector_ms": 0.0025625228881835938, "ViewRequirementAgentConnector_ms": 0.06534004211425781}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114138.74960216806, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113918.17152417214, -114511.77166896372, -113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056811199475817, "mean_inference_ms": 0.3669870600400387, "mean_action_processing_ms": 0.09036190243023874, "mean_env_wait_ms": 0.9805480915762995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036933422088623047, "StateBufferConnector_ms": 0.0025625228881835938, "ViewRequirementAgentConnector_ms": 0.06534004211425781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.5435128052321, "num_env_steps_trained_throughput_per_sec": 422.5435128052321, "timesteps_total": 600000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 8564.873, "sample_time_ms": 8467.916, "load_time_ms": 1.469, "load_throughput": 2450659.655, "learn_time_ms": 94.653, "learn_throughput": 38033.847, "synch_weights_time_ms": 0.777}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 1039, "training_iteration": 250, "trial_id": "5f82d_00000", "date": "2023-07-26_23-49-53", "timestamp": 1690404593, "time_this_iter_s": 17.042630910873413, "time_total_s": 3134.840386867523, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1107.0104327201843, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 18.5125, "ram_util_percent": 66.49583333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.999907407407409e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1554.3826141357422, "policy_loss": -9.615409050473267e+18, "vf_loss": 311220070.78571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7308.5, "diff_num_grad_updates_vs_sampler_policy": 7307.5}}, "num_env_steps_sampled": 607200, "num_env_steps_trained": 607200, "num_agent_steps_sampled": 607200, "num_agent_steps_trained": 607200}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114137.72029090785, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056761606579695, "mean_inference_ms": 0.36688962929961844, "mean_action_processing_ms": 0.09034213598946915, "mean_env_wait_ms": 0.9799960292220643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036940574645996094, "StateBufferConnector_ms": 0.0025665760040283203, "ViewRequirementAgentConnector_ms": 0.06536650657653809}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114137.72029090785, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113893.08457734328, -113585.33428989339, -114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056761606579695, "mean_inference_ms": 0.36688962929961844, "mean_action_processing_ms": 0.09034213598946915, "mean_env_wait_ms": 0.9799960292220643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036940574645996094, "StateBufferConnector_ms": 0.0025665760040283203, "ViewRequirementAgentConnector_ms": 0.06536650657653809}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 607200, "num_agent_steps_trained": 607200, "num_env_steps_sampled": 607200, "num_env_steps_trained": 607200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.59775539919167, "num_env_steps_trained_throughput_per_sec": 419.59775539919167, "timesteps_total": 607200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 607200, "timers": {"training_iteration_time_ms": 8553.616, "sample_time_ms": 8456.447, "load_time_ms": 1.468, "load_throughput": 2451972.914, "learn_time_ms": 94.863, "learn_throughput": 37949.498, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 607200, "num_env_steps_trained": 607200, "num_agent_steps_sampled": 607200, "num_agent_steps_trained": 607200}, "done": false, "episodes_total": 1041, "training_iteration": 251, "trial_id": "5f82d_00000", "date": "2023-07-26_23-50-10", "timestamp": 1690404610, "time_this_iter_s": 17.16226100921631, "time_total_s": 3152.0026478767395, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1124.1726937294006, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 18.84583333333333, "ram_util_percent": 66.45833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.33324074074074e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1554.4822300502233, "policy_loss": -7.960559095328124e+18, "vf_loss": 307579282.4285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7420.5, "diff_num_grad_updates_vs_sampler_policy": 7419.5}}, "num_env_steps_sampled": 614400, "num_env_steps_trained": 614400, "num_agent_steps_sampled": 614400, "num_agent_steps_trained": 614400}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114140.73582884368, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056734014619744, "mean_inference_ms": 0.366799968754626, "mean_action_processing_ms": 0.09032367245103813, "mean_env_wait_ms": 0.9795122238685905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036916732788085938, "StateBufferConnector_ms": 0.002572774887084961, "ViewRequirementAgentConnector_ms": 0.06539440155029297}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114140.73582884368, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114638.97836053895, -113723.24452802654, -113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056734014619744, "mean_inference_ms": 0.366799968754626, "mean_action_processing_ms": 0.09032367245103813, "mean_env_wait_ms": 0.9795122238685905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036916732788085938, "StateBufferConnector_ms": 0.002572774887084961, "ViewRequirementAgentConnector_ms": 0.06539440155029297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 614400, "num_agent_steps_trained": 614400, "num_env_steps_sampled": 614400, "num_env_steps_trained": 614400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.0000011232164, "num_env_steps_trained_throughput_per_sec": 424.0000011232164, "timesteps_total": 614400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 614400, "timers": {"training_iteration_time_ms": 8537.499, "sample_time_ms": 8440.465, "load_time_ms": 1.471, "load_throughput": 2447838.924, "learn_time_ms": 94.724, "learn_throughput": 38005.023, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 614400, "num_env_steps_trained": 614400, "num_agent_steps_sampled": 614400, "num_agent_steps_trained": 614400}, "done": false, "episodes_total": 1043, "training_iteration": 252, "trial_id": "5f82d_00000", "date": "2023-07-26_23-50-27", "timestamp": 1690404627, "time_this_iter_s": 16.983994007110596, "time_total_s": 3168.98664188385, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1141.1566877365112, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 18.2375, "ram_util_percent": 66.4875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.666574074074075e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1554.6942356654577, "policy_loss": -9.843306739924474e+18, "vf_loss": 310429677.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7532.5, "diff_num_grad_updates_vs_sampler_policy": 7531.5}}, "num_env_steps_sampled": 621600, "num_env_steps_trained": 621600, "num_agent_steps_sampled": 621600, "num_agent_steps_trained": 621600}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114137.07152172686, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056818447458125, "mean_inference_ms": 0.36672044964139516, "mean_action_processing_ms": 0.09030675256089679, "mean_env_wait_ms": 0.9790576023432326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036916732788085938, "StateBufferConnector_ms": 0.0025713443756103516, "ViewRequirementAgentConnector_ms": 0.06538915634155273}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114137.07152172686, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113505.10444235196, -113838.55635939374, -114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056818447458125, "mean_inference_ms": 0.36672044964139516, "mean_action_processing_ms": 0.09030675256089679, "mean_env_wait_ms": 0.9790576023432326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036916732788085938, "StateBufferConnector_ms": 0.0025713443756103516, "ViewRequirementAgentConnector_ms": 0.06538915634155273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 621600, "num_agent_steps_trained": 621600, "num_env_steps_sampled": 621600, "num_env_steps_trained": 621600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.1085828179212, "num_env_steps_trained_throughput_per_sec": 419.1085828179212, "timesteps_total": 621600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 621600, "timers": {"training_iteration_time_ms": 8555.259, "sample_time_ms": 8457.757, "load_time_ms": 1.448, "load_throughput": 2485595.312, "learn_time_ms": 95.214, "learn_throughput": 37809.392, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 621600, "num_env_steps_trained": 621600, "num_agent_steps_sampled": 621600, "num_agent_steps_trained": 621600}, "done": false, "episodes_total": 1045, "training_iteration": 253, "trial_id": "5f82d_00000", "date": "2023-07-26_23-50-44", "timestamp": 1690404644, "time_this_iter_s": 17.182302951812744, "time_total_s": 3186.168944835663, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1158.338990688324, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 18.828, "ram_util_percent": 66.516}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1554.6924373081752, "policy_loss": -9.39564492638905e+18, "vf_loss": 308891556.5714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7644.5, "diff_num_grad_updates_vs_sampler_policy": 7643.5}}, "num_env_steps_sampled": 628800, "num_env_steps_trained": 628800, "num_agent_steps_sampled": 628800, "num_agent_steps_trained": 628800}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114143.76381107284, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056820604639956, "mean_inference_ms": 0.36664783908679494, "mean_action_processing_ms": 0.09029114031752128, "mean_env_wait_ms": 0.9786851232029625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003690481185913086, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.06536555290222168}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114143.76381107284, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114695.30336833037, -114177.35587774136, -113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056820604639956, "mean_inference_ms": 0.36664783908679494, "mean_action_processing_ms": 0.09029114031752128, "mean_env_wait_ms": 0.9786851232029625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003690481185913086, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.06536555290222168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 628800, "num_agent_steps_trained": 628800, "num_env_steps_sampled": 628800, "num_env_steps_trained": 628800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 418.50292196190486, "num_env_steps_trained_throughput_per_sec": 418.50292196190486, "timesteps_total": 628800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 628800, "timers": {"training_iteration_time_ms": 8556.343, "sample_time_ms": 8458.475, "load_time_ms": 1.384, "load_throughput": 2600402.025, "learn_time_ms": 95.645, "learn_throughput": 37639.262, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 628800, "num_env_steps_trained": 628800, "num_agent_steps_sampled": 628800, "num_agent_steps_trained": 628800}, "done": false, "episodes_total": 1047, "training_iteration": 254, "trial_id": "5f82d_00000", "date": "2023-07-26_23-51-01", "timestamp": 1690404661, "time_this_iter_s": 17.207077264785767, "time_total_s": 3203.3760221004486, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1175.5460679531097, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 18.929166666666667, "ram_util_percent": 66.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1554.733152117048, "policy_loss": -8.252329808250312e+18, "vf_loss": 307215109.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7756.5, "diff_num_grad_updates_vs_sampler_policy": 7755.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114136.57399510099, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056786393596323, "mean_inference_ms": 0.3665809890717132, "mean_action_processing_ms": 0.09027684261355948, "mean_env_wait_ms": 0.9783413995360958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003690481185913086, "StateBufferConnector_ms": 0.0025663375854492188, "ViewRequirementAgentConnector_ms": 0.06538653373718262}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114136.57399510099, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113699.85826493235, -113235.91275171384, -113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056786393596323, "mean_inference_ms": 0.3665809890717132, "mean_action_processing_ms": 0.09027684261355948, "mean_env_wait_ms": 0.9783413995360958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003690481185913086, "StateBufferConnector_ms": 0.0025663375854492188, "ViewRequirementAgentConnector_ms": 0.06538653373718262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.44924780015884, "num_env_steps_trained_throughput_per_sec": 420.44924780015884, "timesteps_total": 636000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 8564.83, "sample_time_ms": 8466.997, "load_time_ms": 1.415, "load_throughput": 2545044.481, "learn_time_ms": 95.58, "learn_throughput": 37664.621, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 1049, "training_iteration": 255, "trial_id": "5f82d_00000", "date": "2023-07-26_23-51-18", "timestamp": 1690404678, "time_this_iter_s": 17.127401113510132, "time_total_s": 3220.5034232139587, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1192.6734690666199, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 18.844, "ram_util_percent": 66.45599999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1554.784463065011, "policy_loss": -9.142240906395227e+18, "vf_loss": 311414484.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7868.5, "diff_num_grad_updates_vs_sampler_policy": 7867.5}}, "num_env_steps_sampled": 643200, "num_env_steps_trained": 643200, "num_agent_steps_sampled": 643200, "num_agent_steps_trained": 643200}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114149.090594827, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056728161076073, "mean_inference_ms": 0.3665198757349637, "mean_action_processing_ms": 0.09026367946785914, "mean_env_wait_ms": 0.9780255250687635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003691434860229492, "StateBufferConnector_ms": 0.002566814422607422, "ViewRequirementAgentConnector_ms": 0.06541180610656738}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114149.090594827, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113861.43690429442, -114797.77042090865, -113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056728161076073, "mean_inference_ms": 0.3665198757349637, "mean_action_processing_ms": 0.09026367946785914, "mean_env_wait_ms": 0.9780255250687635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003691434860229492, "StateBufferConnector_ms": 0.002566814422607422, "ViewRequirementAgentConnector_ms": 0.06541180610656738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 643200, "num_agent_steps_trained": 643200, "num_env_steps_sampled": 643200, "num_env_steps_trained": 643200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.20103555323567, "num_env_steps_trained_throughput_per_sec": 421.20103555323567, "timesteps_total": 643200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 643200, "timers": {"training_iteration_time_ms": 8558.298, "sample_time_ms": 8460.7, "load_time_ms": 1.421, "load_throughput": 2533727.288, "learn_time_ms": 95.344, "learn_throughput": 37758.081, "synch_weights_time_ms": 0.775}, "counters": {"num_env_steps_sampled": 643200, "num_env_steps_trained": 643200, "num_agent_steps_sampled": 643200, "num_agent_steps_trained": 643200}, "done": false, "episodes_total": 1051, "training_iteration": 256, "trial_id": "5f82d_00000", "date": "2023-07-26_23-51-36", "timestamp": 1690404696, "time_this_iter_s": 17.096939086914062, "time_total_s": 3237.600362300873, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1209.770408153534, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 19.004166666666666, "ram_util_percent": 66.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1554.9205671037946, "policy_loss": -8.125529906921122e+18, "vf_loss": 305141919.35714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7980.5, "diff_num_grad_updates_vs_sampler_policy": 7979.5}}, "num_env_steps_sampled": 650400, "num_env_steps_trained": 650400, "num_agent_steps_sampled": 650400, "num_agent_steps_trained": 650400}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114125.44716552684, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056739083631004, "mean_inference_ms": 0.3664622710505512, "mean_action_processing_ms": 0.09025146730865825, "mean_env_wait_ms": 0.977723676197595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003688812255859375, "StateBufferConnector_ms": 0.002567291259765625, "ViewRequirementAgentConnector_ms": 0.0653846263885498}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114125.44716552684, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113852.38373271584, -115086.65561313796, -113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056739083631004, "mean_inference_ms": 0.3664622710505512, "mean_action_processing_ms": 0.09025146730865825, "mean_env_wait_ms": 0.977723676197595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003688812255859375, "StateBufferConnector_ms": 0.002567291259765625, "ViewRequirementAgentConnector_ms": 0.0653846263885498}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 650400, "num_agent_steps_trained": 650400, "num_env_steps_sampled": 650400, "num_env_steps_trained": 650400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.97216690910125, "num_env_steps_trained_throughput_per_sec": 424.97216690910125, "timesteps_total": 650400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 650400, "timers": {"training_iteration_time_ms": 8554.413, "sample_time_ms": 8456.303, "load_time_ms": 1.45, "load_throughput": 2481959.071, "learn_time_ms": 95.821, "learn_throughput": 37570.025, "synch_weights_time_ms": 0.779}, "counters": {"num_env_steps_sampled": 650400, "num_env_steps_trained": 650400, "num_agent_steps_sampled": 650400, "num_agent_steps_trained": 650400}, "done": false, "episodes_total": 1053, "training_iteration": 257, "trial_id": "5f82d_00000", "date": "2023-07-26_23-51-52", "timestamp": 1690404712, "time_this_iter_s": 16.945151805877686, "time_total_s": 3254.5455141067505, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1226.7155599594116, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 18.3125, "ram_util_percent": 66.55416666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1554.9559086390905, "policy_loss": -9.156973427915114e+18, "vf_loss": 313204957.21428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8092.5, "diff_num_grad_updates_vs_sampler_policy": 8091.5}}, "num_env_steps_sampled": 657600, "num_env_steps_trained": 657600, "num_agent_steps_sampled": 657600, "num_agent_steps_trained": 657600}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114127.44216651164, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056677411204354, "mean_inference_ms": 0.3664083457445338, "mean_action_processing_ms": 0.09024004657109, "mean_env_wait_ms": 0.9774196038016857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003688812255859375, "StateBufferConnector_ms": 0.0025658607482910156, "ViewRequirementAgentConnector_ms": 0.06541919708251953}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114127.44216651164, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113364.51243360288, -113760.05835346665, -114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056677411204354, "mean_inference_ms": 0.3664083457445338, "mean_action_processing_ms": 0.09024004657109, "mean_env_wait_ms": 0.9774196038016857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003688812255859375, "StateBufferConnector_ms": 0.0025658607482910156, "ViewRequirementAgentConnector_ms": 0.06541919708251953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 657600, "num_agent_steps_trained": 657600, "num_env_steps_sampled": 657600, "num_env_steps_trained": 657600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.4706273882545, "num_env_steps_trained_throughput_per_sec": 423.4706273882545, "timesteps_total": 657600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 657600, "timers": {"training_iteration_time_ms": 8536.717, "sample_time_ms": 8438.675, "load_time_ms": 1.441, "load_throughput": 2497807.216, "learn_time_ms": 95.771, "learn_throughput": 37589.497, "synch_weights_time_ms": 0.77}, "counters": {"num_env_steps_sampled": 657600, "num_env_steps_trained": 657600, "num_agent_steps_sampled": 657600, "num_agent_steps_trained": 657600}, "done": false, "episodes_total": 1055, "training_iteration": 258, "trial_id": "5f82d_00000", "date": "2023-07-26_23-52-10", "timestamp": 1690404730, "time_this_iter_s": 17.005281686782837, "time_total_s": 3271.5507957935333, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1243.7208416461945, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 20.287499999999998, "ram_util_percent": 66.70833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1555.090321132115, "policy_loss": -9.622992867927077e+18, "vf_loss": 315662905.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8204.5, "diff_num_grad_updates_vs_sampler_policy": 8203.5}}, "num_env_steps_sampled": 664800, "num_env_steps_trained": 664800, "num_agent_steps_sampled": 664800, "num_agent_steps_trained": 664800}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114140.58151316145, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056597442079942, "mean_inference_ms": 0.3663582502037556, "mean_action_processing_ms": 0.0902294597835801, "mean_env_wait_ms": 0.9771369513526014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036890506744384766, "StateBufferConnector_ms": 0.002564668655395508, "ViewRequirementAgentConnector_ms": 0.06542634963989258}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114140.58151316145, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114261.13233259658, -114283.2171678807, -113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056597442079942, "mean_inference_ms": 0.3663582502037556, "mean_action_processing_ms": 0.0902294597835801, "mean_env_wait_ms": 0.9771369513526014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036890506744384766, "StateBufferConnector_ms": 0.002564668655395508, "ViewRequirementAgentConnector_ms": 0.06542634963989258}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664800, "num_agent_steps_trained": 664800, "num_env_steps_sampled": 664800, "num_env_steps_trained": 664800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 425.6636889977785, "num_env_steps_trained_throughput_per_sec": 425.6636889977785, "timesteps_total": 664800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 664800, "timers": {"training_iteration_time_ms": 8507.776, "sample_time_ms": 8409.889, "load_time_ms": 1.468, "load_throughput": 2452889.048, "learn_time_ms": 95.586, "learn_throughput": 37662.226, "synch_weights_time_ms": 0.772}, "counters": {"num_env_steps_sampled": 664800, "num_env_steps_trained": 664800, "num_agent_steps_sampled": 664800, "num_agent_steps_trained": 664800}, "done": false, "episodes_total": 1057, "training_iteration": 259, "trial_id": "5f82d_00000", "date": "2023-07-26_23-52-26", "timestamp": 1690404746, "time_this_iter_s": 16.91770911216736, "time_total_s": 3288.4685049057007, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1260.6385507583618, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 19.025, "ram_util_percent": 66.67916666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1555.2803671700615, "policy_loss": -9.741947203258468e+18, "vf_loss": 310630910.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8316.5, "diff_num_grad_updates_vs_sampler_policy": 8315.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114147.64210107601, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056551399135457, "mean_inference_ms": 0.36631287708616705, "mean_action_processing_ms": 0.09021973182911043, "mean_env_wait_ms": 0.9768733974535945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687620162963867, "StateBufferConnector_ms": 0.0025649070739746094, "ViewRequirementAgentConnector_ms": 0.06543946266174316}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115495.16675889051, "episode_reward_mean": -114147.64210107601, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113093.20073918099, -114366.18449737498, -114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056551399135457, "mean_inference_ms": 0.36631287708616705, "mean_action_processing_ms": 0.09021973182911043, "mean_env_wait_ms": 0.9768733974535945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687620162963867, "StateBufferConnector_ms": 0.0025649070739746094, "ViewRequirementAgentConnector_ms": 0.06543946266174316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 414.5668684773458, "num_env_steps_trained_throughput_per_sec": 414.5668684773458, "timesteps_total": 672000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 8532.074, "sample_time_ms": 8434.169, "load_time_ms": 1.433, "load_throughput": 2512436.879, "learn_time_ms": 95.643, "learn_throughput": 37640.144, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 1059, "training_iteration": 260, "trial_id": "5f82d_00000", "date": "2023-07-26_23-52-44", "timestamp": 1690404764, "time_this_iter_s": 17.370417833328247, "time_total_s": 3305.838922739029, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1278.00896859169, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 19.224999999999998, "ram_util_percent": 66.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1555.4560808454241, "policy_loss": -9.558408559907308e+18, "vf_loss": 311709493.35714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8428.5, "diff_num_grad_updates_vs_sampler_policy": 8427.5}}, "num_env_steps_sampled": 679200, "num_env_steps_trained": 679200, "num_agent_steps_sampled": 679200, "num_agent_steps_trained": 679200}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114172.26644750168, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056436756781773, "mean_inference_ms": 0.3662706465074029, "mean_action_processing_ms": 0.09021055938487882, "mean_env_wait_ms": 0.9766442670201186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003686189651489258, "StateBufferConnector_ms": 0.002568483352661133, "ViewRequirementAgentConnector_ms": 0.06541252136230469}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114172.26644750168, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114384.91957934554, -113038.12673235995, -114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056436756781773, "mean_inference_ms": 0.3662706465074029, "mean_action_processing_ms": 0.09021055938487882, "mean_env_wait_ms": 0.9766442670201186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003686189651489258, "StateBufferConnector_ms": 0.002568483352661133, "ViewRequirementAgentConnector_ms": 0.06541252136230469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 679200, "num_agent_steps_trained": 679200, "num_env_steps_sampled": 679200, "num_env_steps_trained": 679200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 416.5018539849246, "num_env_steps_trained_throughput_per_sec": 416.5018539849246, "timesteps_total": 679200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 679200, "timers": {"training_iteration_time_ms": 8551.36, "sample_time_ms": 8453.088, "load_time_ms": 1.43, "load_throughput": 2517925.293, "learn_time_ms": 96.012, "learn_throughput": 37495.184, "synch_weights_time_ms": 0.77}, "counters": {"num_env_steps_sampled": 679200, "num_env_steps_trained": 679200, "num_agent_steps_sampled": 679200, "num_agent_steps_trained": 679200}, "done": false, "episodes_total": 1061, "training_iteration": 261, "trial_id": "5f82d_00000", "date": "2023-07-26_23-53-01", "timestamp": 1690404781, "time_this_iter_s": 17.289585828781128, "time_total_s": 3323.12850856781, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1295.2985544204712, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 18.808, "ram_util_percent": 66.64}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1555.5392325265068, "policy_loss": -9.6759551851063e+18, "vf_loss": 311286626.21428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8540.5, "diff_num_grad_updates_vs_sampler_policy": 8539.5}}, "num_env_steps_sampled": 686400, "num_env_steps_trained": 686400, "num_agent_steps_sampled": 686400, "num_agent_steps_trained": 686400}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114186.90953290908, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056359563873195, "mean_inference_ms": 0.36623136869659967, "mean_action_processing_ms": 0.09020187535896962, "mean_env_wait_ms": 0.9764441638150834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036907196044921875, "StateBufferConnector_ms": 0.002567768096923828, "ViewRequirementAgentConnector_ms": 0.06542658805847168}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114186.90953290908, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114500.75972224286, -114302.23686890052, -114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056359563873195, "mean_inference_ms": 0.36623136869659967, "mean_action_processing_ms": 0.09020187535896962, "mean_env_wait_ms": 0.9764441638150834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036907196044921875, "StateBufferConnector_ms": 0.002567768096923828, "ViewRequirementAgentConnector_ms": 0.06542658805847168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 686400, "num_agent_steps_trained": 686400, "num_env_steps_sampled": 686400, "num_env_steps_trained": 686400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 418.30344983774614, "num_env_steps_trained_throughput_per_sec": 418.30344983774614, "timesteps_total": 686400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 686400, "timers": {"training_iteration_time_ms": 8578.37, "sample_time_ms": 8480.492, "load_time_ms": 1.401, "load_throughput": 2570432.971, "learn_time_ms": 95.646, "learn_throughput": 37638.915, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 686400, "num_env_steps_trained": 686400, "num_agent_steps_sampled": 686400, "num_agent_steps_trained": 686400}, "done": false, "episodes_total": 1063, "training_iteration": 262, "trial_id": "5f82d_00000", "date": "2023-07-26_23-53-18", "timestamp": 1690404798, "time_this_iter_s": 17.21561598777771, "time_total_s": 3340.3441245555878, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1312.514170408249, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 18.77916666666667, "ram_util_percent": 66.67083333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1555.4784131731305, "policy_loss": -9.961880709252813e+18, "vf_loss": 312101416.4285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8652.5, "diff_num_grad_updates_vs_sampler_policy": 8651.5}}, "num_env_steps_sampled": 693600, "num_env_steps_trained": 693600, "num_agent_steps_sampled": 693600, "num_agent_steps_trained": 693600}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114179.94562633497, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905638582074996, "mean_inference_ms": 0.3661950612895773, "mean_action_processing_ms": 0.09019369147978715, "mean_env_wait_ms": 0.9762512286563105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036873817443847656, "StateBufferConnector_ms": 0.002566814422607422, "ViewRequirementAgentConnector_ms": 0.06537508964538574}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114179.94562633497, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114092.04608327738, -113917.16934557623, -113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905638582074996, "mean_inference_ms": 0.3661950612895773, "mean_action_processing_ms": 0.09019369147978715, "mean_env_wait_ms": 0.9762512286563105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036873817443847656, "StateBufferConnector_ms": 0.002566814422607422, "ViewRequirementAgentConnector_ms": 0.06537508964538574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 693600, "num_agent_steps_trained": 693600, "num_env_steps_sampled": 693600, "num_env_steps_trained": 693600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.65823945250276, "num_env_steps_trained_throughput_per_sec": 419.65823945250276, "timesteps_total": 693600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 693600, "timers": {"training_iteration_time_ms": 8593.816, "sample_time_ms": 8496.108, "load_time_ms": 1.441, "load_throughput": 2498055.158, "learn_time_ms": 95.44, "learn_throughput": 37720.125, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 693600, "num_env_steps_trained": 693600, "num_agent_steps_sampled": 693600, "num_agent_steps_trained": 693600}, "done": false, "episodes_total": 1065, "training_iteration": 263, "trial_id": "5f82d_00000", "date": "2023-07-26_23-53-36", "timestamp": 1690404816, "time_this_iter_s": 17.15967106819153, "time_total_s": 3357.5037956237793, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1329.6738414764404, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 18.652, "ram_util_percent": 66.744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1555.5469316755023, "policy_loss": -7.674757960803319e+18, "vf_loss": 306489209.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8764.5, "diff_num_grad_updates_vs_sampler_policy": 8763.5}}, "num_env_steps_sampled": 700800, "num_env_steps_trained": 700800, "num_agent_steps_sampled": 700800, "num_agent_steps_trained": 700800}, "sampler_results": {"episode_reward_max": -113017.6215002925, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114173.1639357749, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056363965591294, "mean_inference_ms": 0.36616185513496674, "mean_action_processing_ms": 0.09018593501680967, "mean_env_wait_ms": 0.9760728535916273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036873817443847656, "StateBufferConnector_ms": 0.0025620460510253906, "ViewRequirementAgentConnector_ms": 0.06536221504211426}}, "episode_reward_max": -113017.6215002925, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114173.1639357749, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113017.6215002925, -113544.60637451442, -114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056363965591294, "mean_inference_ms": 0.36616185513496674, "mean_action_processing_ms": 0.09018593501680967, "mean_env_wait_ms": 0.9760728535916273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036873817443847656, "StateBufferConnector_ms": 0.0025620460510253906, "ViewRequirementAgentConnector_ms": 0.06536221504211426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 700800, "num_agent_steps_trained": 700800, "num_env_steps_sampled": 700800, "num_env_steps_trained": 700800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 427.4071289282383, "num_env_steps_trained_throughput_per_sec": 427.4071289282383, "timesteps_total": 700800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 700800, "timers": {"training_iteration_time_ms": 8586.916, "sample_time_ms": 8489.131, "load_time_ms": 1.432, "load_throughput": 2514486.994, "learn_time_ms": 95.516, "learn_throughput": 37690.006, "synch_weights_time_ms": 0.778}, "counters": {"num_env_steps_sampled": 700800, "num_env_steps_trained": 700800, "num_agent_steps_sampled": 700800, "num_agent_steps_trained": 700800}, "done": false, "episodes_total": 1067, "training_iteration": 264, "trial_id": "5f82d_00000", "date": "2023-07-26_23-53-52", "timestamp": 1690404832, "time_this_iter_s": 16.848746061325073, "time_total_s": 3374.3525416851044, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1346.5225875377655, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 18.6, "ram_util_percent": 66.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1555.6481192452568, "policy_loss": -1.0412562716755941e+19, "vf_loss": 315084643.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8876.5, "diff_num_grad_updates_vs_sampler_policy": 8875.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": -113131.0784201875, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114200.20739502319, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056287762652735, "mean_inference_ms": 0.366130029268197, "mean_action_processing_ms": 0.0901785546244012, "mean_env_wait_ms": 0.975917053189773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036859512329101562, "StateBufferConnector_ms": 0.002563953399658203, "ViewRequirementAgentConnector_ms": 0.0653526782989502}}, "episode_reward_max": -113131.0784201875, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114200.20739502319, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114624.30216319776, -113404.95607065845, -114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056287762652735, "mean_inference_ms": 0.366130029268197, "mean_action_processing_ms": 0.0901785546244012, "mean_env_wait_ms": 0.975917053189773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036859512329101562, "StateBufferConnector_ms": 0.002563953399658203, "ViewRequirementAgentConnector_ms": 0.0653526782989502}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 416.3216912380512, "num_env_steps_trained_throughput_per_sec": 416.3216912380512, "timesteps_total": 708000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 8579.596, "sample_time_ms": 8481.941, "load_time_ms": 1.455, "load_throughput": 2473583.277, "learn_time_ms": 95.357, "learn_throughput": 37752.927, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 1069, "training_iteration": 265, "trial_id": "5f82d_00000", "date": "2023-07-26_23-54-10", "timestamp": 1690404850, "time_this_iter_s": 17.2971510887146, "time_total_s": 3391.649692773819, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1363.81973862648, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 18.343999999999998, "ram_util_percent": 66.756}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1555.6148594447545, "policy_loss": -9.850320983813353e+18, "vf_loss": 312847077.14285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8988.5, "diff_num_grad_updates_vs_sampler_policy": 8987.5}}, "num_env_steps_sampled": 715200, "num_env_steps_trained": 715200, "num_agent_steps_sampled": 715200, "num_agent_steps_trained": 715200}, "sampler_results": {"episode_reward_max": -113131.0784201875, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114201.65382408789, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056219069675885, "mean_inference_ms": 0.3661009478177986, "mean_action_processing_ms": 0.09017155085798784, "mean_env_wait_ms": 0.9757832977646304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036852359771728516, "StateBufferConnector_ms": 0.002557992935180664, "ViewRequirementAgentConnector_ms": 0.06528615951538086}}, "episode_reward_max": -113131.0784201875, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114201.65382408789, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114021.48239026769, -113847.09562568383, -114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056219069675885, "mean_inference_ms": 0.3661009478177986, "mean_action_processing_ms": 0.09017155085798784, "mean_env_wait_ms": 0.9757832977646304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036852359771728516, "StateBufferConnector_ms": 0.002557992935180664, "ViewRequirementAgentConnector_ms": 0.06528615951538086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 715200, "num_agent_steps_trained": 715200, "num_env_steps_sampled": 715200, "num_env_steps_trained": 715200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 415.9304091519103, "num_env_steps_trained_throughput_per_sec": 415.9304091519103, "timesteps_total": 715200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 715200, "timers": {"training_iteration_time_ms": 8581.971, "sample_time_ms": 8484.209, "load_time_ms": 1.456, "load_throughput": 2472044.4, "learn_time_ms": 95.462, "learn_throughput": 37711.515, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 715200, "num_env_steps_trained": 715200, "num_agent_steps_sampled": 715200, "num_agent_steps_trained": 715200}, "done": false, "episodes_total": 1071, "training_iteration": 266, "trial_id": "5f82d_00000", "date": "2023-07-26_23-54-27", "timestamp": 1690404867, "time_this_iter_s": 17.313612937927246, "time_total_s": 3408.963305711746, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1381.1333515644073, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 18.26, "ram_util_percent": 66.86399999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1555.584477015904, "policy_loss": -9.353498167309277e+18, "vf_loss": 312482002.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9100.5, "diff_num_grad_updates_vs_sampler_policy": 9099.5}}, "num_env_steps_sampled": 722400, "num_env_steps_trained": 722400, "num_agent_steps_sampled": 722400, "num_agent_steps_trained": 722400}, "sampler_results": {"episode_reward_max": -113131.0784201875, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114206.11765868649, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056131043801947, "mean_inference_ms": 0.36607439448403234, "mean_action_processing_ms": 0.09016488660071378, "mean_env_wait_ms": 0.9756668919735466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00368499755859375, "StateBufferConnector_ms": 0.0025551319122314453, "ViewRequirementAgentConnector_ms": 0.06530451774597168}}, "episode_reward_max": -113131.0784201875, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114206.11765868649, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114369.13241410762, -114771.27160528203, -114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056131043801947, "mean_inference_ms": 0.36607439448403234, "mean_action_processing_ms": 0.09016488660071378, "mean_env_wait_ms": 0.9756668919735466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00368499755859375, "StateBufferConnector_ms": 0.0025551319122314453, "ViewRequirementAgentConnector_ms": 0.06530451774597168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 722400, "num_agent_steps_trained": 722400, "num_env_steps_sampled": 722400, "num_env_steps_trained": 722400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.71490102545584, "num_env_steps_trained_throughput_per_sec": 420.71490102545584, "timesteps_total": 722400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 722400, "timers": {"training_iteration_time_ms": 8572.106, "sample_time_ms": 8474.103, "load_time_ms": 1.457, "load_throughput": 2470588.281, "learn_time_ms": 95.704, "learn_throughput": 37616.055, "synch_weights_time_ms": 0.783}, "counters": {"num_env_steps_sampled": 722400, "num_env_steps_trained": 722400, "num_agent_steps_sampled": 722400, "num_agent_steps_trained": 722400}, "done": false, "episodes_total": 1073, "training_iteration": 267, "trial_id": "5f82d_00000", "date": "2023-07-26_23-54-44", "timestamp": 1690404884, "time_this_iter_s": 17.11665940284729, "time_total_s": 3426.0799651145935, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1398.2500109672546, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 18.745833333333334, "ram_util_percent": 66.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1555.7562691824776, "policy_loss": -8.109574790749113e+18, "vf_loss": 304338021.5714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9212.5, "diff_num_grad_updates_vs_sampler_policy": 9211.5}}, "num_env_steps_sampled": 729600, "num_env_steps_trained": 729600, "num_agent_steps_sampled": 729600, "num_agent_steps_trained": 729600}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114188.22951218447, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056080219491643, "mean_inference_ms": 0.3660490676150385, "mean_action_processing_ms": 0.09015849132072443, "mean_env_wait_ms": 0.975546520209093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003686189651489258, "StateBufferConnector_ms": 0.0025589466094970703, "ViewRequirementAgentConnector_ms": 0.06533360481262207}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114188.22951218447, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114524.04450334744, -114625.3443272653, -114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056080219491643, "mean_inference_ms": 0.3660490676150385, "mean_action_processing_ms": 0.09015849132072443, "mean_env_wait_ms": 0.975546520209093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003686189651489258, "StateBufferConnector_ms": 0.0025589466094970703, "ViewRequirementAgentConnector_ms": 0.06533360481262207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 729600, "num_agent_steps_trained": 729600, "num_env_steps_sampled": 729600, "num_env_steps_trained": 729600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.5473386859383, "num_env_steps_trained_throughput_per_sec": 420.5473386859383, "timesteps_total": 729600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 729600, "timers": {"training_iteration_time_ms": 8568.479, "sample_time_ms": 8470.312, "load_time_ms": 1.407, "load_throughput": 2557979.027, "learn_time_ms": 95.92, "learn_throughput": 37531.242, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 729600, "num_env_steps_trained": 729600, "num_agent_steps_sampled": 729600, "num_agent_steps_trained": 729600}, "done": false, "episodes_total": 1075, "training_iteration": 268, "trial_id": "5f82d_00000", "date": "2023-07-26_23-55-01", "timestamp": 1690404901, "time_this_iter_s": 17.123472929000854, "time_total_s": 3443.2034380435944, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1415.3734838962555, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 18.025000000000002, "ram_util_percent": 66.67083333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1556.0785653250557, "policy_loss": -9.816007599204088e+18, "vf_loss": 306485199.64285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9324.5, "diff_num_grad_updates_vs_sampler_policy": 9323.5}}, "num_env_steps_sampled": 736800, "num_env_steps_trained": 736800, "num_agent_steps_sampled": 736800, "num_agent_steps_trained": 736800}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114180.64299568892, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056010904591787, "mean_inference_ms": 0.3660254229162642, "mean_action_processing_ms": 0.09015240209059815, "mean_env_wait_ms": 0.9754294324286316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036857128143310547, "StateBufferConnector_ms": 0.0025560855865478516, "ViewRequirementAgentConnector_ms": 0.06529450416564941}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114180.64299568892, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114885.88521435864, -113783.24901719733, -114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9056010904591787, "mean_inference_ms": 0.3660254229162642, "mean_action_processing_ms": 0.09015240209059815, "mean_env_wait_ms": 0.9754294324286316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036857128143310547, "StateBufferConnector_ms": 0.0025560855865478516, "ViewRequirementAgentConnector_ms": 0.06529450416564941}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736800, "num_agent_steps_trained": 736800, "num_env_steps_sampled": 736800, "num_env_steps_trained": 736800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 417.9047516406459, "num_env_steps_trained_throughput_per_sec": 417.9047516406459, "timesteps_total": 736800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 736800, "timers": {"training_iteration_time_ms": 8606.782, "sample_time_ms": 8508.744, "load_time_ms": 1.411, "load_throughput": 2551107.387, "learn_time_ms": 95.792, "learn_throughput": 37581.62, "synch_weights_time_ms": 0.778}, "counters": {"num_env_steps_sampled": 736800, "num_env_steps_trained": 736800, "num_agent_steps_sampled": 736800, "num_agent_steps_trained": 736800}, "done": false, "episodes_total": 1077, "training_iteration": 269, "trial_id": "5f82d_00000", "date": "2023-07-26_23-55-19", "timestamp": 1690404919, "time_this_iter_s": 17.231642246246338, "time_total_s": 3460.4350802898407, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1432.6051261425018, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 18.3375, "ram_util_percent": 66.72916666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1556.1221182686943, "policy_loss": -1.060086559127298e+19, "vf_loss": 312440298.78571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9436.5, "diff_num_grad_updates_vs_sampler_policy": 9435.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114175.83776015355, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055930604619528, "mean_inference_ms": 0.36600367964440444, "mean_action_processing_ms": 0.09014670598227947, "mean_env_wait_ms": 0.9753107682214991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003684520721435547, "StateBufferConnector_ms": 0.002562284469604492, "ViewRequirementAgentConnector_ms": 0.06532430648803711}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114175.83776015355, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114279.59832731939, -113765.16723457491, -113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055930604619528, "mean_inference_ms": 0.36600367964440444, "mean_action_processing_ms": 0.09014670598227947, "mean_env_wait_ms": 0.9753107682214991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003684520721435547, "StateBufferConnector_ms": 0.002562284469604492, "ViewRequirementAgentConnector_ms": 0.06532430648803711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.64520588976484, "num_env_steps_trained_throughput_per_sec": 419.64520588976484, "timesteps_total": 744000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 8593.085, "sample_time_ms": 8494.89, "load_time_ms": 1.389, "load_throughput": 2591876.41, "learn_time_ms": 95.975, "learn_throughput": 37509.64, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "episodes_total": 1079, "training_iteration": 270, "trial_id": "5f82d_00000", "date": "2023-07-26_23-55-36", "timestamp": 1690404936, "time_this_iter_s": 17.160187005996704, "time_total_s": 3477.5952672958374, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1449.7653131484985, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 19.432000000000002, "ram_util_percent": 66.72800000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1556.2595912388392, "policy_loss": -8.571490234416835e+18, "vf_loss": 307307083.64285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9548.5, "diff_num_grad_updates_vs_sampler_policy": 9547.5}}, "num_env_steps_sampled": 751200, "num_env_steps_trained": 751200, "num_agent_steps_sampled": 751200, "num_agent_steps_trained": 751200}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114178.3105603712, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055823679168011, "mean_inference_ms": 0.36598269819602564, "mean_action_processing_ms": 0.09014123326737795, "mean_env_wait_ms": 0.9752076764135816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003678560256958008, "StateBufferConnector_ms": 0.002566814422607422, "ViewRequirementAgentConnector_ms": 0.06534600257873535}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114178.3105603712, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113810.4652826786, -113716.63653570862, -114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055823679168011, "mean_inference_ms": 0.36598269819602564, "mean_action_processing_ms": 0.09014123326737795, "mean_env_wait_ms": 0.9752076764135816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003678560256958008, "StateBufferConnector_ms": 0.002566814422607422, "ViewRequirementAgentConnector_ms": 0.06534600257873535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 751200, "num_agent_steps_trained": 751200, "num_env_steps_sampled": 751200, "num_env_steps_trained": 751200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 425.8136722209246, "num_env_steps_trained_throughput_per_sec": 425.8136722209246, "timesteps_total": 751200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 751200, "timers": {"training_iteration_time_ms": 8552.907, "sample_time_ms": 8454.533, "load_time_ms": 1.388, "load_throughput": 2592989.147, "learn_time_ms": 96.145, "learn_throughput": 37443.441, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 751200, "num_env_steps_trained": 751200, "num_agent_steps_sampled": 751200, "num_agent_steps_trained": 751200}, "done": false, "episodes_total": 1081, "training_iteration": 271, "trial_id": "5f82d_00000", "date": "2023-07-26_23-55-53", "timestamp": 1690404953, "time_this_iter_s": 16.911870002746582, "time_total_s": 3494.507137298584, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1466.6771831512451, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 19.083333333333332, "ram_util_percent": 66.80416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1556.6007973807198, "policy_loss": -1.0077314031667128e+19, "vf_loss": 312693325.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9660.5, "diff_num_grad_updates_vs_sampler_policy": 9659.5}}, "num_env_steps_sampled": 758400, "num_env_steps_trained": 758400, "num_agent_steps_sampled": 758400, "num_agent_steps_trained": 758400}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114196.87046861686, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055723797926915, "mean_inference_ms": 0.36596378690388237, "mean_action_processing_ms": 0.09013598148208103, "mean_env_wait_ms": 0.9751205318420947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036809444427490234, "StateBufferConnector_ms": 0.0025725364685058594, "ViewRequirementAgentConnector_ms": 0.06544303894042969}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114196.87046861686, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114413.54661394573, -114127.51548215258, -114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055723797926915, "mean_inference_ms": 0.36596378690388237, "mean_action_processing_ms": 0.09013598148208103, "mean_env_wait_ms": 0.9751205318420947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036809444427490234, "StateBufferConnector_ms": 0.0025725364685058594, "ViewRequirementAgentConnector_ms": 0.06544303894042969}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 758400, "num_agent_steps_trained": 758400, "num_env_steps_sampled": 758400, "num_env_steps_trained": 758400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 415.7359051378942, "num_env_steps_trained_throughput_per_sec": 415.7359051378942, "timesteps_total": 758400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 758400, "timers": {"training_iteration_time_ms": 8573.402, "sample_time_ms": 8475.006, "load_time_ms": 1.426, "load_throughput": 2525336.901, "learn_time_ms": 96.126, "learn_throughput": 37450.713, "synch_weights_time_ms": 0.785}, "counters": {"num_env_steps_sampled": 758400, "num_env_steps_trained": 758400, "num_agent_steps_sampled": 758400, "num_agent_steps_trained": 758400}, "done": false, "episodes_total": 1083, "training_iteration": 272, "trial_id": "5f82d_00000", "date": "2023-07-26_23-56-10", "timestamp": 1690404970, "time_this_iter_s": 17.32160997390747, "time_total_s": 3511.8287472724915, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1483.9987931251526, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 18.658333333333335, "ram_util_percent": 66.7375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1557.0819462367467, "policy_loss": -9.974451883194374e+18, "vf_loss": 312142371.9285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9772.5, "diff_num_grad_updates_vs_sampler_policy": 9771.5}}, "num_env_steps_sampled": 765600, "num_env_steps_trained": 765600, "num_agent_steps_sampled": 765600, "num_agent_steps_trained": 765600}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114195.19041129899, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055653645051452, "mean_inference_ms": 0.36594596756858555, "mean_action_processing_ms": 0.0901310050684453, "mean_env_wait_ms": 0.9750379320674887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003679990768432617, "StateBufferConnector_ms": 0.0025777816772460938, "ViewRequirementAgentConnector_ms": 0.06544733047485352}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114195.19041129899, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114795.49891518934, -114226.70592138809, -113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055653645051452, "mean_inference_ms": 0.36594596756858555, "mean_action_processing_ms": 0.0901310050684453, "mean_env_wait_ms": 0.9750379320674887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003679990768432617, "StateBufferConnector_ms": 0.0025777816772460938, "ViewRequirementAgentConnector_ms": 0.06544733047485352}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 765600, "num_agent_steps_trained": 765600, "num_env_steps_sampled": 765600, "num_env_steps_trained": 765600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 425.1955975801167, "num_env_steps_trained_throughput_per_sec": 425.1955975801167, "timesteps_total": 765600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 765600, "timers": {"training_iteration_time_ms": 8554.686, "sample_time_ms": 8456.091, "load_time_ms": 1.437, "load_throughput": 2505059.128, "learn_time_ms": 96.311, "learn_throughput": 37378.835, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 765600, "num_env_steps_trained": 765600, "num_agent_steps_sampled": 765600, "num_agent_steps_trained": 765600}, "done": false, "episodes_total": 1085, "training_iteration": 273, "trial_id": "5f82d_00000", "date": "2023-07-26_23-56-27", "timestamp": 1690404987, "time_this_iter_s": 16.93626308441162, "time_total_s": 3528.765010356903, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1500.9350562095642, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 18.279166666666665, "ram_util_percent": 66.70833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1557.6147199358259, "policy_loss": -1.0187984947938095e+19, "vf_loss": 307332213.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9884.5, "diff_num_grad_updates_vs_sampler_policy": 9883.5}}, "num_env_steps_sampled": 772800, "num_env_steps_trained": 772800, "num_agent_steps_sampled": 772800, "num_agent_steps_trained": 772800}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114180.77093830986, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055586037703282, "mean_inference_ms": 0.36592901922117343, "mean_action_processing_ms": 0.09012617793262358, "mean_env_wait_ms": 0.974957114307312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003682374954223633, "StateBufferConnector_ms": 0.002573728561401367, "ViewRequirementAgentConnector_ms": 0.06547737121582031}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114180.77093830986, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113915.68841757775, -113601.8181083939, -113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055586037703282, "mean_inference_ms": 0.36592901922117343, "mean_action_processing_ms": 0.09012617793262358, "mean_env_wait_ms": 0.974957114307312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003682374954223633, "StateBufferConnector_ms": 0.002573728561401367, "ViewRequirementAgentConnector_ms": 0.06547737121582031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 772800, "num_agent_steps_trained": 772800, "num_env_steps_sampled": 772800, "num_env_steps_trained": 772800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.985843291527, "num_env_steps_trained_throughput_per_sec": 420.985843291527, "timesteps_total": 772800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 772800, "timers": {"training_iteration_time_ms": 8542.077, "sample_time_ms": 8443.145, "load_time_ms": 1.428, "load_throughput": 2521036.231, "learn_time_ms": 96.651, "learn_throughput": 37247.349, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 772800, "num_env_steps_trained": 772800, "num_agent_steps_sampled": 772800, "num_agent_steps_trained": 772800}, "done": false, "episodes_total": 1087, "training_iteration": 274, "trial_id": "5f82d_00000", "date": "2023-07-26_23-56-44", "timestamp": 1690405004, "time_this_iter_s": 17.105648279190063, "time_total_s": 3545.870658636093, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1518.0407044887543, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 18.992, "ram_util_percent": 66.708}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1558.0948682512555, "policy_loss": -1.0772065023516301e+19, "vf_loss": 313857189.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9996.5, "diff_num_grad_updates_vs_sampler_policy": 9995.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114193.14403447989, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055543302992933, "mean_inference_ms": 0.36591240568010186, "mean_action_processing_ms": 0.09012149850004897, "mean_env_wait_ms": 0.9748972760378778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036809444427490234, "StateBufferConnector_ms": 0.002582550048828125, "ViewRequirementAgentConnector_ms": 0.06550359725952148}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114193.14403447989, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113730.33700997531, -114411.11685152135, -114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055543302992933, "mean_inference_ms": 0.36591240568010186, "mean_action_processing_ms": 0.09012149850004897, "mean_env_wait_ms": 0.9748972760378778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036809444427490234, "StateBufferConnector_ms": 0.002582550048828125, "ViewRequirementAgentConnector_ms": 0.06550359725952148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 418.64011212832975, "num_env_steps_trained_throughput_per_sec": 418.64011212832975, "timesteps_total": 780000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 8546.197, "sample_time_ms": 8447.904, "load_time_ms": 1.448, "load_throughput": 2486045.475, "learn_time_ms": 95.997, "learn_throughput": 37501.2, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 1089, "training_iteration": 275, "trial_id": "5f82d_00000", "date": "2023-07-26_23-57-01", "timestamp": 1690405021, "time_this_iter_s": 17.20143413543701, "time_total_s": 3563.07209277153, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1535.2421386241913, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 18.633333333333333, "ram_util_percent": 66.60833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1558.6259198869977, "policy_loss": -1.0694579783945763e+19, "vf_loss": 311323870.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10108.5, "diff_num_grad_updates_vs_sampler_policy": 10107.5}}, "num_env_steps_sampled": 787200, "num_env_steps_trained": 787200, "num_agent_steps_sampled": 787200, "num_agent_steps_trained": 787200}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114191.87475450536, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905553462398357, "mean_inference_ms": 0.365897328414871, "mean_action_processing_ms": 0.09011706680287307, "mean_env_wait_ms": 0.9748441757724612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003682851791381836, "StateBufferConnector_ms": 0.002584695816040039, "ViewRequirementAgentConnector_ms": 0.06548786163330078}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114191.87475450536, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114855.82637691949, -114596.16482638974, -115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905553462398357, "mean_inference_ms": 0.365897328414871, "mean_action_processing_ms": 0.09011706680287307, "mean_env_wait_ms": 0.9748441757724612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003682851791381836, "StateBufferConnector_ms": 0.002584695816040039, "ViewRequirementAgentConnector_ms": 0.06548786163330078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 787200, "num_agent_steps_trained": 787200, "num_env_steps_sampled": 787200, "num_env_steps_trained": 787200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.0320867220104, "num_env_steps_trained_throughput_per_sec": 419.0320867220104, "timesteps_total": 787200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 787200, "timers": {"training_iteration_time_ms": 8573.561, "sample_time_ms": 8475.85, "load_time_ms": 1.451, "load_throughput": 2480450.504, "learn_time_ms": 95.418, "learn_throughput": 37728.74, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 787200, "num_env_steps_trained": 787200, "num_agent_steps_sampled": 787200, "num_agent_steps_trained": 787200}, "done": false, "episodes_total": 1091, "training_iteration": 276, "trial_id": "5f82d_00000", "date": "2023-07-26_23-57-19", "timestamp": 1690405039, "time_this_iter_s": 17.185389041900635, "time_total_s": 3580.257481813431, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1552.427527666092, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 19.087500000000002, "ram_util_percent": 66.77083333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.73325925925926e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1559.263695853097, "policy_loss": -8.690972023730957e+18, "vf_loss": 310126986.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10220.5, "diff_num_grad_updates_vs_sampler_policy": 10219.5}}, "num_env_steps_sampled": 794400, "num_env_steps_trained": 794400, "num_agent_steps_sampled": 794400, "num_agent_steps_trained": 794400}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114173.66708791068, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055530469636943, "mean_inference_ms": 0.36588328193915354, "mean_action_processing_ms": 0.0901127177859436, "mean_env_wait_ms": 0.9747596357630202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003682374954223633, "StateBufferConnector_ms": 0.0025870800018310547, "ViewRequirementAgentConnector_ms": 0.0654599666595459}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114173.66708791068, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115495.16675889051, -114117.95463226366, -113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055530469636943, "mean_inference_ms": 0.36588328193915354, "mean_action_processing_ms": 0.0901127177859436, "mean_env_wait_ms": 0.9747596357630202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003682374954223633, "StateBufferConnector_ms": 0.0025870800018310547, "ViewRequirementAgentConnector_ms": 0.0654599666595459}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 794400, "num_agent_steps_trained": 794400, "num_env_steps_sampled": 794400, "num_env_steps_trained": 794400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 430.76754363129515, "num_env_steps_trained_throughput_per_sec": 430.76754363129515, "timesteps_total": 794400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 794400, "timers": {"training_iteration_time_ms": 8513.128, "sample_time_ms": 8415.14, "load_time_ms": 1.418, "load_throughput": 2539010.325, "learn_time_ms": 95.734, "learn_throughput": 37604.27, "synch_weights_time_ms": 0.777}, "counters": {"num_env_steps_sampled": 794400, "num_env_steps_trained": 794400, "num_agent_steps_sampled": 794400, "num_agent_steps_trained": 794400}, "done": false, "episodes_total": 1093, "training_iteration": 277, "trial_id": "5f82d_00000", "date": "2023-07-26_23-57-35", "timestamp": 1690405055, "time_this_iter_s": 16.717237949371338, "time_total_s": 3596.974719762802, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1569.1447656154633, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 19.587500000000002, "ram_util_percent": 66.80416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.199925925925927e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1559.543932233538, "policy_loss": -1.039960065182481e+19, "vf_loss": 309820814.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10332.5, "diff_num_grad_updates_vs_sampler_policy": 10331.5}}, "num_env_steps_sampled": 801600, "num_env_steps_trained": 801600, "num_agent_steps_sampled": 801600, "num_agent_steps_trained": 801600}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114163.81514575923, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905552139341334, "mean_inference_ms": 0.3658698787725542, "mean_action_processing_ms": 0.09010845473164868, "mean_env_wait_ms": 0.9746776097959434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036821365356445312, "StateBufferConnector_ms": 0.002588033676147461, "ViewRequirementAgentConnector_ms": 0.06546759605407715}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114163.81514575923, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113525.75868588641, -114757.82476918185, -114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905552139341334, "mean_inference_ms": 0.3658698787725542, "mean_action_processing_ms": 0.09010845473164868, "mean_env_wait_ms": 0.9746776097959434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036821365356445312, "StateBufferConnector_ms": 0.002588033676147461, "ViewRequirementAgentConnector_ms": 0.06546759605407715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 801600, "num_agent_steps_trained": 801600, "num_env_steps_sampled": 801600, "num_env_steps_trained": 801600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.89805562753776, "num_env_steps_trained_throughput_per_sec": 419.89805562753776, "timesteps_total": 801600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 801600, "timers": {"training_iteration_time_ms": 8534.491, "sample_time_ms": 8436.99, "load_time_ms": 1.407, "load_throughput": 2558282.403, "learn_time_ms": 95.245, "learn_throughput": 37797.211, "synch_weights_time_ms": 0.79}, "counters": {"num_env_steps_sampled": 801600, "num_env_steps_trained": 801600, "num_agent_steps_sampled": 801600, "num_agent_steps_trained": 801600}, "done": false, "episodes_total": 1095, "training_iteration": 278, "trial_id": "5f82d_00000", "date": "2023-07-26_23-57-53", "timestamp": 1690405073, "time_this_iter_s": 17.1498920917511, "time_total_s": 3614.124611854553, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1586.2946577072144, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 18.291666666666668, "ram_util_percent": 66.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.6665925925925927e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1559.8796691894531, "policy_loss": -1.020447747492092e+19, "vf_loss": 309042025.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10444.5, "diff_num_grad_updates_vs_sampler_policy": 10443.5}}, "num_env_steps_sampled": 808800, "num_env_steps_trained": 808800, "num_agent_steps_sampled": 808800, "num_agent_steps_trained": 808800}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114156.96840211256, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055530108874571, "mean_inference_ms": 0.36585779545155567, "mean_action_processing_ms": 0.09010439783197484, "mean_env_wait_ms": 0.9745925397983257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036804676055908203, "StateBufferConnector_ms": 0.002585887908935547, "ViewRequirementAgentConnector_ms": 0.06546974182128906}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114156.96840211256, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114602.79144345314, -113991.74439691279, -113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055530108874571, "mean_inference_ms": 0.36585779545155567, "mean_action_processing_ms": 0.09010439783197484, "mean_env_wait_ms": 0.9745925397983257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036804676055908203, "StateBufferConnector_ms": 0.002585887908935547, "ViewRequirementAgentConnector_ms": 0.06546974182128906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 808800, "num_agent_steps_trained": 808800, "num_env_steps_sampled": 808800, "num_env_steps_trained": 808800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 425.3626732601028, "num_env_steps_trained_throughput_per_sec": 425.3626732601028, "timesteps_total": 808800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 808800, "timers": {"training_iteration_time_ms": 8516.893, "sample_time_ms": 8419.278, "load_time_ms": 1.416, "load_throughput": 2541617.331, "learn_time_ms": 95.353, "learn_throughput": 37754.635, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 808800, "num_env_steps_trained": 808800, "num_agent_steps_sampled": 808800, "num_agent_steps_trained": 808800}, "done": false, "episodes_total": 1097, "training_iteration": 279, "trial_id": "5f82d_00000", "date": "2023-07-26_23-58-10", "timestamp": 1690405090, "time_this_iter_s": 16.92986297607422, "time_total_s": 3631.0544748306274, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1603.2245206832886, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 19.01666666666667, "ram_util_percent": 66.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.1332592592592593e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.3058864048548, "policy_loss": -1.2025354181153569e+19, "vf_loss": 311565859.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10556.5, "diff_num_grad_updates_vs_sampler_policy": 10555.5}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114144.60448368637, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055475713506672, "mean_inference_ms": 0.36584690603325526, "mean_action_processing_ms": 0.09010051757051374, "mean_env_wait_ms": 0.974511152921434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036742687225341797, "StateBufferConnector_ms": 0.0025866031646728516, "ViewRequirementAgentConnector_ms": 0.06546425819396973}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114144.60448368637, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113656.76984127212, -115133.36953099328, -114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055475713506672, "mean_inference_ms": 0.36584690603325526, "mean_action_processing_ms": 0.09010051757051374, "mean_env_wait_ms": 0.974511152921434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036742687225341797, "StateBufferConnector_ms": 0.0025866031646728516, "ViewRequirementAgentConnector_ms": 0.06546425819396973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.3651597297198, "num_env_steps_trained_throughput_per_sec": 424.3651597297198, "timesteps_total": 816000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 8493.691, "sample_time_ms": 8395.513, "load_time_ms": 1.414, "load_throughput": 2545731.02, "learn_time_ms": 95.911, "learn_throughput": 37534.62, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "episodes_total": 1099, "training_iteration": 280, "trial_id": "5f82d_00000", "date": "2023-07-26_23-58-27", "timestamp": 1690405107, "time_this_iter_s": 16.969395875930786, "time_total_s": 3648.0238707065582, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1620.1939165592194, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 19.15416666666667, "ram_util_percent": 66.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5999259259259254e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.4434727260045, "policy_loss": -1.0883400757142804e+19, "vf_loss": 313158199.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10668.5, "diff_num_grad_updates_vs_sampler_policy": 10667.5}}, "num_env_steps_sampled": 823200, "num_env_steps_trained": 823200, "num_agent_steps_sampled": 823200, "num_agent_steps_trained": 823200}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114138.59803784241, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055438061253934, "mean_inference_ms": 0.3658367092996045, "mean_action_processing_ms": 0.09009684260331557, "mean_env_wait_ms": 0.974420812868364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036759376525878906, "StateBufferConnector_ms": 0.002588033676147461, "ViewRequirementAgentConnector_ms": 0.06545805931091309}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114138.59803784241, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114315.86961477304, -113737.26958951511, -113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055438061253934, "mean_inference_ms": 0.3658367092996045, "mean_action_processing_ms": 0.09009684260331557, "mean_env_wait_ms": 0.974420812868364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036759376525878906, "StateBufferConnector_ms": 0.002588033676147461, "ViewRequirementAgentConnector_ms": 0.06545805931091309}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 823200, "num_agent_steps_trained": 823200, "num_env_steps_sampled": 823200, "num_env_steps_trained": 823200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 428.0944064828705, "num_env_steps_trained_throughput_per_sec": 428.0944064828705, "timesteps_total": 823200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 823200, "timers": {"training_iteration_time_ms": 8457.317, "sample_time_ms": 8358.448, "load_time_ms": 1.407, "load_throughput": 2558369.095, "learn_time_ms": 96.601, "learn_throughput": 37266.581, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 823200, "num_env_steps_trained": 823200, "num_agent_steps_sampled": 823200, "num_agent_steps_trained": 823200}, "done": false, "episodes_total": 1101, "training_iteration": 281, "trial_id": "5f82d_00000", "date": "2023-07-26_23-58-43", "timestamp": 1690405123, "time_this_iter_s": 16.822345972061157, "time_total_s": 3664.8462166786194, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1637.0162625312805, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 22.662499999999998, "ram_util_percent": 66.7375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0665925925925928e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.5700988769531, "policy_loss": -1.10061721281283e+19, "vf_loss": 312438160.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10780.5, "diff_num_grad_updates_vs_sampler_policy": 10779.5}}, "num_env_steps_sampled": 830400, "num_env_steps_trained": 830400, "num_agent_steps_sampled": 830400, "num_agent_steps_trained": 830400}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114139.73646243587, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055381489980172, "mean_inference_ms": 0.3658267951940997, "mean_action_processing_ms": 0.09009326702717516, "mean_env_wait_ms": 0.9743383377399565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036687850952148438, "StateBufferConnector_ms": 0.002583026885986328, "ViewRequirementAgentConnector_ms": 0.06532883644104004}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114139.73646243587, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113709.11926889232, -115129.82817624313, -113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055381489980172, "mean_inference_ms": 0.3658267951940997, "mean_action_processing_ms": 0.09009326702717516, "mean_env_wait_ms": 0.9743383377399565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036687850952148438, "StateBufferConnector_ms": 0.002583026885986328, "ViewRequirementAgentConnector_ms": 0.06532883644104004}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 830400, "num_agent_steps_trained": 830400, "num_env_steps_sampled": 830400, "num_env_steps_trained": 830400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.5685170568147, "num_env_steps_trained_throughput_per_sec": 422.5685170568147, "timesteps_total": 830400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 830400, "timers": {"training_iteration_time_ms": 8489.748, "sample_time_ms": 8391.123, "load_time_ms": 1.44, "load_throughput": 2499957.681, "learn_time_ms": 96.326, "learn_throughput": 37373.182, "synch_weights_time_ms": 0.799}, "counters": {"num_env_steps_sampled": 830400, "num_env_steps_trained": 830400, "num_agent_steps_sampled": 830400, "num_agent_steps_trained": 830400}, "done": false, "episodes_total": 1103, "training_iteration": 282, "trial_id": "5f82d_00000", "date": "2023-07-26_23-59-00", "timestamp": 1690405140, "time_this_iter_s": 17.04155421257019, "time_total_s": 3681.8877708911896, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1654.0578167438507, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 18.866666666666667, "ram_util_percent": 66.50416666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.533259259259259e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.5881761823382, "policy_loss": -1.0277944837699015e+19, "vf_loss": 308203989.9285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10892.5, "diff_num_grad_updates_vs_sampler_policy": 10891.5}}, "num_env_steps_sampled": 837600, "num_env_steps_trained": 837600, "num_agent_steps_sampled": 837600, "num_agent_steps_trained": 837600}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114127.0297383616, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055298286699334, "mean_inference_ms": 0.36581739099613036, "mean_action_processing_ms": 0.09008986552850347, "mean_env_wait_ms": 0.974250140519006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003668069839477539, "StateBufferConnector_ms": 0.002582073211669922, "ViewRequirementAgentConnector_ms": 0.06541657447814941}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114127.0297383616, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113368.76441884588, -114228.48674120971, -114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055298286699334, "mean_inference_ms": 0.36581739099613036, "mean_action_processing_ms": 0.09008986552850347, "mean_env_wait_ms": 0.974250140519006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003668069839477539, "StateBufferConnector_ms": 0.002582073211669922, "ViewRequirementAgentConnector_ms": 0.06541657447814941}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 837600, "num_agent_steps_trained": 837600, "num_env_steps_sampled": 837600, "num_env_steps_trained": 837600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 427.1417260280355, "num_env_steps_trained_throughput_per_sec": 427.1417260280355, "timesteps_total": 837600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 837600, "timers": {"training_iteration_time_ms": 8460.67, "sample_time_ms": 8362.083, "load_time_ms": 1.441, "load_throughput": 2498303.149, "learn_time_ms": 96.287, "learn_throughput": 37388.081, "synch_weights_time_ms": 0.8}, "counters": {"num_env_steps_sampled": 837600, "num_env_steps_trained": 837600, "num_agent_steps_sampled": 837600, "num_agent_steps_trained": 837600}, "done": false, "episodes_total": 1105, "training_iteration": 283, "trial_id": "5f82d_00000", "date": "2023-07-26_23-59-17", "timestamp": 1690405157, "time_this_iter_s": 16.85937786102295, "time_total_s": 3698.7471487522125, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1670.9171946048737, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 18.55, "ram_util_percent": 66.6375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.582033429827, "policy_loss": -1.0973533321714995e+19, "vf_loss": 306489747.14285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11004.5, "diff_num_grad_updates_vs_sampler_policy": 11003.5}}, "num_env_steps_sampled": 844800, "num_env_steps_trained": 844800, "num_agent_steps_sampled": 844800, "num_agent_steps_trained": 844800}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114127.33822373944, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055223142911804, "mean_inference_ms": 0.36580805218406937, "mean_action_processing_ms": 0.0900865954025218, "mean_env_wait_ms": 0.9741661363469427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003663778305053711, "StateBufferConnector_ms": 0.0025839805603027344, "ViewRequirementAgentConnector_ms": 0.06538820266723633}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114127.33822373944, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114241.64105831653, -114947.59729910576, -114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055223142911804, "mean_inference_ms": 0.36580805218406937, "mean_action_processing_ms": 0.0900865954025218, "mean_env_wait_ms": 0.9741661363469427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003663778305053711, "StateBufferConnector_ms": 0.0025839805603027344, "ViewRequirementAgentConnector_ms": 0.06538820266723633}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 844800, "num_agent_steps_trained": 844800, "num_env_steps_sampled": 844800, "num_env_steps_trained": 844800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.5767516407381, "num_env_steps_trained_throughput_per_sec": 423.5767516407381, "timesteps_total": 844800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 844800, "timers": {"training_iteration_time_ms": 8467.806, "sample_time_ms": 8369.575, "load_time_ms": 1.422, "load_throughput": 2531009.152, "learn_time_ms": 95.953, "learn_throughput": 37518.177, "synch_weights_time_ms": 0.796}, "counters": {"num_env_steps_sampled": 844800, "num_env_steps_trained": 844800, "num_agent_steps_sampled": 844800, "num_agent_steps_trained": 844800}, "done": false, "episodes_total": 1107, "training_iteration": 284, "trial_id": "5f82d_00000", "date": "2023-07-26_23-59-34", "timestamp": 1690405174, "time_this_iter_s": 17.000982999801636, "time_total_s": 3715.748131752014, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1687.9181776046753, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 18.704166666666666, "ram_util_percent": 66.65416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.5671931675502, "policy_loss": -1.1417545156068393e+19, "vf_loss": 312014704.21428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11116.5, "diff_num_grad_updates_vs_sampler_policy": 11115.5}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114128.76126460318, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905519454234161, "mean_inference_ms": 0.365798872008222, "mean_action_processing_ms": 0.09008335471855065, "mean_env_wait_ms": 0.9740733485288249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036649703979492188, "StateBufferConnector_ms": 0.0025794506072998047, "ViewRequirementAgentConnector_ms": 0.06538653373718262}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114128.76126460318, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114049.45148215987, -113582.44630682236, -114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905519454234161, "mean_inference_ms": 0.365798872008222, "mean_action_processing_ms": 0.09008335471855065, "mean_env_wait_ms": 0.9740733485288249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036649703979492188, "StateBufferConnector_ms": 0.0025794506072998047, "ViewRequirementAgentConnector_ms": 0.06538653373718262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.9845930029448, "num_env_steps_trained_throughput_per_sec": 419.9845930029448, "timesteps_total": 852000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 8485.503, "sample_time_ms": 8387.114, "load_time_ms": 1.428, "load_throughput": 2520194.679, "learn_time_ms": 96.1, "learn_throughput": 37461.007, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "episodes_total": 1109, "training_iteration": 285, "trial_id": "5f82d_00000", "date": "2023-07-26_23-59-52", "timestamp": 1690405192, "time_this_iter_s": 17.146383047103882, "time_total_s": 3732.894514799118, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1705.0645606517792, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 18.715999999999998, "ram_util_percent": 66.592}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.6274043491908, "policy_loss": -9.6687030320061e+18, "vf_loss": 306677782.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11228.5, "diff_num_grad_updates_vs_sampler_policy": 11227.5}}, "num_env_steps_sampled": 859200, "num_env_steps_trained": 859200, "num_agent_steps_sampled": 859200, "num_agent_steps_trained": 859200}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114130.33698274144, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055168835433262, "mean_inference_ms": 0.36578981132620014, "mean_action_processing_ms": 0.09008027063838842, "mean_env_wait_ms": 0.9739838564036926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003665447235107422, "StateBufferConnector_ms": 0.0025758743286132812, "ViewRequirementAgentConnector_ms": 0.06544041633605957}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114130.33698274144, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114563.43511333199, -114344.4049777013, -114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055168835433262, "mean_inference_ms": 0.36578981132620014, "mean_action_processing_ms": 0.09008027063838842, "mean_env_wait_ms": 0.9739838564036926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003665447235107422, "StateBufferConnector_ms": 0.0025758743286132812, "ViewRequirementAgentConnector_ms": 0.06544041633605957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 859200, "num_agent_steps_trained": 859200, "num_env_steps_sampled": 859200, "num_env_steps_trained": 859200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 426.22245610982543, "num_env_steps_trained_throughput_per_sec": 426.22245610982543, "timesteps_total": 859200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 859200, "timers": {"training_iteration_time_ms": 8492.889, "sample_time_ms": 8395.202, "load_time_ms": 1.431, "load_throughput": 2514863.91, "learn_time_ms": 95.404, "learn_throughput": 37734.208, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 859200, "num_env_steps_trained": 859200, "num_agent_steps_sampled": 859200, "num_agent_steps_trained": 859200}, "done": false, "episodes_total": 1111, "training_iteration": 286, "trial_id": "5f82d_00000", "date": "2023-07-27_00-00-09", "timestamp": 1690405209, "time_this_iter_s": 16.895491123199463, "time_total_s": 3749.7900059223175, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1721.9600517749786, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 20.06086956521739, "ram_util_percent": 66.83043478260869}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.6190708705358, "policy_loss": -1.1883759182428084e+19, "vf_loss": 312789349.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11340.5, "diff_num_grad_updates_vs_sampler_policy": 11339.5}}, "num_env_steps_sampled": 866400, "num_env_steps_trained": 866400, "num_agent_steps_sampled": 866400, "num_agent_steps_trained": 866400}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114124.1596837639, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055137295549991, "mean_inference_ms": 0.36578162072318543, "mean_action_processing_ms": 0.09007738169301965, "mean_env_wait_ms": 0.9738959627738888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036573410034179688, "StateBufferConnector_ms": 0.002577066421508789, "ViewRequirementAgentConnector_ms": 0.06541681289672852}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114124.1596837639, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114295.09146082765, -113406.40053172207, -114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055137295549991, "mean_inference_ms": 0.36578162072318543, "mean_action_processing_ms": 0.09007738169301965, "mean_env_wait_ms": 0.9738959627738888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036573410034179688, "StateBufferConnector_ms": 0.002577066421508789, "ViewRequirementAgentConnector_ms": 0.06541681289672852}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 866400, "num_agent_steps_trained": 866400, "num_env_steps_sampled": 866400, "num_env_steps_trained": 866400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.7754144564129, "num_env_steps_trained_throughput_per_sec": 420.7754144564129, "timesteps_total": 866400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 866400, "timers": {"training_iteration_time_ms": 8500.15, "sample_time_ms": 8402.539, "load_time_ms": 1.429, "load_throughput": 2518681.301, "learn_time_ms": 95.329, "learn_throughput": 37763.813, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 866400, "num_env_steps_trained": 866400, "num_agent_steps_sampled": 866400, "num_agent_steps_trained": 866400}, "done": false, "episodes_total": 1113, "training_iteration": 287, "trial_id": "5f82d_00000", "date": "2023-07-27_00-00-26", "timestamp": 1690405226, "time_this_iter_s": 17.11419177055359, "time_total_s": 3766.904197692871, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1739.0742435455322, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 17.664, "ram_util_percent": 67.01599999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.5619310651507, "policy_loss": -9.506063604222204e+18, "vf_loss": 308983824.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11452.5, "diff_num_grad_updates_vs_sampler_policy": 11451.5}}, "num_env_steps_sampled": 873600, "num_env_steps_trained": 873600, "num_agent_steps_sampled": 873600, "num_agent_steps_trained": 873600}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114130.33309780547, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055098399922266, "mean_inference_ms": 0.365773472041213, "mean_action_processing_ms": 0.09007462027645133, "mean_env_wait_ms": 0.9738108989502589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036542415618896484, "StateBufferConnector_ms": 0.002577543258666992, "ViewRequirementAgentConnector_ms": 0.06543374061584473}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114130.33309780547, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114162.77276503739, -115106.03181388248, -113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055098399922266, "mean_inference_ms": 0.365773472041213, "mean_action_processing_ms": 0.09007462027645133, "mean_env_wait_ms": 0.9738108989502589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036542415618896484, "StateBufferConnector_ms": 0.002577543258666992, "ViewRequirementAgentConnector_ms": 0.06543374061584473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 873600, "num_agent_steps_trained": 873600, "num_env_steps_sampled": 873600, "num_env_steps_trained": 873600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 427.7824240470955, "num_env_steps_trained_throughput_per_sec": 427.7824240470955, "timesteps_total": 873600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 873600, "timers": {"training_iteration_time_ms": 8497.625, "sample_time_ms": 8399.332, "load_time_ms": 1.429, "load_throughput": 2519017.45, "learn_time_ms": 96.013, "learn_throughput": 37494.942, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 873600, "num_env_steps_trained": 873600, "num_agent_steps_sampled": 873600, "num_agent_steps_trained": 873600}, "done": false, "episodes_total": 1115, "training_iteration": 288, "trial_id": "5f82d_00000", "date": "2023-07-27_00-00-43", "timestamp": 1690405243, "time_this_iter_s": 16.833988189697266, "time_total_s": 3783.7381858825684, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1755.9082317352295, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 19.079166666666666, "ram_util_percent": 67.02083333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.7622746058873, "policy_loss": -1.1293099840185848e+19, "vf_loss": 314690738.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11564.5, "diff_num_grad_updates_vs_sampler_policy": 11563.5}}, "num_env_steps_sampled": 880800, "num_env_steps_trained": 880800, "num_agent_steps_sampled": 880800, "num_agent_steps_trained": 880800}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114130.48109644718, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055036228409044, "mean_inference_ms": 0.36576566550440887, "mean_action_processing_ms": 0.09007189691544149, "mean_env_wait_ms": 0.9737129867177978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036513805389404297, "StateBufferConnector_ms": 0.0025758743286132812, "ViewRequirementAgentConnector_ms": 0.06546163558959961}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114130.48109644718, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113825.36698041119, -114545.52027860045, -113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9055036228409044, "mean_inference_ms": 0.36576566550440887, "mean_action_processing_ms": 0.09007189691544149, "mean_env_wait_ms": 0.9737129867177978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036513805389404297, "StateBufferConnector_ms": 0.0025758743286132812, "ViewRequirementAgentConnector_ms": 0.06546163558959961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880800, "num_agent_steps_trained": 880800, "num_env_steps_sampled": 880800, "num_env_steps_trained": 880800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 428.64996417317315, "num_env_steps_trained_throughput_per_sec": 428.64996417317315, "timesteps_total": 880800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 880800, "timers": {"training_iteration_time_ms": 8477.507, "sample_time_ms": 8379.426, "load_time_ms": 1.443, "load_throughput": 2494176.382, "learn_time_ms": 95.79, "learn_throughput": 37582.303, "synch_weights_time_ms": 0.79}, "counters": {"num_env_steps_sampled": 880800, "num_env_steps_trained": 880800, "num_agent_steps_sampled": 880800, "num_agent_steps_trained": 880800}, "done": false, "episodes_total": 1117, "training_iteration": 289, "trial_id": "5f82d_00000", "date": "2023-07-27_00-00-59", "timestamp": 1690405259, "time_this_iter_s": 16.800057888031006, "time_total_s": 3800.5382437705994, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1772.7082896232605, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 18.31739130434783, "ram_util_percent": 66.78695652173914}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.760493687221, "policy_loss": -1.2062862725021995e+19, "vf_loss": 317462730.9285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11676.5, "diff_num_grad_updates_vs_sampler_policy": 11675.5}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114145.89882137529, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9054953038651081, "mean_inference_ms": 0.36575780253761875, "mean_action_processing_ms": 0.09006938075605808, "mean_env_wait_ms": 0.9736167405259704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036535263061523438, "StateBufferConnector_ms": 0.0025849342346191406, "ViewRequirementAgentConnector_ms": 0.06545615196228027}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114145.89882137529, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113994.20118908939, -114000.53306311322, -114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9054953038651081, "mean_inference_ms": 0.36575780253761875, "mean_action_processing_ms": 0.09006938075605808, "mean_env_wait_ms": 0.9736167405259704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036535263061523438, "StateBufferConnector_ms": 0.0025849342346191406, "ViewRequirementAgentConnector_ms": 0.06545615196228027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.907152082796, "num_env_steps_trained_throughput_per_sec": 419.907152082796, "timesteps_total": 888000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 8477.824, "sample_time_ms": 8380.182, "load_time_ms": 1.416, "load_throughput": 2543158.405, "learn_time_ms": 95.382, "learn_throughput": 37742.839, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "episodes_total": 1119, "training_iteration": 290, "trial_id": "5f82d_00000", "date": "2023-07-27_00-01-17", "timestamp": 1690405277, "time_this_iter_s": 17.149271965026855, "time_total_s": 3817.687515735626, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1789.8575615882874, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 19.152, "ram_util_percent": 66.796}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.7608250209264, "policy_loss": -1.1423320886873901e+19, "vf_loss": 312264219.4285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11788.5, "diff_num_grad_updates_vs_sampler_policy": 11787.5}}, "num_env_steps_sampled": 895200, "num_env_steps_trained": 895200, "num_agent_steps_sampled": 895200, "num_agent_steps_trained": 895200}, "sampler_results": {"episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114158.31321032885, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9054841363827145, "mean_inference_ms": 0.36574957351560433, "mean_action_processing_ms": 0.09006692688253551, "mean_env_wait_ms": 0.973523195146085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036535263061523438, "StateBufferConnector_ms": 0.0025815963745117188, "ViewRequirementAgentConnector_ms": 0.0654914379119873}}, "episode_reward_max": -113034.9210361455, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114158.31321032885, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114222.2875389432, -114819.87224898447, -113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9054841363827145, "mean_inference_ms": 0.36574957351560433, "mean_action_processing_ms": 0.09006692688253551, "mean_env_wait_ms": 0.973523195146085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036535263061523438, "StateBufferConnector_ms": 0.0025815963745117188, "ViewRequirementAgentConnector_ms": 0.0654914379119873}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 895200, "num_agent_steps_trained": 895200, "num_env_steps_sampled": 895200, "num_env_steps_trained": 895200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 426.13860887642295, "num_env_steps_trained_throughput_per_sec": 426.13860887642295, "timesteps_total": 895200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 895200, "timers": {"training_iteration_time_ms": 8478.156, "sample_time_ms": 8380.125, "load_time_ms": 1.429, "load_throughput": 2518513.26, "learn_time_ms": 95.762, "learn_throughput": 37593.072, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 895200, "num_env_steps_trained": 895200, "num_agent_steps_sampled": 895200, "num_agent_steps_trained": 895200}, "done": false, "episodes_total": 1121, "training_iteration": 291, "trial_id": "5f82d_00000", "date": "2023-07-27_00-01-33", "timestamp": 1690405293, "time_this_iter_s": 16.89906883239746, "time_total_s": 3834.5865845680237, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1806.7566304206848, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 19.270833333333332, "ram_util_percent": 66.8625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.7875758579798, "policy_loss": -8.363309413348978e+18, "vf_loss": 301740971.64285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11900.5, "diff_num_grad_updates_vs_sampler_policy": 11899.5}}, "num_env_steps_sampled": 902400, "num_env_steps_trained": 902400, "num_agent_steps_sampled": 902400, "num_agent_steps_trained": 902400}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114129.0505597672, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9054687669967311, "mean_inference_ms": 0.3657405104570305, "mean_action_processing_ms": 0.09006449172283514, "mean_env_wait_ms": 0.9734263856823692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036551952362060547, "StateBufferConnector_ms": 0.0025780200958251953, "ViewRequirementAgentConnector_ms": 0.06546211242675781}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114129.0505597672, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113839.6670303806, -113834.0954129334, -113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9054687669967311, "mean_inference_ms": 0.3657405104570305, "mean_action_processing_ms": 0.09006449172283514, "mean_env_wait_ms": 0.9734263856823692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036551952362060547, "StateBufferConnector_ms": 0.0025780200958251953, "ViewRequirementAgentConnector_ms": 0.06546211242675781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 902400, "num_agent_steps_trained": 902400, "num_env_steps_sampled": 902400, "num_env_steps_trained": 902400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 431.39317849408997, "num_env_steps_trained_throughput_per_sec": 431.39317849408997, "timesteps_total": 902400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 902400, "timers": {"training_iteration_time_ms": 8436.041, "sample_time_ms": 8338.018, "load_time_ms": 1.395, "load_throughput": 2580448.5, "learn_time_ms": 95.778, "learn_throughput": 37586.793, "synch_weights_time_ms": 0.791}, "counters": {"num_env_steps_sampled": 902400, "num_env_steps_trained": 902400, "num_agent_steps_sampled": 902400, "num_agent_steps_trained": 902400}, "done": false, "episodes_total": 1123, "training_iteration": 292, "trial_id": "5f82d_00000", "date": "2023-07-27_00-01-50", "timestamp": 1690405310, "time_this_iter_s": 16.69312286376953, "time_total_s": 3851.279707431793, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1823.4497532844543, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 17.778260869565216, "ram_util_percent": 66.93043478260869}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.814468383789, "policy_loss": -1.148139731879298e+19, "vf_loss": 310803820.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12012.5, "diff_num_grad_updates_vs_sampler_policy": 12011.5}}, "num_env_steps_sampled": 909600, "num_env_steps_trained": 909600, "num_agent_steps_sampled": 909600, "num_agent_steps_trained": 909600}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114134.90001343882, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9054529269232086, "mean_inference_ms": 0.3657304806409523, "mean_action_processing_ms": 0.09006212855382302, "mean_env_wait_ms": 0.9733299268323791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036597251892089844, "StateBufferConnector_ms": 0.0025789737701416016, "ViewRequirementAgentConnector_ms": 0.06545448303222656}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114134.90001343882, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113844.38575180263, -114530.5441878973, -114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9054529269232086, "mean_inference_ms": 0.3657304806409523, "mean_action_processing_ms": 0.09006212855382302, "mean_env_wait_ms": 0.9733299268323791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036597251892089844, "StateBufferConnector_ms": 0.0025789737701416016, "ViewRequirementAgentConnector_ms": 0.06545448303222656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 909600, "num_agent_steps_trained": 909600, "num_env_steps_sampled": 909600, "num_env_steps_trained": 909600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 427.17900592145094, "num_env_steps_trained_throughput_per_sec": 427.17900592145094, "timesteps_total": 909600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 909600, "timers": {"training_iteration_time_ms": 8438.418, "sample_time_ms": 8341.022, "load_time_ms": 1.436, "load_throughput": 2506306.543, "learn_time_ms": 95.119, "learn_throughput": 37847.233, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 909600, "num_env_steps_trained": 909600, "num_agent_steps_sampled": 909600, "num_agent_steps_trained": 909600}, "done": false, "episodes_total": 1125, "training_iteration": 293, "trial_id": "5f82d_00000", "date": "2023-07-27_00-02-07", "timestamp": 1690405327, "time_this_iter_s": 16.857882022857666, "time_total_s": 3868.137589454651, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1840.307635307312, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 20.162499999999998, "ram_util_percent": 66.91250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.85814339774, "policy_loss": -1.1632414800252891e+19, "vf_loss": 312521515.78571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12124.5, "diff_num_grad_updates_vs_sampler_policy": 12123.5}}, "num_env_steps_sampled": 916800, "num_env_steps_trained": 916800, "num_agent_steps_sampled": 916800, "num_agent_steps_trained": 916800}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114141.44396478323, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9054344771779548, "mean_inference_ms": 0.3657198763560774, "mean_action_processing_ms": 0.09005982883712886, "mean_env_wait_ms": 0.9732331475222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036623477935791016, "StateBufferConnector_ms": 0.0025801658630371094, "ViewRequirementAgentConnector_ms": 0.06547045707702637}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114141.44396478323, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114175.90691130239, -113603.53899296276, -114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9054344771779548, "mean_inference_ms": 0.3657198763560774, "mean_action_processing_ms": 0.09005982883712886, "mean_env_wait_ms": 0.9732331475222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036623477935791016, "StateBufferConnector_ms": 0.0025801658630371094, "ViewRequirementAgentConnector_ms": 0.06547045707702637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 916800, "num_agent_steps_trained": 916800, "num_env_steps_sampled": 916800, "num_env_steps_trained": 916800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 425.5058613351984, "num_env_steps_trained_throughput_per_sec": 425.5058613351984, "timesteps_total": 916800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 916800, "timers": {"training_iteration_time_ms": 8450.83, "sample_time_ms": 8353.32, "load_time_ms": 1.45, "load_throughput": 2482979.412, "learn_time_ms": 95.211, "learn_throughput": 37810.632, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 916800, "num_env_steps_trained": 916800, "num_agent_steps_sampled": 916800, "num_agent_steps_trained": 916800}, "done": false, "episodes_total": 1127, "training_iteration": 294, "trial_id": "5f82d_00000", "date": "2023-07-27_00-02-24", "timestamp": 1690405344, "time_this_iter_s": 16.9240460395813, "time_total_s": 3885.061635494232, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1857.2316813468933, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 19.304166666666664, "ram_util_percent": 66.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.8565891810827, "policy_loss": -1.0416049246039216e+19, "vf_loss": 310475929.35714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12236.5, "diff_num_grad_updates_vs_sampler_policy": 12235.5}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114151.34175472106, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905415754712972, "mean_inference_ms": 0.3657093452425979, "mean_action_processing_ms": 0.09005742795015115, "mean_env_wait_ms": 0.9731320261307337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036623477935791016, "StateBufferConnector_ms": 0.0025768280029296875, "ViewRequirementAgentConnector_ms": 0.06546735763549805}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114151.34175472106, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114911.76671713752, -115016.62290142481, -113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905415754712972, "mean_inference_ms": 0.3657093452425979, "mean_action_processing_ms": 0.09005742795015115, "mean_env_wait_ms": 0.9731320261307337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036623477935791016, "StateBufferConnector_ms": 0.0025768280029296875, "ViewRequirementAgentConnector_ms": 0.06546735763549805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.7262368093729, "num_env_steps_trained_throughput_per_sec": 420.7262368093729, "timesteps_total": 924000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 8447.491, "sample_time_ms": 8349.46, "load_time_ms": 1.452, "load_throughput": 2480002.365, "learn_time_ms": 95.709, "learn_throughput": 37614.078, "synch_weights_time_ms": 0.811}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 1129, "training_iteration": 295, "trial_id": "5f82d_00000", "date": "2023-07-27_00-02-41", "timestamp": 1690405361, "time_this_iter_s": 17.11633801460266, "time_total_s": 3902.177973508835, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1874.348019361496, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 18.92, "ram_util_percent": 67.024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.8724735804967, "policy_loss": -1.046931543070024e+19, "vf_loss": 309651865.14285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12348.5, "diff_num_grad_updates_vs_sampler_policy": 12347.5}}, "num_env_steps_sampled": 931200, "num_env_steps_trained": 931200, "num_agent_steps_sampled": 931200, "num_agent_steps_trained": 931200}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114129.00021016576, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9053960189961096, "mean_inference_ms": 0.36569821794022994, "mean_action_processing_ms": 0.09005503596344176, "mean_env_wait_ms": 0.973021005051232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003663301467895508, "StateBufferConnector_ms": 0.0025758743286132812, "ViewRequirementAgentConnector_ms": 0.0654914379119873}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114129.00021016576, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113690.19028322767, -113940.47034626656, -113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9053960189961096, "mean_inference_ms": 0.36569821794022994, "mean_action_processing_ms": 0.09005503596344176, "mean_env_wait_ms": 0.973021005051232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003663301467895508, "StateBufferConnector_ms": 0.0025758743286132812, "ViewRequirementAgentConnector_ms": 0.0654914379119873}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 931200, "num_agent_steps_trained": 931200, "num_env_steps_sampled": 931200, "num_env_steps_trained": 931200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 427.06285549046856, "num_env_steps_trained_throughput_per_sec": 427.06285549046856, "timesteps_total": 931200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 931200, "timers": {"training_iteration_time_ms": 8443.835, "sample_time_ms": 8346.288, "load_time_ms": 1.442, "load_throughput": 2497146.278, "learn_time_ms": 95.239, "learn_throughput": 37799.605, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 931200, "num_env_steps_trained": 931200, "num_agent_steps_sampled": 931200, "num_agent_steps_trained": 931200}, "done": false, "episodes_total": 1131, "training_iteration": 296, "trial_id": "5f82d_00000", "date": "2023-07-27_00-02-58", "timestamp": 1690405378, "time_this_iter_s": 16.86219096183777, "time_total_s": 3919.0401644706726, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1891.2102103233337, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 19.05217391304348, "ram_util_percent": 66.79565217391304}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.9029758998327, "policy_loss": -1.223861478704185e+19, "vf_loss": 309922928.64285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12460.5, "diff_num_grad_updates_vs_sampler_policy": 12459.5}}, "num_env_steps_sampled": 938400, "num_env_steps_trained": 938400, "num_agent_steps_sampled": 938400, "num_agent_steps_trained": 938400}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114134.03442246746, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9053763423270853, "mean_inference_ms": 0.36568755248273155, "mean_action_processing_ms": 0.0900527278799879, "mean_env_wait_ms": 0.9729091775451306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036628246307373047, "StateBufferConnector_ms": 0.0025739669799804688, "ViewRequirementAgentConnector_ms": 0.06549072265625}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114134.03442246746, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113925.88461635775, -114237.70679527998, -114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9053763423270853, "mean_inference_ms": 0.36568755248273155, "mean_action_processing_ms": 0.0900527278799879, "mean_env_wait_ms": 0.9729091775451306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036628246307373047, "StateBufferConnector_ms": 0.0025739669799804688, "ViewRequirementAgentConnector_ms": 0.06549072265625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 938400, "num_agent_steps_trained": 938400, "num_env_steps_sampled": 938400, "num_env_steps_trained": 938400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.72687268397686, "num_env_steps_trained_throughput_per_sec": 421.72687268397686, "timesteps_total": 938400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 938400, "timers": {"training_iteration_time_ms": 8482.09, "sample_time_ms": 8384.394, "load_time_ms": 1.461, "load_throughput": 2463534.295, "learn_time_ms": 95.368, "learn_throughput": 37748.472, "synch_weights_time_ms": 0.807}, "counters": {"num_env_steps_sampled": 938400, "num_env_steps_trained": 938400, "num_agent_steps_sampled": 938400, "num_agent_steps_trained": 938400}, "done": false, "episodes_total": 1133, "training_iteration": 297, "trial_id": "5f82d_00000", "date": "2023-07-27_00-03-15", "timestamp": 1690405395, "time_this_iter_s": 17.07562017440796, "time_total_s": 3936.1157846450806, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1908.2858304977417, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 20.128, "ram_util_percent": 66.976}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1560.9922637939453, "policy_loss": -1.2213819975145918e+19, "vf_loss": 313646861.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12572.5, "diff_num_grad_updates_vs_sampler_policy": 12571.5}}, "num_env_steps_sampled": 945600, "num_env_steps_trained": 945600, "num_agent_steps_sampled": 945600, "num_agent_steps_trained": 945600}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114139.55850230751, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9053578540548958, "mean_inference_ms": 0.3656768514391743, "mean_action_processing_ms": 0.09005040789695597, "mean_env_wait_ms": 0.9728018410846255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036656856536865234, "StateBufferConnector_ms": 0.0025739669799804688, "ViewRequirementAgentConnector_ms": 0.06551694869995117}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114139.55850230751, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114217.74560893018, -113422.94336270484, -114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9053578540548958, "mean_inference_ms": 0.3656768514391743, "mean_action_processing_ms": 0.09005040789695597, "mean_env_wait_ms": 0.9728018410846255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036656856536865234, "StateBufferConnector_ms": 0.0025739669799804688, "ViewRequirementAgentConnector_ms": 0.06551694869995117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 945600, "num_agent_steps_trained": 945600, "num_env_steps_sampled": 945600, "num_env_steps_trained": 945600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.1566288764188, "num_env_steps_trained_throughput_per_sec": 422.1566288764188, "timesteps_total": 945600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 945600, "timers": {"training_iteration_time_ms": 8502.142, "sample_time_ms": 8404.451, "load_time_ms": 1.436, "load_throughput": 2507721.783, "learn_time_ms": 95.395, "learn_throughput": 37737.669, "synch_weights_time_ms": 0.803}, "counters": {"num_env_steps_sampled": 945600, "num_env_steps_trained": 945600, "num_agent_steps_sampled": 945600, "num_agent_steps_trained": 945600}, "done": false, "episodes_total": 1135, "training_iteration": 298, "trial_id": "5f82d_00000", "date": "2023-07-27_00-03-32", "timestamp": 1690405412, "time_this_iter_s": 17.058265209197998, "time_total_s": 3953.1740498542786, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1925.3440957069397, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 18.241666666666667, "ram_util_percent": 66.99583333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.0328369140625, "policy_loss": -1.1682875433876754e+19, "vf_loss": 310994242.64285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12684.5, "diff_num_grad_updates_vs_sampler_policy": 12683.5}}, "num_env_steps_sampled": 952800, "num_env_steps_trained": 952800, "num_agent_steps_sampled": 952800, "num_agent_steps_trained": 952800}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114148.40362571226, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9053379671419199, "mean_inference_ms": 0.36566596476510865, "mean_action_processing_ms": 0.09004812883117999, "mean_env_wait_ms": 0.9726948727363235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036711692810058594, "StateBufferConnector_ms": 0.002572298049926758, "ViewRequirementAgentConnector_ms": 0.0655522346496582}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114148.40362571226, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114950.25358637243, -113805.90208527095, -114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9053379671419199, "mean_inference_ms": 0.36566596476510865, "mean_action_processing_ms": 0.09004812883117999, "mean_env_wait_ms": 0.9726948727363235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036711692810058594, "StateBufferConnector_ms": 0.002572298049926758, "ViewRequirementAgentConnector_ms": 0.0655522346496582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 952800, "num_agent_steps_trained": 952800, "num_env_steps_sampled": 952800, "num_env_steps_trained": 952800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.3913328441225, "num_env_steps_trained_throughput_per_sec": 420.3913328441225, "timesteps_total": 952800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 952800, "timers": {"training_iteration_time_ms": 8522.729, "sample_time_ms": 8424.823, "load_time_ms": 1.407, "load_throughput": 2557935.694, "learn_time_ms": 95.636, "learn_throughput": 37642.725, "synch_weights_time_ms": 0.805}, "counters": {"num_env_steps_sampled": 952800, "num_env_steps_trained": 952800, "num_agent_steps_sampled": 952800, "num_agent_steps_trained": 952800}, "done": false, "episodes_total": 1137, "training_iteration": 299, "trial_id": "5f82d_00000", "date": "2023-07-27_00-03-49", "timestamp": 1690405429, "time_this_iter_s": 17.1300048828125, "time_total_s": 3970.304054737091, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1942.4741005897522, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 18.191666666666666, "ram_util_percent": 66.95833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.07447378976, "policy_loss": -1.1388745672200622e+19, "vf_loss": 311460977.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12796.5, "diff_num_grad_updates_vs_sampler_policy": 12795.5}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114147.00301840268, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905317027632891, "mean_inference_ms": 0.3656550840337937, "mean_action_processing_ms": 0.09004601166654909, "mean_env_wait_ms": 0.9725916813537069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003672361373901367, "StateBufferConnector_ms": 0.002573728561401367, "ViewRequirementAgentConnector_ms": 0.06554317474365234}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114147.00301840268, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114011.93049699845, -114315.08157011673, -114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905317027632891, "mean_inference_ms": 0.3656550840337937, "mean_action_processing_ms": 0.09004601166654909, "mean_env_wait_ms": 0.9725916813537069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003672361373901367, "StateBufferConnector_ms": 0.002573728561401367, "ViewRequirementAgentConnector_ms": 0.06554317474365234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.2673360373173, "num_env_steps_trained_throughput_per_sec": 423.2673360373173, "timesteps_total": 960000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 8512.455, "sample_time_ms": 8415.167, "load_time_ms": 1.428, "load_throughput": 2521878.345, "learn_time_ms": 95.024, "learn_throughput": 37885.008, "synch_weights_time_ms": 0.777}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "episodes_total": 1139, "training_iteration": 300, "trial_id": "5f82d_00000", "date": "2023-07-27_00-04-06", "timestamp": 1690405446, "time_this_iter_s": 17.01364803314209, "time_total_s": 3987.317702770233, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1959.4877486228943, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 19.166666666666668, "ram_util_percent": 66.97916666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.096926007952, "policy_loss": -1.0429548961451438e+19, "vf_loss": 309219588.35714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12908.5, "diff_num_grad_updates_vs_sampler_policy": 12907.5}}, "num_env_steps_sampled": 967200, "num_env_steps_trained": 967200, "num_agent_steps_sampled": 967200, "num_agent_steps_trained": 967200}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114143.26706035939, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9052968796683303, "mean_inference_ms": 0.365643540496926, "mean_action_processing_ms": 0.09004396200776366, "mean_env_wait_ms": 0.9724867732079215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003673553466796875, "StateBufferConnector_ms": 0.0025670528411865234, "ViewRequirementAgentConnector_ms": 0.06552839279174805}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114143.26706035939, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114187.7047197369, -113592.26794108273, -113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9052968796683303, "mean_inference_ms": 0.365643540496926, "mean_action_processing_ms": 0.09004396200776366, "mean_env_wait_ms": 0.9724867732079215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003673553466796875, "StateBufferConnector_ms": 0.0025670528411865234, "ViewRequirementAgentConnector_ms": 0.06552839279174805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 967200, "num_agent_steps_trained": 967200, "num_env_steps_sampled": 967200, "num_env_steps_trained": 967200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.3719803255901, "num_env_steps_trained_throughput_per_sec": 422.3719803255901, "timesteps_total": 967200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 967200, "timers": {"training_iteration_time_ms": 8531.179, "sample_time_ms": 8433.871, "load_time_ms": 1.472, "load_throughput": 2444826.735, "learn_time_ms": 94.992, "learn_throughput": 37897.94, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 967200, "num_env_steps_trained": 967200, "num_agent_steps_sampled": 967200, "num_agent_steps_trained": 967200}, "done": false, "episodes_total": 1141, "training_iteration": 301, "trial_id": "5f82d_00000", "date": "2023-07-27_00-04-24", "timestamp": 1690405464, "time_this_iter_s": 17.049506902694702, "time_total_s": 4004.367209672928, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1976.537255525589, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 17.745833333333334, "ram_util_percent": 66.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.073248726981, "policy_loss": -1.0603168345552116e+19, "vf_loss": 310187732.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13020.5, "diff_num_grad_updates_vs_sampler_policy": 13019.5}}, "num_env_steps_sampled": 974400, "num_env_steps_trained": 974400, "num_agent_steps_sampled": 974400, "num_agent_steps_trained": 974400}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114138.38686634778, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9052739768246546, "mean_inference_ms": 0.3656323175356346, "mean_action_processing_ms": 0.09004200717370425, "mean_env_wait_ms": 0.9723835246632305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003673076629638672, "StateBufferConnector_ms": 0.002566099166870117, "ViewRequirementAgentConnector_ms": 0.06551170349121094}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114138.38686634778, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113836.92790103232, -114158.8642758547, -114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9052739768246546, "mean_inference_ms": 0.3656323175356346, "mean_action_processing_ms": 0.09004200717370425, "mean_env_wait_ms": 0.9723835246632305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003673076629638672, "StateBufferConnector_ms": 0.002566099166870117, "ViewRequirementAgentConnector_ms": 0.06551170349121094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 974400, "num_agent_steps_trained": 974400, "num_env_steps_sampled": 974400, "num_env_steps_trained": 974400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 429.26487009796864, "num_env_steps_trained_throughput_per_sec": 429.26487009796864, "timesteps_total": 974400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 974400, "timers": {"training_iteration_time_ms": 8501.199, "sample_time_ms": 8404.16, "load_time_ms": 1.453, "load_throughput": 2478252.101, "learn_time_ms": 94.746, "learn_throughput": 37996.31, "synch_weights_time_ms": 0.779}, "counters": {"num_env_steps_sampled": 974400, "num_env_steps_trained": 974400, "num_agent_steps_sampled": 974400, "num_agent_steps_trained": 974400}, "done": false, "episodes_total": 1143, "training_iteration": 302, "trial_id": "5f82d_00000", "date": "2023-07-27_00-04-40", "timestamp": 1690405480, "time_this_iter_s": 16.775649070739746, "time_total_s": 4021.1428587436676, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1993.3129045963287, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 21.962500000000002, "ram_util_percent": 67.12916666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.2110617501396, "policy_loss": -1.1303176394256849e+19, "vf_loss": 311769954.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13132.5, "diff_num_grad_updates_vs_sampler_policy": 13131.5}}, "num_env_steps_sampled": 981600, "num_env_steps_trained": 981600, "num_agent_steps_sampled": 981600, "num_agent_steps_trained": 981600}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114137.30513728542, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9052513253452009, "mean_inference_ms": 0.36562081478343933, "mean_action_processing_ms": 0.09004009661643111, "mean_env_wait_ms": 0.9722783594350477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.002566099166870117, "ViewRequirementAgentConnector_ms": 0.06551599502563477}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114137.30513728542, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114209.1510162599, -113803.73872008175, -114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9052513253452009, "mean_inference_ms": 0.36562081478343933, "mean_action_processing_ms": 0.09004009661643111, "mean_env_wait_ms": 0.9722783594350477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.002566099166870117, "ViewRequirementAgentConnector_ms": 0.06551599502563477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 981600, "num_agent_steps_trained": 981600, "num_env_steps_sampled": 981600, "num_env_steps_trained": 981600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.7653456743212, "num_env_steps_trained_throughput_per_sec": 421.7653456743212, "timesteps_total": 981600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 981600, "timers": {"training_iteration_time_ms": 8502.78, "sample_time_ms": 8404.665, "load_time_ms": 1.444, "load_throughput": 2493352.664, "learn_time_ms": 95.813, "learn_throughput": 37573.016, "synch_weights_time_ms": 0.795}, "counters": {"num_env_steps_sampled": 981600, "num_env_steps_trained": 981600, "num_agent_steps_sampled": 981600, "num_agent_steps_trained": 981600}, "done": false, "episodes_total": 1145, "training_iteration": 303, "trial_id": "5f82d_00000", "date": "2023-07-27_00-04-57", "timestamp": 1690405497, "time_this_iter_s": 17.07429790496826, "time_total_s": 4038.217156648636, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2010.387202501297, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 18.895833333333332, "ram_util_percent": 67.57083333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6276005336217, "policy_loss": -1.107543358129081e+19, "vf_loss": 307078981.5714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13244.5, "diff_num_grad_updates_vs_sampler_policy": 13243.5}}, "num_env_steps_sampled": 988800, "num_env_steps_trained": 988800, "num_agent_steps_sampled": 988800, "num_agent_steps_trained": 988800}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114139.8855143399, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905228554457883, "mean_inference_ms": 0.3656092634159641, "mean_action_processing_ms": 0.09003824938492366, "mean_env_wait_ms": 0.972167049417159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003670930862426758, "StateBufferConnector_ms": 0.0025644302368164062, "ViewRequirementAgentConnector_ms": 0.06551885604858398}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114139.8855143399, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114539.09367910892, -113614.58396977476, -113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905228554457883, "mean_inference_ms": 0.3656092634159641, "mean_action_processing_ms": 0.09003824938492366, "mean_env_wait_ms": 0.972167049417159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003670930862426758, "StateBufferConnector_ms": 0.0025644302368164062, "ViewRequirementAgentConnector_ms": 0.06551885604858398}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 988800, "num_agent_steps_trained": 988800, "num_env_steps_sampled": 988800, "num_env_steps_trained": 988800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 425.5684386074354, "num_env_steps_trained_throughput_per_sec": 425.5684386074354, "timesteps_total": 988800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 988800, "timers": {"training_iteration_time_ms": 8481.945, "sample_time_ms": 8384.245, "load_time_ms": 1.456, "load_throughput": 2471801.594, "learn_time_ms": 95.376, "learn_throughput": 37745.292, "synch_weights_time_ms": 0.804}, "counters": {"num_env_steps_sampled": 988800, "num_env_steps_trained": 988800, "num_agent_steps_sampled": 988800, "num_agent_steps_trained": 988800}, "done": false, "episodes_total": 1147, "training_iteration": 304, "trial_id": "5f82d_00000", "date": "2023-07-27_00-05-14", "timestamp": 1690405514, "time_this_iter_s": 16.921523094177246, "time_total_s": 4055.138679742813, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2027.3087255954742, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 22.804166666666664, "ram_util_percent": 68.10416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.651129586356, "policy_loss": -1.1482809262620488e+19, "vf_loss": 311823782.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13356.5, "diff_num_grad_updates_vs_sampler_policy": 13355.5}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114145.90751059794, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9052074393762238, "mean_inference_ms": 0.3655982310728809, "mean_action_processing_ms": 0.09003643613783764, "mean_env_wait_ms": 0.972054836066708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00366973876953125, "StateBufferConnector_ms": 0.0025653839111328125, "ViewRequirementAgentConnector_ms": 0.06549668312072754}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114145.90751059794, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113959.75541197091, -114227.67557727535, -113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9052074393762238, "mean_inference_ms": 0.3655982310728809, "mean_action_processing_ms": 0.09003643613783764, "mean_env_wait_ms": 0.972054836066708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00366973876953125, "StateBufferConnector_ms": 0.0025653839111328125, "ViewRequirementAgentConnector_ms": 0.06549668312072754}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.97769181243183, "num_env_steps_trained_throughput_per_sec": 420.97769181243183, "timesteps_total": 996000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 8491.197, "sample_time_ms": 8393.241, "load_time_ms": 1.46, "load_throughput": 2466512.202, "learn_time_ms": 95.625, "learn_throughput": 37646.995, "synch_weights_time_ms": 0.807}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "episodes_total": 1149, "training_iteration": 305, "trial_id": "5f82d_00000", "date": "2023-07-27_00-05-31", "timestamp": 1690405531, "time_this_iter_s": 17.105885982513428, "time_total_s": 4072.2445657253265, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2044.4146115779877, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 18.948, "ram_util_percent": 68.12400000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6426304408483, "policy_loss": -1.082506730651105e+19, "vf_loss": 308886644.14285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13468.5, "diff_num_grad_updates_vs_sampler_policy": 13467.5}}, "num_env_steps_sampled": 1003200, "num_env_steps_trained": 1003200, "num_agent_steps_sampled": 1003200, "num_agent_steps_trained": 1003200}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114145.21265567227, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905183877003308, "mean_inference_ms": 0.36558734754762495, "mean_action_processing_ms": 0.09003468373971023, "mean_env_wait_ms": 0.971945755257282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036666393280029297, "StateBufferConnector_ms": 0.002565622329711914, "ViewRequirementAgentConnector_ms": 0.06546664237976074}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114145.21265567227, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113163.78597500036, -113131.0784201875, -114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905183877003308, "mean_inference_ms": 0.36558734754762495, "mean_action_processing_ms": 0.09003468373971023, "mean_env_wait_ms": 0.971945755257282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036666393280029297, "StateBufferConnector_ms": 0.002565622329711914, "ViewRequirementAgentConnector_ms": 0.06546664237976074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1003200, "num_agent_steps_trained": 1003200, "num_env_steps_sampled": 1003200, "num_env_steps_trained": 1003200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.51376461624784, "num_env_steps_trained_throughput_per_sec": 422.51376461624784, "timesteps_total": 1003200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1003200, "timers": {"training_iteration_time_ms": 8490.625, "sample_time_ms": 8392.303, "load_time_ms": 1.412, "load_throughput": 2550202.571, "learn_time_ms": 96.031, "learn_throughput": 37487.793, "synch_weights_time_ms": 0.817}, "counters": {"num_env_steps_sampled": 1003200, "num_env_steps_trained": 1003200, "num_agent_steps_sampled": 1003200, "num_agent_steps_trained": 1003200}, "done": false, "episodes_total": 1151, "training_iteration": 306, "trial_id": "5f82d_00000", "date": "2023-07-27_00-05-49", "timestamp": 1690405549, "time_this_iter_s": 17.043658018112183, "time_total_s": 4089.2882237434387, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2061.4582695961, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 19.9, "ram_util_percent": 68.09166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.666574074074074e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6393563406807, "policy_loss": -1.136700858222959e+19, "vf_loss": 307151728.5714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13580.5, "diff_num_grad_updates_vs_sampler_policy": 13579.5}}, "num_env_steps_sampled": 1010400, "num_env_steps_trained": 1010400, "num_agent_steps_sampled": 1010400, "num_agent_steps_trained": 1010400}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114165.07911576412, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9051588581750382, "mean_inference_ms": 0.365577500634228, "mean_action_processing_ms": 0.09003296422243506, "mean_env_wait_ms": 0.9718450367312488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003667116165161133, "StateBufferConnector_ms": 0.0025634765625, "ViewRequirementAgentConnector_ms": 0.06546568870544434}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114165.07911576412, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114485.47012883703, -114653.06931549944, -113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9051588581750382, "mean_inference_ms": 0.365577500634228, "mean_action_processing_ms": 0.09003296422243506, "mean_env_wait_ms": 0.9718450367312488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003667116165161133, "StateBufferConnector_ms": 0.0025634765625, "ViewRequirementAgentConnector_ms": 0.06546568870544434}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1010400, "num_agent_steps_trained": 1010400, "num_env_steps_sampled": 1010400, "num_env_steps_trained": 1010400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.32610413981405, "num_env_steps_trained_throughput_per_sec": 421.32610413981405, "timesteps_total": 1010400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1010400, "timers": {"training_iteration_time_ms": 8522.229, "sample_time_ms": 8423.484, "load_time_ms": 1.453, "load_throughput": 2478414.812, "learn_time_ms": 96.418, "learn_throughput": 37337.436, "synch_weights_time_ms": 0.811}, "counters": {"num_env_steps_sampled": 1010400, "num_env_steps_trained": 1010400, "num_agent_steps_sampled": 1010400, "num_agent_steps_trained": 1010400}, "done": false, "episodes_total": 1153, "training_iteration": 307, "trial_id": "5f82d_00000", "date": "2023-07-27_00-06-06", "timestamp": 1690405566, "time_this_iter_s": 17.09182381629944, "time_total_s": 4106.380047559738, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2078.5500934123993, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 20.900000000000002, "ram_util_percent": 68.15416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.999907407407408e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.620396205357, "policy_loss": -1.1805807848260616e+19, "vf_loss": 310867878.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13692.5, "diff_num_grad_updates_vs_sampler_policy": 13691.5}}, "num_env_steps_sampled": 1017600, "num_env_steps_trained": 1017600, "num_agent_steps_sampled": 1017600, "num_agent_steps_trained": 1017600}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114167.75354209365, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9051336995217416, "mean_inference_ms": 0.36556854665225713, "mean_action_processing_ms": 0.09003138551499591, "mean_env_wait_ms": 0.9717559368871074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003668546676635742, "StateBufferConnector_ms": 0.0025675296783447266, "ViewRequirementAgentConnector_ms": 0.06546616554260254}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114167.75354209365, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113335.06500068569, -115103.4404513676, -115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9051336995217416, "mean_inference_ms": 0.36556854665225713, "mean_action_processing_ms": 0.09003138551499591, "mean_env_wait_ms": 0.9717559368871074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003668546676635742, "StateBufferConnector_ms": 0.0025675296783447266, "ViewRequirementAgentConnector_ms": 0.06546616554260254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1017600, "num_agent_steps_trained": 1017600, "num_env_steps_sampled": 1017600, "num_env_steps_trained": 1017600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 413.7534611567438, "num_env_steps_trained_throughput_per_sec": 413.7534611567438, "timesteps_total": 1017600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1017600, "timers": {"training_iteration_time_ms": 8555.286, "sample_time_ms": 8457.325, "load_time_ms": 1.451, "load_throughput": 2481714.314, "learn_time_ms": 95.639, "learn_throughput": 37641.402, "synch_weights_time_ms": 0.81}, "counters": {"num_env_steps_sampled": 1017600, "num_env_steps_trained": 1017600, "num_agent_steps_sampled": 1017600, "num_agent_steps_trained": 1017600}, "done": false, "episodes_total": 1155, "training_iteration": 308, "trial_id": "5f82d_00000", "date": "2023-07-27_00-06-23", "timestamp": 1690405583, "time_this_iter_s": 17.404536962509155, "time_total_s": 4123.784584522247, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2095.9546303749084, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 18.264, "ram_util_percent": 68.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.33324074074074e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.606216430664, "policy_loss": -1.1704515225949344e+19, "vf_loss": 312004117.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13804.5, "diff_num_grad_updates_vs_sampler_policy": 13803.5}}, "num_env_steps_sampled": 1024800, "num_env_steps_trained": 1024800, "num_agent_steps_sampled": 1024800, "num_agent_steps_trained": 1024800}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114169.70563690651, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9051140905776307, "mean_inference_ms": 0.365559920691447, "mean_action_processing_ms": 0.0900298590972825, "mean_env_wait_ms": 0.9716698575293193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003672361373901367, "StateBufferConnector_ms": 0.002572298049926758, "ViewRequirementAgentConnector_ms": 0.0655357837677002}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114169.70563690651, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115099.08428117048, -114151.32401075892, -115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9051140905776307, "mean_inference_ms": 0.365559920691447, "mean_action_processing_ms": 0.0900298590972825, "mean_env_wait_ms": 0.9716698575293193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003672361373901367, "StateBufferConnector_ms": 0.002572298049926758, "ViewRequirementAgentConnector_ms": 0.0655357837677002}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024800, "num_agent_steps_trained": 1024800, "num_env_steps_sampled": 1024800, "num_env_steps_trained": 1024800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.86735220263773, "num_env_steps_trained_throughput_per_sec": 420.86735220263773, "timesteps_total": 1024800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1024800, "timers": {"training_iteration_time_ms": 8574.184, "sample_time_ms": 8475.959, "load_time_ms": 1.442, "load_throughput": 2497394.089, "learn_time_ms": 95.917, "learn_throughput": 37532.306, "synch_weights_time_ms": 0.807}, "counters": {"num_env_steps_sampled": 1024800, "num_env_steps_trained": 1024800, "num_agent_steps_sampled": 1024800, "num_agent_steps_trained": 1024800}, "done": false, "episodes_total": 1157, "training_iteration": 309, "trial_id": "5f82d_00000", "date": "2023-07-27_00-06-40", "timestamp": 1690405600, "time_this_iter_s": 17.11061382293701, "time_total_s": 4140.895198345184, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2113.0652441978455, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 18.795833333333334, "ram_util_percent": 68.2625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.666574074074075e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5941467285156, "policy_loss": -9.108795288302611e+18, "vf_loss": 308066369.4285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13916.5, "diff_num_grad_updates_vs_sampler_policy": 13915.5}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114160.6011768055, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905092577723347, "mean_inference_ms": 0.3655513015247473, "mean_action_processing_ms": 0.09002833227499356, "mean_env_wait_ms": 0.9715694305637398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036704540252685547, "StateBufferConnector_ms": 0.0025725364685058594, "ViewRequirementAgentConnector_ms": 0.0655210018157959}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115546.31559687694, "episode_reward_mean": -114160.6011768055, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115546.31559687694, -114375.50428224615, -114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905092577723347, "mean_inference_ms": 0.3655513015247473, "mean_action_processing_ms": 0.09002833227499356, "mean_env_wait_ms": 0.9715694305637398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036704540252685547, "StateBufferConnector_ms": 0.0025725364685058594, "ViewRequirementAgentConnector_ms": 0.0655210018157959}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 430.06400734471384, "num_env_steps_trained_throughput_per_sec": 430.06400734471384, "timesteps_total": 1032000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 8538.049, "sample_time_ms": 8439.841, "load_time_ms": 1.43, "load_throughput": 2517505.485, "learn_time_ms": 95.912, "learn_throughput": 37534.396, "synch_weights_time_ms": 0.808}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "episodes_total": 1159, "training_iteration": 310, "trial_id": "5f82d_00000", "date": "2023-07-27_00-06-57", "timestamp": 1690405617, "time_this_iter_s": 16.7446608543396, "time_total_s": 4157.639859199524, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2129.809905052185, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 20.020833333333332, "ram_util_percent": 68.12083333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.999907407407406e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6150469098773, "policy_loss": -1.1695454851828285e+19, "vf_loss": 311542178.64285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14028.5, "diff_num_grad_updates_vs_sampler_policy": 14027.5}}, "num_env_steps_sampled": 1039200, "num_env_steps_trained": 1039200, "num_agent_steps_sampled": 1039200, "num_agent_steps_trained": 1039200}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114147.34467259163, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9050709364643414, "mean_inference_ms": 0.3655427010940822, "mean_action_processing_ms": 0.09002680834996238, "mean_env_wait_ms": 0.9714591916393952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036742687225341797, "StateBufferConnector_ms": 0.0025663375854492188, "ViewRequirementAgentConnector_ms": 0.06557464599609375}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114147.34467259163, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114636.79236057797, -114250.56249186941, -113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9050709364643414, "mean_inference_ms": 0.3655427010940822, "mean_action_processing_ms": 0.09002680834996238, "mean_env_wait_ms": 0.9714591916393952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036742687225341797, "StateBufferConnector_ms": 0.0025663375854492188, "ViewRequirementAgentConnector_ms": 0.06557464599609375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1039200, "num_agent_steps_trained": 1039200, "num_env_steps_sampled": 1039200, "num_env_steps_trained": 1039200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 426.4604043039317, "num_env_steps_trained_throughput_per_sec": 426.4604043039317, "timesteps_total": 1039200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1039200, "timers": {"training_iteration_time_ms": 8522.279, "sample_time_ms": 8424.015, "load_time_ms": 1.46, "load_throughput": 2466592.786, "learn_time_ms": 95.942, "learn_throughput": 37522.848, "synch_weights_time_ms": 0.804}, "counters": {"num_env_steps_sampled": 1039200, "num_env_steps_trained": 1039200, "num_agent_steps_sampled": 1039200, "num_agent_steps_trained": 1039200}, "done": false, "episodes_total": 1161, "training_iteration": 311, "trial_id": "5f82d_00000", "date": "2023-07-27_00-07-14", "timestamp": 1690405634, "time_this_iter_s": 16.88594889640808, "time_total_s": 4174.525808095932, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2146.695853948593, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 19.820833333333336, "ram_util_percent": 68.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.333240740740741e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5294625418526, "policy_loss": -1.1911686061513552e+19, "vf_loss": 317068193.14285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14140.5, "diff_num_grad_updates_vs_sampler_policy": 14139.5}}, "num_env_steps_sampled": 1046400, "num_env_steps_trained": 1046400, "num_agent_steps_sampled": 1046400, "num_agent_steps_trained": 1046400}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114153.69516400163, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9050489950595713, "mean_inference_ms": 0.36553404453433025, "mean_action_processing_ms": 0.09002530864700674, "mean_env_wait_ms": 0.9713488424770702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036704540252685547, "StateBufferConnector_ms": 0.0025713443756103516, "ViewRequirementAgentConnector_ms": 0.06553506851196289}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114153.69516400163, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113804.78227489466, -114301.82365883767, -113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9050489950595713, "mean_inference_ms": 0.36553404453433025, "mean_action_processing_ms": 0.09002530864700674, "mean_env_wait_ms": 0.9713488424770702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036704540252685547, "StateBufferConnector_ms": 0.0025713443756103516, "ViewRequirementAgentConnector_ms": 0.06553506851196289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1046400, "num_agent_steps_trained": 1046400, "num_env_steps_sampled": 1046400, "num_env_steps_trained": 1046400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 418.99287832549965, "num_env_steps_trained_throughput_per_sec": 418.99287832549965, "timesteps_total": 1046400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1046400, "timers": {"training_iteration_time_ms": 8531.795, "sample_time_ms": 8433.875, "load_time_ms": 1.442, "load_throughput": 2496361.869, "learn_time_ms": 95.616, "learn_throughput": 37650.421, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 1046400, "num_env_steps_trained": 1046400, "num_agent_steps_sampled": 1046400, "num_agent_steps_trained": 1046400}, "done": false, "episodes_total": 1163, "training_iteration": 312, "trial_id": "5f82d_00000", "date": "2023-07-27_00-07-31", "timestamp": 1690405651, "time_this_iter_s": 17.187145948410034, "time_total_s": 4191.712954044342, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2163.882999897003, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 19.087500000000002, "ram_util_percent": 68.15833333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.666574074074073e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6358446393695, "policy_loss": -1.0591969059624778e+19, "vf_loss": 309758270.9285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14252.5, "diff_num_grad_updates_vs_sampler_policy": 14251.5}}, "num_env_steps_sampled": 1053600, "num_env_steps_trained": 1053600, "num_agent_steps_sampled": 1053600, "num_agent_steps_trained": 1053600}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114152.73854703717, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905024354342284, "mean_inference_ms": 0.3655253364573609, "mean_action_processing_ms": 0.09002384284743681, "mean_env_wait_ms": 0.9712384718445847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036733150482177734, "StateBufferConnector_ms": 0.0025806427001953125, "ViewRequirementAgentConnector_ms": 0.06564760208129883}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114152.73854703717, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113838.21415331938, -113492.83221952508, -114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.905024354342284, "mean_inference_ms": 0.3655253364573609, "mean_action_processing_ms": 0.09002384284743681, "mean_env_wait_ms": 0.9712384718445847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036733150482177734, "StateBufferConnector_ms": 0.0025806427001953125, "ViewRequirementAgentConnector_ms": 0.06564760208129883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1053600, "num_agent_steps_trained": 1053600, "num_env_steps_sampled": 1053600, "num_env_steps_trained": 1053600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.96030396950056, "num_env_steps_trained_throughput_per_sec": 423.96030396950056, "timesteps_total": 1053600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1053600, "timers": {"training_iteration_time_ms": 8489.901, "sample_time_ms": 8392.077, "load_time_ms": 1.441, "load_throughput": 2497683.263, "learn_time_ms": 95.524, "learn_throughput": 37686.892, "synch_weights_time_ms": 0.8}, "counters": {"num_env_steps_sampled": 1053600, "num_env_steps_trained": 1053600, "num_agent_steps_sampled": 1053600, "num_agent_steps_trained": 1053600}, "done": false, "episodes_total": 1165, "training_iteration": 313, "trial_id": "5f82d_00000", "date": "2023-07-27_00-07-48", "timestamp": 1690405668, "time_this_iter_s": 16.985655784606934, "time_total_s": 4208.698609828949, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2180.86865568161, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 19.349999999999998, "ram_util_percent": 68.24166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6573181152344, "policy_loss": -1.1227801184356794e+19, "vf_loss": 311132955.5714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14364.5, "diff_num_grad_updates_vs_sampler_policy": 14363.5}}, "num_env_steps_sampled": 1060800, "num_env_steps_trained": 1060800, "num_agent_steps_sampled": 1060800, "num_agent_steps_trained": 1060800}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114162.71047566403, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9050021619877439, "mean_inference_ms": 0.3655166839391077, "mean_action_processing_ms": 0.09002241235897877, "mean_env_wait_ms": 0.9711357044448419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003673076629638672, "StateBufferConnector_ms": 0.0025870800018310547, "ViewRequirementAgentConnector_ms": 0.06564188003540039}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114162.71047566403, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114243.31807029965, -115023.25572933616, -113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9050021619877439, "mean_inference_ms": 0.3655166839391077, "mean_action_processing_ms": 0.09002241235897877, "mean_env_wait_ms": 0.9711357044448419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003673076629638672, "StateBufferConnector_ms": 0.0025870800018310547, "ViewRequirementAgentConnector_ms": 0.06564188003540039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1060800, "num_agent_steps_trained": 1060800, "num_env_steps_sampled": 1060800, "num_env_steps_trained": 1060800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.9270242438165, "num_env_steps_trained_throughput_per_sec": 421.9270242438165, "timesteps_total": 1060800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1060800, "timers": {"training_iteration_time_ms": 8485.604, "sample_time_ms": 8387.843, "load_time_ms": 1.437, "load_throughput": 2505059.128, "learn_time_ms": 95.479, "learn_throughput": 37704.499, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 1060800, "num_env_steps_trained": 1060800, "num_agent_steps_sampled": 1060800, "num_agent_steps_trained": 1060800}, "done": false, "episodes_total": 1167, "training_iteration": 314, "trial_id": "5f82d_00000", "date": "2023-07-27_00-08-05", "timestamp": 1690405685, "time_this_iter_s": 17.06743621826172, "time_total_s": 4225.766046047211, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2197.936091899872, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 21.662500000000005, "ram_util_percent": 68.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6506129673548, "policy_loss": -1.0159683840379984e+19, "vf_loss": 309520504.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14476.5, "diff_num_grad_updates_vs_sampler_policy": 14475.5}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114152.69433885941, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9049803544885302, "mean_inference_ms": 0.3655087752553552, "mean_action_processing_ms": 0.09002111608786408, "mean_env_wait_ms": 0.971023854282069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003674745559692383, "StateBufferConnector_ms": 0.0025861263275146484, "ViewRequirementAgentConnector_ms": 0.06561827659606934}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114152.69433885941, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113599.39959015163, -114574.50155017356, -113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9049803544885302, "mean_inference_ms": 0.3655087752553552, "mean_action_processing_ms": 0.09002111608786408, "mean_env_wait_ms": 0.971023854282069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003674745559692383, "StateBufferConnector_ms": 0.0025861263275146484, "ViewRequirementAgentConnector_ms": 0.06561827659606934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.2488177320815, "num_env_steps_trained_throughput_per_sec": 424.2488177320815, "timesteps_total": 1068000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 8508.551, "sample_time_ms": 8410.799, "load_time_ms": 1.469, "load_throughput": 2450142.697, "learn_time_ms": 95.425, "learn_throughput": 37725.912, "synch_weights_time_ms": 0.795}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "episodes_total": 1169, "training_iteration": 315, "trial_id": "5f82d_00000", "date": "2023-07-27_00-08-22", "timestamp": 1690405702, "time_this_iter_s": 16.974972009658813, "time_total_s": 4242.7410180568695, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2214.9110639095306, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 18.745833333333334, "ram_util_percent": 68.35416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.612040928432, "policy_loss": -1.2152714519011832e+19, "vf_loss": 315378398.64285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14588.5, "diff_num_grad_updates_vs_sampler_policy": 14587.5}}, "num_env_steps_sampled": 1075200, "num_env_steps_trained": 1075200, "num_agent_steps_sampled": 1075200, "num_agent_steps_trained": 1075200}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114159.8965356783, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.904955116120641, "mean_inference_ms": 0.36550096447994185, "mean_action_processing_ms": 0.09001986053407686, "mean_env_wait_ms": 0.9709053197351871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003675699234008789, "StateBufferConnector_ms": 0.002584218978881836, "ViewRequirementAgentConnector_ms": 0.06562232971191406}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114159.8965356783, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113771.17024044659, -114543.79123536695, -114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.904955116120641, "mean_inference_ms": 0.36550096447994185, "mean_action_processing_ms": 0.09001986053407686, "mean_env_wait_ms": 0.9709053197351871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003675699234008789, "StateBufferConnector_ms": 0.002584218978881836, "ViewRequirementAgentConnector_ms": 0.06562232971191406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1075200, "num_agent_steps_trained": 1075200, "num_env_steps_sampled": 1075200, "num_env_steps_trained": 1075200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 426.41687929743233, "num_env_steps_trained_throughput_per_sec": 426.41687929743233, "timesteps_total": 1075200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1075200, "timers": {"training_iteration_time_ms": 8508.723, "sample_time_ms": 8411.278, "load_time_ms": 1.463, "load_throughput": 2461044.822, "learn_time_ms": 95.123, "learn_throughput": 37845.687, "synch_weights_time_ms": 0.797}, "counters": {"num_env_steps_sampled": 1075200, "num_env_steps_trained": 1075200, "num_agent_steps_sampled": 1075200, "num_agent_steps_trained": 1075200}, "done": false, "episodes_total": 1171, "training_iteration": 316, "trial_id": "5f82d_00000", "date": "2023-07-27_00-08-39", "timestamp": 1690405719, "time_this_iter_s": 16.88781213760376, "time_total_s": 4259.628830194473, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2231.7988760471344, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 20.854166666666668, "ram_util_percent": 68.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5124882289342, "policy_loss": -1.1894774312326892e+19, "vf_loss": 310271053.9285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14700.5, "diff_num_grad_updates_vs_sampler_policy": 14699.5}}, "num_env_steps_sampled": 1082400, "num_env_steps_trained": 1082400, "num_agent_steps_sampled": 1082400, "num_agent_steps_trained": 1082400}, "sampler_results": {"episode_reward_max": -112590.9644823077, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114146.69600984453, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9049300918765636, "mean_inference_ms": 0.36549325105982516, "mean_action_processing_ms": 0.09001864708259047, "mean_env_wait_ms": 0.970786851212122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003673553466796875, "StateBufferConnector_ms": 0.002584218978881836, "ViewRequirementAgentConnector_ms": 0.06555914878845215}}, "episode_reward_max": -112590.9644823077, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114146.69600984453, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114316.66833303988, -113034.9210361455, -114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9049300918765636, "mean_inference_ms": 0.36549325105982516, "mean_action_processing_ms": 0.09001864708259047, "mean_env_wait_ms": 0.970786851212122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003673553466796875, "StateBufferConnector_ms": 0.002584218978881836, "ViewRequirementAgentConnector_ms": 0.06555914878845215}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1082400, "num_agent_steps_trained": 1082400, "num_env_steps_sampled": 1082400, "num_env_steps_trained": 1082400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.18010003682735, "num_env_steps_trained_throughput_per_sec": 422.18010003682735, "timesteps_total": 1082400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1082400, "timers": {"training_iteration_time_ms": 8495.75, "sample_time_ms": 8398.227, "load_time_ms": 1.47, "load_throughput": 2449745.186, "learn_time_ms": 95.193, "learn_throughput": 37817.858, "synch_weights_time_ms": 0.799}, "counters": {"num_env_steps_sampled": 1082400, "num_env_steps_trained": 1082400, "num_agent_steps_sampled": 1082400, "num_agent_steps_trained": 1082400}, "done": false, "episodes_total": 1173, "training_iteration": 317, "trial_id": "5f82d_00000", "date": "2023-07-27_00-08-56", "timestamp": 1690405736, "time_this_iter_s": 17.057239055633545, "time_total_s": 4276.686069250107, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2248.856115102768, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 18.720833333333335, "ram_util_percent": 68.28750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.561536516462, "policy_loss": -1.3148165861178378e+19, "vf_loss": 316285666.64285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14812.5, "diff_num_grad_updates_vs_sampler_policy": 14811.5}}, "num_env_steps_sampled": 1089600, "num_env_steps_trained": 1089600, "num_agent_steps_sampled": 1089600, "num_agent_steps_trained": 1089600}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114150.5330131246, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.904904010385759, "mean_inference_ms": 0.3654857146225003, "mean_action_processing_ms": 0.09001743581152478, "mean_env_wait_ms": 0.9706682111486341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036706924438476562, "StateBufferConnector_ms": 0.002584695816040039, "ViewRequirementAgentConnector_ms": 0.06551098823547363}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114150.5330131246, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114936.4549574007, -113454.2822236569, -113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.904904010385759, "mean_inference_ms": 0.3654857146225003, "mean_action_processing_ms": 0.09001743581152478, "mean_env_wait_ms": 0.9706682111486341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036706924438476562, "StateBufferConnector_ms": 0.002584695816040039, "ViewRequirementAgentConnector_ms": 0.06551098823547363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1089600, "num_agent_steps_trained": 1089600, "num_env_steps_sampled": 1089600, "num_env_steps_trained": 1089600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.7548535938295, "num_env_steps_trained_throughput_per_sec": 423.7548535938295, "timesteps_total": 1089600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1089600, "timers": {"training_iteration_time_ms": 8496.573, "sample_time_ms": 8399.454, "load_time_ms": 1.489, "load_throughput": 2417698.53, "learn_time_ms": 94.774, "learn_throughput": 37985.07, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 1089600, "num_env_steps_trained": 1089600, "num_agent_steps_sampled": 1089600, "num_agent_steps_trained": 1089600}, "done": false, "episodes_total": 1175, "training_iteration": 318, "trial_id": "5f82d_00000", "date": "2023-07-27_00-09-13", "timestamp": 1690405753, "time_this_iter_s": 16.99378275871277, "time_total_s": 4293.67985200882, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2265.8498978614807, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 18.479166666666668, "ram_util_percent": 68.32916666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6014404296875, "policy_loss": -1.0409898261651818e+19, "vf_loss": 308131418.9285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14924.5, "diff_num_grad_updates_vs_sampler_policy": 14923.5}}, "num_env_steps_sampled": 1096800, "num_env_steps_trained": 1096800, "num_agent_steps_sampled": 1096800, "num_agent_steps_trained": 1096800}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114147.48107481118, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9048775539918791, "mean_inference_ms": 0.3654782115638994, "mean_action_processing_ms": 0.09001615692156154, "mean_env_wait_ms": 0.9705449534125812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036668777465820312, "StateBufferConnector_ms": 0.0025835037231445312, "ViewRequirementAgentConnector_ms": 0.06550788879394531}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114147.48107481118, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113586.31176726152, -114602.29891076013, -114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9048775539918791, "mean_inference_ms": 0.3654782115638994, "mean_action_processing_ms": 0.09001615692156154, "mean_env_wait_ms": 0.9705449534125812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036668777465820312, "StateBufferConnector_ms": 0.0025835037231445312, "ViewRequirementAgentConnector_ms": 0.06550788879394531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1096800, "num_agent_steps_trained": 1096800, "num_env_steps_sampled": 1096800, "num_env_steps_trained": 1096800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.2044439459953, "num_env_steps_trained_throughput_per_sec": 424.2044439459953, "timesteps_total": 1096800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1096800, "timers": {"training_iteration_time_ms": 8487.411, "sample_time_ms": 8390.563, "load_time_ms": 1.49, "load_throughput": 2415725.846, "learn_time_ms": 94.497, "learn_throughput": 38096.346, "synch_weights_time_ms": 0.798}, "counters": {"num_env_steps_sampled": 1096800, "num_env_steps_trained": 1096800, "num_agent_steps_sampled": 1096800, "num_agent_steps_trained": 1096800}, "done": false, "episodes_total": 1177, "training_iteration": 319, "trial_id": "5f82d_00000", "date": "2023-07-27_00-09-30", "timestamp": 1690405770, "time_this_iter_s": 16.975893020629883, "time_total_s": 4310.6557450294495, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2282.8257908821106, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 19.232, "ram_util_percent": 68.376}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.59135219029, "policy_loss": -1.1879357498856049e+19, "vf_loss": 308571902.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15036.5, "diff_num_grad_updates_vs_sampler_policy": 15035.5}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114143.18858214683, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9048511057598081, "mean_inference_ms": 0.3654706864698541, "mean_action_processing_ms": 0.09001482442788354, "mean_env_wait_ms": 0.9704209119527909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036695003509521484, "StateBufferConnector_ms": 0.002577543258666992, "ViewRequirementAgentConnector_ms": 0.06551980972290039}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114143.18858214683, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114685.24529942029, -113606.80028424005, -114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9048511057598081, "mean_inference_ms": 0.3654706864698541, "mean_action_processing_ms": 0.09001482442788354, "mean_env_wait_ms": 0.9704209119527909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036695003509521484, "StateBufferConnector_ms": 0.002577543258666992, "ViewRequirementAgentConnector_ms": 0.06551980972290039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.08078594856636, "num_env_steps_trained_throughput_per_sec": 422.08078594856636, "timesteps_total": 1104000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 8496.13, "sample_time_ms": 8399.454, "load_time_ms": 1.47, "load_throughput": 2448831.398, "learn_time_ms": 94.35, "learn_throughput": 38155.705, "synch_weights_time_ms": 0.796}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "episodes_total": 1179, "training_iteration": 320, "trial_id": "5f82d_00000", "date": "2023-07-27_00-09-47", "timestamp": 1690405787, "time_this_iter_s": 17.061336040496826, "time_total_s": 4327.717081069946, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2299.8871269226074, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 18.650000000000002, "ram_util_percent": 68.34583333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6221030099052, "policy_loss": -1.2072318183204254e+19, "vf_loss": 311516742.35714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15148.5, "diff_num_grad_updates_vs_sampler_policy": 15147.5}}, "num_env_steps_sampled": 1111200, "num_env_steps_trained": 1111200, "num_agent_steps_sampled": 1111200, "num_agent_steps_trained": 1111200}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114153.73895899125, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9048235973723241, "mean_inference_ms": 0.36546379934578666, "mean_action_processing_ms": 0.09001355296994701, "mean_env_wait_ms": 0.97030962512197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036737918853759766, "StateBufferConnector_ms": 0.002574443817138672, "ViewRequirementAgentConnector_ms": 0.06550312042236328}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114153.73895899125, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114848.46808134502, -114534.6245616062, -113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9048235973723241, "mean_inference_ms": 0.36546379934578666, "mean_action_processing_ms": 0.09001355296994701, "mean_env_wait_ms": 0.97030962512197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036737918853759766, "StateBufferConnector_ms": 0.002574443817138672, "ViewRequirementAgentConnector_ms": 0.06550312042236328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1111200, "num_agent_steps_trained": 1111200, "num_env_steps_sampled": 1111200, "num_env_steps_trained": 1111200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 416.0548602407707, "num_env_steps_trained_throughput_per_sec": 416.0548602407707, "timesteps_total": 1111200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1111200, "timers": {"training_iteration_time_ms": 8538.182, "sample_time_ms": 8441.546, "load_time_ms": 1.446, "load_throughput": 2489816.869, "learn_time_ms": 94.345, "learn_throughput": 38157.778, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 1111200, "num_env_steps_trained": 1111200, "num_agent_steps_sampled": 1111200, "num_agent_steps_trained": 1111200}, "done": false, "episodes_total": 1181, "training_iteration": 321, "trial_id": "5f82d_00000", "date": "2023-07-27_00-10-05", "timestamp": 1690405805, "time_this_iter_s": 17.308589696884155, "time_total_s": 4345.02567076683, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2317.1957166194916, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 20.13333333333333, "ram_util_percent": 68.35833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.833287037037037e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.579112461635, "policy_loss": -1.1502869078665298e+19, "vf_loss": 312192743.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15260.5, "diff_num_grad_updates_vs_sampler_policy": 15259.5}}, "num_env_steps_sampled": 1118400, "num_env_steps_trained": 1118400, "num_agent_steps_sampled": 1118400, "num_agent_steps_trained": 1118400}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114147.77826236, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9047958638317877, "mean_inference_ms": 0.36545723743208164, "mean_action_processing_ms": 0.09001231625339588, "mean_env_wait_ms": 0.9701951215208757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036742687225341797, "StateBufferConnector_ms": 0.002569437026977539, "ViewRequirementAgentConnector_ms": 0.06543564796447754}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114147.77826236, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113937.83578177846, -114435.2205825324, -114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9047958638317877, "mean_inference_ms": 0.36545723743208164, "mean_action_processing_ms": 0.09001231625339588, "mean_env_wait_ms": 0.9701951215208757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036742687225341797, "StateBufferConnector_ms": 0.002569437026977539, "ViewRequirementAgentConnector_ms": 0.06543564796447754}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1118400, "num_agent_steps_trained": 1118400, "num_env_steps_sampled": 1118400, "num_env_steps_trained": 1118400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 418.38271158149, "num_env_steps_trained_throughput_per_sec": 418.38271158149, "timesteps_total": 1118400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1118400, "timers": {"training_iteration_time_ms": 8553.661, "sample_time_ms": 8457.162, "load_time_ms": 1.419, "load_throughput": 2536706.942, "learn_time_ms": 94.227, "learn_throughput": 38205.521, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 1118400, "num_env_steps_trained": 1118400, "num_agent_steps_sampled": 1118400, "num_agent_steps_trained": 1118400}, "done": false, "episodes_total": 1183, "training_iteration": 322, "trial_id": "5f82d_00000", "date": "2023-07-27_00-10-22", "timestamp": 1690405822, "time_this_iter_s": 17.21204710006714, "time_total_s": 4362.237717866898, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2334.4077637195587, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 18.064, "ram_util_percent": 68.336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.499953703703704e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5015694754463, "policy_loss": -1.0792865491062352e+19, "vf_loss": 308731759.5714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15372.5, "diff_num_grad_updates_vs_sampler_policy": 15371.5}}, "num_env_steps_sampled": 1125600, "num_env_steps_trained": 1125600, "num_agent_steps_sampled": 1125600, "num_agent_steps_trained": 1125600}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114137.41647287259, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9047660460214676, "mean_inference_ms": 0.3654508529752074, "mean_action_processing_ms": 0.0900111403499221, "mean_env_wait_ms": 0.9700850549679538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036787986755371094, "StateBufferConnector_ms": 0.002565622329711914, "ViewRequirementAgentConnector_ms": 0.06546711921691895}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114137.41647287259, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114199.5228319911, -113380.73470567416, -113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9047660460214676, "mean_inference_ms": 0.3654508529752074, "mean_action_processing_ms": 0.0900111403499221, "mean_env_wait_ms": 0.9700850549679538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036787986755371094, "StateBufferConnector_ms": 0.002565622329711914, "ViewRequirementAgentConnector_ms": 0.06546711921691895}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1125600, "num_agent_steps_trained": 1125600, "num_env_steps_sampled": 1125600, "num_env_steps_trained": 1125600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 426.6391860389829, "num_env_steps_trained_throughput_per_sec": 426.6391860389829, "timesteps_total": 1125600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1125600, "timers": {"training_iteration_time_ms": 8542.175, "sample_time_ms": 8445.656, "load_time_ms": 1.398, "load_throughput": 2575562.788, "learn_time_ms": 94.264, "learn_throughput": 38190.659, "synch_weights_time_ms": 0.799}, "counters": {"num_env_steps_sampled": 1125600, "num_env_steps_trained": 1125600, "num_agent_steps_sampled": 1125600, "num_agent_steps_trained": 1125600}, "done": false, "episodes_total": 1185, "training_iteration": 323, "trial_id": "5f82d_00000", "date": "2023-07-27_00-10-39", "timestamp": 1690405839, "time_this_iter_s": 16.879013776779175, "time_total_s": 4379.116731643677, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2351.286777496338, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 19.839130434782607, "ram_util_percent": 68.29565217391306}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.16662037037037e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6155460902623, "policy_loss": -1.165271987970431e+19, "vf_loss": 312734419.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15484.5, "diff_num_grad_updates_vs_sampler_policy": 15483.5}}, "num_env_steps_sampled": 1132800, "num_env_steps_trained": 1132800, "num_agent_steps_sampled": 1132800, "num_agent_steps_trained": 1132800}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114147.9220647795, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9047384946946779, "mean_inference_ms": 0.36544477361481187, "mean_action_processing_ms": 0.09001002760114384, "mean_env_wait_ms": 0.9699810185999479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003679037094116211, "StateBufferConnector_ms": 0.002562999725341797, "ViewRequirementAgentConnector_ms": 0.0654606819152832}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114147.9220647795, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113931.45060646451, -114823.36553650834, -113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9047384946946779, "mean_inference_ms": 0.36544477361481187, "mean_action_processing_ms": 0.09001002760114384, "mean_env_wait_ms": 0.9699810185999479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003679037094116211, "StateBufferConnector_ms": 0.002562999725341797, "ViewRequirementAgentConnector_ms": 0.0654606819152832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1132800, "num_agent_steps_trained": 1132800, "num_env_steps_sampled": 1132800, "num_env_steps_trained": 1132800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 412.67059205153976, "num_env_steps_trained_throughput_per_sec": 412.67059205153976, "timesteps_total": 1132800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1132800, "timers": {"training_iteration_time_ms": 8589.613, "sample_time_ms": 8493.16, "load_time_ms": 1.4, "load_throughput": 2572140.638, "learn_time_ms": 94.207, "learn_throughput": 38213.701, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 1132800, "num_env_steps_trained": 1132800, "num_agent_steps_sampled": 1132800, "num_agent_steps_trained": 1132800}, "done": false, "episodes_total": 1187, "training_iteration": 324, "trial_id": "5f82d_00000", "date": "2023-07-27_00-10-56", "timestamp": 1690405856, "time_this_iter_s": 17.45042872428894, "time_total_s": 4396.567160367966, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2368.737206220627, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 18.588, "ram_util_percent": 68.196}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.8332870370370374e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.659408569336, "policy_loss": -1.067407802915032e+19, "vf_loss": 307292360.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15596.5, "diff_num_grad_updates_vs_sampler_policy": 15595.5}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114132.75053726675, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9047095564023954, "mean_inference_ms": 0.3654391634206229, "mean_action_processing_ms": 0.0900089132997482, "mean_env_wait_ms": 0.9698733889947918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036826133728027344, "StateBufferConnector_ms": 0.0025527477264404297, "ViewRequirementAgentConnector_ms": 0.06544971466064453}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114132.75053726675, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113624.5138616778, -114390.01200236505, -113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9047095564023954, "mean_inference_ms": 0.3654391634206229, "mean_action_processing_ms": 0.0900089132997482, "mean_env_wait_ms": 0.9698733889947918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036826133728027344, "StateBufferConnector_ms": 0.0025527477264404297, "ViewRequirementAgentConnector_ms": 0.06544971466064453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.6872077496929, "num_env_steps_trained_throughput_per_sec": 424.6872077496929, "timesteps_total": 1140000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 8579.144, "sample_time_ms": 8482.718, "load_time_ms": 1.374, "load_throughput": 2619620.819, "learn_time_ms": 94.208, "learn_throughput": 38213.498, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "episodes_total": 1189, "training_iteration": 325, "trial_id": "5f82d_00000", "date": "2023-07-27_00-11-13", "timestamp": 1690405873, "time_this_iter_s": 16.956714868545532, "time_total_s": 4413.523875236511, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2385.6939210891724, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 18.929166666666664, "ram_util_percent": 68.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.499953703703703e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5785457066127, "policy_loss": -1.1115016771273472e+19, "vf_loss": 312837224.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15708.5, "diff_num_grad_updates_vs_sampler_policy": 15707.5}}, "num_env_steps_sampled": 1147200, "num_env_steps_trained": 1147200, "num_agent_steps_sampled": 1147200, "num_agent_steps_trained": 1147200}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114140.33408034203, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9046819997392896, "mean_inference_ms": 0.3654343779315478, "mean_action_processing_ms": 0.09000783719636103, "mean_env_wait_ms": 0.9697660741591301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003682851791381836, "StateBufferConnector_ms": 0.0025501251220703125, "ViewRequirementAgentConnector_ms": 0.06545138359069824}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114140.33408034203, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113518.15810985114, -114113.06643399091, -114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9046819997392896, "mean_inference_ms": 0.3654343779315478, "mean_action_processing_ms": 0.09000783719636103, "mean_env_wait_ms": 0.9697660741591301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003682851791381836, "StateBufferConnector_ms": 0.0025501251220703125, "ViewRequirementAgentConnector_ms": 0.06545138359069824}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1147200, "num_agent_steps_trained": 1147200, "num_env_steps_sampled": 1147200, "num_env_steps_trained": 1147200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 416.6937694565078, "num_env_steps_trained_throughput_per_sec": 416.6937694565078, "timesteps_total": 1147200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1147200, "timers": {"training_iteration_time_ms": 8576.491, "sample_time_ms": 8480.106, "load_time_ms": 1.376, "load_throughput": 2616080.668, "learn_time_ms": 94.162, "learn_throughput": 38232.046, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 1147200, "num_env_steps_trained": 1147200, "num_agent_steps_sampled": 1147200, "num_agent_steps_trained": 1147200}, "done": false, "episodes_total": 1191, "training_iteration": 326, "trial_id": "5f82d_00000", "date": "2023-07-27_00-11-31", "timestamp": 1690405891, "time_this_iter_s": 17.28186798095703, "time_total_s": 4430.805743217468, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2402.9757890701294, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 18.887999999999998, "ram_util_percent": 68.252}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.1666203703703705e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6058415004186, "policy_loss": -1.1374028144040999e+19, "vf_loss": 310947776.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15820.5, "diff_num_grad_updates_vs_sampler_policy": 15819.5}}, "num_env_steps_sampled": 1154400, "num_env_steps_trained": 1154400, "num_agent_steps_sampled": 1154400, "num_agent_steps_trained": 1154400}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114155.37154111444, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9046535727351447, "mean_inference_ms": 0.36542980483051707, "mean_action_processing_ms": 0.0900067761882368, "mean_env_wait_ms": 0.9696764592321706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003683805465698242, "StateBufferConnector_ms": 0.0025501251220703125, "ViewRequirementAgentConnector_ms": 0.06546735763549805}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114155.37154111444, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114731.23973060965, -113896.68744539964, -113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9046535727351447, "mean_inference_ms": 0.36542980483051707, "mean_action_processing_ms": 0.0900067761882368, "mean_env_wait_ms": 0.9696764592321706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003683805465698242, "StateBufferConnector_ms": 0.0025501251220703125, "ViewRequirementAgentConnector_ms": 0.06546735763549805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1154400, "num_agent_steps_trained": 1154400, "num_env_steps_sampled": 1154400, "num_env_steps_trained": 1154400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 416.46216999887554, "num_env_steps_trained_throughput_per_sec": 416.46216999887554, "timesteps_total": 1154400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1154400, "timers": {"training_iteration_time_ms": 8584.427, "sample_time_ms": 8488.359, "load_time_ms": 1.377, "load_throughput": 2614359.443, "learn_time_ms": 93.846, "learn_throughput": 38360.821, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 1154400, "num_env_steps_trained": 1154400, "num_agent_steps_sampled": 1154400, "num_agent_steps_trained": 1154400}, "done": false, "episodes_total": 1193, "training_iteration": 327, "trial_id": "5f82d_00000", "date": "2023-07-27_00-11-48", "timestamp": 1690405908, "time_this_iter_s": 17.291404962539673, "time_total_s": 4448.097148180008, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2420.267194032669, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 18.591666666666665, "ram_util_percent": 68.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.8332870370370363e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.639157976423, "policy_loss": -1.1054370957478226e+19, "vf_loss": 307103244.9285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15932.5, "diff_num_grad_updates_vs_sampler_policy": 15931.5}}, "num_env_steps_sampled": 1161600, "num_env_steps_trained": 1161600, "num_agent_steps_sampled": 1161600, "num_agent_steps_trained": 1161600}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114141.88071688227, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9046207636476236, "mean_inference_ms": 0.36542567752903027, "mean_action_processing_ms": 0.09000576526543239, "mean_env_wait_ms": 0.9695821694589779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036835670471191406, "StateBufferConnector_ms": 0.002546548843383789, "ViewRequirementAgentConnector_ms": 0.06543946266174316}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114141.88071688227, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113904.99658163766, -113693.912508763, -113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9046207636476236, "mean_inference_ms": 0.36542567752903027, "mean_action_processing_ms": 0.09000576526543239, "mean_env_wait_ms": 0.9695821694589779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036835670471191406, "StateBufferConnector_ms": 0.002546548843383789, "ViewRequirementAgentConnector_ms": 0.06543946266174316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1161600, "num_agent_steps_trained": 1161600, "num_env_steps_sampled": 1161600, "num_env_steps_trained": 1161600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 431.99459685407857, "num_env_steps_trained_throughput_per_sec": 431.99459685407857, "timesteps_total": 1161600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1161600, "timers": {"training_iteration_time_ms": 8563.506, "sample_time_ms": 8467.196, "load_time_ms": 1.379, "load_throughput": 2610201.632, "learn_time_ms": 94.096, "learn_throughput": 38258.822, "synch_weights_time_ms": 0.774}, "counters": {"num_env_steps_sampled": 1161600, "num_env_steps_trained": 1161600, "num_agent_steps_sampled": 1161600, "num_agent_steps_trained": 1161600}, "done": false, "episodes_total": 1195, "training_iteration": 328, "trial_id": "5f82d_00000", "date": "2023-07-27_00-12-05", "timestamp": 1690405925, "time_this_iter_s": 16.669694185256958, "time_total_s": 4464.766842365265, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2436.936888217926, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 20.933333333333334, "ram_util_percent": 68.11666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.641573224749, "policy_loss": -1.0344668776764213e+19, "vf_loss": 304307293.21428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16044.5, "diff_num_grad_updates_vs_sampler_policy": 16043.5}}, "num_env_steps_sampled": 1168800, "num_env_steps_trained": 1168800, "num_agent_steps_sampled": 1168800, "num_agent_steps_trained": 1168800}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114133.05997785839, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.904586678291552, "mean_inference_ms": 0.3654216357477567, "mean_action_processing_ms": 0.09000479493421473, "mean_env_wait_ms": 0.9694897364673793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036835670471191406, "StateBufferConnector_ms": 0.0025472640991210938, "ViewRequirementAgentConnector_ms": 0.06543278694152832}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114133.05997785839, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113061.84971017207, -114296.29428757598, -113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.904586678291552, "mean_inference_ms": 0.3654216357477567, "mean_action_processing_ms": 0.09000479493421473, "mean_env_wait_ms": 0.9694897364673793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036835670471191406, "StateBufferConnector_ms": 0.0025472640991210938, "ViewRequirementAgentConnector_ms": 0.06543278694152832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168800, "num_agent_steps_trained": 1168800, "num_env_steps_sampled": 1168800, "num_env_steps_trained": 1168800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 428.6661917113339, "num_env_steps_trained_throughput_per_sec": 428.6661917113339, "timesteps_total": 1168800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1168800, "timers": {"training_iteration_time_ms": 8498.401, "sample_time_ms": 8401.43, "load_time_ms": 1.379, "load_throughput": 2610607.791, "learn_time_ms": 94.748, "learn_throughput": 37995.469, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 1168800, "num_env_steps_trained": 1168800, "num_agent_steps_sampled": 1168800, "num_agent_steps_trained": 1168800}, "done": false, "episodes_total": 1197, "training_iteration": 329, "trial_id": "5f82d_00000", "date": "2023-07-27_00-12-21", "timestamp": 1690405941, "time_this_iter_s": 16.799250841140747, "time_total_s": 4481.566093206406, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2453.7361390590668, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 19.42083333333333, "ram_util_percent": 68.30416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6595132010323, "policy_loss": -1.0906786363216177e+19, "vf_loss": 311478101.35714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16156.5, "diff_num_grad_updates_vs_sampler_policy": 16155.5}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114138.17410141275, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9045552472430954, "mean_inference_ms": 0.3654175533846625, "mean_action_processing_ms": 0.09000385972539332, "mean_env_wait_ms": 0.9693944793803212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036895275115966797, "StateBufferConnector_ms": 0.0025446414947509766, "ViewRequirementAgentConnector_ms": 0.06544804573059082}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114138.17410141275, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113570.86871798232, -114618.62606988958, -113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9045552472430954, "mean_inference_ms": 0.3654175533846625, "mean_action_processing_ms": 0.09000385972539332, "mean_env_wait_ms": 0.9693944793803212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036895275115966797, "StateBufferConnector_ms": 0.0025446414947509766, "ViewRequirementAgentConnector_ms": 0.06544804573059082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 428.18598872667644, "num_env_steps_trained_throughput_per_sec": 428.18598872667644, "timesteps_total": 1176000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 8484.548, "sample_time_ms": 8387.38, "load_time_ms": 1.41, "load_throughput": 2554084.88, "learn_time_ms": 94.92, "learn_throughput": 37926.621, "synch_weights_time_ms": 0.778}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 1199, "training_iteration": 330, "trial_id": "5f82d_00000", "date": "2023-07-27_00-12-38", "timestamp": 1690405958, "time_this_iter_s": 16.818088054656982, "time_total_s": 4498.384181261063, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2470.5542271137238, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 20.633333333333333, "ram_util_percent": 68.24583333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6377716064453, "policy_loss": -1.2045383994953173e+19, "vf_loss": 312290965.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16268.5, "diff_num_grad_updates_vs_sampler_policy": 16267.5}}, "num_env_steps_sampled": 1183200, "num_env_steps_trained": 1183200, "num_agent_steps_sampled": 1183200, "num_agent_steps_trained": 1183200}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114139.84355072197, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9045228630808225, "mean_inference_ms": 0.36541317803345935, "mean_action_processing_ms": 0.09000284894201703, "mean_env_wait_ms": 0.9693099369135066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036885738372802734, "StateBufferConnector_ms": 0.002545595169067383, "ViewRequirementAgentConnector_ms": 0.06546187400817871}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114139.84355072197, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113660.2731373356, -114506.70852629787, -113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9045228630808225, "mean_inference_ms": 0.36541317803345935, "mean_action_processing_ms": 0.09000284894201703, "mean_env_wait_ms": 0.9693099369135066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036885738372802734, "StateBufferConnector_ms": 0.002545595169067383, "ViewRequirementAgentConnector_ms": 0.06546187400817871}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1183200, "num_agent_steps_trained": 1183200, "num_env_steps_sampled": 1183200, "num_env_steps_trained": 1183200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.40050001262154, "num_env_steps_trained_throughput_per_sec": 421.40050001262154, "timesteps_total": 1183200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1183200, "timers": {"training_iteration_time_ms": 8465.249, "sample_time_ms": 8367.926, "load_time_ms": 1.41, "load_throughput": 2554084.88, "learn_time_ms": 95.067, "learn_throughput": 37868.011, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 1183200, "num_env_steps_trained": 1183200, "num_agent_steps_sampled": 1183200, "num_agent_steps_trained": 1183200}, "done": false, "episodes_total": 1201, "training_iteration": 331, "trial_id": "5f82d_00000", "date": "2023-07-27_00-12-55", "timestamp": 1690405975, "time_this_iter_s": 17.088796138763428, "time_total_s": 4515.472977399826, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2487.643023252487, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 18.3, "ram_util_percent": 68.21666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6416277204241, "policy_loss": -1.0116743646547997e+19, "vf_loss": 307258524.78571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16380.5, "diff_num_grad_updates_vs_sampler_policy": 16379.5}}, "num_env_steps_sampled": 1190400, "num_env_steps_trained": 1190400, "num_agent_steps_sampled": 1190400, "num_agent_steps_trained": 1190400}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114132.22961362851, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9044911407952607, "mean_inference_ms": 0.36540882640717376, "mean_action_processing_ms": 0.09000184739315868, "mean_env_wait_ms": 0.9692248568923344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036847591400146484, "StateBufferConnector_ms": 0.0025489330291748047, "ViewRequirementAgentConnector_ms": 0.06544017791748047}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114132.22961362851, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113783.29426538025, -113784.98077232744, -114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9044911407952607, "mean_inference_ms": 0.36540882640717376, "mean_action_processing_ms": 0.09000184739315868, "mean_env_wait_ms": 0.9692248568923344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036847591400146484, "StateBufferConnector_ms": 0.0025489330291748047, "ViewRequirementAgentConnector_ms": 0.06544017791748047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1190400, "num_agent_steps_trained": 1190400, "num_env_steps_sampled": 1190400, "num_env_steps_trained": 1190400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.74232186441907, "num_env_steps_trained_throughput_per_sec": 424.74232186441907, "timesteps_total": 1190400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1190400, "timers": {"training_iteration_time_ms": 8431.545, "sample_time_ms": 8333.657, "load_time_ms": 1.454, "load_throughput": 2476585.543, "learn_time_ms": 95.591, "learn_throughput": 37660.601, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 1190400, "num_env_steps_trained": 1190400, "num_agent_steps_sampled": 1190400, "num_agent_steps_trained": 1190400}, "done": false, "episodes_total": 1203, "training_iteration": 332, "trial_id": "5f82d_00000", "date": "2023-07-27_00-13-12", "timestamp": 1690405992, "time_this_iter_s": 16.954432010650635, "time_total_s": 4532.427409410477, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2504.597455263138, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 18.787499999999998, "ram_util_percent": 68.32916666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.56929234096, "policy_loss": -1.1135819435418626e+19, "vf_loss": 309419575.4285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16492.5, "diff_num_grad_updates_vs_sampler_policy": 16491.5}}, "num_env_steps_sampled": 1197600, "num_env_steps_trained": 1197600, "num_agent_steps_sampled": 1197600, "num_agent_steps_trained": 1197600}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114134.30207829978, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9044600837410792, "mean_inference_ms": 0.3654044473512738, "mean_action_processing_ms": 0.09000085789396327, "mean_env_wait_ms": 0.9691446483809565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00368499755859375, "StateBufferConnector_ms": 0.0025496482849121094, "ViewRequirementAgentConnector_ms": 0.06534790992736816}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114134.30207829978, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114327.54395419422, -113300.55574364636, -114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9044600837410792, "mean_inference_ms": 0.3654044473512738, "mean_action_processing_ms": 0.09000085789396327, "mean_env_wait_ms": 0.9691446483809565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00368499755859375, "StateBufferConnector_ms": 0.0025496482849121094, "ViewRequirementAgentConnector_ms": 0.06534790992736816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1197600, "num_agent_steps_trained": 1197600, "num_env_steps_sampled": 1197600, "num_env_steps_trained": 1197600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.3937795617029, "num_env_steps_trained_throughput_per_sec": 424.3937795617029, "timesteps_total": 1197600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1197600, "timers": {"training_iteration_time_ms": 8461.396, "sample_time_ms": 8363.321, "load_time_ms": 1.451, "load_throughput": 2480654.258, "learn_time_ms": 95.777, "learn_throughput": 37587.43, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 1197600, "num_env_steps_trained": 1197600, "num_agent_steps_sampled": 1197600, "num_agent_steps_trained": 1197600}, "done": false, "episodes_total": 1205, "training_iteration": 333, "trial_id": "5f82d_00000", "date": "2023-07-27_00-13-29", "timestamp": 1690406009, "time_this_iter_s": 16.968273878097534, "time_total_s": 4549.395683288574, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2521.5657291412354, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 18.8, "ram_util_percent": 68.37083333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6080409458705, "policy_loss": -9.756852998687457e+18, "vf_loss": 307905232.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16604.5, "diff_num_grad_updates_vs_sampler_policy": 16603.5}}, "num_env_steps_sampled": 1204800, "num_env_steps_trained": 1204800, "num_agent_steps_sampled": 1204800, "num_agent_steps_trained": 1204800}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114130.84997615064, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9044279323582333, "mean_inference_ms": 0.3654002456984316, "mean_action_processing_ms": 0.08999986297075957, "mean_env_wait_ms": 0.9690637813915501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036859512329101562, "StateBufferConnector_ms": 0.0025484561920166016, "ViewRequirementAgentConnector_ms": 0.06537699699401855}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114130.84997615064, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114907.25312708058, -114424.28931671417, -114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9044279323582333, "mean_inference_ms": 0.3654002456984316, "mean_action_processing_ms": 0.08999986297075957, "mean_env_wait_ms": 0.9690637813915501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036859512329101562, "StateBufferConnector_ms": 0.0025484561920166016, "ViewRequirementAgentConnector_ms": 0.06537699699401855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1204800, "num_agent_steps_trained": 1204800, "num_env_steps_sampled": 1204800, "num_env_steps_trained": 1204800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 428.5896708020237, "num_env_steps_trained_throughput_per_sec": 428.5896708020237, "timesteps_total": 1204800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1204800, "timers": {"training_iteration_time_ms": 8461.695, "sample_time_ms": 8364.191, "load_time_ms": 1.477, "load_throughput": 2436699.275, "learn_time_ms": 95.176, "learn_throughput": 37824.603, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 1204800, "num_env_steps_trained": 1204800, "num_agent_steps_sampled": 1204800, "num_agent_steps_trained": 1204800}, "done": false, "episodes_total": 1207, "training_iteration": 334, "trial_id": "5f82d_00000", "date": "2023-07-27_00-13-46", "timestamp": 1690406026, "time_this_iter_s": 16.802149295806885, "time_total_s": 4566.197832584381, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2538.3678784370422, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 18.570833333333333, "ram_util_percent": 68.3375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6224408830915, "policy_loss": -1.087991479046876e+19, "vf_loss": 309640559.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16716.5, "diff_num_grad_updates_vs_sampler_policy": 16715.5}}, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114121.04170993673, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9043941920966054, "mean_inference_ms": 0.3653962477380137, "mean_action_processing_ms": 0.08999893897118925, "mean_env_wait_ms": 0.9689812265336425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003688335418701172, "StateBufferConnector_ms": 0.002547025680541992, "ViewRequirementAgentConnector_ms": 0.06540203094482422}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114121.04170993673, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114419.66936476537, -113369.80023804228, -113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9043941920966054, "mean_inference_ms": 0.3653962477380137, "mean_action_processing_ms": 0.08999893897118925, "mean_env_wait_ms": 0.9689812265336425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003688335418701172, "StateBufferConnector_ms": 0.002547025680541992, "ViewRequirementAgentConnector_ms": 0.06540203094482422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.96286164600605, "num_env_steps_trained_throughput_per_sec": 424.96286164600605, "timesteps_total": 1212000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 8474.449, "sample_time_ms": 8376.897, "load_time_ms": 1.45, "load_throughput": 2482571.175, "learn_time_ms": 95.247, "learn_throughput": 37796.407, "synch_weights_time_ms": 0.796}, "counters": {"num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "episodes_total": 1209, "training_iteration": 335, "trial_id": "5f82d_00000", "date": "2023-07-27_00-14-03", "timestamp": 1690406043, "time_this_iter_s": 16.94557476043701, "time_total_s": 4583.143407344818, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2555.3134531974792, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 19.900000000000002, "ram_util_percent": 68.22500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6323830740791, "policy_loss": -1.1442211699513684e+19, "vf_loss": 314838771.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16828.5, "diff_num_grad_updates_vs_sampler_policy": 16827.5}}, "num_env_steps_sampled": 1219200, "num_env_steps_trained": 1219200, "num_agent_steps_sampled": 1219200, "num_agent_steps_trained": 1219200}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114134.68867221609, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9043609999573238, "mean_inference_ms": 0.36539264953908124, "mean_action_processing_ms": 0.08999806269656783, "mean_env_wait_ms": 0.9689041949643858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036911964416503906, "StateBufferConnector_ms": 0.0025517940521240234, "ViewRequirementAgentConnector_ms": 0.06534481048583984}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114134.68867221609, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113737.70767875045, -114552.4025145259, -114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9043609999573238, "mean_inference_ms": 0.36539264953908124, "mean_action_processing_ms": 0.08999806269656783, "mean_env_wait_ms": 0.9689041949643858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036911964416503906, "StateBufferConnector_ms": 0.0025517940521240234, "ViewRequirementAgentConnector_ms": 0.06534481048583984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1219200, "num_agent_steps_trained": 1219200, "num_env_steps_sampled": 1219200, "num_env_steps_trained": 1219200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.3769155466247, "num_env_steps_trained_throughput_per_sec": 421.3769155466247, "timesteps_total": 1219200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1219200, "timers": {"training_iteration_time_ms": 8474.545, "sample_time_ms": 8376.874, "load_time_ms": 1.483, "load_throughput": 2427805.64, "learn_time_ms": 95.333, "learn_throughput": 37762.434, "synch_weights_time_ms": 0.796}, "counters": {"num_env_steps_sampled": 1219200, "num_env_steps_trained": 1219200, "num_agent_steps_sampled": 1219200, "num_agent_steps_trained": 1219200}, "done": false, "episodes_total": 1211, "training_iteration": 336, "trial_id": "5f82d_00000", "date": "2023-07-27_00-14-20", "timestamp": 1690406060, "time_this_iter_s": 17.089902877807617, "time_total_s": 4600.233310222626, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2572.403356075287, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 19.3875, "ram_util_percent": 68.45416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.339955555555556e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.596703665597, "policy_loss": -9.905970430839706e+18, "vf_loss": 305742000.4285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16940.5, "diff_num_grad_updates_vs_sampler_policy": 16939.5}}, "num_env_steps_sampled": 1226400, "num_env_steps_trained": 1226400, "num_agent_steps_sampled": 1226400, "num_agent_steps_trained": 1226400}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114118.03928792711, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9043270236826371, "mean_inference_ms": 0.3653890601378372, "mean_action_processing_ms": 0.08999723284015343, "mean_env_wait_ms": 0.9688241864064022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696918487548828, "StateBufferConnector_ms": 0.0025408267974853516, "ViewRequirementAgentConnector_ms": 0.0653371810913086}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114118.03928792711, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114462.04815040484, -113856.78524630572, -114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9043270236826371, "mean_inference_ms": 0.3653890601378372, "mean_action_processing_ms": 0.08999723284015343, "mean_env_wait_ms": 0.9688241864064022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696918487548828, "StateBufferConnector_ms": 0.0025408267974853516, "ViewRequirementAgentConnector_ms": 0.0653371810913086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1226400, "num_agent_steps_trained": 1226400, "num_env_steps_sampled": 1226400, "num_env_steps_trained": 1226400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 427.16864302904054, "num_env_steps_trained_throughput_per_sec": 427.16864302904054, "timesteps_total": 1226400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1226400, "timers": {"training_iteration_time_ms": 8464.916, "sample_time_ms": 8367.662, "load_time_ms": 1.437, "load_throughput": 2504518.967, "learn_time_ms": 94.968, "learn_throughput": 37907.331, "synch_weights_time_ms": 0.79}, "counters": {"num_env_steps_sampled": 1226400, "num_env_steps_trained": 1226400, "num_agent_steps_sampled": 1226400, "num_agent_steps_trained": 1226400}, "done": false, "episodes_total": 1213, "training_iteration": 337, "trial_id": "5f82d_00000", "date": "2023-07-27_00-14-37", "timestamp": 1690406077, "time_this_iter_s": 16.858083963394165, "time_total_s": 4617.09139418602, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2589.261440038681, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 18.829166666666666, "ram_util_percent": 68.45416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0199555555555555e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6449323381696, "policy_loss": -1.1111983536234359e+19, "vf_loss": 312308262.64285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17052.5, "diff_num_grad_updates_vs_sampler_policy": 17051.5}}, "num_env_steps_sampled": 1233600, "num_env_steps_trained": 1233600, "num_agent_steps_sampled": 1233600, "num_agent_steps_trained": 1233600}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114122.11169222734, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9042943611114864, "mean_inference_ms": 0.3653855463773421, "mean_action_processing_ms": 0.08999643484847766, "mean_env_wait_ms": 0.9687497518304633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037043094635009766, "StateBufferConnector_ms": 0.002543926239013672, "ViewRequirementAgentConnector_ms": 0.06535625457763672}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114122.11169222734, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114278.32200835478, -115005.28243473671, -114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9042943611114864, "mean_inference_ms": 0.3653855463773421, "mean_action_processing_ms": 0.08999643484847766, "mean_env_wait_ms": 0.9687497518304633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037043094635009766, "StateBufferConnector_ms": 0.002543926239013672, "ViewRequirementAgentConnector_ms": 0.06535625457763672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1233600, "num_agent_steps_trained": 1233600, "num_env_steps_sampled": 1233600, "num_env_steps_trained": 1233600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.0568017742868, "num_env_steps_trained_throughput_per_sec": 423.0568017742868, "timesteps_total": 1233600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1233600, "timers": {"training_iteration_time_ms": 8470.278, "sample_time_ms": 8373.115, "load_time_ms": 1.458, "load_throughput": 2469456.93, "learn_time_ms": 94.855, "learn_throughput": 37952.646, "synch_weights_time_ms": 0.791}, "counters": {"num_env_steps_sampled": 1233600, "num_env_steps_trained": 1233600, "num_agent_steps_sampled": 1233600, "num_agent_steps_trained": 1233600}, "done": false, "episodes_total": 1215, "training_iteration": 338, "trial_id": "5f82d_00000", "date": "2023-07-27_00-14-54", "timestamp": 1690406094, "time_this_iter_s": 17.0219829082489, "time_total_s": 4634.113377094269, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2606.28342294693, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 18.3125, "ram_util_percent": 68.30416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.6999555555555553e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6527513776507, "policy_loss": -1.0441532559166396e+19, "vf_loss": 310289795.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17164.5, "diff_num_grad_updates_vs_sampler_policy": 17163.5}}, "num_env_steps_sampled": 1240800, "num_env_steps_trained": 1240800, "num_agent_steps_sampled": 1240800, "num_agent_steps_trained": 1240800}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114113.28642394685, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9042611896700993, "mean_inference_ms": 0.3653821604802209, "mean_action_processing_ms": 0.0899956804699794, "mean_env_wait_ms": 0.9686764169979517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704547882080078, "StateBufferConnector_ms": 0.0025446414947509766, "ViewRequirementAgentConnector_ms": 0.06534314155578613}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115468.08809124639, "episode_reward_mean": -114113.28642394685, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114444.57166057425, -115468.08809124639, -114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9042611896700993, "mean_inference_ms": 0.3653821604802209, "mean_action_processing_ms": 0.0899956804699794, "mean_env_wait_ms": 0.9686764169979517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704547882080078, "StateBufferConnector_ms": 0.0025446414947509766, "ViewRequirementAgentConnector_ms": 0.06534314155578613}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1240800, "num_agent_steps_trained": 1240800, "num_env_steps_sampled": 1240800, "num_env_steps_trained": 1240800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 432.79608689936407, "num_env_steps_trained_throughput_per_sec": 432.79608689936407, "timesteps_total": 1240800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1240800, "timers": {"training_iteration_time_ms": 8453.949, "sample_time_ms": 8357.018, "load_time_ms": 1.433, "load_throughput": 2512687.734, "learn_time_ms": 94.651, "learn_throughput": 38034.355, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 1240800, "num_env_steps_trained": 1240800, "num_agent_steps_sampled": 1240800, "num_agent_steps_trained": 1240800}, "done": false, "episodes_total": 1217, "training_iteration": 339, "trial_id": "5f82d_00000", "date": "2023-07-27_00-15-11", "timestamp": 1690406111, "time_this_iter_s": 16.638954639434814, "time_total_s": 4650.752331733704, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2622.9223775863647, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 23.62173913043478, "ram_util_percent": 68.30869565217392}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.379955555555555e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6490783691406, "policy_loss": -1.1055102829398514e+19, "vf_loss": 310031073.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17276.5, "diff_num_grad_updates_vs_sampler_policy": 17275.5}}, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114091.42807166185, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9042287929568903, "mean_inference_ms": 0.36537866014612347, "mean_action_processing_ms": 0.08999488459359585, "mean_env_wait_ms": 0.9685965362050902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003703594207763672, "StateBufferConnector_ms": 0.002533435821533203, "ViewRequirementAgentConnector_ms": 0.06534695625305176}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114091.42807166185, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114719.06823320012, -114517.10491435946, -113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9042287929568903, "mean_inference_ms": 0.36537866014612347, "mean_action_processing_ms": 0.08999488459359585, "mean_env_wait_ms": 0.9685965362050902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003703594207763672, "StateBufferConnector_ms": 0.002533435821533203, "ViewRequirementAgentConnector_ms": 0.06534695625305176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 428.8465296456125, "num_env_steps_trained_throughput_per_sec": 428.8465296456125, "timesteps_total": 1248000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 8438.606, "sample_time_ms": 8341.908, "load_time_ms": 1.47, "load_throughput": 2449506.74, "learn_time_ms": 94.391, "learn_throughput": 38139.292, "synch_weights_time_ms": 0.778}, "counters": {"num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "episodes_total": 1219, "training_iteration": 340, "trial_id": "5f82d_00000", "date": "2023-07-27_00-15-28", "timestamp": 1690406128, "time_this_iter_s": 16.792426109313965, "time_total_s": 4667.544757843018, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2639.7148036956787, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 21.712500000000002, "ram_util_percent": 68.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0599555555555556e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.623519897461, "policy_loss": -1.0790703399715154e+19, "vf_loss": 307537617.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17388.5, "diff_num_grad_updates_vs_sampler_policy": 17387.5}}, "num_env_steps_sampled": 1255200, "num_env_steps_trained": 1255200, "num_agent_steps_sampled": 1255200, "num_agent_steps_trained": 1255200}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114082.9962857539, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9041989977443906, "mean_inference_ms": 0.3653753034479651, "mean_action_processing_ms": 0.08999408248274872, "mean_env_wait_ms": 0.9685196014191344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037021636962890625, "StateBufferConnector_ms": 0.002534151077270508, "ViewRequirementAgentConnector_ms": 0.06528592109680176}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114082.9962857539, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113524.93024945795, -112590.9644823077, -114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9041989977443906, "mean_inference_ms": 0.3653753034479651, "mean_action_processing_ms": 0.08999408248274872, "mean_env_wait_ms": 0.9685196014191344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037021636962890625, "StateBufferConnector_ms": 0.002534151077270508, "ViewRequirementAgentConnector_ms": 0.06528592109680176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1255200, "num_agent_steps_trained": 1255200, "num_env_steps_sampled": 1255200, "num_env_steps_trained": 1255200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.97433086114233, "num_env_steps_trained_throughput_per_sec": 421.97433086114233, "timesteps_total": 1255200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1255200, "timers": {"training_iteration_time_ms": 8436.187, "sample_time_ms": 8339.448, "load_time_ms": 1.463, "load_throughput": 2461004.71, "learn_time_ms": 94.438, "learn_throughput": 38120.15, "synch_weights_time_ms": 0.778}, "counters": {"num_env_steps_sampled": 1255200, "num_env_steps_trained": 1255200, "num_agent_steps_sampled": 1255200, "num_agent_steps_trained": 1255200}, "done": false, "episodes_total": 1221, "training_iteration": 341, "trial_id": "5f82d_00000", "date": "2023-07-27_00-15-45", "timestamp": 1690406145, "time_this_iter_s": 17.065788745880127, "time_total_s": 4684.610546588898, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2656.780592441559, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 18.733333333333334, "ram_util_percent": 68.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.399555555555558e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6349836077009, "policy_loss": -1.1566806082220345e+19, "vf_loss": 314878865.64285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17500.5, "diff_num_grad_updates_vs_sampler_policy": 17499.5}}, "num_env_steps_sampled": 1262400, "num_env_steps_trained": 1262400, "num_agent_steps_sampled": 1262400, "num_agent_steps_trained": 1262400}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114114.82836679649, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.904171416719326, "mean_inference_ms": 0.3653720923797401, "mean_action_processing_ms": 0.08999334264861612, "mean_env_wait_ms": 0.9684514820408978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036995410919189453, "StateBufferConnector_ms": 0.002532958984375, "ViewRequirementAgentConnector_ms": 0.06533360481262207}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114114.82836679649, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114084.07641117509, -114174.63139929887, -114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.904171416719326, "mean_inference_ms": 0.3653720923797401, "mean_action_processing_ms": 0.08999334264861612, "mean_env_wait_ms": 0.9684514820408978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036995410919189453, "StateBufferConnector_ms": 0.002532958984375, "ViewRequirementAgentConnector_ms": 0.06533360481262207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1262400, "num_agent_steps_trained": 1262400, "num_env_steps_sampled": 1262400, "num_env_steps_trained": 1262400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.5151907157696, "num_env_steps_trained_throughput_per_sec": 421.5151907157696, "timesteps_total": 1262400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1262400, "timers": {"training_iteration_time_ms": 8458.793, "sample_time_ms": 8361.676, "load_time_ms": 1.46, "load_throughput": 2465424.835, "learn_time_ms": 94.823, "learn_throughput": 37965.653, "synch_weights_time_ms": 0.775}, "counters": {"num_env_steps_sampled": 1262400, "num_env_steps_trained": 1262400, "num_agent_steps_sampled": 1262400, "num_agent_steps_trained": 1262400}, "done": false, "episodes_total": 1223, "training_iteration": 342, "trial_id": "5f82d_00000", "date": "2023-07-27_00-16-02", "timestamp": 1690406162, "time_this_iter_s": 17.08418893814087, "time_total_s": 4701.694735527039, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2673.8647813796997, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 17.968, "ram_util_percent": 68.21600000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.199555555555555e-08, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6344909667969, "policy_loss": -1.0119247224634927e+19, "vf_loss": 308190044.78571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17612.5, "diff_num_grad_updates_vs_sampler_policy": 17611.5}}, "num_env_steps_sampled": 1269600, "num_env_steps_trained": 1269600, "num_agent_steps_sampled": 1269600, "num_agent_steps_trained": 1269600}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114105.43819446984, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.904144123376432, "mean_inference_ms": 0.36536897524783923, "mean_action_processing_ms": 0.08999263530389101, "mean_env_wait_ms": 0.9683851413205116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036962032318115234, "StateBufferConnector_ms": 0.0025377273559570312, "ViewRequirementAgentConnector_ms": 0.06535720825195312}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114105.43819446984, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114478.64641636371, -114550.6786577773, -114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.904144123376432, "mean_inference_ms": 0.36536897524783923, "mean_action_processing_ms": 0.08999263530389101, "mean_env_wait_ms": 0.9683851413205116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036962032318115234, "StateBufferConnector_ms": 0.0025377273559570312, "ViewRequirementAgentConnector_ms": 0.06535720825195312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1269600, "num_agent_steps_trained": 1269600, "num_env_steps_sampled": 1269600, "num_env_steps_trained": 1269600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 428.0059813429347, "num_env_steps_trained_throughput_per_sec": 428.0059813429347, "timesteps_total": 1269600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1269600, "timers": {"training_iteration_time_ms": 8439.113, "sample_time_ms": 8342.039, "load_time_ms": 1.449, "load_throughput": 2484695.475, "learn_time_ms": 94.786, "learn_throughput": 37980.417, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 1269600, "num_env_steps_trained": 1269600, "num_agent_steps_sampled": 1269600, "num_agent_steps_trained": 1269600}, "done": false, "episodes_total": 1225, "training_iteration": 343, "trial_id": "5f82d_00000", "date": "2023-07-27_00-16-19", "timestamp": 1690406179, "time_this_iter_s": 16.82506799697876, "time_total_s": 4718.519803524017, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2690.6898493766785, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 18.587500000000002, "ram_util_percent": 68.30416666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6395416259766, "policy_loss": -1.1019507328314933e+19, "vf_loss": 313110284.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17724.5, "diff_num_grad_updates_vs_sampler_policy": 17723.5}}, "num_env_steps_sampled": 1276800, "num_env_steps_trained": 1276800, "num_agent_steps_sampled": 1276800, "num_agent_steps_trained": 1276800}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114097.93209787732, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9041187979364125, "mean_inference_ms": 0.3653662639664874, "mean_action_processing_ms": 0.08999197414144422, "mean_env_wait_ms": 0.9683176868536411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036911964416503906, "StateBufferConnector_ms": 0.002536773681640625, "ViewRequirementAgentConnector_ms": 0.06535601615905762}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114097.93209787732, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114612.70211883723, -114156.52277920957, -113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9041187979364125, "mean_inference_ms": 0.3653662639664874, "mean_action_processing_ms": 0.08999197414144422, "mean_env_wait_ms": 0.9683176868536411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036911964416503906, "StateBufferConnector_ms": 0.002536773681640625, "ViewRequirementAgentConnector_ms": 0.06535601615905762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1276800, "num_agent_steps_trained": 1276800, "num_env_steps_sampled": 1276800, "num_env_steps_trained": 1276800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 426.7520425432334, "num_env_steps_trained_throughput_per_sec": 426.7520425432334, "timesteps_total": 1276800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1276800, "timers": {"training_iteration_time_ms": 8462.676, "sample_time_ms": 8365.171, "load_time_ms": 1.452, "load_throughput": 2478903.073, "learn_time_ms": 95.219, "learn_throughput": 37807.631, "synch_weights_time_ms": 0.774}, "counters": {"num_env_steps_sampled": 1276800, "num_env_steps_trained": 1276800, "num_agent_steps_sampled": 1276800, "num_agent_steps_trained": 1276800}, "done": false, "episodes_total": 1227, "training_iteration": 344, "trial_id": "5f82d_00000", "date": "2023-07-27_00-16-36", "timestamp": 1690406196, "time_this_iter_s": 16.874574184417725, "time_total_s": 4735.394377708435, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2707.564423561096, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 19.64347826086957, "ram_util_percent": 68.25217391304348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.4935193743024, "policy_loss": -1.1711497679464006e+19, "vf_loss": 313243642.14285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17836.5, "diff_num_grad_updates_vs_sampler_policy": 17835.5}}, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114093.06884172153, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9040918885181872, "mean_inference_ms": 0.36536328222786496, "mean_action_processing_ms": 0.08999129443744298, "mean_env_wait_ms": 0.9682501301592998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036940574645996094, "StateBufferConnector_ms": 0.002537250518798828, "ViewRequirementAgentConnector_ms": 0.0653388500213623}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114093.06884172153, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113706.4396182907, -113987.79554474198, -114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9040918885181872, "mean_inference_ms": 0.36536328222786496, "mean_action_processing_ms": 0.08999129443744298, "mean_env_wait_ms": 0.9682501301592998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036940574645996094, "StateBufferConnector_ms": 0.002537250518798828, "ViewRequirementAgentConnector_ms": 0.0653388500213623}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 425.09310061775415, "num_env_steps_trained_throughput_per_sec": 425.09310061775415, "timesteps_total": 1284000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 8477.5, "sample_time_ms": 8380.021, "load_time_ms": 1.444, "load_throughput": 2492858.695, "learn_time_ms": 95.192, "learn_throughput": 37818.388, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "episodes_total": 1229, "training_iteration": 345, "trial_id": "5f82d_00000", "date": "2023-07-27_00-16-53", "timestamp": 1690406213, "time_this_iter_s": 16.940404891967773, "time_total_s": 4752.334782600403, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2724.504828453064, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 19.104166666666668, "ram_util_percent": 68.22916666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5912911551338, "policy_loss": -1.1199807772953467e+19, "vf_loss": 311317812.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17948.5, "diff_num_grad_updates_vs_sampler_policy": 17947.5}}, "num_env_steps_sampled": 1291200, "num_env_steps_trained": 1291200, "num_agent_steps_sampled": 1291200, "num_agent_steps_trained": 1291200}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114098.97344195795, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9040673320604846, "mean_inference_ms": 0.365360431766609, "mean_action_processing_ms": 0.08999059887255174, "mean_env_wait_ms": 0.9681832582398674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003694772720336914, "StateBufferConnector_ms": 0.002532958984375, "ViewRequirementAgentConnector_ms": 0.06533241271972656}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114098.97344195795, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114110.10901175794, -114023.97284790588, -114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9040673320604846, "mean_inference_ms": 0.365360431766609, "mean_action_processing_ms": 0.08999059887255174, "mean_env_wait_ms": 0.9681832582398674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003694772720336914, "StateBufferConnector_ms": 0.002532958984375, "ViewRequirementAgentConnector_ms": 0.06533241271972656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1291200, "num_agent_steps_trained": 1291200, "num_env_steps_sampled": 1291200, "num_env_steps_trained": 1291200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 426.25846864199383, "num_env_steps_trained_throughput_per_sec": 426.25846864199383, "timesteps_total": 1291200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1291200, "timers": {"training_iteration_time_ms": 8460.351, "sample_time_ms": 8363.468, "load_time_ms": 1.418, "load_throughput": 2538242.066, "learn_time_ms": 94.621, "learn_throughput": 38046.603, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 1291200, "num_env_steps_trained": 1291200, "num_agent_steps_sampled": 1291200, "num_agent_steps_trained": 1291200}, "done": false, "episodes_total": 1231, "training_iteration": 346, "trial_id": "5f82d_00000", "date": "2023-07-27_00-17-10", "timestamp": 1690406230, "time_this_iter_s": 16.894031047821045, "time_total_s": 4769.228813648224, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2741.398859500885, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 19.712500000000002, "ram_util_percent": 68.25833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6551535470146, "policy_loss": -1.1863141980782733e+19, "vf_loss": 309501712.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18060.5, "diff_num_grad_updates_vs_sampler_policy": 18059.5}}, "num_env_steps_sampled": 1298400, "num_env_steps_trained": 1298400, "num_agent_steps_sampled": 1298400, "num_agent_steps_trained": 1298400}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114099.69460087434, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.90404383296564, "mean_inference_ms": 0.3653576034710977, "mean_action_processing_ms": 0.08998990908531333, "mean_env_wait_ms": 0.9681189963887007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036973953247070312, "StateBufferConnector_ms": 0.0025348663330078125, "ViewRequirementAgentConnector_ms": 0.06539392471313477}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114099.69460087434, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114126.29729144399, -114589.70210420036, -114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.90404383296564, "mean_inference_ms": 0.3653576034710977, "mean_action_processing_ms": 0.08998990908531333, "mean_env_wait_ms": 0.9681189963887007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036973953247070312, "StateBufferConnector_ms": 0.0025348663330078125, "ViewRequirementAgentConnector_ms": 0.06539392471313477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1298400, "num_agent_steps_trained": 1298400, "num_env_steps_sampled": 1298400, "num_env_steps_trained": 1298400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 417.8185199832895, "num_env_steps_trained_throughput_per_sec": 417.8185199832895, "timesteps_total": 1298400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1298400, "timers": {"training_iteration_time_ms": 8475.464, "sample_time_ms": 8378.682, "load_time_ms": 1.424, "load_throughput": 2527915.89, "learn_time_ms": 94.514, "learn_throughput": 38089.513, "synch_weights_time_ms": 0.785}, "counters": {"num_env_steps_sampled": 1298400, "num_env_steps_trained": 1298400, "num_agent_steps_sampled": 1298400, "num_agent_steps_trained": 1298400}, "done": false, "episodes_total": 1233, "training_iteration": 347, "trial_id": "5f82d_00000", "date": "2023-07-27_00-17-27", "timestamp": 1690406247, "time_this_iter_s": 17.235281944274902, "time_total_s": 4786.464095592499, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2758.63414144516, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 18.064, "ram_util_percent": 68.388}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6356157575335, "policy_loss": -1.1953416753461705e+19, "vf_loss": 313192840.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18172.5, "diff_num_grad_updates_vs_sampler_policy": 18171.5}}, "num_env_steps_sampled": 1305600, "num_env_steps_trained": 1305600, "num_agent_steps_sampled": 1305600, "num_agent_steps_trained": 1305600}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114104.14352806516, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9040199437413662, "mean_inference_ms": 0.36535502176520074, "mean_action_processing_ms": 0.0899892799316049, "mean_env_wait_ms": 0.9680543033281275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696441650390625, "StateBufferConnector_ms": 0.0025386810302734375, "ViewRequirementAgentConnector_ms": 0.06541585922241211}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114104.14352806516, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114365.72830963419, -114159.47300247564, -114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9040199437413662, "mean_inference_ms": 0.36535502176520074, "mean_action_processing_ms": 0.0899892799316049, "mean_env_wait_ms": 0.9680543033281275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696441650390625, "StateBufferConnector_ms": 0.0025386810302734375, "ViewRequirementAgentConnector_ms": 0.06541585922241211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1305600, "num_agent_steps_trained": 1305600, "num_env_steps_sampled": 1305600, "num_env_steps_trained": 1305600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.3690597672027, "num_env_steps_trained_throughput_per_sec": 424.3690597672027, "timesteps_total": 1305600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1305600, "timers": {"training_iteration_time_ms": 8489.881, "sample_time_ms": 8393.208, "load_time_ms": 1.417, "load_throughput": 2539736.33, "learn_time_ms": 94.413, "learn_throughput": 38130.152, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 1305600, "num_env_steps_trained": 1305600, "num_agent_steps_sampled": 1305600, "num_agent_steps_trained": 1305600}, "done": false, "episodes_total": 1235, "training_iteration": 348, "trial_id": "5f82d_00000", "date": "2023-07-27_00-17-44", "timestamp": 1690406264, "time_this_iter_s": 16.969316005706787, "time_total_s": 4803.433411598206, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2775.6034574508667, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 19.775, "ram_util_percent": 68.38333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6149727957588, "policy_loss": -1.0745945153923412e+19, "vf_loss": 310590149.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18284.5, "diff_num_grad_updates_vs_sampler_policy": 18283.5}}, "num_env_steps_sampled": 1312800, "num_env_steps_trained": 1312800, "num_agent_steps_sampled": 1312800, "num_agent_steps_trained": 1312800}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114101.81861167414, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.903995375238145, "mean_inference_ms": 0.3653524649323694, "mean_action_processing_ms": 0.08998867509430859, "mean_env_wait_ms": 0.9679874385092806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036978721618652344, "StateBufferConnector_ms": 0.0025370121002197266, "ViewRequirementAgentConnector_ms": 0.06544804573059082}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114101.81861167414, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114310.8090743003, -114305.28586638521, -113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.903995375238145, "mean_inference_ms": 0.3653524649323694, "mean_action_processing_ms": 0.08998867509430859, "mean_env_wait_ms": 0.9679874385092806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036978721618652344, "StateBufferConnector_ms": 0.0025370121002197266, "ViewRequirementAgentConnector_ms": 0.06544804573059082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312800, "num_agent_steps_trained": 1312800, "num_env_steps_sampled": 1312800, "num_env_steps_trained": 1312800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 425.2066552420232, "num_env_steps_trained_throughput_per_sec": 425.2066552420232, "timesteps_total": 1312800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1312800, "timers": {"training_iteration_time_ms": 8496.013, "sample_time_ms": 8399.483, "load_time_ms": 1.431, "load_throughput": 2515953.412, "learn_time_ms": 94.263, "learn_throughput": 38191.065, "synch_weights_time_ms": 0.778}, "counters": {"num_env_steps_sampled": 1312800, "num_env_steps_trained": 1312800, "num_agent_steps_sampled": 1312800, "num_agent_steps_trained": 1312800}, "done": false, "episodes_total": 1237, "training_iteration": 349, "trial_id": "5f82d_00000", "date": "2023-07-27_00-18-01", "timestamp": 1690406281, "time_this_iter_s": 16.93612813949585, "time_total_s": 4820.369539737701, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2792.5395855903625, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 19.020833333333332, "ram_util_percent": 68.30416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5718950544085, "policy_loss": -1.2261540043745507e+19, "vf_loss": 311190530.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18396.5, "diff_num_grad_updates_vs_sampler_policy": 18395.5}}, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114099.15039178723, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9039707359163068, "mean_inference_ms": 0.36535019292590803, "mean_action_processing_ms": 0.08998809377623905, "mean_env_wait_ms": 0.9679239412382837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036988258361816406, "StateBufferConnector_ms": 0.0025386810302734375, "ViewRequirementAgentConnector_ms": 0.06545686721801758}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114099.15039178723, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113996.24527179614, -113957.17099099011, -113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9039707359163068, "mean_inference_ms": 0.36535019292590803, "mean_action_processing_ms": 0.08998809377623905, "mean_env_wait_ms": 0.9679239412382837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036988258361816406, "StateBufferConnector_ms": 0.0025386810302734375, "ViewRequirementAgentConnector_ms": 0.06545686721801758}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.8563617730338, "num_env_steps_trained_throughput_per_sec": 419.8563617730338, "timesteps_total": 1320000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 8517.138, "sample_time_ms": 8420.553, "load_time_ms": 1.402, "load_throughput": 2567329.955, "learn_time_ms": 94.339, "learn_throughput": 38160.218, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "episodes_total": 1239, "training_iteration": 350, "trial_id": "5f82d_00000", "date": "2023-07-27_00-18-18", "timestamp": 1690406298, "time_this_iter_s": 17.151697158813477, "time_total_s": 4837.521236896515, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2809.691282749176, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 19.320833333333333, "ram_util_percent": 68.41666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6278359549385, "policy_loss": -1.0546042748536052e+19, "vf_loss": 311974525.21428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18508.5, "diff_num_grad_updates_vs_sampler_policy": 18507.5}}, "num_env_steps_sampled": 1327200, "num_env_steps_trained": 1327200, "num_agent_steps_sampled": 1327200, "num_agent_steps_trained": 1327200}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114113.55812615609, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9039462951075042, "mean_inference_ms": 0.36534829357535054, "mean_action_processing_ms": 0.08998753981107856, "mean_env_wait_ms": 0.9678631954176729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003698587417602539, "StateBufferConnector_ms": 0.0025436878204345703, "ViewRequirementAgentConnector_ms": 0.06548595428466797}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114113.55812615609, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113216.17728005479, -114075.77597960005, -113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9039462951075042, "mean_inference_ms": 0.36534829357535054, "mean_action_processing_ms": 0.08998753981107856, "mean_env_wait_ms": 0.9678631954176729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003698587417602539, "StateBufferConnector_ms": 0.0025436878204345703, "ViewRequirementAgentConnector_ms": 0.06548595428466797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1327200, "num_agent_steps_trained": 1327200, "num_env_steps_sampled": 1327200, "num_env_steps_trained": 1327200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 418.81668232104215, "num_env_steps_trained_throughput_per_sec": 418.81668232104215, "timesteps_total": 1327200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1327200, "timers": {"training_iteration_time_ms": 8547.152, "sample_time_ms": 8449.81, "load_time_ms": 1.403, "load_throughput": 2566806.242, "learn_time_ms": 95.098, "learn_throughput": 37855.764, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 1327200, "num_env_steps_trained": 1327200, "num_agent_steps_sampled": 1327200, "num_agent_steps_trained": 1327200}, "done": false, "episodes_total": 1241, "training_iteration": 351, "trial_id": "5f82d_00000", "date": "2023-07-27_00-18-35", "timestamp": 1690406315, "time_this_iter_s": 17.194359064102173, "time_total_s": 4854.715595960617, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2826.885641813278, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 17.82, "ram_util_percent": 68.36399999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.666574074074075e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.63427734375, "policy_loss": -1.1738624521094052e+19, "vf_loss": 311215735.21428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18620.5, "diff_num_grad_updates_vs_sampler_policy": 18619.5}}, "num_env_steps_sampled": 1334400, "num_env_steps_trained": 1334400, "num_agent_steps_sampled": 1334400, "num_agent_steps_trained": 1334400}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114123.10602409061, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.903923568184288, "mean_inference_ms": 0.36534626980234736, "mean_action_processing_ms": 0.0899869825409325, "mean_env_wait_ms": 0.9678076791046902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036966800689697266, "StateBufferConnector_ms": 0.002538442611694336, "ViewRequirementAgentConnector_ms": 0.06549382209777832}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114123.10602409061, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113607.59068860317, -114280.02858204996, -114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.903923568184288, "mean_inference_ms": 0.36534626980234736, "mean_action_processing_ms": 0.0899869825409325, "mean_env_wait_ms": 0.9678076791046902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036966800689697266, "StateBufferConnector_ms": 0.002538442611694336, "ViewRequirementAgentConnector_ms": 0.06549382209777832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1334400, "num_agent_steps_trained": 1334400, "num_env_steps_sampled": 1334400, "num_env_steps_trained": 1334400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.33571904549683, "num_env_steps_trained_throughput_per_sec": 423.33571904549683, "timesteps_total": 1334400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1334400, "timers": {"training_iteration_time_ms": 8524.693, "sample_time_ms": 8427.488, "load_time_ms": 1.456, "load_throughput": 2472125.346, "learn_time_ms": 94.895, "learn_throughput": 37936.503, "synch_weights_time_ms": 0.795}, "counters": {"num_env_steps_sampled": 1334400, "num_env_steps_trained": 1334400, "num_agent_steps_sampled": 1334400, "num_agent_steps_trained": 1334400}, "done": false, "episodes_total": 1243, "training_iteration": 352, "trial_id": "5f82d_00000", "date": "2023-07-27_00-18-52", "timestamp": 1690406332, "time_this_iter_s": 17.0108699798584, "time_total_s": 4871.7264659404755, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2843.8965117931366, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 18.474999999999998, "ram_util_percent": 68.34166666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.999907407407409e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6441650390625, "policy_loss": -9.388045370636423e+18, "vf_loss": 305215552.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18732.5, "diff_num_grad_updates_vs_sampler_policy": 18731.5}}, "num_env_steps_sampled": 1341600, "num_env_steps_trained": 1341600, "num_agent_steps_sampled": 1341600, "num_agent_steps_trained": 1341600}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114117.74255858277, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9039002344046918, "mean_inference_ms": 0.36534409850213506, "mean_action_processing_ms": 0.08998641799376227, "mean_env_wait_ms": 0.9677515705332368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003699779510498047, "StateBufferConnector_ms": 0.0025415420532226562, "ViewRequirementAgentConnector_ms": 0.06551456451416016}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114117.74255858277, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114773.96218432699, -113496.96525746405, -114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9039002344046918, "mean_inference_ms": 0.36534409850213506, "mean_action_processing_ms": 0.08998641799376227, "mean_env_wait_ms": 0.9677515705332368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003699779510498047, "StateBufferConnector_ms": 0.0025415420532226562, "ViewRequirementAgentConnector_ms": 0.06551456451416016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1341600, "num_agent_steps_trained": 1341600, "num_env_steps_sampled": 1341600, "num_env_steps_trained": 1341600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 425.3067451570727, "num_env_steps_trained_throughput_per_sec": 425.3067451570727, "timesteps_total": 1341600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1341600, "timers": {"training_iteration_time_ms": 8520.953, "sample_time_ms": 8423.881, "load_time_ms": 1.454, "load_throughput": 2475448.694, "learn_time_ms": 94.759, "learn_throughput": 37991.205, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 1341600, "num_env_steps_trained": 1341600, "num_agent_steps_sampled": 1341600, "num_agent_steps_trained": 1341600}, "done": false, "episodes_total": 1245, "training_iteration": 353, "trial_id": "5f82d_00000", "date": "2023-07-27_00-19-09", "timestamp": 1690406349, "time_this_iter_s": 16.931843042373657, "time_total_s": 4888.658308982849, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2860.8283548355103, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 18.974999999999998, "ram_util_percent": 68.34583333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.33324074074074e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.635264805385, "policy_loss": -1.2477680311725656e+19, "vf_loss": 313892335.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18844.5, "diff_num_grad_updates_vs_sampler_policy": 18843.5}}, "num_env_steps_sampled": 1348800, "num_env_steps_trained": 1348800, "num_agent_steps_sampled": 1348800, "num_agent_steps_trained": 1348800}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114121.31567837505, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9038760453086786, "mean_inference_ms": 0.36534194532351216, "mean_action_processing_ms": 0.08998583289248797, "mean_env_wait_ms": 0.9677004223910396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037026405334472656, "StateBufferConnector_ms": 0.002549409866333008, "ViewRequirementAgentConnector_ms": 0.06551504135131836}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114121.31567837505, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114336.77702308811, -114419.10025160028, -114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9038760453086786, "mean_inference_ms": 0.36534194532351216, "mean_action_processing_ms": 0.08998583289248797, "mean_env_wait_ms": 0.9677004223910396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037026405334472656, "StateBufferConnector_ms": 0.002549409866333008, "ViewRequirementAgentConnector_ms": 0.06551504135131836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1348800, "num_agent_steps_trained": 1348800, "num_env_steps_sampled": 1348800, "num_env_steps_trained": 1348800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.0118110807299, "num_env_steps_trained_throughput_per_sec": 422.0118110807299, "timesteps_total": 1348800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1348800, "timers": {"training_iteration_time_ms": 8533.772, "sample_time_ms": 8436.634, "load_time_ms": 1.461, "load_throughput": 2463654.881, "learn_time_ms": 94.814, "learn_throughput": 37969.09, "synch_weights_time_ms": 0.805}, "counters": {"num_env_steps_sampled": 1348800, "num_env_steps_trained": 1348800, "num_agent_steps_sampled": 1348800, "num_agent_steps_trained": 1348800}, "done": false, "episodes_total": 1247, "training_iteration": 354, "trial_id": "5f82d_00000", "date": "2023-07-27_00-19-26", "timestamp": 1690406366, "time_this_iter_s": 17.06401300430298, "time_total_s": 4905.722321987152, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2877.8923678398132, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 18.416666666666668, "ram_util_percent": 68.39583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.666574074074077e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6298457554408, "policy_loss": -1.3013582058217126e+19, "vf_loss": 313262317.78571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18956.5, "diff_num_grad_updates_vs_sampler_policy": 18955.5}}, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114130.0564262392, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.903851424435789, "mean_inference_ms": 0.3653395839312854, "mean_action_processing_ms": 0.08998525558466593, "mean_env_wait_ms": 0.9676565201178198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706693649291992, "StateBufferConnector_ms": 0.0025482177734375, "ViewRequirementAgentConnector_ms": 0.06557083129882812}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114130.0564262392, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114306.51963550586, -113811.42586117065, -114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.903851424435789, "mean_inference_ms": 0.3653395839312854, "mean_action_processing_ms": 0.08998525558466593, "mean_env_wait_ms": 0.9676565201178198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706693649291992, "StateBufferConnector_ms": 0.0025482177734375, "ViewRequirementAgentConnector_ms": 0.06557083129882812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 411.92891134755655, "num_env_steps_trained_throughput_per_sec": 411.92891134755655, "timesteps_total": 1356000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 8566.774, "sample_time_ms": 8469.3, "load_time_ms": 1.485, "load_throughput": 2424180.712, "learn_time_ms": 95.13, "learn_throughput": 37843.098, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "episodes_total": 1249, "training_iteration": 355, "trial_id": "5f82d_00000", "date": "2023-07-27_00-19-44", "timestamp": 1690406384, "time_this_iter_s": 17.481729984283447, "time_total_s": 4923.204051971436, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2895.3740978240967, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 19.232, "ram_util_percent": 68.348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.999907407407407e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6519056047712, "policy_loss": -1.1125562486990653e+19, "vf_loss": 312037044.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19068.5, "diff_num_grad_updates_vs_sampler_policy": 19067.5}}, "num_env_steps_sampled": 1363200, "num_env_steps_trained": 1363200, "num_agent_steps_sampled": 1363200, "num_agent_steps_trained": 1363200}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114128.77089854704, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9038277954866518, "mean_inference_ms": 0.36533731476481024, "mean_action_processing_ms": 0.08998469426954343, "mean_env_wait_ms": 0.967612208197973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037097930908203125, "StateBufferConnector_ms": 0.0025479793548583984, "ViewRequirementAgentConnector_ms": 0.06560134887695312}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114128.77089854704, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114635.26072676081, -113646.24967761278, -115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9038277954866518, "mean_inference_ms": 0.36533731476481024, "mean_action_processing_ms": 0.08998469426954343, "mean_env_wait_ms": 0.967612208197973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037097930908203125, "StateBufferConnector_ms": 0.0025479793548583984, "ViewRequirementAgentConnector_ms": 0.06560134887695312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1363200, "num_agent_steps_trained": 1363200, "num_env_steps_sampled": 1363200, "num_env_steps_trained": 1363200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.8235235411239, "num_env_steps_trained_throughput_per_sec": 422.8235235411239, "timesteps_total": 1363200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1363200, "timers": {"training_iteration_time_ms": 8550.483, "sample_time_ms": 8453.442, "load_time_ms": 1.529, "load_throughput": 2353926.106, "learn_time_ms": 94.661, "learn_throughput": 38030.351, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 1363200, "num_env_steps_trained": 1363200, "num_agent_steps_sampled": 1363200, "num_agent_steps_trained": 1363200}, "done": false, "episodes_total": 1251, "training_iteration": 356, "trial_id": "5f82d_00000", "date": "2023-07-27_00-20-01", "timestamp": 1690406401, "time_this_iter_s": 17.03146505355835, "time_total_s": 4940.235517024994, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2912.405562877655, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 19.608333333333334, "ram_util_percent": 68.32916666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.3332407407407406e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5570656912666, "policy_loss": -1.1396183141359026e+19, "vf_loss": 309745669.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19180.5, "diff_num_grad_updates_vs_sampler_policy": 19179.5}}, "num_env_steps_sampled": 1370400, "num_env_steps_trained": 1370400, "num_agent_steps_sampled": 1370400, "num_agent_steps_trained": 1370400}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114130.53159045264, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9038059740813079, "mean_inference_ms": 0.3653343569616325, "mean_action_processing_ms": 0.08998410122474959, "mean_env_wait_ms": 0.9675668568322806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003711700439453125, "StateBufferConnector_ms": 0.002547740936279297, "ViewRequirementAgentConnector_ms": 0.06561732292175293}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114130.53159045264, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-115138.08728688568, -114267.8947904041, -114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9038059740813079, "mean_inference_ms": 0.3653343569616325, "mean_action_processing_ms": 0.08998410122474959, "mean_env_wait_ms": 0.9675668568322806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003711700439453125, "StateBufferConnector_ms": 0.002547740936279297, "ViewRequirementAgentConnector_ms": 0.06561732292175293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1370400, "num_agent_steps_trained": 1370400, "num_env_steps_sampled": 1370400, "num_env_steps_trained": 1370400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.2302380299207, "num_env_steps_trained_throughput_per_sec": 422.2302380299207, "timesteps_total": 1370400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1370400, "timers": {"training_iteration_time_ms": 8554.936, "sample_time_ms": 8458.116, "load_time_ms": 1.497, "load_throughput": 2405067.44, "learn_time_ms": 94.476, "learn_throughput": 38104.854, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 1370400, "num_env_steps_trained": 1370400, "num_agent_steps_sampled": 1370400, "num_agent_steps_trained": 1370400}, "done": false, "episodes_total": 1253, "training_iteration": 357, "trial_id": "5f82d_00000", "date": "2023-07-27_00-20-18", "timestamp": 1690406418, "time_this_iter_s": 17.055234909057617, "time_total_s": 4957.2907519340515, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2929.4607977867126, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 18.129166666666666, "ram_util_percent": 68.44166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.666574074074074e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6275024414062, "policy_loss": -1.2606819101002396e+19, "vf_loss": 311848263.4285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19292.5, "diff_num_grad_updates_vs_sampler_policy": 19291.5}}, "num_env_steps_sampled": 1377600, "num_env_steps_trained": 1377600, "num_agent_steps_sampled": 1377600, "num_agent_steps_trained": 1377600}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114127.84753256544, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9037845026142309, "mean_inference_ms": 0.36533137012736466, "mean_action_processing_ms": 0.08998354286293454, "mean_env_wait_ms": 0.9675170587464983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037119388580322266, "StateBufferConnector_ms": 0.0025482177734375, "ViewRequirementAgentConnector_ms": 0.06562447547912598}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115259.711144626, "episode_reward_mean": -114127.84753256544, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114238.74542905072, -114394.96950428859, -114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9037845026142309, "mean_inference_ms": 0.36533137012736466, "mean_action_processing_ms": 0.08998354286293454, "mean_env_wait_ms": 0.9675170587464983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037119388580322266, "StateBufferConnector_ms": 0.0025482177734375, "ViewRequirementAgentConnector_ms": 0.06562447547912598}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1377600, "num_agent_steps_trained": 1377600, "num_env_steps_sampled": 1377600, "num_env_steps_trained": 1377600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 417.6395153537724, "num_env_steps_trained_throughput_per_sec": 417.6395153537724, "timesteps_total": 1377600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1377600, "timers": {"training_iteration_time_ms": 8586.015, "sample_time_ms": 8489.1, "load_time_ms": 1.499, "load_throughput": 2401930.262, "learn_time_ms": 94.586, "learn_throughput": 38060.643, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 1377600, "num_env_steps_trained": 1377600, "num_agent_steps_sampled": 1377600, "num_agent_steps_trained": 1377600}, "done": false, "episodes_total": 1255, "training_iteration": 358, "trial_id": "5f82d_00000", "date": "2023-07-27_00-20-35", "timestamp": 1690406435, "time_this_iter_s": 17.24269199371338, "time_total_s": 4974.533443927765, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2946.703489780426, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 17.958333333333332, "ram_util_percent": 68.35416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6289367675781, "policy_loss": -1.314117988685859e+19, "vf_loss": 316999528.5714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19404.5, "diff_num_grad_updates_vs_sampler_policy": 19403.5}}, "num_env_steps_sampled": 1384800, "num_env_steps_trained": 1384800, "num_agent_steps_sampled": 1384800, "num_agent_steps_trained": 1384800}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114139.10793814396, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9037595964739483, "mean_inference_ms": 0.3653282189126152, "mean_action_processing_ms": 0.08998298786600817, "mean_env_wait_ms": 0.9674691800028653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037064552307128906, "StateBufferConnector_ms": 0.0025475025177001953, "ViewRequirementAgentConnector_ms": 0.06555724143981934}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114139.10793814396, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114657.89351854852, -113682.06876327921, -114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9037595964739483, "mean_inference_ms": 0.3653282189126152, "mean_action_processing_ms": 0.08998298786600817, "mean_env_wait_ms": 0.9674691800028653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037064552307128906, "StateBufferConnector_ms": 0.0025475025177001953, "ViewRequirementAgentConnector_ms": 0.06555724143981934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1384800, "num_agent_steps_trained": 1384800, "num_env_steps_sampled": 1384800, "num_env_steps_trained": 1384800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.153740710406, "num_env_steps_trained_throughput_per_sec": 424.153740710406, "timesteps_total": 1384800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1384800, "timers": {"training_iteration_time_ms": 8577.399, "sample_time_ms": 8480.639, "load_time_ms": 1.498, "load_throughput": 2402847.613, "learn_time_ms": 94.426, "learn_throughput": 38125.049, "synch_weights_time_ms": 0.778}, "counters": {"num_env_steps_sampled": 1384800, "num_env_steps_trained": 1384800, "num_agent_steps_sampled": 1384800, "num_agent_steps_trained": 1384800}, "done": false, "episodes_total": 1257, "training_iteration": 359, "trial_id": "5f82d_00000", "date": "2023-07-27_00-20-52", "timestamp": 1690406452, "time_this_iter_s": 16.977909088134766, "time_total_s": 4991.5113530159, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2963.681398868561, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 21.20416666666667, "ram_util_percent": 68.12916666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6355351039342, "policy_loss": -1.067618668289131e+19, "vf_loss": 307561396.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19516.5, "diff_num_grad_updates_vs_sampler_policy": 19515.5}}, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114129.77181345777, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9037350769073208, "mean_inference_ms": 0.36532502540987283, "mean_action_processing_ms": 0.08998242757352337, "mean_env_wait_ms": 0.9674252455271389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704547882080078, "StateBufferConnector_ms": 0.002551555633544922, "ViewRequirementAgentConnector_ms": 0.06554412841796875}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114129.77181345777, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114231.22345036852, -114364.94600737146, -114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9037350769073208, "mean_inference_ms": 0.36532502540987283, "mean_action_processing_ms": 0.08998242757352337, "mean_env_wait_ms": 0.9674252455271389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704547882080078, "StateBufferConnector_ms": 0.002551555633544922, "ViewRequirementAgentConnector_ms": 0.06554412841796875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 427.61923712099417, "num_env_steps_trained_throughput_per_sec": 427.61923712099417, "timesteps_total": 1392000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 8513.266, "sample_time_ms": 8416.649, "load_time_ms": 1.481, "load_throughput": 2431402.274, "learn_time_ms": 94.3, "learn_throughput": 38176.002, "synch_weights_time_ms": 0.777}, "counters": {"num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "episodes_total": 1259, "training_iteration": 360, "trial_id": "5f82d_00000", "date": "2023-07-27_00-21-09", "timestamp": 1690406469, "time_this_iter_s": 16.8405020236969, "time_total_s": 5008.351855039597, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2980.5219008922577, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 20.604166666666668, "ram_util_percent": 68.11666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.620404924665, "policy_loss": -1.159599936761431e+19, "vf_loss": 311486931.14285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19628.5, "diff_num_grad_updates_vs_sampler_policy": 19627.5}}, "num_env_steps_sampled": 1399200, "num_env_steps_trained": 1399200, "num_agent_steps_sampled": 1399200, "num_agent_steps_trained": 1399200}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114132.17940929676, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9037099551386573, "mean_inference_ms": 0.3653221135165172, "mean_action_processing_ms": 0.0899819519572291, "mean_env_wait_ms": 0.9673854389697436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701925277709961, "StateBufferConnector_ms": 0.0025539398193359375, "ViewRequirementAgentConnector_ms": 0.06551241874694824}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114132.17940929676, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114262.69284881945, -115259.711144626, -114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9037099551386573, "mean_inference_ms": 0.3653221135165172, "mean_action_processing_ms": 0.0899819519572291, "mean_env_wait_ms": 0.9673854389697436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701925277709961, "StateBufferConnector_ms": 0.0025539398193359375, "ViewRequirementAgentConnector_ms": 0.06551241874694824}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1399200, "num_agent_steps_trained": 1399200, "num_env_steps_sampled": 1399200, "num_env_steps_trained": 1399200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.3082919872038, "num_env_steps_trained_throughput_per_sec": 423.3082919872038, "timesteps_total": 1399200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1399200, "timers": {"training_iteration_time_ms": 8511.316, "sample_time_ms": 8414.813, "load_time_ms": 1.471, "load_throughput": 2446767.954, "learn_time_ms": 94.195, "learn_throughput": 38218.45, "synch_weights_time_ms": 0.777}, "counters": {"num_env_steps_sampled": 1399200, "num_env_steps_trained": 1399200, "num_agent_steps_sampled": 1399200, "num_agent_steps_trained": 1399200}, "done": false, "episodes_total": 1261, "training_iteration": 361, "trial_id": "5f82d_00000", "date": "2023-07-27_00-21-26", "timestamp": 1690406486, "time_this_iter_s": 17.011731147766113, "time_total_s": 5025.363586187363, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2997.533632040024, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 20.433333333333334, "ram_util_percent": 68.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6507982526507, "policy_loss": -1.273891283759837e+19, "vf_loss": 314037954.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19740.5, "diff_num_grad_updates_vs_sampler_policy": 19739.5}}, "num_env_steps_sampled": 1406400, "num_env_steps_trained": 1406400, "num_agent_steps_sampled": 1406400, "num_agent_steps_trained": 1406400}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114121.88108261417, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9036853323156494, "mean_inference_ms": 0.36531928029316374, "mean_action_processing_ms": 0.08998147176329897, "mean_env_wait_ms": 0.967343558498601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037050247192382812, "StateBufferConnector_ms": 0.0025506019592285156, "ViewRequirementAgentConnector_ms": 0.06553816795349121}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114121.88108261417, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114011.609500796, -113999.33473648917, -114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9036853323156494, "mean_inference_ms": 0.36531928029316374, "mean_action_processing_ms": 0.08998147176329897, "mean_env_wait_ms": 0.967343558498601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037050247192382812, "StateBufferConnector_ms": 0.0025506019592285156, "ViewRequirementAgentConnector_ms": 0.06553816795349121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1406400, "num_agent_steps_trained": 1406400, "num_env_steps_sampled": 1406400, "num_env_steps_trained": 1406400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.1433831633761, "num_env_steps_trained_throughput_per_sec": 421.1433831633761, "timesteps_total": 1406400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1406400, "timers": {"training_iteration_time_ms": 8515.717, "sample_time_ms": 8419.032, "load_time_ms": 1.482, "load_throughput": 2428586.612, "learn_time_ms": 94.356, "learn_throughput": 38153.449, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 1406400, "num_env_steps_trained": 1406400, "num_agent_steps_sampled": 1406400, "num_agent_steps_trained": 1406400}, "done": false, "episodes_total": 1263, "training_iteration": 362, "trial_id": "5f82d_00000", "date": "2023-07-27_00-21-43", "timestamp": 1690406503, "time_this_iter_s": 17.099402904510498, "time_total_s": 5042.462989091873, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3014.6330349445343, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 20.104, "ram_util_percent": 68.256}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6482587541852, "policy_loss": -9.547269696496011e+18, "vf_loss": 305379617.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19852.5, "diff_num_grad_updates_vs_sampler_policy": 19851.5}}, "num_env_steps_sampled": 1413600, "num_env_steps_trained": 1413600, "num_agent_steps_sampled": 1413600, "num_agent_steps_trained": 1413600}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114102.7326507408, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9036623650892475, "mean_inference_ms": 0.36531676291427784, "mean_action_processing_ms": 0.0899809712460138, "mean_env_wait_ms": 0.9672977128731587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00370025634765625, "StateBufferConnector_ms": 0.00254058837890625, "ViewRequirementAgentConnector_ms": 0.0653998851776123}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114102.7326507408, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114246.15271350066, -114082.08652203216, -114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9036623650892475, "mean_inference_ms": 0.36531676291427784, "mean_action_processing_ms": 0.0899809712460138, "mean_env_wait_ms": 0.9672977128731587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00370025634765625, "StateBufferConnector_ms": 0.00254058837890625, "ViewRequirementAgentConnector_ms": 0.0653998851776123}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1413600, "num_agent_steps_trained": 1413600, "num_env_steps_sampled": 1413600, "num_env_steps_trained": 1413600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 429.10211127865597, "num_env_steps_trained_throughput_per_sec": 429.10211127865597, "timesteps_total": 1413600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1413600, "timers": {"training_iteration_time_ms": 8469.664, "sample_time_ms": 8373.253, "load_time_ms": 1.515, "load_throughput": 2376525.812, "learn_time_ms": 94.048, "learn_throughput": 38278.355, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 1413600, "num_env_steps_trained": 1413600, "num_agent_steps_sampled": 1413600, "num_agent_steps_trained": 1413600}, "done": false, "episodes_total": 1265, "training_iteration": 363, "trial_id": "5f82d_00000", "date": "2023-07-27_00-22-00", "timestamp": 1690406520, "time_this_iter_s": 16.78211498260498, "time_total_s": 5059.245104074478, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3031.4151499271393, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 19.639130434782608, "ram_util_percent": 68.29565217391307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6056954520088, "policy_loss": -1.1666439668401213e+19, "vf_loss": 313604176.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19964.5, "diff_num_grad_updates_vs_sampler_policy": 19963.5}}, "num_env_steps_sampled": 1420800, "num_env_steps_trained": 1420800, "num_agent_steps_sampled": 1420800, "num_agent_steps_trained": 1420800}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114110.08417942998, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9036377993153322, "mean_inference_ms": 0.36531416654047905, "mean_action_processing_ms": 0.08998046114132047, "mean_env_wait_ms": 0.9672556124018779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036978721618652344, "StateBufferConnector_ms": 0.0025391578674316406, "ViewRequirementAgentConnector_ms": 0.06540346145629883}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114110.08417942998, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114191.29220653656, -114073.66791263565, -113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9036377993153322, "mean_inference_ms": 0.36531416654047905, "mean_action_processing_ms": 0.08998046114132047, "mean_env_wait_ms": 0.9672556124018779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036978721618652344, "StateBufferConnector_ms": 0.0025391578674316406, "ViewRequirementAgentConnector_ms": 0.06540346145629883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1420800, "num_agent_steps_trained": 1420800, "num_env_steps_sampled": 1420800, "num_env_steps_trained": 1420800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.6568689950667, "num_env_steps_trained_throughput_per_sec": 419.6568689950667, "timesteps_total": 1420800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1420800, "timers": {"training_iteration_time_ms": 8487.854, "sample_time_ms": 8391.207, "load_time_ms": 1.491, "load_throughput": 2414451.118, "learn_time_ms": 94.303, "learn_throughput": 38174.641, "synch_weights_time_ms": 0.791}, "counters": {"num_env_steps_sampled": 1420800, "num_env_steps_trained": 1420800, "num_agent_steps_sampled": 1420800, "num_agent_steps_trained": 1420800}, "done": false, "episodes_total": 1267, "training_iteration": 364, "trial_id": "5f82d_00000", "date": "2023-07-27_00-22-17", "timestamp": 1690406537, "time_this_iter_s": 17.159780025482178, "time_total_s": 5076.40488409996, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3048.5749299526215, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 19.124, "ram_util_percent": 68.444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6246403285436, "policy_loss": -1.1481753095195154e+19, "vf_loss": 307663117.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20076.5, "diff_num_grad_updates_vs_sampler_policy": 20075.5}}, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114110.36129917167, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.903614930234871, "mean_inference_ms": 0.36531160047004485, "mean_action_processing_ms": 0.08997987564032116, "mean_env_wait_ms": 0.9672167750612626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036945343017578125, "StateBufferConnector_ms": 0.002537965774536133, "ViewRequirementAgentConnector_ms": 0.0654141902923584}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114110.36129917167, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113875.21188260903, -115018.90893960385, -113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.903614930234871, "mean_inference_ms": 0.36531160047004485, "mean_action_processing_ms": 0.08997987564032116, "mean_env_wait_ms": 0.9672167750612626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036945343017578125, "StateBufferConnector_ms": 0.002537965774536133, "ViewRequirementAgentConnector_ms": 0.0654141902923584}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 418.3590521938403, "num_env_steps_trained_throughput_per_sec": 418.3590521938403, "timesteps_total": 1428000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 8525.123, "sample_time_ms": 8428.661, "load_time_ms": 1.484, "load_throughput": 2425504.699, "learn_time_ms": 94.137, "learn_throughput": 38242.126, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "episodes_total": 1269, "training_iteration": 365, "trial_id": "5f82d_00000", "date": "2023-07-27_00-22-34", "timestamp": 1690406554, "time_this_iter_s": 17.21312427520752, "time_total_s": 5093.618008375168, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3065.788054227829, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 18.029166666666665, "ram_util_percent": 68.46249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6481563023158, "policy_loss": -1.0854291324236388e+19, "vf_loss": 308273982.78571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20188.5, "diff_num_grad_updates_vs_sampler_policy": 20187.5}}, "num_env_steps_sampled": 1435200, "num_env_steps_trained": 1435200, "num_agent_steps_sampled": 1435200, "num_agent_steps_trained": 1435200}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114097.07996735162, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.903595037241704, "mean_inference_ms": 0.3653092316425631, "mean_action_processing_ms": 0.0899792918454943, "mean_env_wait_ms": 0.9671772993765778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036954879760742188, "StateBufferConnector_ms": 0.0025386810302734375, "ViewRequirementAgentConnector_ms": 0.06542611122131348}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114097.07996735162, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113050.52817147654, -113944.38072096072, -112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.903595037241704, "mean_inference_ms": 0.3653092316425631, "mean_action_processing_ms": 0.0899792918454943, "mean_env_wait_ms": 0.9671772993765778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036954879760742188, "StateBufferConnector_ms": 0.0025386810302734375, "ViewRequirementAgentConnector_ms": 0.06542611122131348}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1435200, "num_agent_steps_trained": 1435200, "num_env_steps_sampled": 1435200, "num_env_steps_trained": 1435200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.94911380578833, "num_env_steps_trained_throughput_per_sec": 424.94911380578833, "timesteps_total": 1435200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1435200, "timers": {"training_iteration_time_ms": 8518.555, "sample_time_ms": 8422.119, "load_time_ms": 1.449, "load_throughput": 2484082.323, "learn_time_ms": 94.139, "learn_throughput": 38241.429, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 1435200, "num_env_steps_trained": 1435200, "num_agent_steps_sampled": 1435200, "num_agent_steps_trained": 1435200}, "done": false, "episodes_total": 1271, "training_iteration": 366, "trial_id": "5f82d_00000", "date": "2023-07-27_00-22-51", "timestamp": 1690406571, "time_this_iter_s": 16.9460711479187, "time_total_s": 5110.564079523087, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3082.7341253757477, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 19.008333333333333, "ram_util_percent": 68.425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.73325925925926e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5838535853795, "policy_loss": -1.1078389597230727e+19, "vf_loss": 311447477.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20300.5, "diff_num_grad_updates_vs_sampler_policy": 20299.5}}, "num_env_steps_sampled": 1442400, "num_env_steps_trained": 1442400, "num_agent_steps_sampled": 1442400, "num_agent_steps_trained": 1442400}, "sampler_results": {"episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114114.30533231713, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.903574368622714, "mean_inference_ms": 0.36530673854700024, "mean_action_processing_ms": 0.08997873340253744, "mean_env_wait_ms": 0.9671407445072794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036971569061279297, "StateBufferConnector_ms": 0.002535104751586914, "ViewRequirementAgentConnector_ms": 0.06545543670654297}}, "episode_reward_max": -112563.92027087398, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114114.30533231713, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-112563.92027087398, -115171.36942631946, -114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.903574368622714, "mean_inference_ms": 0.36530673854700024, "mean_action_processing_ms": 0.08997873340253744, "mean_env_wait_ms": 0.9671407445072794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036971569061279297, "StateBufferConnector_ms": 0.002535104751586914, "ViewRequirementAgentConnector_ms": 0.06545543670654297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1442400, "num_agent_steps_trained": 1442400, "num_env_steps_sampled": 1442400, "num_env_steps_trained": 1442400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.965231555236, "num_env_steps_trained_throughput_per_sec": 419.965231555236, "timesteps_total": 1442400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1442400, "timers": {"training_iteration_time_ms": 8523.351, "sample_time_ms": 8427.041, "load_time_ms": 1.434, "load_throughput": 2509639.065, "learn_time_ms": 94.033, "learn_throughput": 38284.489, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 1442400, "num_env_steps_trained": 1442400, "num_agent_steps_sampled": 1442400, "num_agent_steps_trained": 1442400}, "done": false, "episodes_total": 1273, "training_iteration": 367, "trial_id": "5f82d_00000", "date": "2023-07-27_00-23-09", "timestamp": 1690406589, "time_this_iter_s": 17.14719009399414, "time_total_s": 5127.711269617081, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3099.881315469742, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 18.941666666666666, "ram_util_percent": 68.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.199925925925925e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6396942138672, "policy_loss": -1.1509734051212196e+19, "vf_loss": 311855337.5714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20412.5, "diff_num_grad_updates_vs_sampler_policy": 20411.5}}, "num_env_steps_sampled": 1449600, "num_env_steps_trained": 1449600, "num_agent_steps_sampled": 1449600, "num_agent_steps_trained": 1449600}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114126.45549251453, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9035547487467549, "mean_inference_ms": 0.3653045854226602, "mean_action_processing_ms": 0.0899781628811213, "mean_env_wait_ms": 0.9671075016017704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037009716033935547, "StateBufferConnector_ms": 0.002532958984375, "ViewRequirementAgentConnector_ms": 0.06547927856445312}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114126.45549251453, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114425.86023368711, -113659.68311603078, -113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9035547487467549, "mean_inference_ms": 0.3653045854226602, "mean_action_processing_ms": 0.0899781628811213, "mean_env_wait_ms": 0.9671075016017704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037009716033935547, "StateBufferConnector_ms": 0.002532958984375, "ViewRequirementAgentConnector_ms": 0.06547927856445312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1449600, "num_agent_steps_trained": 1449600, "num_env_steps_sampled": 1449600, "num_env_steps_trained": 1449600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 417.67023321965405, "num_env_steps_trained_throughput_per_sec": 417.67023321965405, "timesteps_total": 1449600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1449600, "timers": {"training_iteration_time_ms": 8569.276, "sample_time_ms": 8472.724, "load_time_ms": 1.425, "load_throughput": 2525590.339, "learn_time_ms": 94.284, "learn_throughput": 38182.605, "synch_weights_time_ms": 0.785}, "counters": {"num_env_steps_sampled": 1449600, "num_env_steps_trained": 1449600, "num_agent_steps_sampled": 1449600, "num_agent_steps_trained": 1449600}, "done": false, "episodes_total": 1275, "training_iteration": 368, "trial_id": "5f82d_00000", "date": "2023-07-27_00-23-26", "timestamp": 1690406606, "time_this_iter_s": 17.24152183532715, "time_total_s": 5144.952791452408, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3117.122837305069, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 18.375999999999998, "ram_util_percent": 68.34}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.6665925925925925e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6105695452009, "policy_loss": -1.2525982510366665e+19, "vf_loss": 313663624.35714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20524.5, "diff_num_grad_updates_vs_sampler_policy": 20523.5}}, "num_env_steps_sampled": 1456800, "num_env_steps_trained": 1456800, "num_agent_steps_sampled": 1456800, "num_agent_steps_trained": 1456800}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114141.15199735682, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9035347620909704, "mean_inference_ms": 0.36530288706496533, "mean_action_processing_ms": 0.08997766220353057, "mean_env_wait_ms": 0.9670797840621037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037021636962890625, "StateBufferConnector_ms": 0.0025348663330078125, "ViewRequirementAgentConnector_ms": 0.06551289558410645}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114141.15199735682, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113981.88812063662, -113777.47329094935, -114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9035347620909704, "mean_inference_ms": 0.36530288706496533, "mean_action_processing_ms": 0.08997766220353057, "mean_env_wait_ms": 0.9670797840621037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037021636962890625, "StateBufferConnector_ms": 0.0025348663330078125, "ViewRequirementAgentConnector_ms": 0.06551289558410645}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456800, "num_agent_steps_trained": 1456800, "num_env_steps_sampled": 1456800, "num_env_steps_trained": 1456800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 416.54943993604235, "num_env_steps_trained_throughput_per_sec": 416.54943993604235, "timesteps_total": 1456800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1456800, "timers": {"training_iteration_time_ms": 8582.075, "sample_time_ms": 8485.635, "load_time_ms": 1.425, "load_throughput": 2525928.335, "learn_time_ms": 94.175, "learn_throughput": 38226.733, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 1456800, "num_env_steps_trained": 1456800, "num_agent_steps_sampled": 1456800, "num_agent_steps_trained": 1456800}, "done": false, "episodes_total": 1277, "training_iteration": 369, "trial_id": "5f82d_00000", "date": "2023-07-27_00-23-43", "timestamp": 1690406623, "time_this_iter_s": 17.287931203842163, "time_total_s": 5162.24072265625, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3134.410768508911, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 19.120833333333334, "ram_util_percent": 68.30416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.13325925925926e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.61695425851, "policy_loss": -1.1889316413427567e+19, "vf_loss": 313514944.35714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20636.5, "diff_num_grad_updates_vs_sampler_policy": 20635.5}}, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114146.08045712714, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9035155395815755, "mean_inference_ms": 0.3653010303958454, "mean_action_processing_ms": 0.08997715533966248, "mean_env_wait_ms": 0.9670532878157988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003705739974975586, "StateBufferConnector_ms": 0.0025374889373779297, "ViewRequirementAgentConnector_ms": 0.06549429893493652}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114146.08045712714, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114957.62967060624, -114389.45359749197, -114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9035155395815755, "mean_inference_ms": 0.3653010303958454, "mean_action_processing_ms": 0.08997715533966248, "mean_env_wait_ms": 0.9670532878157988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003705739974975586, "StateBufferConnector_ms": 0.0025374889373779297, "ViewRequirementAgentConnector_ms": 0.06549429893493652}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.7751169939915, "num_env_steps_trained_throughput_per_sec": 419.7751169939915, "timesteps_total": 1464000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 8576.27, "sample_time_ms": 8479.512, "load_time_ms": 1.451, "load_throughput": 2480491.252, "learn_time_ms": 94.459, "learn_throughput": 38111.616, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "episodes_total": 1279, "training_iteration": 370, "trial_id": "5f82d_00000", "date": "2023-07-27_00-24-00", "timestamp": 1690406640, "time_this_iter_s": 17.154913902282715, "time_total_s": 5179.395636558533, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3151.565682411194, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 18.936, "ram_util_percent": 68.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.599925925925926e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5909380231585, "policy_loss": -1.0379972981041863e+19, "vf_loss": 308460073.4285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20748.5, "diff_num_grad_updates_vs_sampler_policy": 20747.5}}, "num_env_steps_sampled": 1471200, "num_env_steps_trained": 1471200, "num_agent_steps_sampled": 1471200, "num_agent_steps_trained": 1471200}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114125.71416771022, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9034965066270197, "mean_inference_ms": 0.3652988652482135, "mean_action_processing_ms": 0.08997663613397944, "mean_env_wait_ms": 0.9670189778422323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003708362579345703, "StateBufferConnector_ms": 0.002538442611694336, "ViewRequirementAgentConnector_ms": 0.0655069351196289}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114125.71416771022, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114383.70434299622, -114403.31863683021, -113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9034965066270197, "mean_inference_ms": 0.3652988652482135, "mean_action_processing_ms": 0.08997663613397944, "mean_env_wait_ms": 0.9670189778422323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003708362579345703, "StateBufferConnector_ms": 0.002538442611694336, "ViewRequirementAgentConnector_ms": 0.0655069351196289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1471200, "num_agent_steps_trained": 1471200, "num_env_steps_sampled": 1471200, "num_env_steps_trained": 1471200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 427.5841203645993, "num_env_steps_trained_throughput_per_sec": 427.5841203645993, "timesteps_total": 1471200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1471200, "timers": {"training_iteration_time_ms": 8565.829, "sample_time_ms": 8468.658, "load_time_ms": 1.451, "load_throughput": 2480654.258, "learn_time_ms": 94.874, "learn_throughput": 37945.026, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 1471200, "num_env_steps_trained": 1471200, "num_agent_steps_sampled": 1471200, "num_agent_steps_trained": 1471200}, "done": false, "episodes_total": 1281, "training_iteration": 371, "trial_id": "5f82d_00000", "date": "2023-07-27_00-24-17", "timestamp": 1690406657, "time_this_iter_s": 16.84163999557495, "time_total_s": 5196.237276554108, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3168.407322406769, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 19.22083333333333, "ram_util_percent": 68.37083333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0665925925925926e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6187831333705, "policy_loss": -1.1749033597673275e+19, "vf_loss": 312626673.21428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20860.5, "diff_num_grad_updates_vs_sampler_policy": 20859.5}}, "num_env_steps_sampled": 1478400, "num_env_steps_trained": 1478400, "num_agent_steps_sampled": 1478400, "num_agent_steps_trained": 1478400}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114117.63525218588, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9034771006833031, "mean_inference_ms": 0.3652966493489661, "mean_action_processing_ms": 0.08997611513052974, "mean_env_wait_ms": 0.9669795413573542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706693649291992, "StateBufferConnector_ms": 0.002537965774536133, "ViewRequirementAgentConnector_ms": 0.06549882888793945}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114117.63525218588, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113620.44636512575, -113716.43105044389, -114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9034771006833031, "mean_inference_ms": 0.3652966493489661, "mean_action_processing_ms": 0.08997611513052974, "mean_env_wait_ms": 0.9669795413573542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003706693649291992, "StateBufferConnector_ms": 0.002537965774536133, "ViewRequirementAgentConnector_ms": 0.06549882888793945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1478400, "num_agent_steps_trained": 1478400, "num_env_steps_sampled": 1478400, "num_env_steps_trained": 1478400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 427.2224509463591, "num_env_steps_trained_throughput_per_sec": 427.2224509463591, "timesteps_total": 1478400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1478400, "timers": {"training_iteration_time_ms": 8536.706, "sample_time_ms": 8439.813, "load_time_ms": 1.482, "load_throughput": 2429602.626, "learn_time_ms": 94.574, "learn_throughput": 38065.479, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 1478400, "num_env_steps_trained": 1478400, "num_agent_steps_sampled": 1478400, "num_agent_steps_trained": 1478400}, "done": false, "episodes_total": 1283, "training_iteration": 372, "trial_id": "5f82d_00000", "date": "2023-07-27_00-24-34", "timestamp": 1690406674, "time_this_iter_s": 16.856241941452026, "time_total_s": 5213.09351849556, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3185.263564348221, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 18.92608695652174, "ram_util_percent": 68.32173913043479}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5332592592592595e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6256801060267, "policy_loss": -1.112905730924119e+19, "vf_loss": 310954009.78571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20972.5, "diff_num_grad_updates_vs_sampler_policy": 20971.5}}, "num_env_steps_sampled": 1485600, "num_env_steps_trained": 1485600, "num_agent_steps_sampled": 1485600, "num_agent_steps_trained": 1485600}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114126.07010080268, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9034592235821864, "mean_inference_ms": 0.36529430375178124, "mean_action_processing_ms": 0.08997555965347787, "mean_env_wait_ms": 0.9669409361817816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701448440551758, "StateBufferConnector_ms": 0.0025408267974853516, "ViewRequirementAgentConnector_ms": 0.0654611587524414}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114126.07010080268, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114168.47305412727, -114462.34367423023, -113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9034592235821864, "mean_inference_ms": 0.36529430375178124, "mean_action_processing_ms": 0.08997555965347787, "mean_env_wait_ms": 0.9669409361817816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701448440551758, "StateBufferConnector_ms": 0.0025408267974853516, "ViewRequirementAgentConnector_ms": 0.0654611587524414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1485600, "num_agent_steps_trained": 1485600, "num_env_steps_sampled": 1485600, "num_env_steps_trained": 1485600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 425.3048104612826, "num_env_steps_trained_throughput_per_sec": 425.3048104612826, "timesteps_total": 1485600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1485600, "timers": {"training_iteration_time_ms": 8505.762, "sample_time_ms": 8408.546, "load_time_ms": 1.464, "load_throughput": 2458280.188, "learn_time_ms": 94.902, "learn_throughput": 37933.863, "synch_weights_time_ms": 0.791}, "counters": {"num_env_steps_sampled": 1485600, "num_env_steps_trained": 1485600, "num_agent_steps_sampled": 1485600, "num_agent_steps_trained": 1485600}, "done": false, "episodes_total": 1285, "training_iteration": 373, "trial_id": "5f82d_00000", "date": "2023-07-27_00-24-51", "timestamp": 1690406691, "time_this_iter_s": 16.93202805519104, "time_total_s": 5230.025546550751, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3202.195592403412, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 18.616666666666667, "ram_util_percent": 68.24166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6117292131696, "policy_loss": -1.325354440893978e+19, "vf_loss": 314000302.14285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21084.5, "diff_num_grad_updates_vs_sampler_policy": 21083.5}}, "num_env_steps_sampled": 1492800, "num_env_steps_trained": 1492800, "num_agent_steps_sampled": 1492800, "num_agent_steps_trained": 1492800}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114130.09176415023, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9034381127531452, "mean_inference_ms": 0.3652917696782532, "mean_action_processing_ms": 0.08997500888997066, "mean_env_wait_ms": 0.9668997142886121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037012100219726562, "StateBufferConnector_ms": 0.0025403499603271484, "ViewRequirementAgentConnector_ms": 0.06545186042785645}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114130.09176415023, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113746.00818791607, -113491.65520378378, -114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9034381127531452, "mean_inference_ms": 0.3652917696782532, "mean_action_processing_ms": 0.08997500888997066, "mean_env_wait_ms": 0.9668997142886121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037012100219726562, "StateBufferConnector_ms": 0.0025403499603271484, "ViewRequirementAgentConnector_ms": 0.06545186042785645}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1492800, "num_agent_steps_trained": 1492800, "num_env_steps_sampled": 1492800, "num_env_steps_trained": 1492800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.80593389978725, "num_env_steps_trained_throughput_per_sec": 419.80593389978725, "timesteps_total": 1492800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1492800, "timers": {"training_iteration_time_ms": 8492.354, "sample_time_ms": 8394.689, "load_time_ms": 1.485, "load_throughput": 2423713.767, "learn_time_ms": 95.337, "learn_throughput": 37760.772, "synch_weights_time_ms": 0.783}, "counters": {"num_env_steps_sampled": 1492800, "num_env_steps_trained": 1492800, "num_agent_steps_sampled": 1492800, "num_agent_steps_trained": 1492800}, "done": false, "episodes_total": 1287, "training_iteration": 374, "trial_id": "5f82d_00000", "date": "2023-07-27_00-25-08", "timestamp": 1690406708, "time_this_iter_s": 17.153614282608032, "time_total_s": 5247.179160833359, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3219.34920668602, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 20.028, "ram_util_percent": 68.18400000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.654549734933, "policy_loss": -9.822084312798851e+18, "vf_loss": 306346160.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21196.5, "diff_num_grad_updates_vs_sampler_policy": 21195.5}}, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114128.01836844168, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9034142199032275, "mean_inference_ms": 0.36528899425497824, "mean_action_processing_ms": 0.08997448295597847, "mean_env_wait_ms": 0.9668569505035367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036945343017578125, "StateBufferConnector_ms": 0.0025415420532226562, "ViewRequirementAgentConnector_ms": 0.06542110443115234}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114128.01836844168, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114429.81622881834, -114343.0639427533, -114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9034142199032275, "mean_inference_ms": 0.36528899425497824, "mean_action_processing_ms": 0.08997448295597847, "mean_env_wait_ms": 0.9668569505035367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036945343017578125, "StateBufferConnector_ms": 0.0025415420532226562, "ViewRequirementAgentConnector_ms": 0.06542110443115234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 434.47065157501027, "num_env_steps_trained_throughput_per_sec": 434.47065157501027, "timesteps_total": 1500000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 8434.338, "sample_time_ms": 8336.782, "load_time_ms": 1.47, "load_throughput": 2448434.312, "learn_time_ms": 95.241, "learn_throughput": 37798.819, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": false, "episodes_total": 1289, "training_iteration": 375, "trial_id": "5f82d_00000", "date": "2023-07-27_00-25-25", "timestamp": 1690406725, "time_this_iter_s": 16.574856281280518, "time_total_s": 5263.754017114639, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3235.9240629673004, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 20.691304347826087, "ram_util_percent": 68.1608695652174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5962415422712, "policy_loss": -1.2088348992221188e+19, "vf_loss": 312985295.21428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21308.5, "diff_num_grad_updates_vs_sampler_policy": 21307.5}}, "num_env_steps_sampled": 1507200, "num_env_steps_trained": 1507200, "num_agent_steps_sampled": 1507200, "num_agent_steps_trained": 1507200}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114123.37073600317, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9033876820035752, "mean_inference_ms": 0.3652859158655161, "mean_action_processing_ms": 0.08997392972581501, "mean_env_wait_ms": 0.9668100344152495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003694772720336914, "StateBufferConnector_ms": 0.002541065216064453, "ViewRequirementAgentConnector_ms": 0.06548881530761719}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114123.37073600317, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114888.2190229838, -114246.75159809808, -113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9033876820035752, "mean_inference_ms": 0.3652859158655161, "mean_action_processing_ms": 0.08997392972581501, "mean_env_wait_ms": 0.9668100344152495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003694772720336914, "StateBufferConnector_ms": 0.002541065216064453, "ViewRequirementAgentConnector_ms": 0.06548881530761719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1507200, "num_agent_steps_trained": 1507200, "num_env_steps_sampled": 1507200, "num_env_steps_trained": 1507200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 427.72299238623333, "num_env_steps_trained_throughput_per_sec": 427.72299238623333, "timesteps_total": 1507200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1507200, "timers": {"training_iteration_time_ms": 8433.791, "sample_time_ms": 8336.19, "load_time_ms": 1.473, "load_throughput": 2444510.094, "learn_time_ms": 95.285, "learn_throughput": 37781.209, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 1507200, "num_env_steps_trained": 1507200, "num_agent_steps_sampled": 1507200, "num_agent_steps_trained": 1507200}, "done": false, "episodes_total": 1291, "training_iteration": 376, "trial_id": "5f82d_00000", "date": "2023-07-27_00-25-42", "timestamp": 1690406742, "time_this_iter_s": 16.836358070373535, "time_total_s": 5280.590375185013, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3252.760421037674, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 21.01666666666667, "ram_util_percent": 68.22083333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.645760672433, "policy_loss": -1.073440185256273e+19, "vf_loss": 308936968.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21420.5, "diff_num_grad_updates_vs_sampler_policy": 21419.5}}, "num_env_steps_sampled": 1514400, "num_env_steps_trained": 1514400, "num_agent_steps_sampled": 1514400, "num_agent_steps_trained": 1514400}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114113.03951415056, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9033604295884203, "mean_inference_ms": 0.3652829020192504, "mean_action_processing_ms": 0.08997337983315726, "mean_env_wait_ms": 0.966759445330114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036971569061279297, "StateBufferConnector_ms": 0.002537965774536133, "ViewRequirementAgentConnector_ms": 0.06550312042236328}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114113.03951415056, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113800.61467852231, -113478.23007426983, -113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9033604295884203, "mean_inference_ms": 0.3652829020192504, "mean_action_processing_ms": 0.08997337983315726, "mean_env_wait_ms": 0.966759445330114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036971569061279297, "StateBufferConnector_ms": 0.002537965774536133, "ViewRequirementAgentConnector_ms": 0.06550312042236328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1514400, "num_agent_steps_trained": 1514400, "num_env_steps_sampled": 1514400, "num_env_steps_trained": 1514400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.7341495772531, "num_env_steps_trained_throughput_per_sec": 422.7341495772531, "timesteps_total": 1514400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1514400, "timers": {"training_iteration_time_ms": 8451.685, "sample_time_ms": 8353.667, "load_time_ms": 1.422, "load_throughput": 2532325.021, "learn_time_ms": 95.749, "learn_throughput": 37598.202, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 1514400, "num_env_steps_trained": 1514400, "num_agent_steps_sampled": 1514400, "num_agent_steps_trained": 1514400}, "done": false, "episodes_total": 1293, "training_iteration": 377, "trial_id": "5f82d_00000", "date": "2023-07-27_00-25-59", "timestamp": 1690406759, "time_this_iter_s": 17.03493094444275, "time_total_s": 5297.625306129456, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3269.7953519821167, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 18.491666666666667, "ram_util_percent": 68.30416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.640337262835, "policy_loss": -1.0673629263006728e+19, "vf_loss": 312955004.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21532.5, "diff_num_grad_updates_vs_sampler_policy": 21531.5}}, "num_env_steps_sampled": 1521600, "num_env_steps_trained": 1521600, "num_agent_steps_sampled": 1521600, "num_agent_steps_trained": 1521600}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114122.74007424813, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9033346195341335, "mean_inference_ms": 0.36527957466022426, "mean_action_processing_ms": 0.08997281041181221, "mean_env_wait_ms": 0.9667098457559807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036971569061279297, "StateBufferConnector_ms": 0.0025415420532226562, "ViewRequirementAgentConnector_ms": 0.06553459167480469}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114122.74007424813, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113698.02342398708, -113018.81176402402, -113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9033346195341335, "mean_inference_ms": 0.36527957466022426, "mean_action_processing_ms": 0.08997281041181221, "mean_env_wait_ms": 0.9667098457559807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036971569061279297, "StateBufferConnector_ms": 0.0025415420532226562, "ViewRequirementAgentConnector_ms": 0.06553459167480469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1521600, "num_agent_steps_trained": 1521600, "num_env_steps_sampled": 1521600, "num_env_steps_trained": 1521600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 432.89133027387413, "num_env_steps_trained_throughput_per_sec": 432.89133027387413, "timesteps_total": 1521600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1521600, "timers": {"training_iteration_time_ms": 8422.016, "sample_time_ms": 8324.116, "load_time_ms": 1.42, "load_throughput": 2535514.24, "learn_time_ms": 95.637, "learn_throughput": 37642.171, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 1521600, "num_env_steps_trained": 1521600, "num_agent_steps_sampled": 1521600, "num_agent_steps_trained": 1521600}, "done": false, "episodes_total": 1295, "training_iteration": 378, "trial_id": "5f82d_00000", "date": "2023-07-27_00-26-15", "timestamp": 1690406775, "time_this_iter_s": 16.635206937789917, "time_total_s": 5314.2605130672455, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3286.4305589199066, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 20.854166666666668, "ram_util_percent": 68.33749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6361367361885, "policy_loss": -1.0566835333142643e+19, "vf_loss": 306840689.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21644.5, "diff_num_grad_updates_vs_sampler_policy": 21643.5}}, "num_env_steps_sampled": 1528800, "num_env_steps_trained": 1528800, "num_agent_steps_sampled": 1528800, "num_agent_steps_trained": 1528800}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114133.3588499227, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9033110250686529, "mean_inference_ms": 0.36527621802738913, "mean_action_processing_ms": 0.08997224981768083, "mean_env_wait_ms": 0.9666632798674353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036954879760742188, "StateBufferConnector_ms": 0.0025436878204345703, "ViewRequirementAgentConnector_ms": 0.06552577018737793}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114133.3588499227, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113475.16810850438, -114394.38824468001, -113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9033110250686529, "mean_inference_ms": 0.36527621802738913, "mean_action_processing_ms": 0.08997224981768083, "mean_env_wait_ms": 0.9666632798674353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036954879760742188, "StateBufferConnector_ms": 0.0025436878204345703, "ViewRequirementAgentConnector_ms": 0.06552577018737793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1528800, "num_agent_steps_trained": 1528800, "num_env_steps_sampled": 1528800, "num_env_steps_trained": 1528800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.96288615896265, "num_env_steps_trained_throughput_per_sec": 422.96288615896265, "timesteps_total": 1528800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1528800, "timers": {"training_iteration_time_ms": 8409.215, "sample_time_ms": 8311.644, "load_time_ms": 1.431, "load_throughput": 2515827.652, "learn_time_ms": 95.29, "learn_throughput": 37779.309, "synch_weights_time_ms": 0.791}, "counters": {"num_env_steps_sampled": 1528800, "num_env_steps_trained": 1528800, "num_agent_steps_sampled": 1528800, "num_agent_steps_trained": 1528800}, "done": false, "episodes_total": 1297, "training_iteration": 379, "trial_id": "5f82d_00000", "date": "2023-07-27_00-26-32", "timestamp": 1690406792, "time_this_iter_s": 17.025681972503662, "time_total_s": 5331.286195039749, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3303.4562408924103, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 19.004166666666666, "ram_util_percent": 68.34583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5533425467354, "policy_loss": -1.0287392136115218e+19, "vf_loss": 310388857.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21756.5, "diff_num_grad_updates_vs_sampler_policy": 21755.5}}, "num_env_steps_sampled": 1536000, "num_env_steps_trained": 1536000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114146.36712459447, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9032890481457008, "mean_inference_ms": 0.365272835849608, "mean_action_processing_ms": 0.08997168556639629, "mean_env_wait_ms": 0.9666202007462852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003689289093017578, "StateBufferConnector_ms": 0.0025434494018554688, "ViewRequirementAgentConnector_ms": 0.06549859046936035}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114146.36712459447, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113866.25001016748, -114490.18970862619, -113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9032890481457008, "mean_inference_ms": 0.365272835849608, "mean_action_processing_ms": 0.08997168556639629, "mean_env_wait_ms": 0.9666202007462852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003689289093017578, "StateBufferConnector_ms": 0.0025434494018554688, "ViewRequirementAgentConnector_ms": 0.06549859046936035}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 1536000, "num_env_steps_trained": 1536000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.3495864863298, "num_env_steps_trained_throughput_per_sec": 422.3495864863298, "timesteps_total": 1536000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 8456.775, "sample_time_ms": 8359.353, "load_time_ms": 1.422, "load_throughput": 2531730.588, "learn_time_ms": 95.15, "learn_throughput": 37834.896, "synch_weights_time_ms": 0.791}, "counters": {"num_env_steps_sampled": 1536000, "num_env_steps_trained": 1536000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "episodes_total": 1299, "training_iteration": 380, "trial_id": "5f82d_00000", "date": "2023-07-27_00-26-50", "timestamp": 1690406810, "time_this_iter_s": 17.05037021636963, "time_total_s": 5348.336565256119, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3320.50661110878, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 18.025000000000002, "ram_util_percent": 68.37083333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6163046700615, "policy_loss": -1.284131149918169e+19, "vf_loss": 312048554.85714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21868.5, "diff_num_grad_updates_vs_sampler_policy": 21867.5}}, "num_env_steps_sampled": 1543200, "num_env_steps_trained": 1543200, "num_agent_steps_sampled": 1543200, "num_agent_steps_trained": 1543200}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114145.50669252744, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9032677442563498, "mean_inference_ms": 0.3652697121812003, "mean_action_processing_ms": 0.0899711600928032, "mean_env_wait_ms": 0.9665765029880808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003688335418701172, "StateBufferConnector_ms": 0.002542734146118164, "ViewRequirementAgentConnector_ms": 0.06549715995788574}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114145.50669252744, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113925.75709016056, -113479.83086412503, -113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9032677442563498, "mean_inference_ms": 0.3652697121812003, "mean_action_processing_ms": 0.0899711600928032, "mean_env_wait_ms": 0.9665765029880808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003688335418701172, "StateBufferConnector_ms": 0.002542734146118164, "ViewRequirementAgentConnector_ms": 0.06549715995788574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1543200, "num_agent_steps_trained": 1543200, "num_env_steps_sampled": 1543200, "num_env_steps_trained": 1543200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.5293997916877, "num_env_steps_trained_throughput_per_sec": 421.5293997916877, "timesteps_total": 1543200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1543200, "timers": {"training_iteration_time_ms": 8481.509, "sample_time_ms": 8384.625, "load_time_ms": 1.465, "load_throughput": 2456760.287, "learn_time_ms": 94.57, "learn_throughput": 38066.899, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 1543200, "num_env_steps_trained": 1543200, "num_agent_steps_sampled": 1543200, "num_agent_steps_trained": 1543200}, "done": false, "episodes_total": 1301, "training_iteration": 381, "trial_id": "5f82d_00000", "date": "2023-07-27_00-27-07", "timestamp": 1690406827, "time_this_iter_s": 17.08380913734436, "time_total_s": 5365.420374393463, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3337.5904202461243, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 19.483333333333334, "ram_util_percent": 68.3375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.4956425258092, "policy_loss": -1.2611207416345254e+19, "vf_loss": 310320632.35714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21980.5, "diff_num_grad_updates_vs_sampler_policy": 21979.5}}, "num_env_steps_sampled": 1550400, "num_env_steps_trained": 1550400, "num_agent_steps_sampled": 1550400, "num_agent_steps_trained": 1550400}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114153.54618809692, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9032467524902753, "mean_inference_ms": 0.3652666860674717, "mean_action_processing_ms": 0.08997062712278604, "mean_env_wait_ms": 0.9665368430425955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036852359771728516, "StateBufferConnector_ms": 0.0025415420532226562, "ViewRequirementAgentConnector_ms": 0.06545352935791016}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114153.54618809692, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113847.83591886541, -113927.68558597015, -113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9032467524902753, "mean_inference_ms": 0.3652666860674717, "mean_action_processing_ms": 0.08997062712278604, "mean_env_wait_ms": 0.9665368430425955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036852359771728516, "StateBufferConnector_ms": 0.0025415420532226562, "ViewRequirementAgentConnector_ms": 0.06545352935791016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1550400, "num_agent_steps_trained": 1550400, "num_env_steps_sampled": 1550400, "num_env_steps_trained": 1550400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 418.88749853037694, "num_env_steps_trained_throughput_per_sec": 418.88749853037694, "timesteps_total": 1550400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1550400, "timers": {"training_iteration_time_ms": 8497.149, "sample_time_ms": 8400.423, "load_time_ms": 1.478, "load_throughput": 2436345.424, "learn_time_ms": 94.397, "learn_throughput": 38136.826, "synch_weights_time_ms": 0.792}, "counters": {"num_env_steps_sampled": 1550400, "num_env_steps_trained": 1550400, "num_agent_steps_sampled": 1550400, "num_agent_steps_trained": 1550400}, "done": false, "episodes_total": 1303, "training_iteration": 382, "trial_id": "5f82d_00000", "date": "2023-07-27_00-27-24", "timestamp": 1690406844, "time_this_iter_s": 17.191349029541016, "time_total_s": 5382.611723423004, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3354.7817692756653, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 18.396, "ram_util_percent": 68.348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6421203613281, "policy_loss": -1.1552998140321135e+19, "vf_loss": 308780825.4285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22092.5, "diff_num_grad_updates_vs_sampler_policy": 22091.5}}, "num_env_steps_sampled": 1557600, "num_env_steps_trained": 1557600, "num_agent_steps_sampled": 1557600, "num_agent_steps_trained": 1557600}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114155.47542429421, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9032271347452943, "mean_inference_ms": 0.36526385695021674, "mean_action_processing_ms": 0.08997010079369204, "mean_env_wait_ms": 0.966498339664551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036878585815429688, "StateBufferConnector_ms": 0.0025396347045898438, "ViewRequirementAgentConnector_ms": 0.06546330451965332}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114155.47542429421, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113775.94081674868, -113506.94866617834, -114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9032271347452943, "mean_inference_ms": 0.36526385695021674, "mean_action_processing_ms": 0.08997010079369204, "mean_env_wait_ms": 0.966498339664551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036878585815429688, "StateBufferConnector_ms": 0.0025396347045898438, "ViewRequirementAgentConnector_ms": 0.06546330451965332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1557600, "num_agent_steps_trained": 1557600, "num_env_steps_sampled": 1557600, "num_env_steps_trained": 1557600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.1613908648458, "num_env_steps_trained_throughput_per_sec": 421.1613908648458, "timesteps_total": 1557600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1557600, "timers": {"training_iteration_time_ms": 8543.472, "sample_time_ms": 8446.444, "load_time_ms": 1.478, "load_throughput": 2436384.736, "learn_time_ms": 94.699, "learn_throughput": 38015.251, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 1557600, "num_env_steps_trained": 1557600, "num_agent_steps_sampled": 1557600, "num_agent_steps_trained": 1557600}, "done": false, "episodes_total": 1305, "training_iteration": 383, "trial_id": "5f82d_00000", "date": "2023-07-27_00-27-41", "timestamp": 1690406861, "time_this_iter_s": 17.09865093231201, "time_total_s": 5399.710374355316, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3371.8804202079773, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 17.900000000000002, "ram_util_percent": 68.37083333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5902361188616, "policy_loss": -1.1488199973634652e+19, "vf_loss": 309259397.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22204.5, "diff_num_grad_updates_vs_sampler_policy": 22203.5}}, "num_env_steps_sampled": 1564800, "num_env_steps_trained": 1564800, "num_agent_steps_sampled": 1564800, "num_agent_steps_trained": 1564800}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114153.01281254087, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9032061837471624, "mean_inference_ms": 0.3652611112489399, "mean_action_processing_ms": 0.08996956994019518, "mean_env_wait_ms": 0.966463019441787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687620162963867, "StateBufferConnector_ms": 0.00254058837890625, "ViewRequirementAgentConnector_ms": 0.06545615196228027}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114153.01281254087, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114389.96836669344, -113960.74745571196, -114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9032061837471624, "mean_inference_ms": 0.3652611112489399, "mean_action_processing_ms": 0.08996956994019518, "mean_env_wait_ms": 0.966463019441787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687620162963867, "StateBufferConnector_ms": 0.00254058837890625, "ViewRequirementAgentConnector_ms": 0.06545615196228027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1564800, "num_agent_steps_trained": 1564800, "num_env_steps_sampled": 1564800, "num_env_steps_trained": 1564800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 428.0139341058705, "num_env_steps_trained_throughput_per_sec": 428.0139341058705, "timesteps_total": 1564800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1564800, "timers": {"training_iteration_time_ms": 8523.383, "sample_time_ms": 8426.176, "load_time_ms": 1.47, "load_throughput": 2448235.817, "learn_time_ms": 94.892, "learn_throughput": 37937.904, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 1564800, "num_env_steps_trained": 1564800, "num_agent_steps_sampled": 1564800, "num_agent_steps_trained": 1564800}, "done": false, "episodes_total": 1307, "training_iteration": 384, "trial_id": "5f82d_00000", "date": "2023-07-27_00-27-58", "timestamp": 1690406878, "time_this_iter_s": 16.824761152267456, "time_total_s": 5416.535135507584, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3388.7051813602448, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 19.354166666666668, "ram_util_percent": 68.29583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5784432547432, "policy_loss": -1.312870716930068e+19, "vf_loss": 315505453.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22316.5, "diff_num_grad_updates_vs_sampler_policy": 22315.5}}, "num_env_steps_sampled": 1572000, "num_env_steps_trained": 1572000, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114157.78235611331, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9031880732928039, "mean_inference_ms": 0.3652585283851586, "mean_action_processing_ms": 0.08996900779505371, "mean_env_wait_ms": 0.9664293619302454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036864280700683594, "StateBufferConnector_ms": 0.002545595169067383, "ViewRequirementAgentConnector_ms": 0.06549501419067383}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114157.78235611331, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114205.16403002266, -114949.00180071937, -113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9031880732928039, "mean_inference_ms": 0.3652585283851586, "mean_action_processing_ms": 0.08996900779505371, "mean_env_wait_ms": 0.9664293619302454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036864280700683594, "StateBufferConnector_ms": 0.002545595169067383, "ViewRequirementAgentConnector_ms": 0.06549501419067383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000, "num_env_steps_sampled": 1572000, "num_env_steps_trained": 1572000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 418.5540118449485, "num_env_steps_trained_throughput_per_sec": 418.5540118449485, "timesteps_total": 1572000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1572000, "timers": {"training_iteration_time_ms": 8538.842, "sample_time_ms": 8441.769, "load_time_ms": 1.487, "load_throughput": 2421265.258, "learn_time_ms": 94.746, "learn_throughput": 37996.444, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 1572000, "num_env_steps_trained": 1572000, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000}, "done": false, "episodes_total": 1309, "training_iteration": 385, "trial_id": "5f82d_00000", "date": "2023-07-27_00-28-15", "timestamp": 1690406895, "time_this_iter_s": 17.205096006393433, "time_total_s": 5433.740231513977, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3405.910277366638, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 19.175, "ram_util_percent": 68.40416666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.643051147461, "policy_loss": -1.1155218350178216e+19, "vf_loss": 311465546.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22428.5, "diff_num_grad_updates_vs_sampler_policy": 22427.5}}, "num_env_steps_sampled": 1579200, "num_env_steps_trained": 1579200, "num_agent_steps_sampled": 1579200, "num_agent_steps_trained": 1579200}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114147.13371301009, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9031699198994064, "mean_inference_ms": 0.36525594968703534, "mean_action_processing_ms": 0.08996844068165709, "mean_env_wait_ms": 0.9663932933348411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036842823028564453, "StateBufferConnector_ms": 0.0025434494018554688, "ViewRequirementAgentConnector_ms": 0.06550002098083496}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114147.13371301009, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113347.13883729542, -113278.03292708611, -114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9031699198994064, "mean_inference_ms": 0.36525594968703534, "mean_action_processing_ms": 0.08996844068165709, "mean_env_wait_ms": 0.9663932933348411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036842823028564453, "StateBufferConnector_ms": 0.0025434494018554688, "ViewRequirementAgentConnector_ms": 0.06550002098083496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1579200, "num_agent_steps_trained": 1579200, "num_env_steps_sampled": 1579200, "num_env_steps_trained": 1579200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 426.34303116440384, "num_env_steps_trained_throughput_per_sec": 426.34303116440384, "timesteps_total": 1579200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1579200, "timers": {"training_iteration_time_ms": 8519.558, "sample_time_ms": 8422.021, "load_time_ms": 1.471, "load_throughput": 2447719.881, "learn_time_ms": 95.225, "learn_throughput": 37805.387, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 1579200, "num_env_steps_trained": 1579200, "num_agent_steps_sampled": 1579200, "num_agent_steps_trained": 1579200}, "done": false, "episodes_total": 1311, "training_iteration": 386, "trial_id": "5f82d_00000", "date": "2023-07-27_00-28-32", "timestamp": 1690406912, "time_this_iter_s": 16.890815019607544, "time_total_s": 5450.631046533585, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3422.8010923862457, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 18.55, "ram_util_percent": 68.51666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.633797781808, "policy_loss": -1.1816769713422584e+19, "vf_loss": 310268207.35714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22540.5, "diff_num_grad_updates_vs_sampler_policy": 22539.5}}, "num_env_steps_sampled": 1586400, "num_env_steps_trained": 1586400, "num_agent_steps_sampled": 1586400, "num_agent_steps_trained": 1586400}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114163.18408906701, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9031507520103491, "mean_inference_ms": 0.36525327330749957, "mean_action_processing_ms": 0.0899678640244252, "mean_env_wait_ms": 0.9663615547565665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687620162963867, "StateBufferConnector_ms": 0.002547740936279297, "ViewRequirementAgentConnector_ms": 0.06549644470214844}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114163.18408906701, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114315.71218033324, -114410.36164639835, -114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9031507520103491, "mean_inference_ms": 0.36525327330749957, "mean_action_processing_ms": 0.0899678640244252, "mean_env_wait_ms": 0.9663615547565665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003687620162963867, "StateBufferConnector_ms": 0.002547740936279297, "ViewRequirementAgentConnector_ms": 0.06549644470214844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1586400, "num_agent_steps_trained": 1586400, "num_env_steps_sampled": 1586400, "num_env_steps_trained": 1586400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 423.65995027187955, "num_env_steps_trained_throughput_per_sec": 423.65995027187955, "timesteps_total": 1586400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1586400, "timers": {"training_iteration_time_ms": 8500.196, "sample_time_ms": 8402.414, "load_time_ms": 1.459, "load_throughput": 2466915.174, "learn_time_ms": 95.482, "learn_throughput": 37703.322, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 1586400, "num_env_steps_trained": 1586400, "num_agent_steps_sampled": 1586400, "num_agent_steps_trained": 1586400}, "done": false, "episodes_total": 1313, "training_iteration": 387, "trial_id": "5f82d_00000", "date": "2023-07-27_00-28-49", "timestamp": 1690406929, "time_this_iter_s": 16.997629165649414, "time_total_s": 5467.628675699234, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3439.798721551895, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 20.212500000000002, "ram_util_percent": 68.33749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6394871303014, "policy_loss": -1.1409960795149242e+19, "vf_loss": 311939847.64285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22652.5, "diff_num_grad_updates_vs_sampler_policy": 22651.5}}, "num_env_steps_sampled": 1593600, "num_env_steps_trained": 1593600, "num_agent_steps_sampled": 1593600, "num_agent_steps_trained": 1593600}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114159.41979099925, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9031318203125676, "mean_inference_ms": 0.3652506416430407, "mean_action_processing_ms": 0.08996728781652048, "mean_env_wait_ms": 0.9663271592523792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036835670471191406, "StateBufferConnector_ms": 0.0025489330291748047, "ViewRequirementAgentConnector_ms": 0.06548190116882324}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114159.41979099925, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114227.43465342217, -114173.64296161919, -113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9031318203125676, "mean_inference_ms": 0.3652506416430407, "mean_action_processing_ms": 0.08996728781652048, "mean_env_wait_ms": 0.9663271592523792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036835670471191406, "StateBufferConnector_ms": 0.0025489330291748047, "ViewRequirementAgentConnector_ms": 0.06548190116882324}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1593600, "num_agent_steps_trained": 1593600, "num_env_steps_sampled": 1593600, "num_env_steps_trained": 1593600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 428.4227009270087, "num_env_steps_trained_throughput_per_sec": 428.4227009270087, "timesteps_total": 1593600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1593600, "timers": {"training_iteration_time_ms": 8471.22, "sample_time_ms": 8373.701, "load_time_ms": 1.483, "load_throughput": 2427961.795, "learn_time_ms": 95.2, "learn_throughput": 37815.13, "synch_weights_time_ms": 0.777}, "counters": {"num_env_steps_sampled": 1593600, "num_env_steps_trained": 1593600, "num_agent_steps_sampled": 1593600, "num_agent_steps_trained": 1593600}, "done": false, "episodes_total": 1315, "training_iteration": 388, "trial_id": "5f82d_00000", "date": "2023-07-27_00-29-06", "timestamp": 1690406946, "time_this_iter_s": 16.808886766433716, "time_total_s": 5484.437562465668, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3456.607608318329, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 23.587500000000002, "ram_util_percent": 68.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6362043108259, "policy_loss": -1.0296917617663468e+19, "vf_loss": 308965454.5714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22764.5, "diff_num_grad_updates_vs_sampler_policy": 22763.5}}, "num_env_steps_sampled": 1600800, "num_env_steps_trained": 1600800, "num_agent_steps_sampled": 1600800, "num_agent_steps_trained": 1600800}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114158.59318326114, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9031179174138916, "mean_inference_ms": 0.3652480606776908, "mean_action_processing_ms": 0.08996669735097346, "mean_env_wait_ms": 0.9662958156435465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003679037094116211, "StateBufferConnector_ms": 0.0025544166564941406, "ViewRequirementAgentConnector_ms": 0.06548285484313965}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114158.59318326114, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113702.99554984865, -114023.82897347378, -114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9031179174138916, "mean_inference_ms": 0.3652480606776908, "mean_action_processing_ms": 0.08996669735097346, "mean_env_wait_ms": 0.9662958156435465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003679037094116211, "StateBufferConnector_ms": 0.0025544166564941406, "ViewRequirementAgentConnector_ms": 0.06548285484313965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600800, "num_agent_steps_trained": 1600800, "num_env_steps_sampled": 1600800, "num_env_steps_trained": 1600800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.81671087044094, "num_env_steps_trained_throughput_per_sec": 421.81671087044094, "timesteps_total": 1600800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1600800, "timers": {"training_iteration_time_ms": 8495.935, "sample_time_ms": 8398.675, "load_time_ms": 1.457, "load_throughput": 2471235.233, "learn_time_ms": 94.96, "learn_throughput": 37910.7, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 1600800, "num_env_steps_trained": 1600800, "num_agent_steps_sampled": 1600800, "num_agent_steps_trained": 1600800}, "done": false, "episodes_total": 1317, "training_iteration": 389, "trial_id": "5f82d_00000", "date": "2023-07-27_00-29-23", "timestamp": 1690406963, "time_this_iter_s": 17.072015047073364, "time_total_s": 5501.509577512741, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3473.679623365402, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 18.15, "ram_util_percent": 68.07499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.643593924386, "policy_loss": -1.225922659273753e+19, "vf_loss": 314924548.21428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22876.5, "diff_num_grad_updates_vs_sampler_policy": 22875.5}}, "num_env_steps_sampled": 1608000, "num_env_steps_trained": 1608000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114174.93851158401, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9031044667646299, "mean_inference_ms": 0.365245884552745, "mean_action_processing_ms": 0.0899661474850564, "mean_env_wait_ms": 0.9662701721643014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036766529083251953, "StateBufferConnector_ms": 0.0025548934936523438, "ViewRequirementAgentConnector_ms": 0.06547856330871582}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114174.93851158401, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114743.22417458436, -113649.77038217967, -114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9031044667646299, "mean_inference_ms": 0.365245884552745, "mean_action_processing_ms": 0.0899661474850564, "mean_env_wait_ms": 0.9662701721643014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036766529083251953, "StateBufferConnector_ms": 0.0025548934936523438, "ViewRequirementAgentConnector_ms": 0.06547856330871582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000, "num_env_steps_sampled": 1608000, "num_env_steps_trained": 1608000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.5735211900059, "num_env_steps_trained_throughput_per_sec": 419.5735211900059, "timesteps_total": 1608000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1608000, "timers": {"training_iteration_time_ms": 8491.755, "sample_time_ms": 8394.728, "load_time_ms": 1.439, "load_throughput": 2502526.543, "learn_time_ms": 94.735, "learn_throughput": 38000.671, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 1608000, "num_env_steps_trained": 1608000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "done": false, "episodes_total": 1319, "training_iteration": 390, "trial_id": "5f82d_00000", "date": "2023-07-27_00-29-40", "timestamp": 1690406980, "time_this_iter_s": 17.16364812850952, "time_total_s": 5518.673225641251, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3490.8432714939117, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 18.791666666666668, "ram_util_percent": 68.01666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6399557931084, "policy_loss": -1.2046662437237553e+19, "vf_loss": 313845661.5714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22988.5, "diff_num_grad_updates_vs_sampler_policy": 22987.5}}, "num_env_steps_sampled": 1615200, "num_env_steps_trained": 1615200, "num_agent_steps_sampled": 1615200, "num_agent_steps_trained": 1615200}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114182.52753699642, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9030916233963444, "mean_inference_ms": 0.36524386918039725, "mean_action_processing_ms": 0.08996564121441232, "mean_env_wait_ms": 0.9662450093535139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036766529083251953, "StateBufferConnector_ms": 0.002553701400756836, "ViewRequirementAgentConnector_ms": 0.06548523902893066}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114182.52753699642, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114311.70272666326, -114987.40010935986, -113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9030916233963444, "mean_inference_ms": 0.36524386918039725, "mean_action_processing_ms": 0.08996564121441232, "mean_env_wait_ms": 0.9662450093535139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036766529083251953, "StateBufferConnector_ms": 0.002553701400756836, "ViewRequirementAgentConnector_ms": 0.06548523902893066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1615200, "num_agent_steps_trained": 1615200, "num_env_steps_sampled": 1615200, "num_env_steps_trained": 1615200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.2419514118077, "num_env_steps_trained_throughput_per_sec": 420.2419514118077, "timesteps_total": 1615200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1615200, "timers": {"training_iteration_time_ms": 8516.273, "sample_time_ms": 8419.588, "load_time_ms": 1.412, "load_throughput": 2548782.013, "learn_time_ms": 94.406, "learn_throughput": 38133.156, "synch_weights_time_ms": 0.807}, "counters": {"num_env_steps_sampled": 1615200, "num_env_steps_trained": 1615200, "num_agent_steps_sampled": 1615200, "num_agent_steps_trained": 1615200}, "done": false, "episodes_total": 1321, "training_iteration": 391, "trial_id": "5f82d_00000", "date": "2023-07-27_00-29-57", "timestamp": 1690406997, "time_this_iter_s": 17.13588309288025, "time_total_s": 5535.809108734131, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3507.979154586792, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 18.26, "ram_util_percent": 68.09599999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5478886195592, "policy_loss": -1.0997419239224519e+19, "vf_loss": 307496468.35714287}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23100.5, "diff_num_grad_updates_vs_sampler_policy": 23099.5}}, "num_env_steps_sampled": 1622400, "num_env_steps_trained": 1622400, "num_agent_steps_sampled": 1622400, "num_agent_steps_trained": 1622400}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114170.1859033885, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9030789975380944, "mean_inference_ms": 0.36524177226789156, "mean_action_processing_ms": 0.08996511486390801, "mean_env_wait_ms": 0.9662205349898888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003677845001220703, "StateBufferConnector_ms": 0.0025529861450195312, "ViewRequirementAgentConnector_ms": 0.0654609203338623}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114170.1859033885, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113608.27390103671, -113711.41667677455, -113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9030789975380944, "mean_inference_ms": 0.36524177226789156, "mean_action_processing_ms": 0.08996511486390801, "mean_env_wait_ms": 0.9662205349898888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003677845001220703, "StateBufferConnector_ms": 0.0025529861450195312, "ViewRequirementAgentConnector_ms": 0.0654609203338623}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1622400, "num_agent_steps_trained": 1622400, "num_env_steps_sampled": 1622400, "num_env_steps_trained": 1622400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.5653423056944, "num_env_steps_trained_throughput_per_sec": 420.5653423056944, "timesteps_total": 1622400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1622400, "timers": {"training_iteration_time_ms": 8528.778, "sample_time_ms": 8432.419, "load_time_ms": 1.432, "load_throughput": 2514780.141, "learn_time_ms": 94.054, "learn_throughput": 38275.745, "synch_weights_time_ms": 0.814}, "counters": {"num_env_steps_sampled": 1622400, "num_env_steps_trained": 1622400, "num_agent_steps_sampled": 1622400, "num_agent_steps_trained": 1622400}, "done": false, "episodes_total": 1323, "training_iteration": 392, "trial_id": "5f82d_00000", "date": "2023-07-27_00-30-14", "timestamp": 1690407014, "time_this_iter_s": 17.12271809577942, "time_total_s": 5552.93182682991, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3525.1018726825714, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 19.587500000000002, "ram_util_percent": 68.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6218981061663, "policy_loss": -1.2694430818478143e+19, "vf_loss": 314392986.5714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23212.5, "diff_num_grad_updates_vs_sampler_policy": 23211.5}}, "num_env_steps_sampled": 1629600, "num_env_steps_trained": 1629600, "num_agent_steps_sampled": 1629600, "num_agent_steps_trained": 1629600}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114187.35939574566, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9030668094535949, "mean_inference_ms": 0.3652399410384172, "mean_action_processing_ms": 0.08996462758377956, "mean_env_wait_ms": 0.9661998869277585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036804676055908203, "StateBufferConnector_ms": 0.0025479793548583984, "ViewRequirementAgentConnector_ms": 0.06548166275024414}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114187.35939574566, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113636.75582751729, -114641.95958737019, -113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9030668094535949, "mean_inference_ms": 0.3652399410384172, "mean_action_processing_ms": 0.08996462758377956, "mean_env_wait_ms": 0.9661998869277585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036804676055908203, "StateBufferConnector_ms": 0.0025479793548583984, "ViewRequirementAgentConnector_ms": 0.06548166275024414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1629600, "num_agent_steps_trained": 1629600, "num_env_steps_sampled": 1629600, "num_env_steps_trained": 1629600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.83271976268514, "num_env_steps_trained_throughput_per_sec": 421.83271976268514, "timesteps_total": 1629600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1629600, "timers": {"training_iteration_time_ms": 8555.032, "sample_time_ms": 8458.615, "load_time_ms": 1.431, "load_throughput": 2515869.57, "learn_time_ms": 94.122, "learn_throughput": 38248.268, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 1629600, "num_env_steps_trained": 1629600, "num_agent_steps_sampled": 1629600, "num_agent_steps_trained": 1629600}, "done": false, "episodes_total": 1325, "training_iteration": 393, "trial_id": "5f82d_00000", "date": "2023-07-27_00-30-32", "timestamp": 1690407032, "time_this_iter_s": 17.07149577140808, "time_total_s": 5570.003322601318, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3542.1733684539795, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 20.025000000000002, "ram_util_percent": 68.29583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6008954729352, "policy_loss": -1.1525725058723232e+19, "vf_loss": 313244067.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23324.5, "diff_num_grad_updates_vs_sampler_policy": 23323.5}}, "num_env_steps_sampled": 1636800, "num_env_steps_trained": 1636800, "num_agent_steps_sampled": 1636800, "num_agent_steps_trained": 1636800}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114198.82527172923, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9030561612668777, "mean_inference_ms": 0.3652380153428247, "mean_action_processing_ms": 0.08996411074987894, "mean_env_wait_ms": 0.9661856996859646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00370025634765625, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.0654911994934082}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114198.82527172923, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113730.93261369839, -114551.96666876755, -114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9030561612668777, "mean_inference_ms": 0.3652380153428247, "mean_action_processing_ms": 0.08996411074987894, "mean_env_wait_ms": 0.9661856996859646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00370025634765625, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.0654911994934082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1636800, "num_agent_steps_trained": 1636800, "num_env_steps_sampled": 1636800, "num_env_steps_trained": 1636800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 414.15891628701286, "num_env_steps_trained_throughput_per_sec": 414.15891628701286, "timesteps_total": 1636800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1636800, "timers": {"training_iteration_time_ms": 8586.592, "sample_time_ms": 8489.973, "load_time_ms": 1.474, "load_throughput": 2443086.223, "learn_time_ms": 94.283, "learn_throughput": 38183.039, "synch_weights_time_ms": 0.804}, "counters": {"num_env_steps_sampled": 1636800, "num_env_steps_trained": 1636800, "num_agent_steps_sampled": 1636800, "num_agent_steps_trained": 1636800}, "done": false, "episodes_total": 1327, "training_iteration": 394, "trial_id": "5f82d_00000", "date": "2023-07-27_00-30-49", "timestamp": 1690407049, "time_this_iter_s": 17.387485027313232, "time_total_s": 5587.390807628632, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3559.5608534812927, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 18.18, "ram_util_percent": 68.308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6183711460658, "policy_loss": -1.1851777339017445e+19, "vf_loss": 312615131.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23436.5, "diff_num_grad_updates_vs_sampler_policy": 23435.5}}, "num_env_steps_sampled": 1644000, "num_env_steps_trained": 1644000, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114202.89048975449, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9030460968722603, "mean_inference_ms": 0.3652361395895643, "mean_action_processing_ms": 0.08996362136607758, "mean_env_wait_ms": 0.9661728226230253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036973953247070312, "StateBufferConnector_ms": 0.002549886703491211, "ViewRequirementAgentConnector_ms": 0.0655064582824707}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114202.89048975449, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114045.34585074712, -114239.34933592846, -114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9030460968722603, "mean_inference_ms": 0.3652361395895643, "mean_action_processing_ms": 0.08996362136607758, "mean_env_wait_ms": 0.9661728226230253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036973953247070312, "StateBufferConnector_ms": 0.002549886703491211, "ViewRequirementAgentConnector_ms": 0.0655064582824707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000, "num_env_steps_sampled": 1644000, "num_env_steps_trained": 1644000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.62839383713276, "num_env_steps_trained_throughput_per_sec": 422.62839383713276, "timesteps_total": 1644000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1644000, "timers": {"training_iteration_time_ms": 8574.188, "sample_time_ms": 8476.901, "load_time_ms": 1.486, "load_throughput": 2422819.293, "learn_time_ms": 94.949, "learn_throughput": 37915.222, "synch_weights_time_ms": 0.792}, "counters": {"num_env_steps_sampled": 1644000, "num_env_steps_trained": 1644000, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000}, "done": false, "episodes_total": 1329, "training_iteration": 395, "trial_id": "5f82d_00000", "date": "2023-07-27_00-31-06", "timestamp": 1690407066, "time_this_iter_s": 17.03926992416382, "time_total_s": 5604.430077552795, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3576.6001234054565, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 19.945833333333336, "ram_util_percent": 68.22916666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.643539428711, "policy_loss": -1.08531459718094e+19, "vf_loss": 312990880.9285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23548.5, "diff_num_grad_updates_vs_sampler_policy": 23547.5}}, "num_env_steps_sampled": 1651200, "num_env_steps_trained": 1651200, "num_agent_steps_sampled": 1651200, "num_agent_steps_trained": 1651200}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114208.51143213602, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9030371079040539, "mean_inference_ms": 0.3652343594541005, "mean_action_processing_ms": 0.08996314493591148, "mean_env_wait_ms": 0.9661662137715464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036966800689697266, "StateBufferConnector_ms": 0.002557992935180664, "ViewRequirementAgentConnector_ms": 0.06551980972290039}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114208.51143213602, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114157.52540865295, -114048.67234265081, -114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9030371079040539, "mean_inference_ms": 0.3652343594541005, "mean_action_processing_ms": 0.08996314493591148, "mean_env_wait_ms": 0.9661662137715464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036966800689697266, "StateBufferConnector_ms": 0.002557992935180664, "ViewRequirementAgentConnector_ms": 0.06551980972290039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1651200, "num_agent_steps_trained": 1651200, "num_env_steps_sampled": 1651200, "num_env_steps_trained": 1651200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 413.9270785194424, "num_env_steps_trained_throughput_per_sec": 413.9270785194424, "timesteps_total": 1651200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1651200, "timers": {"training_iteration_time_ms": 8600.326, "sample_time_ms": 8502.795, "load_time_ms": 1.515, "load_throughput": 2376413.604, "learn_time_ms": 95.176, "learn_throughput": 37824.697, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 1651200, "num_env_steps_trained": 1651200, "num_agent_steps_sampled": 1651200, "num_agent_steps_trained": 1651200}, "done": false, "episodes_total": 1331, "training_iteration": 396, "trial_id": "5f82d_00000", "date": "2023-07-27_00-31-23", "timestamp": 1690407083, "time_this_iter_s": 17.397258043289185, "time_total_s": 5621.827335596085, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3593.9973814487457, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 18.236, "ram_util_percent": 68.236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5843004499163, "policy_loss": -1.0747853974828814e+19, "vf_loss": 307495702.64285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23660.5, "diff_num_grad_updates_vs_sampler_policy": 23659.5}}, "num_env_steps_sampled": 1658400, "num_env_steps_trained": 1658400, "num_agent_steps_sampled": 1658400, "num_agent_steps_trained": 1658400}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114206.43184407926, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9030281947858358, "mean_inference_ms": 0.36523260184431594, "mean_action_processing_ms": 0.08996269548153679, "mean_env_wait_ms": 0.9661578284923675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036907196044921875, "StateBufferConnector_ms": 0.0025627613067626953, "ViewRequirementAgentConnector_ms": 0.0654451847076416}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114206.43184407926, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114465.27251440079, -114695.61960032595, -114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9030281947858358, "mean_inference_ms": 0.36523260184431594, "mean_action_processing_ms": 0.08996269548153679, "mean_env_wait_ms": 0.9661578284923675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036907196044921875, "StateBufferConnector_ms": 0.0025627613067626953, "ViewRequirementAgentConnector_ms": 0.0654451847076416}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1658400, "num_agent_steps_trained": 1658400, "num_env_steps_sampled": 1658400, "num_env_steps_trained": 1658400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 419.98307439350884, "num_env_steps_trained_throughput_per_sec": 419.98307439350884, "timesteps_total": 1658400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1658400, "timers": {"training_iteration_time_ms": 8602.7, "sample_time_ms": 8505.459, "load_time_ms": 1.505, "load_throughput": 2391809.663, "learn_time_ms": 94.902, "learn_throughput": 37933.949, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 1658400, "num_env_steps_trained": 1658400, "num_agent_steps_sampled": 1658400, "num_agent_steps_trained": 1658400}, "done": false, "episodes_total": 1333, "training_iteration": 397, "trial_id": "5f82d_00000", "date": "2023-07-27_00-31-41", "timestamp": 1690407101, "time_this_iter_s": 17.146548986434937, "time_total_s": 5638.9738845825195, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3611.1439304351807, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 18.75, "ram_util_percent": 68.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.641108921596, "policy_loss": -1.1281595107346043e+19, "vf_loss": 309533969.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23772.5, "diff_num_grad_updates_vs_sampler_policy": 23771.5}}, "num_env_steps_sampled": 1665600, "num_env_steps_trained": 1665600, "num_agent_steps_sampled": 1665600, "num_agent_steps_trained": 1665600}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114194.37947590409, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9030187759831187, "mean_inference_ms": 0.3652305853475859, "mean_action_processing_ms": 0.08996223632492932, "mean_env_wait_ms": 0.9661515833001697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036954879760742188, "StateBufferConnector_ms": 0.0025615692138671875, "ViewRequirementAgentConnector_ms": 0.06548690795898438}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114194.37947590409, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114344.58317684408, -113948.12649616614, -114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9030187759831187, "mean_inference_ms": 0.3652305853475859, "mean_action_processing_ms": 0.08996223632492932, "mean_env_wait_ms": 0.9661515833001697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036954879760742188, "StateBufferConnector_ms": 0.0025615692138671875, "ViewRequirementAgentConnector_ms": 0.06548690795898438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1665600, "num_agent_steps_trained": 1665600, "num_env_steps_sampled": 1665600, "num_env_steps_trained": 1665600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.8489517146476, "num_env_steps_trained_throughput_per_sec": 422.8489517146476, "timesteps_total": 1665600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1665600, "timers": {"training_iteration_time_ms": 8598.598, "sample_time_ms": 8501.87, "load_time_ms": 1.506, "load_throughput": 2390862.861, "learn_time_ms": 94.39, "learn_throughput": 38139.648, "synch_weights_time_ms": 0.772}, "counters": {"num_env_steps_sampled": 1665600, "num_env_steps_trained": 1665600, "num_agent_steps_sampled": 1665600, "num_agent_steps_trained": 1665600}, "done": false, "episodes_total": 1335, "training_iteration": 398, "trial_id": "5f82d_00000", "date": "2023-07-27_00-31-58", "timestamp": 1690407118, "time_this_iter_s": 17.03041100502014, "time_total_s": 5656.00429558754, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3628.174341440201, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 17.900000000000002, "ram_util_percent": 68.3625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6374250139509, "policy_loss": -1.0513645525527335e+19, "vf_loss": 306231078.21428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23884.5, "diff_num_grad_updates_vs_sampler_policy": 23883.5}}, "num_env_steps_sampled": 1672800, "num_env_steps_trained": 1672800, "num_agent_steps_sampled": 1672800, "num_agent_steps_trained": 1672800}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114183.35659763681, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.903008343207033, "mean_inference_ms": 0.3652285168470252, "mean_action_processing_ms": 0.08996175855222552, "mean_env_wait_ms": 0.9661443628906601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003693819046020508, "StateBufferConnector_ms": 0.002564668655395508, "ViewRequirementAgentConnector_ms": 0.06546640396118164}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114183.35659763681, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114140.6288215684, -114208.64413042385, -114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.903008343207033, "mean_inference_ms": 0.3652285168470252, "mean_action_processing_ms": 0.08996175855222552, "mean_env_wait_ms": 0.9661443628906601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003693819046020508, "StateBufferConnector_ms": 0.002564668655395508, "ViewRequirementAgentConnector_ms": 0.06546640396118164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1672800, "num_agent_steps_trained": 1672800, "num_env_steps_sampled": 1672800, "num_env_steps_trained": 1672800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 430.59205781145744, "num_env_steps_trained_throughput_per_sec": 430.59205781145744, "timesteps_total": 1672800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1672800, "timers": {"training_iteration_time_ms": 8532.251, "sample_time_ms": 8436.107, "load_time_ms": 1.466, "load_throughput": 2455841.26, "learn_time_ms": 93.847, "learn_throughput": 38360.12, "synch_weights_time_ms": 0.771}, "counters": {"num_env_steps_sampled": 1672800, "num_env_steps_trained": 1672800, "num_agent_steps_sampled": 1672800, "num_agent_steps_trained": 1672800}, "done": false, "episodes_total": 1337, "training_iteration": 399, "trial_id": "5f82d_00000", "date": "2023-07-27_00-32-14", "timestamp": 1690407134, "time_this_iter_s": 16.72411274909973, "time_total_s": 5672.728408336639, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3644.8984541893005, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 21.025000000000002, "ram_util_percent": 68.41250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.565185546875, "policy_loss": -1.069702395968522e+19, "vf_loss": 308283714.4285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23996.5, "diff_num_grad_updates_vs_sampler_policy": 23995.5}}, "num_env_steps_sampled": 1680000, "num_env_steps_trained": 1680000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114175.36516966074, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029982456369313, "mean_inference_ms": 0.3652265920091854, "mean_action_processing_ms": 0.08996129424532878, "mean_env_wait_ms": 0.9661341511800817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036933422088623047, "StateBufferConnector_ms": 0.0025610923767089844, "ViewRequirementAgentConnector_ms": 0.06547212600708008}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114175.36516966074, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114995.25232137789, -114398.93737829513, -113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029982456369313, "mean_inference_ms": 0.3652265920091854, "mean_action_processing_ms": 0.08996129424532878, "mean_env_wait_ms": 0.9661341511800817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036933422088623047, "StateBufferConnector_ms": 0.0025610923767089844, "ViewRequirementAgentConnector_ms": 0.06547212600708008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 1680000, "num_env_steps_trained": 1680000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.29111436374393, "num_env_steps_trained_throughput_per_sec": 424.29111436374393, "timesteps_total": 1680000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 8525.575, "sample_time_ms": 8429.842, "load_time_ms": 1.478, "load_throughput": 2435245.21, "learn_time_ms": 93.431, "learn_throughput": 38530.904, "synch_weights_time_ms": 0.765}, "counters": {"num_env_steps_sampled": 1680000, "num_env_steps_trained": 1680000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "episodes_total": 1339, "training_iteration": 400, "trial_id": "5f82d_00000", "date": "2023-07-27_00-32-31", "timestamp": 1690407151, "time_this_iter_s": 16.972476959228516, "time_total_s": 5689.700885295868, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3661.870931148529, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 18.974999999999998, "ram_util_percent": 68.40833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6504887172155, "policy_loss": -1.1043993687874894e+19, "vf_loss": 309475864.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24108.5, "diff_num_grad_updates_vs_sampler_policy": 24107.5}}, "num_env_steps_sampled": 1687200, "num_env_steps_trained": 1687200, "num_agent_steps_sampled": 1687200, "num_agent_steps_trained": 1687200}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114157.1013596344, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029877278020747, "mean_inference_ms": 0.3652244942972363, "mean_action_processing_ms": 0.08996081031193402, "mean_env_wait_ms": 0.9661212846219823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036933422088623047, "StateBufferConnector_ms": 0.002561807632446289, "ViewRequirementAgentConnector_ms": 0.06544852256774902}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114157.1013596344, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113961.84565678492, -114284.89739632192, -114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029877278020747, "mean_inference_ms": 0.3652244942972363, "mean_action_processing_ms": 0.08996081031193402, "mean_env_wait_ms": 0.9661212846219823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036933422088623047, "StateBufferConnector_ms": 0.002561807632446289, "ViewRequirementAgentConnector_ms": 0.06544852256774902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1687200, "num_agent_steps_trained": 1687200, "num_env_steps_sampled": 1687200, "num_env_steps_trained": 1687200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.5135905899673, "num_env_steps_trained_throughput_per_sec": 424.5135905899673, "timesteps_total": 1687200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1687200, "timers": {"training_iteration_time_ms": 8482.196, "sample_time_ms": 8386.657, "load_time_ms": 1.463, "load_throughput": 2461084.935, "learn_time_ms": 93.244, "learn_throughput": 38608.223, "synch_weights_time_ms": 0.775}, "counters": {"num_env_steps_sampled": 1687200, "num_env_steps_trained": 1687200, "num_agent_steps_sampled": 1687200, "num_agent_steps_trained": 1687200}, "done": false, "episodes_total": 1341, "training_iteration": 401, "trial_id": "5f82d_00000", "date": "2023-07-27_00-32-48", "timestamp": 1690407168, "time_this_iter_s": 16.963469743728638, "time_total_s": 5706.664355039597, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3678.8344008922577, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 18.787499999999998, "ram_util_percent": 68.39583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6338566371373, "policy_loss": -1.1064777412577241e+19, "vf_loss": 311235245.64285713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24220.5, "diff_num_grad_updates_vs_sampler_policy": 24219.5}}, "num_env_steps_sampled": 1694400, "num_env_steps_trained": 1694400, "num_agent_steps_sampled": 1694400, "num_agent_steps_trained": 1694400}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114163.53375161932, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029781428074848, "mean_inference_ms": 0.36522231089184354, "mean_action_processing_ms": 0.08996034518795387, "mean_env_wait_ms": 0.9661073490685326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003694772720336914, "StateBufferConnector_ms": 0.002559661865234375, "ViewRequirementAgentConnector_ms": 0.06543612480163574}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114163.53375161932, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114237.51640032328, -113113.75631954349, -113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029781428074848, "mean_inference_ms": 0.36522231089184354, "mean_action_processing_ms": 0.08996034518795387, "mean_env_wait_ms": 0.9661073490685326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003694772720336914, "StateBufferConnector_ms": 0.002559661865234375, "ViewRequirementAgentConnector_ms": 0.06543612480163574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1694400, "num_agent_steps_trained": 1694400, "num_env_steps_sampled": 1694400, "num_env_steps_trained": 1694400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 424.51916428720625, "num_env_steps_trained_throughput_per_sec": 424.51916428720625, "timesteps_total": 1694400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1694400, "timers": {"training_iteration_time_ms": 8463.877, "sample_time_ms": 8367.861, "load_time_ms": 1.47, "load_throughput": 2449069.712, "learn_time_ms": 93.715, "learn_throughput": 38414.498, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 1694400, "num_env_steps_trained": 1694400, "num_agent_steps_sampled": 1694400, "num_agent_steps_trained": 1694400}, "done": false, "episodes_total": 1343, "training_iteration": 402, "trial_id": "5f82d_00000", "date": "2023-07-27_00-33-05", "timestamp": 1690407185, "time_this_iter_s": 16.96333384513855, "time_total_s": 5723.627688884735, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3695.7977347373962, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 19.212500000000002, "ram_util_percent": 68.41250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6439252580915, "policy_loss": -1.2578110086669922e+19, "vf_loss": 311095475.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24332.5, "diff_num_grad_updates_vs_sampler_policy": 24331.5}}, "num_env_steps_sampled": 1701600, "num_env_steps_trained": 1701600, "num_agent_steps_sampled": 1701600, "num_agent_steps_trained": 1701600}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114168.02450396921, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029690633980083, "mean_inference_ms": 0.3652201610960415, "mean_action_processing_ms": 0.08995988263627297, "mean_env_wait_ms": 0.9660972308562371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036928653717041016, "StateBufferConnector_ms": 0.002558469772338867, "ViewRequirementAgentConnector_ms": 0.0654294490814209}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114168.02450396921, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113892.2334974454, -114736.0059235751, -114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029690633980083, "mean_inference_ms": 0.3652201610960415, "mean_action_processing_ms": 0.08995988263627297, "mean_env_wait_ms": 0.9660972308562371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036928653717041016, "StateBufferConnector_ms": 0.002558469772338867, "ViewRequirementAgentConnector_ms": 0.0654294490814209}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1701600, "num_agent_steps_trained": 1701600, "num_env_steps_sampled": 1701600, "num_env_steps_trained": 1701600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 418.193922544264, "num_env_steps_trained_throughput_per_sec": 418.193922544264, "timesteps_total": 1701600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1701600, "timers": {"training_iteration_time_ms": 8482.83, "sample_time_ms": 8386.795, "load_time_ms": 1.473, "load_throughput": 2443560.662, "learn_time_ms": 93.724, "learn_throughput": 38410.579, "synch_weights_time_ms": 0.779}, "counters": {"num_env_steps_sampled": 1701600, "num_env_steps_trained": 1701600, "num_agent_steps_sampled": 1701600, "num_agent_steps_trained": 1701600}, "done": false, "episodes_total": 1345, "training_iteration": 403, "trial_id": "5f82d_00000", "date": "2023-07-27_00-33-23", "timestamp": 1690407203, "time_this_iter_s": 17.219785928726196, "time_total_s": 5740.847474813461, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3713.0175206661224, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 18.1375, "ram_util_percent": 68.37916666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6473410470146, "policy_loss": -1.2548583781783499e+19, "vf_loss": 309921691.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24444.5, "diff_num_grad_updates_vs_sampler_policy": 24443.5}}, "num_env_steps_sampled": 1708800, "num_env_steps_trained": 1708800, "num_agent_steps_sampled": 1708800, "num_agent_steps_trained": 1708800}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114162.404472909, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332, -113929.45198746689, -114136.784327531], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029592586961663, "mean_inference_ms": 0.3652179952117279, "mean_action_processing_ms": 0.08995945440236415, "mean_env_wait_ms": 0.9660878884028634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036928653717041016, "StateBufferConnector_ms": 0.0025482177734375, "ViewRequirementAgentConnector_ms": 0.06542110443115234}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114162.404472909, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114910.92864237835, -114719.02341872423, -113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332, -113929.45198746689, -114136.784327531], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029592586961663, "mean_inference_ms": 0.3652179952117279, "mean_action_processing_ms": 0.08995945440236415, "mean_env_wait_ms": 0.9660878884028634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036928653717041016, "StateBufferConnector_ms": 0.0025482177734375, "ViewRequirementAgentConnector_ms": 0.06542110443115234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1708800, "num_agent_steps_trained": 1708800, "num_env_steps_sampled": 1708800, "num_env_steps_trained": 1708800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.2576967851075, "num_env_steps_trained_throughput_per_sec": 422.2576967851075, "timesteps_total": 1708800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1708800, "timers": {"training_iteration_time_ms": 8515.834, "sample_time_ms": 8419.601, "load_time_ms": 1.504, "load_throughput": 2393629.625, "learn_time_ms": 93.887, "learn_throughput": 38343.813, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 1708800, "num_env_steps_trained": 1708800, "num_agent_steps_sampled": 1708800, "num_agent_steps_trained": 1708800}, "done": false, "episodes_total": 1347, "training_iteration": 404, "trial_id": "5f82d_00000", "date": "2023-07-27_00-33-40", "timestamp": 1690407220, "time_this_iter_s": 17.054121017456055, "time_total_s": 5757.901595830917, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3730.0716416835785, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 18.9125, "ram_util_percent": 68.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.670403616769, "policy_loss": -1.1412494705595054e+19, "vf_loss": 309387526.71428573}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24556.5, "diff_num_grad_updates_vs_sampler_policy": 24555.5}}, "num_env_steps_sampled": 1716000, "num_env_steps_trained": 1716000, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114148.63381821291, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332, -113929.45198746689, -114136.784327531, -114260.50042365528, -113992.38616784113], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029495322537155, "mean_inference_ms": 0.3652156844518484, "mean_action_processing_ms": 0.08995903129279885, "mean_env_wait_ms": 0.9660714347716589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003693819046020508, "StateBufferConnector_ms": 0.002549409866333008, "ViewRequirementAgentConnector_ms": 0.06540608406066895}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114148.63381821291, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113474.71966650397, -114514.67306095683, -114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332, -113929.45198746689, -114136.784327531, -114260.50042365528, -113992.38616784113], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029495322537155, "mean_inference_ms": 0.3652156844518484, "mean_action_processing_ms": 0.08995903129279885, "mean_env_wait_ms": 0.9660714347716589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003693819046020508, "StateBufferConnector_ms": 0.002549409866333008, "ViewRequirementAgentConnector_ms": 0.06540608406066895}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000, "num_env_steps_sampled": 1716000, "num_env_steps_trained": 1716000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.98969970185374, "num_env_steps_trained_throughput_per_sec": 422.98969970185374, "timesteps_total": 1716000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1716000, "timers": {"training_iteration_time_ms": 8521.055, "sample_time_ms": 8424.712, "load_time_ms": 1.491, "load_throughput": 2414644.172, "learn_time_ms": 93.999, "learn_throughput": 38298.21, "synch_weights_time_ms": 0.792}, "counters": {"num_env_steps_sampled": 1716000, "num_env_steps_trained": 1716000, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000}, "done": false, "episodes_total": 1349, "training_iteration": 405, "trial_id": "5f82d_00000", "date": "2023-07-27_00-33-57", "timestamp": 1690407237, "time_this_iter_s": 17.02465009689331, "time_total_s": 5774.926245927811, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3747.096291780472, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 18.528, "ram_util_percent": 68.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.629122052874, "policy_loss": -1.030372368299334e+19, "vf_loss": 307964506.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24668.5, "diff_num_grad_updates_vs_sampler_policy": 24667.5}}, "num_env_steps_sampled": 1723200, "num_env_steps_trained": 1723200, "num_agent_steps_sampled": 1723200, "num_agent_steps_trained": 1723200}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114140.3976342084, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332, -113929.45198746689, -114136.784327531, -114260.50042365528, -113992.38616784113, -113445.23099149417, -113720.54333551599], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029386895871631, "mean_inference_ms": 0.3652133262063398, "mean_action_processing_ms": 0.08995860966704435, "mean_env_wait_ms": 0.9660520792959219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036923885345458984, "StateBufferConnector_ms": 0.002550363540649414, "ViewRequirementAgentConnector_ms": 0.06537342071533203}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114140.3976342084, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114506.53398960984, -113951.04560532352, -114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332, -113929.45198746689, -114136.784327531, -114260.50042365528, -113992.38616784113, -113445.23099149417, -113720.54333551599], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029386895871631, "mean_inference_ms": 0.3652133262063398, "mean_action_processing_ms": 0.08995860966704435, "mean_env_wait_ms": 0.9660520792959219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036923885345458984, "StateBufferConnector_ms": 0.002550363540649414, "ViewRequirementAgentConnector_ms": 0.06537342071533203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1723200, "num_agent_steps_trained": 1723200, "num_env_steps_sampled": 1723200, "num_env_steps_trained": 1723200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 431.72859682421245, "num_env_steps_trained_throughput_per_sec": 431.72859682421245, "timesteps_total": 1723200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1723200, "timers": {"training_iteration_time_ms": 8492.711, "sample_time_ms": 8396.723, "load_time_ms": 1.479, "load_throughput": 2434499.202, "learn_time_ms": 93.666, "learn_throughput": 38434.592, "synch_weights_time_ms": 0.783}, "counters": {"num_env_steps_sampled": 1723200, "num_env_steps_trained": 1723200, "num_agent_steps_sampled": 1723200, "num_agent_steps_trained": 1723200}, "done": false, "episodes_total": 1351, "training_iteration": 406, "trial_id": "5f82d_00000", "date": "2023-07-27_00-34-14", "timestamp": 1690407254, "time_this_iter_s": 16.68000888824463, "time_total_s": 5791.606254816055, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3763.7763006687164, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 20.49130434782609, "ram_util_percent": 68.26521739130435}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.629185267857, "policy_loss": -1.111126978072169e+19, "vf_loss": 307898787.4285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24780.5, "diff_num_grad_updates_vs_sampler_policy": 24779.5}}, "num_env_steps_sampled": 1730400, "num_env_steps_trained": 1730400, "num_agent_steps_sampled": 1730400, "num_agent_steps_trained": 1730400}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114143.03821913182, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332, -113929.45198746689, -114136.784327531, -114260.50042365528, -113992.38616784113, -113445.23099149417, -113720.54333551599, -114939.71574079241, -113781.92234648335], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029284543902488, "mean_inference_ms": 0.36521096529935354, "mean_action_processing_ms": 0.08995819149761022, "mean_env_wait_ms": 0.9660323265286905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036897659301757812, "StateBufferConnector_ms": 0.0025517940521240234, "ViewRequirementAgentConnector_ms": 0.06535720825195312}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114143.03821913182, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114680.22174172525, -114457.35454684576, -114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332, -113929.45198746689, -114136.784327531, -114260.50042365528, -113992.38616784113, -113445.23099149417, -113720.54333551599, -114939.71574079241, -113781.92234648335], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029284543902488, "mean_inference_ms": 0.36521096529935354, "mean_action_processing_ms": 0.08995819149761022, "mean_env_wait_ms": 0.9660323265286905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036897659301757812, "StateBufferConnector_ms": 0.0025517940521240234, "ViewRequirementAgentConnector_ms": 0.06535720825195312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1730400, "num_agent_steps_trained": 1730400, "num_env_steps_sampled": 1730400, "num_env_steps_trained": 1730400, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 422.3349204288074, "num_env_steps_trained_throughput_per_sec": 422.3349204288074, "timesteps_total": 1730400, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1730400, "timers": {"training_iteration_time_ms": 8501.484, "sample_time_ms": 8405.733, "load_time_ms": 1.461, "load_throughput": 2464539.54, "learn_time_ms": 93.447, "learn_throughput": 38524.504, "synch_weights_time_ms": 0.783}, "counters": {"num_env_steps_sampled": 1730400, "num_env_steps_trained": 1730400, "num_agent_steps_sampled": 1730400, "num_agent_steps_trained": 1730400}, "done": false, "episodes_total": 1353, "training_iteration": 407, "trial_id": "5f82d_00000", "date": "2023-07-27_00-34-31", "timestamp": 1690407271, "time_this_iter_s": 17.051077127456665, "time_total_s": 5808.657331943512, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3780.827377796173, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 18.983333333333334, "ram_util_percent": 68.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6380310058594, "policy_loss": -1.097274143211055e+19, "vf_loss": 313557339.28571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24892.5, "diff_num_grad_updates_vs_sampler_policy": 24891.5}}, "num_env_steps_sampled": 1737600, "num_env_steps_trained": 1737600, "num_agent_steps_sampled": 1737600, "num_agent_steps_trained": 1737600}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114144.58701527836, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332, -113929.45198746689, -114136.784327531, -114260.50042365528, -113992.38616784113, -113445.23099149417, -113720.54333551599, -114939.71574079241, -113781.92234648335, -114502.79579841161, -114789.66010481086], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029174518614701, "mean_inference_ms": 0.3652083363245208, "mean_action_processing_ms": 0.08995775288914899, "mean_env_wait_ms": 0.966011219389909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003683805465698242, "StateBufferConnector_ms": 0.002555370330810547, "ViewRequirementAgentConnector_ms": 0.06537008285522461}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115343.10683349169, "episode_reward_mean": -114144.58701527836, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114416.64865769929, -115343.10683349169, -113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332, -113929.45198746689, -114136.784327531, -114260.50042365528, -113992.38616784113, -113445.23099149417, -113720.54333551599, -114939.71574079241, -113781.92234648335, -114502.79579841161, -114789.66010481086], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029174518614701, "mean_inference_ms": 0.3652083363245208, "mean_action_processing_ms": 0.08995775288914899, "mean_env_wait_ms": 0.966011219389909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003683805465698242, "StateBufferConnector_ms": 0.002555370330810547, "ViewRequirementAgentConnector_ms": 0.06537008285522461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1737600, "num_agent_steps_trained": 1737600, "num_env_steps_sampled": 1737600, "num_env_steps_trained": 1737600, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 421.50778354839395, "num_env_steps_trained_throughput_per_sec": 421.50778354839395, "timesteps_total": 1737600, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1737600, "timers": {"training_iteration_time_ms": 8487.948, "sample_time_ms": 8391.938, "load_time_ms": 1.443, "load_throughput": 2494547.233, "learn_time_ms": 93.712, "learn_throughput": 38415.582, "synch_weights_time_ms": 0.795}, "counters": {"num_env_steps_sampled": 1737600, "num_env_steps_trained": 1737600, "num_agent_steps_sampled": 1737600, "num_agent_steps_trained": 1737600}, "done": false, "episodes_total": 1355, "training_iteration": 408, "trial_id": "5f82d_00000", "date": "2023-07-27_00-34-48", "timestamp": 1690407288, "time_this_iter_s": 17.084441900253296, "time_total_s": 5825.741773843765, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3797.9118196964264, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 18.104, "ram_util_percent": 68.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.630122593471, "policy_loss": -1.2086490999185955e+19, "vf_loss": 313955012.4285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25004.5, "diff_num_grad_updates_vs_sampler_policy": 25003.5}}, "num_env_steps_sampled": 1744800, "num_env_steps_trained": 1744800, "num_agent_steps_sampled": 1744800, "num_agent_steps_trained": 1744800}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115143.64585269403, "episode_reward_mean": -114138.94575512157, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332, -113929.45198746689, -114136.784327531, -114260.50042365528, -113992.38616784113, -113445.23099149417, -113720.54333551599, -114939.71574079241, -113781.92234648335, -114502.79579841161, -114789.66010481086, -114399.66385479883, -114795.965620713], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.90290871044712, "mean_inference_ms": 0.3652058474587361, "mean_action_processing_ms": 0.08995731737917759, "mean_env_wait_ms": 0.9659899636027753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003686666488647461, "StateBufferConnector_ms": 0.002555370330810547, "ViewRequirementAgentConnector_ms": 0.06534886360168457}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115143.64585269403, "episode_reward_mean": -114138.94575512157, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113826.19671258176, -113580.15310062592, -114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332, -113929.45198746689, -114136.784327531, -114260.50042365528, -113992.38616784113, -113445.23099149417, -113720.54333551599, -114939.71574079241, -113781.92234648335, -114502.79579841161, -114789.66010481086, -114399.66385479883, -114795.965620713], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.90290871044712, "mean_inference_ms": 0.3652058474587361, "mean_action_processing_ms": 0.08995731737917759, "mean_env_wait_ms": 0.9659899636027753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003686666488647461, "StateBufferConnector_ms": 0.002555370330810547, "ViewRequirementAgentConnector_ms": 0.06534886360168457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1744800, "num_agent_steps_trained": 1744800, "num_env_steps_sampled": 1744800, "num_env_steps_trained": 1744800, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 420.74908021101635, "num_env_steps_trained_throughput_per_sec": 420.74908021101635, "timesteps_total": 1744800, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1744800, "timers": {"training_iteration_time_ms": 8494.062, "sample_time_ms": 8397.983, "load_time_ms": 1.413, "load_throughput": 2548609.931, "learn_time_ms": 93.814, "learn_throughput": 38373.865, "synch_weights_time_ms": 0.792}, "counters": {"num_env_steps_sampled": 1744800, "num_env_steps_trained": 1744800, "num_agent_steps_sampled": 1744800, "num_agent_steps_trained": 1744800}, "done": false, "episodes_total": 1357, "training_iteration": 409, "trial_id": "5f82d_00000", "date": "2023-07-27_00-35-05", "timestamp": 1690407305, "time_this_iter_s": 17.11532497406006, "time_total_s": 5842.857098817825, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3815.0271446704865, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 20.404166666666665, "ram_util_percent": 68.27499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6527099609375, "policy_loss": -1.0096108802378015e+19, "vf_loss": 308999146.0714286}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25116.5, "diff_num_grad_updates_vs_sampler_policy": 25115.5}}, "num_env_steps_sampled": 1752000, "num_env_steps_trained": 1752000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115143.64585269403, "episode_reward_mean": -114143.97025877425, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332, -113929.45198746689, -114136.784327531, -114260.50042365528, -113992.38616784113, -113445.23099149417, -113720.54333551599, -114939.71574079241, -113781.92234648335, -114502.79579841161, -114789.66010481086, -114399.66385479883, -114795.965620713, -114057.43742101201, -113851.36275746406], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029004675539781, "mean_inference_ms": 0.3652032824867102, "mean_action_processing_ms": 0.08995690298252544, "mean_env_wait_ms": 0.9659701563575499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003684520721435547, "StateBufferConnector_ms": 0.0025565624237060547, "ViewRequirementAgentConnector_ms": 0.06534504890441895}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115143.64585269403, "episode_reward_mean": -114143.97025877425, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-114474.05737387114, -114362.87166776518, -113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332, -113929.45198746689, -114136.784327531, -114260.50042365528, -113992.38616784113, -113445.23099149417, -113720.54333551599, -114939.71574079241, -113781.92234648335, -114502.79579841161, -114789.66010481086, -114399.66385479883, -114795.965620713, -114057.43742101201, -113851.36275746406], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9029004675539781, "mean_inference_ms": 0.3652032824867102, "mean_action_processing_ms": 0.08995690298252544, "mean_env_wait_ms": 0.9659701563575499, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003684520721435547, "StateBufferConnector_ms": 0.0025565624237060547, "ViewRequirementAgentConnector_ms": 0.06534504890441895}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000, "num_env_steps_sampled": 1752000, "num_env_steps_trained": 1752000, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 425.884201874743, "num_env_steps_trained_throughput_per_sec": 425.884201874743, "timesteps_total": 1752000, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1752000, "timers": {"training_iteration_time_ms": 8482.493, "sample_time_ms": 8386.582, "load_time_ms": 1.403, "load_throughput": 2565018.499, "learn_time_ms": 93.652, "learn_throughput": 38440.335, "synch_weights_time_ms": 0.796}, "counters": {"num_env_steps_sampled": 1752000, "num_env_steps_trained": 1752000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "done": false, "episodes_total": 1359, "training_iteration": 410, "trial_id": "5f82d_00000", "date": "2023-07-27_00-35-22", "timestamp": 1690407322, "time_this_iter_s": 16.909084796905518, "time_total_s": 5859.766183614731, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3831.936229467392, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 19.575, "ram_util_percent": 68.37916666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.6417170933314, "policy_loss": -1.11674964443612e+19, "vf_loss": 309665595.78571427}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25228.5, "diff_num_grad_updates_vs_sampler_policy": 25227.5}}, "num_env_steps_sampled": 1759200, "num_env_steps_trained": 1759200, "num_agent_steps_sampled": 1759200, "num_agent_steps_trained": 1759200}, "sampler_results": {"episode_reward_max": -112945.86882185032, "episode_reward_min": -115143.64585269403, "episode_reward_mean": -114141.14154982647, "episode_len_mean": 3600.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332, -113929.45198746689, -114136.784327531, -114260.50042365528, -113992.38616784113, -113445.23099149417, -113720.54333551599, -114939.71574079241, -113781.92234648335, -114502.79579841161, -114789.66010481086, -114399.66385479883, -114795.965620713, -114057.43742101201, -113851.36275746406, -114477.83389691167, -114076.22424994534], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9028924813628433, "mean_inference_ms": 0.36520050452581687, "mean_action_processing_ms": 0.08995645306025413, "mean_env_wait_ms": 0.9659495766751889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036873817443847656, "StateBufferConnector_ms": 0.0025615692138671875, "ViewRequirementAgentConnector_ms": 0.06535816192626953}}, "episode_reward_max": -112945.86882185032, "episode_reward_min": -115143.64585269403, "episode_reward_mean": -114141.14154982647, "episode_len_mean": 3600.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-113634.40745692281, -114858.16386826518, -112945.86882185032, -113150.23222809934, -114387.27494269836, -114676.11716175285, -114657.19313275364, -113635.47896058901, -113707.56781444755, -113858.4198257584, -114433.8915825653, -114283.55380642471, -114525.00829849065, -114425.29741844603, -114819.3013228418, -114735.89251110051, -113534.0606612313, -114718.14672738728, -113667.85325307261, -113642.60107333474, -113532.82964691002, -114446.30178048322, -114115.22964845026, -114065.13262879779, -114352.65083643806, -114680.33222667394, -113641.73533660539, -113388.5884842405, -113722.93669243774, -114585.18023528067, -114161.92254056888, -113939.92589525331, -113749.95137218098, -114498.94939036785, -114324.12679380008, -113454.5859616683, -115143.64585269403, -114026.73796766733, -113940.29627947346, -114330.10023261659, -114258.12567897639, -113951.41183225765, -114073.0764430117, -113895.3686815521, -113220.6889413813, -113815.93936621305, -113861.79718090614, -114965.87299874042, -113696.65847128896, -114392.6430491341, -114262.76009647563, -113967.4492735976, -113892.45486293132, -114457.18915702456, -114401.33725321187, -113917.07958801716, -114584.12948672211, -114777.22786888861, -114430.51460747137, -114721.38249053159, -114565.22756796922, -113499.71190726367, -114123.70522523626, -114913.33458829089, -114848.00597744987, -114577.29703579302, -114170.90437080327, -114518.51671418999, -114175.67539281484, -114671.11403201442, -114453.33443570367, -113544.9045099236, -113940.73188788797, -114014.92340932136, -113770.59646100458, -113419.82538527808, -113844.10014850557, -113706.03000588075, -113791.21078447248, -113776.59791256308, -114618.28897214944, -114271.69327945368, -113544.7619584198, -114255.5859964332, -113929.45198746689, -114136.784327531, -114260.50042365528, -113992.38616784113, -113445.23099149417, -113720.54333551599, -114939.71574079241, -113781.92234648335, -114502.79579841161, -114789.66010481086, -114399.66385479883, -114795.965620713, -114057.43742101201, -113851.36275746406, -114477.83389691167, -114076.22424994534], "episode_lengths": [3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600, 3600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9028924813628433, "mean_inference_ms": 0.36520050452581687, "mean_action_processing_ms": 0.08995645306025413, "mean_env_wait_ms": 0.9659495766751889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036873817443847656, "StateBufferConnector_ms": 0.0025615692138671875, "ViewRequirementAgentConnector_ms": 0.06535816192626953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1759200, "num_agent_steps_trained": 1759200, "num_env_steps_sampled": 1759200, "num_env_steps_trained": 1759200, "num_env_steps_sampled_this_iter": 7200, "num_env_steps_trained_this_iter": 7200, "num_env_steps_sampled_throughput_per_sec": 425.58002545702027, "num_env_steps_trained_throughput_per_sec": 425.58002545702027, "timesteps_total": 1759200, "num_steps_trained_this_iter": 7200, "agent_timesteps_total": 1759200, "timers": {"training_iteration_time_ms": 8506.588, "sample_time_ms": 8410.358, "load_time_ms": 1.45, "load_throughput": 2482448.73, "learn_time_ms": 93.915, "learn_throughput": 38332.492, "synch_weights_time_ms": 0.803}, "counters": {"num_env_steps_sampled": 1759200, "num_env_steps_trained": 1759200, "num_agent_steps_sampled": 1759200, "num_agent_steps_trained": 1759200}, "done": true, "episodes_total": 1361, "training_iteration": 411, "trial_id": "5f82d_00000", "date": "2023-07-27_00-35-39", "timestamp": 1690407339, "time_this_iter_s": 16.921052932739258, "time_total_s": 5876.68723654747, "pid": 15162, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 30, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[139199, 5e-05], [193199, 8e-05], [247199, 2.5e-05], [301199, 2.5e-05], [355199, 2.5e-05], [409199, 2.5e-05], [463199, 1e-05], [517199, 1e-05], [571199, 1e-05], [625199, 5e-06], [679199, 5e-06], [733199, 5e-06], [787199, 5e-06], [841199, 1e-06], [895199, 1e-06], [949199, 1e-06], [1003199, 1e-06], [1057199, 5e-07], [1111199, 5e-07], [1165199, 2.5e-07], [1219199, 2.5e-07], [1273199, 1e-08], [1327199, 1e-08], [1381199, 5e-09], [1435199, 5e-09], [1489199, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.15, "final_epsilon": 0.05, "epsilon_timesteps": 162599}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 3600, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30ada49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3848.857282400131, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 20.441666666666666, "ram_util_percent": 68.33333333333333}}
