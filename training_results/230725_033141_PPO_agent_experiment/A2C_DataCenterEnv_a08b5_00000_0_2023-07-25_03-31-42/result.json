{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.800000000000002e-05, "entropy_coeff": 0.1, "policy_entropy": 40.02293090820312, "policy_loss": -29753.0390625, "vf_loss": 14316697.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 12.0}}, "num_env_steps_sampled": 5076960, "num_env_steps_trained": 5076960, "num_agent_steps_sampled": 5076960, "num_agent_steps_trained": 5076960}, "sampler_results": {"episode_reward_max": -1903.9732632971813, "episode_reward_min": -1906.8187876734942, "episode_reward_mean": -1905.3261016364343, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.423519536811483, "mean_inference_ms": 0.3895234664648799, "mean_action_processing_ms": 0.09412394972667994, "mean_env_wait_ms": 4.169517485330107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033299128214518228, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.07043679555257161}}, "episode_reward_max": -1903.9732632971813, "episode_reward_min": -1906.8187876734942, "episode_reward_mean": -1905.3261016364343, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275], "episode_lengths": [360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.423519536811483, "mean_inference_ms": 0.3895234664648799, "mean_action_processing_ms": 0.09412394972667994, "mean_env_wait_ms": 4.169517485330107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033299128214518228, "StateBufferConnector_ms": 0.002765655517578125, "ViewRequirementAgentConnector_ms": 0.07043679555257161}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5076960, "num_agent_steps_trained": 5076960, "num_env_steps_sampled": 5076960, "num_env_steps_trained": 5076960, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 82.14431923635213, "num_env_steps_trained_throughput_per_sec": 82.14431923635213, "timesteps_total": 5076960, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5076960, "timers": {"training_iteration_time_ms": 4382.515, "sample_time_ms": 4362.145, "load_time_ms": 0.388, "load_throughput": 926918.011, "learn_time_ms": 19.205, "learn_throughput": 18745.493, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 5076960, "num_env_steps_trained": 5076960, "num_agent_steps_sampled": 5076960, "num_agent_steps_trained": 5076960}, "done": false, "episodes_total": 1192, "training_iteration": 571, "trial_id": "a08b5_00000", "date": "2023-07-25_03-32-02", "timestamp": 1690245122, "time_this_iter_s": 13.150315046310425, "time_total_s": 10082.264133930206, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 13.150315046310425, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 28.484210526315792, "ram_util_percent": 78.2421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.5e-05, "entropy_coeff": 0.1, "policy_entropy": 42.35894241333008, "policy_loss": -24475.53125, "vf_loss": 14176038.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28.0, "diff_num_grad_updates_vs_sampler_policy": 27.0}}, "num_env_steps_sampled": 5078040, "num_env_steps_trained": 5078040, "num_agent_steps_sampled": 5078040, "num_agent_steps_trained": 5078040}, "sampler_results": {"episode_reward_max": -1890.2342114304934, "episode_reward_min": -1906.8187876734942, "episode_reward_mean": -1901.6454965951043, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934], "episode_lengths": [360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.468593142768107, "mean_inference_ms": 0.3872261517451965, "mean_action_processing_ms": 0.09370441601934865, "mean_env_wait_ms": 3.4999207386829965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003814697265625, "StateBufferConnector_ms": 0.0028292338053385415, "ViewRequirementAgentConnector_ms": 0.07028579711914062}}, "episode_reward_max": -1890.2342114304934, "episode_reward_min": -1906.8187876734942, "episode_reward_mean": -1901.6454965951043, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934], "episode_lengths": [360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.468593142768107, "mean_inference_ms": 0.3872261517451965, "mean_action_processing_ms": 0.09370441601934865, "mean_env_wait_ms": 3.4999207386829965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003814697265625, "StateBufferConnector_ms": 0.0028292338053385415, "ViewRequirementAgentConnector_ms": 0.07028579711914062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5078040, "num_agent_steps_trained": 5078040, "num_env_steps_sampled": 5078040, "num_env_steps_trained": 5078040, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 103.89788418062295, "num_env_steps_trained_throughput_per_sec": 103.89788418062295, "timesteps_total": 5078040, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5078040, "timers": {"training_iteration_time_ms": 3923.721, "sample_time_ms": 3908.142, "load_time_ms": 0.35, "load_throughput": 1028575.913, "learn_time_ms": 14.446, "learn_throughput": 24920.427, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 5078040, "num_env_steps_trained": 5078040, "num_agent_steps_sampled": 5078040, "num_agent_steps_trained": 5078040}, "done": false, "episodes_total": 1195, "training_iteration": 572, "trial_id": "a08b5_00000", "date": "2023-07-25_03-32-12", "timestamp": 1690245132, "time_this_iter_s": 10.397345066070557, "time_total_s": 10092.661478996277, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 23.54766011238098, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.439999999999998, "ram_util_percent": 78.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.2e-05, "entropy_coeff": 0.1, "policy_entropy": 50.104974365234376, "policy_loss": -34439.269140625, "vf_loss": 13419063.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 5079120, "num_env_steps_trained": 5079120, "num_agent_steps_sampled": 5079120, "num_agent_steps_trained": 5079120}, "sampler_results": {"episode_reward_max": -1815.3042852245978, "episode_reward_min": -1906.8187876734942, "episode_reward_mean": -1882.6576607613783, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.469918903773768, "mean_inference_ms": 0.38793453316531606, "mean_action_processing_ms": 0.09373233575321722, "mean_env_wait_ms": 3.1353341527169536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036478042602539062, "StateBufferConnector_ms": 0.0027868482801649305, "ViewRequirementAgentConnector_ms": 0.0695943832397461}}, "episode_reward_max": -1815.3042852245978, "episode_reward_min": -1906.8187876734942, "episode_reward_mean": -1882.6576607613783, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.469918903773768, "mean_inference_ms": 0.38793453316531606, "mean_action_processing_ms": 0.09373233575321722, "mean_env_wait_ms": 3.1353341527169536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036478042602539062, "StateBufferConnector_ms": 0.0027868482801649305, "ViewRequirementAgentConnector_ms": 0.0695943832397461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5079120, "num_agent_steps_trained": 5079120, "num_env_steps_sampled": 5079120, "num_env_steps_trained": 5079120, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 105.26313597794169, "num_env_steps_trained_throughput_per_sec": 105.26313597794169, "timesteps_total": 5079120, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5079120, "timers": {"training_iteration_time_ms": 3755.81, "sample_time_ms": 3741.779, "load_time_ms": 0.336, "load_throughput": 1071223.787, "learn_time_ms": 12.916, "learn_throughput": 27872.216, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 5079120, "num_env_steps_trained": 5079120, "num_agent_steps_sampled": 5079120, "num_agent_steps_trained": 5079120}, "done": false, "episodes_total": 1198, "training_iteration": 573, "trial_id": "a08b5_00000", "date": "2023-07-25_03-32-22", "timestamp": 1690245142, "time_this_iter_s": 10.262442111968994, "time_total_s": 10102.923921108246, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 33.810102224349976, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.64666666666666, "ram_util_percent": 78.04666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.900000000000001e-05, "entropy_coeff": 0.1, "policy_entropy": 55.22344284057617, "policy_loss": -39847.66015625, "vf_loss": 13503685.9}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 58.0, "diff_num_grad_updates_vs_sampler_policy": 57.0}}, "num_env_steps_sampled": 5080200, "num_env_steps_trained": 5080200, "num_agent_steps_sampled": 5080200, "num_agent_steps_trained": 5080200}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -1906.8187876734942, "episode_reward_mean": -1864.306203354783, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.468095154787696, "mean_inference_ms": 0.39108474432331347, "mean_action_processing_ms": 0.09428070681026401, "mean_env_wait_ms": 2.897465311325201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039517879486083984, "StateBufferConnector_ms": 0.0028689702351888022, "ViewRequirementAgentConnector_ms": 0.07165869077046712}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -1906.8187876734942, "episode_reward_mean": -1864.306203354783, "episode_len_mean": 360.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.468095154787696, "mean_inference_ms": 0.39108474432331347, "mean_action_processing_ms": 0.09428070681026401, "mean_env_wait_ms": 2.897465311325201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039517879486083984, "StateBufferConnector_ms": 0.0028689702351888022, "ViewRequirementAgentConnector_ms": 0.07165869077046712}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5080200, "num_agent_steps_trained": 5080200, "num_env_steps_sampled": 5080200, "num_env_steps_trained": 5080200, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "num_env_steps_sampled_throughput_per_sec": 104.74593162312725, "num_env_steps_trained_throughput_per_sec": 104.74593162312725, "timesteps_total": 5080200, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 5080200, "timers": {"training_iteration_time_ms": 3446.673, "sample_time_ms": 3435.818, "load_time_ms": 0.309, "load_throughput": 1165624.085, "learn_time_ms": 9.738, "learn_throughput": 36967.52, "synch_weights_time_ms": 0.764}, "counters": {"num_env_steps_sampled": 5080200, "num_env_steps_trained": 5080200, "num_agent_steps_sampled": 5080200, "num_agent_steps_trained": 5080200}, "done": false, "episodes_total": 1201, "training_iteration": 574, "trial_id": "a08b5_00000", "date": "2023-07-25_03-32-33", "timestamp": 1690245153, "time_this_iter_s": 10.31351900100708, "time_total_s": 10113.237440109253, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 44.123621225357056, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 29.471428571428564, "ram_util_percent": 78.42142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.5e-05, "entropy_coeff": 0.1, "policy_entropy": 53.33791809082031, "policy_loss": -57569.03984375, "vf_loss": 15244488.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 78.0, "diff_num_grad_updates_vs_sampler_policy": 77.0}}, "num_env_steps_sampled": 5081640, "num_env_steps_trained": 5081640, "num_agent_steps_sampled": 5081640, "num_agent_steps_trained": 5081640}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2009.5137669377002, "episode_reward_mean": -1875.6877305472146, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.458576258762818, "mean_inference_ms": 0.3925831128123963, "mean_action_processing_ms": 0.09456173066569878, "mean_env_wait_ms": 2.6559224096781353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037863850593566895, "StateBufferConnector_ms": 0.0028312206268310547, "ViewRequirementAgentConnector_ms": 0.0706106424331665}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2009.5137669377002, "episode_reward_mean": -1875.6877305472146, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.458576258762818, "mean_inference_ms": 0.3925831128123963, "mean_action_processing_ms": 0.09456173066569878, "mean_env_wait_ms": 2.6559224096781353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037863850593566895, "StateBufferConnector_ms": 0.0028312206268310547, "ViewRequirementAgentConnector_ms": 0.0706106424331665}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5081640, "num_agent_steps_trained": 5081640, "num_env_steps_sampled": 5081640, "num_env_steps_trained": 5081640, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 110.56140126843802, "num_env_steps_trained_throughput_per_sec": 110.56140126843802, "timesteps_total": 5081640, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5081640, "timers": {"training_iteration_time_ms": 3359.497, "sample_time_ms": 3348.668, "load_time_ms": 0.31, "load_throughput": 1160606.795, "learn_time_ms": 9.73, "learn_throughput": 37000.312, "synch_weights_time_ms": 0.745}, "counters": {"num_env_steps_sampled": 5081640, "num_env_steps_trained": 5081640, "num_agent_steps_sampled": 5081640, "num_agent_steps_trained": 5081640}, "done": false, "episodes_total": 1205, "training_iteration": 575, "trial_id": "a08b5_00000", "date": "2023-07-25_03-32-46", "timestamp": 1690245166, "time_this_iter_s": 13.027251958847046, "time_total_s": 10126.2646920681, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 57.1508731842041, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 27.18421052631579, "ram_util_percent": 78.32631578947368}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.233333333333333e-05, "entropy_coeff": 0.1, "policy_entropy": 40.53569869995117, "policy_loss": -40664.516796875, "vf_loss": 15836524.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 98.0, "diff_num_grad_updates_vs_sampler_policy": 97.0}}, "num_env_steps_sampled": 5083080, "num_env_steps_trained": 5083080, "num_agent_steps_sampled": 5083080, "num_agent_steps_trained": 5083080}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2063.87605943827, "episode_reward_mean": -1910.6084031450987, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.449705541832435, "mean_inference_ms": 0.3927586463652514, "mean_action_processing_ms": 0.09461396843180178, "mean_env_wait_ms": 2.4647931386331705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719329833984375, "StateBufferConnector_ms": 0.0028264522552490234, "ViewRequirementAgentConnector_ms": 0.07065176963806152}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2063.87605943827, "episode_reward_mean": -1910.6084031450987, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.449705541832435, "mean_inference_ms": 0.3927586463652514, "mean_action_processing_ms": 0.09461396843180178, "mean_env_wait_ms": 2.4647931386331705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003719329833984375, "StateBufferConnector_ms": 0.0028264522552490234, "ViewRequirementAgentConnector_ms": 0.07065176963806152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5083080, "num_agent_steps_trained": 5083080, "num_env_steps_sampled": 5083080, "num_env_steps_trained": 5083080, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 115.52330077800663, "num_env_steps_trained_throughput_per_sec": 115.52330077800663, "timesteps_total": 5083080, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5083080, "timers": {"training_iteration_time_ms": 3247.93, "sample_time_ms": 3237.264, "load_time_ms": 0.307, "load_throughput": 1171502.397, "learn_time_ms": 9.585, "learn_throughput": 37556.914, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 5083080, "num_env_steps_trained": 5083080, "num_agent_steps_sampled": 5083080, "num_agent_steps_trained": 5083080}, "done": false, "episodes_total": 1209, "training_iteration": 576, "trial_id": "a08b5_00000", "date": "2023-07-25_03-32-58", "timestamp": 1690245178, "time_this_iter_s": 12.467526197433472, "time_total_s": 10138.732218265533, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 69.61839938163757, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 32.50555555555556, "ram_util_percent": 78.49999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.966666666666666e-05, "entropy_coeff": 0.1, "policy_entropy": 37.91017303466797, "policy_loss": -30285.715625, "vf_loss": 15634290.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 118.0, "diff_num_grad_updates_vs_sampler_policy": 117.0}}, "num_env_steps_sampled": 5084520, "num_env_steps_trained": 5084520, "num_agent_steps_sampled": 5084520, "num_agent_steps_trained": 5084520}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2064.5891496665795, "episode_reward_mean": -1934.5139438381455, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.440844412729494, "mean_inference_ms": 0.39246800570012735, "mean_action_processing_ms": 0.09460092109006714, "mean_env_wait_ms": 2.3115569911878615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038117170333862305, "StateBufferConnector_ms": 0.0028212865193684897, "ViewRequirementAgentConnector_ms": 0.07013579209645589}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2064.5891496665795, "episode_reward_mean": -1934.5139438381455, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.440844412729494, "mean_inference_ms": 0.39246800570012735, "mean_action_processing_ms": 0.09460092109006714, "mean_env_wait_ms": 2.3115569911878615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038117170333862305, "StateBufferConnector_ms": 0.0028212865193684897, "ViewRequirementAgentConnector_ms": 0.07013579209645589}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5084520, "num_agent_steps_trained": 5084520, "num_env_steps_sampled": 5084520, "num_env_steps_trained": 5084520, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 116.09783569280292, "num_env_steps_trained_throughput_per_sec": 116.09783569280292, "timesteps_total": 5084520, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5084520, "timers": {"training_iteration_time_ms": 3126.499, "sample_time_ms": 3115.463, "load_time_ms": 0.303, "load_throughput": 1188936.567, "learn_time_ms": 9.93, "learn_throughput": 36254.245, "synch_weights_time_ms": 0.758}, "counters": {"num_env_steps_sampled": 5084520, "num_env_steps_trained": 5084520, "num_agent_steps_sampled": 5084520, "num_agent_steps_trained": 5084520}, "done": false, "episodes_total": 1213, "training_iteration": 577, "trial_id": "a08b5_00000", "date": "2023-07-25_03-33-11", "timestamp": 1690245191, "time_this_iter_s": 12.405753135681152, "time_total_s": 10151.137971401215, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 82.02415251731873, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 36.21764705882353, "ram_util_percent": 78.6470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.7e-05, "entropy_coeff": 0.1, "policy_entropy": 35.77459869384766, "policy_loss": -32482.559375, "vf_loss": 15954147.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 138.0, "diff_num_grad_updates_vs_sampler_policy": 137.0}}, "num_env_steps_sampled": 5085960, "num_env_steps_trained": 5085960, "num_agent_steps_sampled": 5085960, "num_agent_steps_trained": 5085960}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -1953.6993739432542, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4360693410908665, "mean_inference_ms": 0.39215481570701816, "mean_action_processing_ms": 0.09458521120185695, "mean_env_wait_ms": 2.186466717220792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038683414459228516, "StateBufferConnector_ms": 0.0027912003653390066, "ViewRequirementAgentConnector_ms": 0.06991454533168248}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -1953.6993739432542, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4360693410908665, "mean_inference_ms": 0.39215481570701816, "mean_action_processing_ms": 0.09458521120185695, "mean_env_wait_ms": 2.186466717220792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038683414459228516, "StateBufferConnector_ms": 0.0027912003653390066, "ViewRequirementAgentConnector_ms": 0.06991454533168248}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5085960, "num_agent_steps_trained": 5085960, "num_env_steps_sampled": 5085960, "num_env_steps_trained": 5085960, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.77008153914826, "num_env_steps_trained_throughput_per_sec": 113.77008153914826, "timesteps_total": 5085960, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5085960, "timers": {"training_iteration_time_ms": 3115.515, "sample_time_ms": 3104.491, "load_time_ms": 0.307, "load_throughput": 1172594.114, "learn_time_ms": 9.92, "learn_throughput": 36291.453, "synch_weights_time_ms": 0.753}, "counters": {"num_env_steps_sampled": 5085960, "num_env_steps_trained": 5085960, "num_agent_steps_sampled": 5085960, "num_agent_steps_trained": 5085960}, "done": false, "episodes_total": 1217, "training_iteration": 578, "trial_id": "a08b5_00000", "date": "2023-07-25_03-33-23", "timestamp": 1690245203, "time_this_iter_s": 12.659639120101929, "time_total_s": 10163.797610521317, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 94.68379163742065, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 26.861111111111107, "ram_util_percent": 78.81666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.333333333333333e-05, "entropy_coeff": 0.1, "policy_entropy": 31.50833206176758, "policy_loss": -27740.0349609375, "vf_loss": 15423694.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 158.0, "diff_num_grad_updates_vs_sampler_policy": 157.0}}, "num_env_steps_sampled": 5087400, "num_env_steps_trained": 5087400, "num_agent_steps_sampled": 5087400, "num_agent_steps_trained": 5087400}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -1964.9338488706912, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.428989840326475, "mean_inference_ms": 0.3918738237657653, "mean_action_processing_ms": 0.09455957853220227, "mean_env_wait_ms": 2.0824056474159147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037863850593566895, "StateBufferConnector_ms": 0.002759695053100586, "ViewRequirementAgentConnector_ms": 0.06933286786079407}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -1964.9338488706912, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.428989840326475, "mean_inference_ms": 0.3918738237657653, "mean_action_processing_ms": 0.09455957853220227, "mean_env_wait_ms": 2.0824056474159147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037863850593566895, "StateBufferConnector_ms": 0.002759695053100586, "ViewRequirementAgentConnector_ms": 0.06933286786079407}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5087400, "num_agent_steps_trained": 5087400, "num_env_steps_sampled": 5087400, "num_env_steps_trained": 5087400, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 117.51375146632012, "num_env_steps_trained_throughput_per_sec": 117.51375146632012, "timesteps_total": 5087400, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5087400, "timers": {"training_iteration_time_ms": 3113.808, "sample_time_ms": 3102.33, "load_time_ms": 0.311, "load_throughput": 1157049.379, "learn_time_ms": 10.348, "learn_throughput": 34789.297, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 5087400, "num_env_steps_trained": 5087400, "num_agent_steps_sampled": 5087400, "num_agent_steps_trained": 5087400}, "done": false, "episodes_total": 1221, "training_iteration": 579, "trial_id": "a08b5_00000", "date": "2023-07-25_03-33-36", "timestamp": 1690245216, "time_this_iter_s": 12.256440162658691, "time_total_s": 10176.054050683975, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 106.94023180007935, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 29.772222222222226, "ram_util_percent": 78.32777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.666666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": 31.453295135498045, "policy_loss": -22300.523828125, "vf_loss": 15667312.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 178.0, "diff_num_grad_updates_vs_sampler_policy": 177.0}}, "num_env_steps_sampled": 5088840, "num_env_steps_trained": 5088840, "num_agent_steps_sampled": 5088840, "num_agent_steps_trained": 5088840}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -1974.3994946035973, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.425878149288581, "mean_inference_ms": 0.3914471102773322, "mean_action_processing_ms": 0.09450276802370017, "mean_env_wait_ms": 1.994316037638227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003721316655476888, "StateBufferConnector_ms": 0.002743138207329644, "ViewRequirementAgentConnector_ms": 0.06884270244174534}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -1974.3994946035973, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.425878149288581, "mean_inference_ms": 0.3914471102773322, "mean_action_processing_ms": 0.09450276802370017, "mean_env_wait_ms": 1.994316037638227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003721316655476888, "StateBufferConnector_ms": 0.002743138207329644, "ViewRequirementAgentConnector_ms": 0.06884270244174534}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5088840, "num_agent_steps_trained": 5088840, "num_env_steps_sampled": 5088840, "num_env_steps_trained": 5088840, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.74358722309556, "num_env_steps_trained_throughput_per_sec": 112.74358722309556, "timesteps_total": 5088840, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5088840, "timers": {"training_iteration_time_ms": 3142.426, "sample_time_ms": 3131.046, "load_time_ms": 0.311, "load_throughput": 1155897.91, "learn_time_ms": 10.244, "learn_throughput": 35142.155, "synch_weights_time_ms": 0.778}, "counters": {"num_env_steps_sampled": 5088840, "num_env_steps_trained": 5088840, "num_agent_steps_sampled": 5088840, "num_agent_steps_trained": 5088840}, "done": false, "episodes_total": 1225, "training_iteration": 580, "trial_id": "a08b5_00000", "date": "2023-07-25_03-33-48", "timestamp": 1690245228, "time_this_iter_s": 12.774914026260376, "time_total_s": 10188.828964710236, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 119.71514582633972, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.811111111111114, "ram_util_percent": 78.37222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.000000000000001e-05, "entropy_coeff": 0.1, "policy_entropy": 28.455941009521485, "policy_loss": -22056.88671875, "vf_loss": 15631930.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 198.0, "diff_num_grad_updates_vs_sampler_policy": 197.0}}, "num_env_steps_sampled": 5090280, "num_env_steps_trained": 5090280, "num_agent_steps_sampled": 5090280, "num_agent_steps_trained": 5090280}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -1982.2313742511658, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.426106345534127, "mean_inference_ms": 0.3909074464936961, "mean_action_processing_ms": 0.09442322048748285, "mean_env_wait_ms": 1.9186993905929512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003660917282104492, "StateBufferConnector_ms": 0.0027185678482055664, "ViewRequirementAgentConnector_ms": 0.06846964359283447}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -1982.2313742511658, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.426106345534127, "mean_inference_ms": 0.3909074464936961, "mean_action_processing_ms": 0.09442322048748285, "mean_env_wait_ms": 1.9186993905929512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003660917282104492, "StateBufferConnector_ms": 0.0027185678482055664, "ViewRequirementAgentConnector_ms": 0.06846964359283447}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5090280, "num_agent_steps_trained": 5090280, "num_env_steps_sampled": 5090280, "num_env_steps_trained": 5090280, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.55358042466102, "num_env_steps_trained_throughput_per_sec": 111.55358042466102, "timesteps_total": 5090280, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5090280, "timers": {"training_iteration_time_ms": 3183.177, "sample_time_ms": 3171.939, "load_time_ms": 0.312, "load_throughput": 1154219.11, "learn_time_ms": 10.1, "learn_throughput": 35644.297, "synch_weights_time_ms": 0.778}, "counters": {"num_env_steps_sampled": 5090280, "num_env_steps_trained": 5090280, "num_agent_steps_sampled": 5090280, "num_agent_steps_trained": 5090280}, "done": false, "episodes_total": 1229, "training_iteration": 581, "trial_id": "a08b5_00000", "date": "2023-07-25_03-34-01", "timestamp": 1690245241, "time_this_iter_s": 12.911267042160034, "time_total_s": 10201.740231752396, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 132.62641286849976, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.577777777777776, "ram_util_percent": 78.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.333333333333333e-05, "entropy_coeff": 0.1, "policy_entropy": 25.61695098876953, "policy_loss": -17179.3052734375, "vf_loss": 15528304.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 218.0, "diff_num_grad_updates_vs_sampler_policy": 217.0}}, "num_env_steps_sampled": 5091720, "num_env_steps_trained": 5091720, "num_agent_steps_sampled": 5091720, "num_agent_steps_trained": 5091720}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -1989.0984323742525, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.42635206298883, "mean_inference_ms": 0.3903436329563823, "mean_action_processing_ms": 0.09433508239764121, "mean_env_wait_ms": 1.8529977962721746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037995251742276278, "StateBufferConnector_ms": 0.0027141787789084697, "ViewRequirementAgentConnector_ms": 0.06876967170021751}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -1989.0984323742525, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.42635206298883, "mean_inference_ms": 0.3903436329563823, "mean_action_processing_ms": 0.09433508239764121, "mean_env_wait_ms": 1.8529977962721746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037995251742276278, "StateBufferConnector_ms": 0.0027141787789084697, "ViewRequirementAgentConnector_ms": 0.06876967170021751}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5091720, "num_agent_steps_trained": 5091720, "num_env_steps_sampled": 5091720, "num_env_steps_trained": 5091720, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.55405155969805, "num_env_steps_trained_throughput_per_sec": 114.55405155969805, "timesteps_total": 5091720, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5091720, "timers": {"training_iteration_time_ms": 3171.566, "sample_time_ms": 3160.98, "load_time_ms": 0.307, "load_throughput": 1171775.136, "learn_time_ms": 9.506, "learn_throughput": 37870.585, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 5091720, "num_env_steps_trained": 5091720, "num_agent_steps_sampled": 5091720, "num_agent_steps_trained": 5091720}, "done": false, "episodes_total": 1233, "training_iteration": 582, "trial_id": "a08b5_00000", "date": "2023-07-25_03-34-14", "timestamp": 1690245254, "time_this_iter_s": 12.572974920272827, "time_total_s": 10214.313206672668, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 145.19938778877258, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.072222222222223, "ram_util_percent": 77.96111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.666666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": 25.303791046142578, "policy_loss": -18408.396337890626, "vf_loss": 15577856.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 238.0, "diff_num_grad_updates_vs_sampler_policy": 237.0}}, "num_env_steps_sampled": 5093160, "num_env_steps_trained": 5093160, "num_agent_steps_sampled": 5093160, "num_agent_steps_trained": 5093160}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -1994.140284299854, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4268594273203306, "mean_inference_ms": 0.3897528068796468, "mean_action_processing_ms": 0.09423755039604892, "mean_env_wait_ms": 1.7952349867499224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038271148999532065, "StateBufferConnector_ms": 0.002714991569519043, "ViewRequirementAgentConnector_ms": 0.06849318742752075}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -1994.140284299854, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4268594273203306, "mean_inference_ms": 0.3897528068796468, "mean_action_processing_ms": 0.09423755039604892, "mean_env_wait_ms": 1.7952349867499224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038271148999532065, "StateBufferConnector_ms": 0.002714991569519043, "ViewRequirementAgentConnector_ms": 0.06849318742752075}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5093160, "num_agent_steps_trained": 5093160, "num_env_steps_sampled": 5093160, "num_env_steps_trained": 5093160, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.29715173693396, "num_env_steps_trained_throughput_per_sec": 114.29715173693396, "timesteps_total": 5093160, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5093160, "timers": {"training_iteration_time_ms": 3172.005, "sample_time_ms": 3161.337, "load_time_ms": 0.309, "load_throughput": 1165264.269, "learn_time_ms": 9.591, "learn_throughput": 37535.721, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 5093160, "num_env_steps_trained": 5093160, "num_agent_steps_sampled": 5093160, "num_agent_steps_trained": 5093160}, "done": false, "episodes_total": 1237, "training_iteration": 583, "trial_id": "a08b5_00000", "date": "2023-07-25_03-34-26", "timestamp": 1690245266, "time_this_iter_s": 12.601187705993652, "time_total_s": 10226.914394378662, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 157.80057549476624, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 25.26111111111111, "ram_util_percent": 78.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4e-05, "entropy_coeff": 0.1, "policy_entropy": 27.44328079223633, "policy_loss": -22027.8447265625, "vf_loss": 15473242.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 258.0, "diff_num_grad_updates_vs_sampler_policy": 257.0}}, "num_env_steps_sampled": 5094600, "num_env_steps_trained": 5094600, "num_agent_steps_sampled": 5094600, "num_agent_steps_trained": 5094600}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -1997.9698551589502, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.427571364386046, "mean_inference_ms": 0.38919000957216066, "mean_action_processing_ms": 0.09414344890159007, "mean_env_wait_ms": 1.74412819853053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00381011229294997, "StateBufferConnector_ms": 0.0027124698345477763, "ViewRequirementAgentConnector_ms": 0.06838303345900315}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -1997.9698551589502, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.427571364386046, "mean_inference_ms": 0.38919000957216066, "mean_action_processing_ms": 0.09414344890159007, "mean_env_wait_ms": 1.74412819853053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00381011229294997, "StateBufferConnector_ms": 0.0027124698345477763, "ViewRequirementAgentConnector_ms": 0.06838303345900315}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5094600, "num_agent_steps_trained": 5094600, "num_env_steps_sampled": 5094600, "num_env_steps_trained": 5094600, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.82553229493959, "num_env_steps_trained_throughput_per_sec": 113.82553229493959, "timesteps_total": 5094600, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5094600, "timers": {"training_iteration_time_ms": 3164.297, "sample_time_ms": 3153.644, "load_time_ms": 0.303, "load_throughput": 1189967.247, "learn_time_ms": 9.606, "learn_throughput": 37475.353, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 5094600, "num_env_steps_trained": 5094600, "num_agent_steps_sampled": 5094600, "num_agent_steps_trained": 5094600}, "done": false, "episodes_total": 1241, "training_iteration": 584, "trial_id": "a08b5_00000", "date": "2023-07-25_03-34-39", "timestamp": 1690245279, "time_this_iter_s": 12.653609991073608, "time_total_s": 10239.568004369736, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 170.45418548583984, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 24.722222222222218, "ram_util_percent": 78.25555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.3333333333333335e-05, "entropy_coeff": 0.1, "policy_entropy": 25.329542541503905, "policy_loss": -15886.5890625, "vf_loss": 15451444.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 278.0, "diff_num_grad_updates_vs_sampler_policy": 277.0}}, "num_env_steps_sampled": 5096040, "num_env_steps_trained": 5096040, "num_agent_steps_sampled": 5096040, "num_agent_steps_trained": 5096040}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2001.1834706698226, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.428706622868255, "mean_inference_ms": 0.3886373114816596, "mean_action_processing_ms": 0.09405137768036385, "mean_env_wait_ms": 1.6985095066830735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003769568034580776, "StateBufferConnector_ms": 0.002708179610116141, "ViewRequirementAgentConnector_ms": 0.06814726761409215}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2001.1834706698226, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.428706622868255, "mean_inference_ms": 0.3886373114816596, "mean_action_processing_ms": 0.09405137768036385, "mean_env_wait_ms": 1.6985095066830735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003769568034580776, "StateBufferConnector_ms": 0.002708179610116141, "ViewRequirementAgentConnector_ms": 0.06814726761409215}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5096040, "num_agent_steps_trained": 5096040, "num_env_steps_sampled": 5096040, "num_env_steps_trained": 5096040, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.23012224575847, "num_env_steps_trained_throughput_per_sec": 113.23012224575847, "timesteps_total": 5096040, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5096040, "timers": {"training_iteration_time_ms": 3156.088, "sample_time_ms": 3145.484, "load_time_ms": 0.303, "load_throughput": 1189873.475, "learn_time_ms": 9.559, "learn_throughput": 37661.456, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 5096040, "num_env_steps_trained": 5096040, "num_agent_steps_sampled": 5096040, "num_agent_steps_trained": 5096040}, "done": false, "episodes_total": 1245, "training_iteration": 585, "trial_id": "a08b5_00000", "date": "2023-07-25_03-34-52", "timestamp": 1690245292, "time_this_iter_s": 12.7201828956604, "time_total_s": 10252.288187265396, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 183.17436838150024, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 22.855555555555554, "ram_util_percent": 78.17222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.6666666666666667e-05, "entropy_coeff": 0.1, "policy_entropy": 26.70115432739258, "policy_loss": -23472.56171875, "vf_loss": 15367710.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 298.0, "diff_num_grad_updates_vs_sampler_policy": 297.0}}, "num_env_steps_sampled": 5097480, "num_env_steps_trained": 5097480, "num_agent_steps_sampled": 5097480, "num_agent_steps_trained": 5097480}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2003.5004737515414, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.430008304086538, "mean_inference_ms": 0.38809990886455886, "mean_action_processing_ms": 0.09396063345391541, "mean_env_wait_ms": 1.6574741341124715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037248929341634116, "StateBufferConnector_ms": 0.002711216608683268, "ViewRequirementAgentConnector_ms": 0.06793737411499023}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2003.5004737515414, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.430008304086538, "mean_inference_ms": 0.38809990886455886, "mean_action_processing_ms": 0.09396063345391541, "mean_env_wait_ms": 1.6574741341124715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037248929341634116, "StateBufferConnector_ms": 0.002711216608683268, "ViewRequirementAgentConnector_ms": 0.06793737411499023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5097480, "num_agent_steps_trained": 5097480, "num_env_steps_sampled": 5097480, "num_env_steps_trained": 5097480, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.65005779788189, "num_env_steps_trained_throughput_per_sec": 113.65005779788189, "timesteps_total": 5097480, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5097480, "timers": {"training_iteration_time_ms": 3157.72, "sample_time_ms": 3147.227, "load_time_ms": 0.301, "load_throughput": 1194296.797, "learn_time_ms": 9.447, "learn_throughput": 38107.614, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 5097480, "num_env_steps_trained": 5097480, "num_agent_steps_sampled": 5097480, "num_agent_steps_trained": 5097480}, "done": false, "episodes_total": 1249, "training_iteration": 586, "trial_id": "a08b5_00000", "date": "2023-07-25_03-35-05", "timestamp": 1690245305, "time_this_iter_s": 12.673097848892212, "time_total_s": 10264.961285114288, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 195.84746623039246, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 24.127777777777776, "ram_util_percent": 78.27777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.2e-05, "entropy_coeff": 0.1, "policy_entropy": 24.292105865478515, "policy_loss": -23899.7796875, "vf_loss": 15392368.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 318.0, "diff_num_grad_updates_vs_sampler_policy": 317.0}}, "num_env_steps_sampled": 5098920, "num_env_steps_trained": 5098920, "num_agent_steps_sampled": 5098920, "num_agent_steps_trained": 5098920}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2005.6725267705292, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.431638406204765, "mean_inference_ms": 0.3875910594174873, "mean_action_processing_ms": 0.0938739345292296, "mean_env_wait_ms": 1.6202952674447912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037413090467453003, "StateBufferConnector_ms": 0.0027291476726531982, "ViewRequirementAgentConnector_ms": 0.06767921149730682}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2005.6725267705292, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.431638406204765, "mean_inference_ms": 0.3875910594174873, "mean_action_processing_ms": 0.0938739345292296, "mean_env_wait_ms": 1.6202952674447912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037413090467453003, "StateBufferConnector_ms": 0.0027291476726531982, "ViewRequirementAgentConnector_ms": 0.06767921149730682}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5098920, "num_agent_steps_trained": 5098920, "num_env_steps_sampled": 5098920, "num_env_steps_trained": 5098920, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.98932394727278, "num_env_steps_trained_throughput_per_sec": 112.98932394727278, "timesteps_total": 5098920, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5098920, "timers": {"training_iteration_time_ms": 3187.808, "sample_time_ms": 3177.265, "load_time_ms": 0.301, "load_throughput": 1197897.215, "learn_time_ms": 9.496, "learn_throughput": 37911.947, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 5098920, "num_env_steps_trained": 5098920, "num_agent_steps_sampled": 5098920, "num_agent_steps_trained": 5098920}, "done": false, "episodes_total": 1253, "training_iteration": 587, "trial_id": "a08b5_00000", "date": "2023-07-25_03-35-17", "timestamp": 1690245317, "time_this_iter_s": 12.747204065322876, "time_total_s": 10277.708489179611, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 208.59467029571533, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 25.25263157894737, "ram_util_percent": 78.4157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.8e-05, "entropy_coeff": 0.1, "policy_entropy": 22.62442626953125, "policy_loss": -11261.018310546875, "vf_loss": 15359581.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 338.0, "diff_num_grad_updates_vs_sampler_policy": 337.0}}, "num_env_steps_sampled": 5100360, "num_env_steps_trained": 5100360, "num_agent_steps_sampled": 5100360, "num_agent_steps_trained": 5100360}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2007.576935963402, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.433777033908073, "mean_inference_ms": 0.3871046265058939, "mean_action_processing_ms": 0.09379031350665358, "mean_env_wait_ms": 1.5864587396992567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701448440551758, "StateBufferConnector_ms": 0.002721828572890338, "ViewRequirementAgentConnector_ms": 0.06751733667710248}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2007.576935963402, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.433777033908073, "mean_inference_ms": 0.3871046265058939, "mean_action_processing_ms": 0.09379031350665358, "mean_env_wait_ms": 1.5864587396992567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701448440551758, "StateBufferConnector_ms": 0.002721828572890338, "ViewRequirementAgentConnector_ms": 0.06751733667710248}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5100360, "num_agent_steps_trained": 5100360, "num_env_steps_sampled": 5100360, "num_env_steps_trained": 5100360, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 111.83224719724006, "num_env_steps_trained_throughput_per_sec": 111.83224719724006, "timesteps_total": 5100360, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5100360, "timers": {"training_iteration_time_ms": 3196.897, "sample_time_ms": 3186.201, "load_time_ms": 0.309, "load_throughput": 1164275.92, "learn_time_ms": 9.617, "learn_throughput": 37432.989, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 5100360, "num_env_steps_trained": 5100360, "num_agent_steps_sampled": 5100360, "num_agent_steps_trained": 5100360}, "done": false, "episodes_total": 1257, "training_iteration": 588, "trial_id": "a08b5_00000", "date": "2023-07-25_03-35-30", "timestamp": 1690245330, "time_this_iter_s": 12.87936019897461, "time_total_s": 10290.587849378586, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 221.47403049468994, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 25.033333333333335, "ram_util_percent": 78.36111111111113}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4000000000000001e-05, "entropy_coeff": 0.1, "policy_entropy": 25.33708801269531, "policy_loss": -13602.42763671875, "vf_loss": 15356397.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 358.0, "diff_num_grad_updates_vs_sampler_policy": 357.0}}, "num_env_steps_sampled": 5101800, "num_env_steps_trained": 5101800, "num_agent_steps_sampled": 5101800, "num_agent_steps_trained": 5101800}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2009.4550055271352, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4357348103355925, "mean_inference_ms": 0.38663450818175565, "mean_action_processing_ms": 0.09370973544717603, "mean_env_wait_ms": 1.555542638825244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003723965750800239, "StateBufferConnector_ms": 0.0027298927307128906, "ViewRequirementAgentConnector_ms": 0.06767279571957058}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2009.4550055271352, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.4357348103355925, "mean_inference_ms": 0.38663450818175565, "mean_action_processing_ms": 0.09370973544717603, "mean_env_wait_ms": 1.555542638825244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003723965750800239, "StateBufferConnector_ms": 0.0027298927307128906, "ViewRequirementAgentConnector_ms": 0.06767279571957058}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5101800, "num_agent_steps_trained": 5101800, "num_env_steps_sampled": 5101800, "num_env_steps_trained": 5101800, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.96494645411669, "num_env_steps_trained_throughput_per_sec": 113.96494645411669, "timesteps_total": 5101800, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5101800, "timers": {"training_iteration_time_ms": 3187.47, "sample_time_ms": 3176.79, "load_time_ms": 0.312, "load_throughput": 1153778.131, "learn_time_ms": 9.605, "learn_throughput": 37481.493, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 5101800, "num_env_steps_trained": 5101800, "num_agent_steps_sampled": 5101800, "num_agent_steps_trained": 5101800}, "done": false, "episodes_total": 1261, "training_iteration": 589, "trial_id": "a08b5_00000", "date": "2023-07-25_03-35-43", "timestamp": 1690245343, "time_this_iter_s": 12.638130187988281, "time_total_s": 10303.225979566574, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 234.11216068267822, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 23.62222222222222, "ram_util_percent": 78.27777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-05, "entropy_coeff": 0.1, "policy_entropy": 26.199993896484376, "policy_loss": -15901.52275390625, "vf_loss": 15425507.2}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 378.0, "diff_num_grad_updates_vs_sampler_policy": 377.0}}, "num_env_steps_sampled": 5103240, "num_env_steps_trained": 5103240, "num_agent_steps_sampled": 5103240, "num_agent_steps_trained": 5103240}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2011.0516644442607, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.437394565521892, "mean_inference_ms": 0.38618454938987373, "mean_action_processing_ms": 0.09363295292226957, "mean_env_wait_ms": 1.5271415442865284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036942331414473685, "StateBufferConnector_ms": 0.00273710802981728, "ViewRequirementAgentConnector_ms": 0.06755151246723376}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2011.0516644442607, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.437394565521892, "mean_inference_ms": 0.38618454938987373, "mean_action_processing_ms": 0.09363295292226957, "mean_env_wait_ms": 1.5271415442865284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036942331414473685, "StateBufferConnector_ms": 0.00273710802981728, "ViewRequirementAgentConnector_ms": 0.06755151246723376}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5103240, "num_agent_steps_trained": 5103240, "num_env_steps_sampled": 5103240, "num_env_steps_trained": 5103240, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.74906284969119, "num_env_steps_trained_throughput_per_sec": 114.74906284969119, "timesteps_total": 5103240, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5103240, "timers": {"training_iteration_time_ms": 3148.885, "sample_time_ms": 3138.229, "load_time_ms": 0.312, "load_throughput": 1153601.834, "learn_time_ms": 9.582, "learn_throughput": 37569.716, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 5103240, "num_env_steps_trained": 5103240, "num_agent_steps_sampled": 5103240, "num_agent_steps_trained": 5103240}, "done": false, "episodes_total": 1265, "training_iteration": 590, "trial_id": "a08b5_00000", "date": "2023-07-25_03-35-55", "timestamp": 1690245355, "time_this_iter_s": 12.551734924316406, "time_total_s": 10315.77771449089, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 246.66389560699463, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 24.261111111111113, "ram_util_percent": 78.25555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.333333333333334e-06, "entropy_coeff": 0.1, "policy_entropy": 27.02908248901367, "policy_loss": -16397.43662109375, "vf_loss": 15435900.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 398.0, "diff_num_grad_updates_vs_sampler_policy": 397.0}}, "num_env_steps_sampled": 5104680, "num_env_steps_trained": 5104680, "num_agent_steps_sampled": 5104680, "num_agent_steps_trained": 5104680}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2012.3922197636257, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.439219783695387, "mean_inference_ms": 0.3857623916745815, "mean_action_processing_ms": 0.09356062531662146, "mean_env_wait_ms": 1.5009413433250691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00366896390914917, "StateBufferConnector_ms": 0.002734959125518799, "ViewRequirementAgentConnector_ms": 0.06759613752365112}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2012.3922197636257, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.439219783695387, "mean_inference_ms": 0.3857623916745815, "mean_action_processing_ms": 0.09356062531662146, "mean_env_wait_ms": 1.5009413433250691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00366896390914917, "StateBufferConnector_ms": 0.002734959125518799, "ViewRequirementAgentConnector_ms": 0.06759613752365112}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5104680, "num_agent_steps_trained": 5104680, "num_env_steps_sampled": 5104680, "num_env_steps_trained": 5104680, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.61422331331573, "num_env_steps_trained_throughput_per_sec": 112.61422331331573, "timesteps_total": 5104680, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5104680, "timers": {"training_iteration_time_ms": 3181.015, "sample_time_ms": 3170.517, "load_time_ms": 0.304, "load_throughput": 1185389.732, "learn_time_ms": 9.45, "learn_throughput": 38096.75, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 5104680, "num_env_steps_trained": 5104680, "num_agent_steps_sampled": 5104680, "num_agent_steps_trained": 5104680}, "done": false, "episodes_total": 1269, "training_iteration": 591, "trial_id": "a08b5_00000", "date": "2023-07-25_03-36-08", "timestamp": 1690245368, "time_this_iter_s": 12.789645910263062, "time_total_s": 10328.567360401154, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 259.4535415172577, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.383333333333333, "ram_util_percent": 78.22222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.666666666666668e-06, "entropy_coeff": 0.1, "policy_entropy": 25.51633987426758, "policy_loss": -16475.3166015625, "vf_loss": 15454521.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 418.0, "diff_num_grad_updates_vs_sampler_policy": 417.0}}, "num_env_steps_sampled": 5106120, "num_env_steps_trained": 5106120, "num_agent_steps_sampled": 5106120, "num_agent_steps_trained": 5106120}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2013.818253822163, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934, -2043.5583380955818, -2043.6784392319303, -2039.0290545211963, -2043.0899081228915], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.441244056942732, "mean_inference_ms": 0.385361840601602, "mean_action_processing_ms": 0.0934913536215491, "mean_env_wait_ms": 1.4767016665376338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003686121531895229, "StateBufferConnector_ms": 0.0027344340369814917, "ViewRequirementAgentConnector_ms": 0.06749289376395089}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2013.818253822163, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934, -2043.5583380955818, -2043.6784392319303, -2039.0290545211963, -2043.0899081228915], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.441244056942732, "mean_inference_ms": 0.385361840601602, "mean_action_processing_ms": 0.0934913536215491, "mean_env_wait_ms": 1.4767016665376338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003686121531895229, "StateBufferConnector_ms": 0.0027344340369814917, "ViewRequirementAgentConnector_ms": 0.06749289376395089}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5106120, "num_agent_steps_trained": 5106120, "num_env_steps_sampled": 5106120, "num_env_steps_trained": 5106120, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.07192883639557, "num_env_steps_trained_throughput_per_sec": 112.07192883639557, "timesteps_total": 5106120, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5106120, "timers": {"training_iteration_time_ms": 3189.363, "sample_time_ms": 3178.855, "load_time_ms": 0.302, "load_throughput": 1191469.613, "learn_time_ms": 9.47, "learn_throughput": 38015.797, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 5106120, "num_env_steps_trained": 5106120, "num_agent_steps_sampled": 5106120, "num_agent_steps_trained": 5106120}, "done": false, "episodes_total": 1273, "training_iteration": 592, "trial_id": "a08b5_00000", "date": "2023-07-25_03-36-21", "timestamp": 1690245381, "time_this_iter_s": 12.851491212844849, "time_total_s": 10341.418851613998, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 272.30503273010254, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 23.62222222222222, "ram_util_percent": 78.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8e-06, "entropy_coeff": 0.1, "policy_entropy": 24.300148010253906, "policy_loss": -18480.603125, "vf_loss": 15393541.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 438.0, "diff_num_grad_updates_vs_sampler_policy": 437.0}}, "num_env_steps_sampled": 5107560, "num_env_steps_trained": 5107560, "num_agent_steps_sampled": 5107560, "num_agent_steps_trained": 5107560}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2015.0346354330252, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934, -2043.5583380955818, -2043.6784392319303, -2039.0290545211963, -2043.0899081228915, -2033.081093932084, -2044.5609571416514, -2045.090898343955, -2039.5816476268799], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.442863617016408, "mean_inference_ms": 0.38498375605437724, "mean_action_processing_ms": 0.09342556815544101, "mean_env_wait_ms": 1.45423150344729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036968426270918412, "StateBufferConnector_ms": 0.002730163660916415, "ViewRequirementAgentConnector_ms": 0.06736950440840288}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2015.0346354330252, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934, -2043.5583380955818, -2043.6784392319303, -2039.0290545211963, -2043.0899081228915, -2033.081093932084, -2044.5609571416514, -2045.090898343955, -2039.5816476268799], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.442863617016408, "mean_inference_ms": 0.38498375605437724, "mean_action_processing_ms": 0.09342556815544101, "mean_env_wait_ms": 1.45423150344729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036968426270918412, "StateBufferConnector_ms": 0.002730163660916415, "ViewRequirementAgentConnector_ms": 0.06736950440840288}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5107560, "num_agent_steps_trained": 5107560, "num_env_steps_sampled": 5107560, "num_env_steps_trained": 5107560, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 115.26019256730066, "num_env_steps_trained_throughput_per_sec": 115.26019256730066, "timesteps_total": 5107560, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5107560, "timers": {"training_iteration_time_ms": 3168.355, "sample_time_ms": 3157.83, "load_time_ms": 0.302, "load_throughput": 1192881.529, "learn_time_ms": 9.478, "learn_throughput": 37982.136, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 5107560, "num_env_steps_trained": 5107560, "num_agent_steps_sampled": 5107560, "num_agent_steps_trained": 5107560}, "done": false, "episodes_total": 1277, "training_iteration": 593, "trial_id": "a08b5_00000", "date": "2023-07-25_03-36-34", "timestamp": 1690245394, "time_this_iter_s": 12.4961678981781, "time_total_s": 10353.915019512177, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 284.80120062828064, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 24.783333333333335, "ram_util_percent": 78.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.333333333333333e-06, "entropy_coeff": 0.1, "policy_entropy": 23.259934997558595, "policy_loss": -23973.3728515625, "vf_loss": 15422592.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 458.0, "diff_num_grad_updates_vs_sampler_policy": 457.0}}, "num_env_steps_sampled": 5109000, "num_env_steps_trained": 5109000, "num_agent_steps_sampled": 5109000, "num_agent_steps_trained": 5109000}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2016.1547415979037, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934, -2043.5583380955818, -2043.6784392319303, -2039.0290545211963, -2043.0899081228915, -2033.081093932084, -2044.5609571416514, -2045.090898343955, -2039.5816476268799, -2035.8170952216092, -2044.0431298318997, -2041.390332264116, -2041.9377515833012], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.44421786799654, "mean_inference_ms": 0.3846241758919834, "mean_action_processing_ms": 0.09336318603107235, "mean_env_wait_ms": 1.4333347538915446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036822712939718494, "StateBufferConnector_ms": 0.002730411031971807, "ViewRequirementAgentConnector_ms": 0.06739289864249852}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2016.1547415979037, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934, -2043.5583380955818, -2043.6784392319303, -2039.0290545211963, -2043.0899081228915, -2033.081093932084, -2044.5609571416514, -2045.090898343955, -2039.5816476268799, -2035.8170952216092, -2044.0431298318997, -2041.390332264116, -2041.9377515833012], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.44421786799654, "mean_inference_ms": 0.3846241758919834, "mean_action_processing_ms": 0.09336318603107235, "mean_env_wait_ms": 1.4333347538915446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036822712939718494, "StateBufferConnector_ms": 0.002730411031971807, "ViewRequirementAgentConnector_ms": 0.06739289864249852}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5109000, "num_agent_steps_trained": 5109000, "num_env_steps_sampled": 5109000, "num_env_steps_trained": 5109000, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 114.81718989509501, "num_env_steps_trained_throughput_per_sec": 114.81718989509501, "timesteps_total": 5109000, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5109000, "timers": {"training_iteration_time_ms": 3149.387, "sample_time_ms": 3138.899, "load_time_ms": 0.303, "load_throughput": 1189123.831, "learn_time_ms": 9.433, "learn_throughput": 38165.021, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 5109000, "num_env_steps_trained": 5109000, "num_agent_steps_sampled": 5109000, "num_agent_steps_trained": 5109000}, "done": false, "episodes_total": 1281, "training_iteration": 594, "trial_id": "a08b5_00000", "date": "2023-07-25_03-36-46", "timestamp": 1690245406, "time_this_iter_s": 12.54484486579895, "time_total_s": 10366.459864377975, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 297.3460454940796, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 23.866666666666664, "ram_util_percent": 78.28333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.666666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 22.267872619628907, "policy_loss": -10444.244970703125, "vf_loss": 15386524.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 478.0, "diff_num_grad_updates_vs_sampler_policy": 477.0}}, "num_env_steps_sampled": 5110440, "num_env_steps_trained": 5110440, "num_agent_steps_sampled": 5110440, "num_agent_steps_trained": 5110440}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2016.9720068703325, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934, -2043.5583380955818, -2043.6784392319303, -2039.0290545211963, -2043.0899081228915, -2033.081093932084, -2044.5609571416514, -2045.090898343955, -2039.5816476268799, -2035.8170952216092, -2044.0431298318997, -2041.390332264116, -2041.9377515833012, -2035.204003929613, -2031.0288958038566, -2038.9481727856567, -2037.8953600256416], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.445607724389835, "mean_inference_ms": 0.3842759998419396, "mean_action_processing_ms": 0.09330284299586816, "mean_env_wait_ms": 1.4138086019236944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00365525484085083, "StateBufferConnector_ms": 0.0027301410833994546, "ViewRequirementAgentConnector_ms": 0.06727650761604309}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2016.9720068703325, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934, -2043.5583380955818, -2043.6784392319303, -2039.0290545211963, -2043.0899081228915, -2033.081093932084, -2044.5609571416514, -2045.090898343955, -2039.5816476268799, -2035.8170952216092, -2044.0431298318997, -2041.390332264116, -2041.9377515833012, -2035.204003929613, -2031.0288958038566, -2038.9481727856567, -2037.8953600256416], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.445607724389835, "mean_inference_ms": 0.3842759998419396, "mean_action_processing_ms": 0.09330284299586816, "mean_env_wait_ms": 1.4138086019236944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00365525484085083, "StateBufferConnector_ms": 0.0027301410833994546, "ViewRequirementAgentConnector_ms": 0.06727650761604309}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5110440, "num_agent_steps_trained": 5110440, "num_env_steps_sampled": 5110440, "num_env_steps_trained": 5110440, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.21283497898885, "num_env_steps_trained_throughput_per_sec": 113.21283497898885, "timesteps_total": 5110440, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5110440, "timers": {"training_iteration_time_ms": 3157.632, "sample_time_ms": 3147.143, "load_time_ms": 0.304, "load_throughput": 1185855.211, "learn_time_ms": 9.432, "learn_throughput": 38169.652, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 5110440, "num_env_steps_trained": 5110440, "num_agent_steps_sampled": 5110440, "num_agent_steps_trained": 5110440}, "done": false, "episodes_total": 1285, "training_iteration": 595, "trial_id": "a08b5_00000", "date": "2023-07-25_03-36-59", "timestamp": 1690245419, "time_this_iter_s": 12.72221302986145, "time_total_s": 10379.182077407837, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 310.06825852394104, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 23.944444444444443, "ram_util_percent": 78.1888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6e-06, "entropy_coeff": 0.1, "policy_entropy": 21.868693542480468, "policy_loss": -18165.6662109375, "vf_loss": 15392261.8}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 498.0, "diff_num_grad_updates_vs_sampler_policy": 497.0}}, "num_env_steps_sampled": 5111880, "num_env_steps_trained": 5111880, "num_agent_steps_sampled": 5111880, "num_agent_steps_trained": 5111880}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2017.8165518367607, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934, -2043.5583380955818, -2043.6784392319303, -2039.0290545211963, -2043.0899081228915, -2033.081093932084, -2044.5609571416514, -2045.090898343955, -2039.5816476268799, -2035.8170952216092, -2044.0431298318997, -2041.390332264116, -2041.9377515833012, -2035.204003929613, -2031.0288958038566, -2038.9481727856567, -2037.8953600256416, -2038.3895234205963, -2039.3678841444562, -2034.766534079298, -2039.818582479799], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.447022245433468, "mean_inference_ms": 0.38394319877799943, "mean_action_processing_ms": 0.0932454191201761, "mean_env_wait_ms": 1.395531083418032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003634929656982422, "StateBufferConnector_ms": 0.002721548080444336, "ViewRequirementAgentConnector_ms": 0.06716585159301758}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2017.8165518367607, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1906.8187876734942, -1903.9732632971813, -1905.1862539386275, -1903.7156766554556, -1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934, -2043.5583380955818, -2043.6784392319303, -2039.0290545211963, -2043.0899081228915, -2033.081093932084, -2044.5609571416514, -2045.090898343955, -2039.5816476268799, -2035.8170952216092, -2044.0431298318997, -2041.390332264116, -2041.9377515833012, -2035.204003929613, -2031.0288958038566, -2038.9481727856567, -2037.8953600256416, -2038.3895234205963, -2039.3678841444562, -2034.766534079298, -2039.818582479799], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.447022245433468, "mean_inference_ms": 0.38394319877799943, "mean_action_processing_ms": 0.0932454191201761, "mean_env_wait_ms": 1.395531083418032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003634929656982422, "StateBufferConnector_ms": 0.002721548080444336, "ViewRequirementAgentConnector_ms": 0.06716585159301758}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5111880, "num_agent_steps_trained": 5111880, "num_env_steps_sampled": 5111880, "num_env_steps_trained": 5111880, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 113.02561379033514, "num_env_steps_trained_throughput_per_sec": 113.02561379033514, "timesteps_total": 5111880, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5111880, "timers": {"training_iteration_time_ms": 3176.286, "sample_time_ms": 3165.818, "load_time_ms": 0.303, "load_throughput": 1189404.837, "learn_time_ms": 9.419, "learn_throughput": 38221.149, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 5111880, "num_env_steps_trained": 5111880, "num_agent_steps_sampled": 5111880, "num_agent_steps_trained": 5111880}, "done": false, "episodes_total": 1289, "training_iteration": 596, "trial_id": "a08b5_00000", "date": "2023-07-25_03-37-12", "timestamp": 1690245432, "time_this_iter_s": 12.743433952331543, "time_total_s": 10391.925511360168, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 322.8116924762726, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 24.694444444444443, "ram_util_percent": 78.41666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.333333333333334e-06, "entropy_coeff": 0.1, "policy_entropy": 21.872804260253908, "policy_loss": -12886.417626953125, "vf_loss": 15399286.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 518.0, "diff_num_grad_updates_vs_sampler_policy": 517.0}}, "num_env_steps_sampled": 5113320, "num_env_steps_trained": 5113320, "num_agent_steps_sampled": 5113320, "num_agent_steps_trained": 5113320}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2023.0896811481132, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934, -2043.5583380955818, -2043.6784392319303, -2039.0290545211963, -2043.0899081228915, -2033.081093932084, -2044.5609571416514, -2045.090898343955, -2039.5816476268799, -2035.8170952216092, -2044.0431298318997, -2041.390332264116, -2041.9377515833012, -2035.204003929613, -2031.0288958038566, -2038.9481727856567, -2037.8953600256416, -2038.3895234205963, -2039.3678841444562, -2034.766534079298, -2039.818582479799, -2037.9057543149543, -2040.0618955896714, -2029.0790239577152, -2039.960238837639], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.448633449300574, "mean_inference_ms": 0.3834333257831649, "mean_action_processing_ms": 0.09316127250839223, "mean_env_wait_ms": 1.2801248704597001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003625631332397461, "StateBufferConnector_ms": 0.00270843505859375, "ViewRequirementAgentConnector_ms": 0.06683611869812012}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2023.0896811481132, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1899.9447865753727, -1890.2342114304934, -1871.2798050583644, -1847.4618769988183, -1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934, -2043.5583380955818, -2043.6784392319303, -2039.0290545211963, -2043.0899081228915, -2033.081093932084, -2044.5609571416514, -2045.090898343955, -2039.5816476268799, -2035.8170952216092, -2044.0431298318997, -2041.390332264116, -2041.9377515833012, -2035.204003929613, -2031.0288958038566, -2038.9481727856567, -2037.8953600256416, -2038.3895234205963, -2039.3678841444562, -2034.766534079298, -2039.818582479799, -2037.9057543149543, -2040.0618955896714, -2029.0790239577152, -2039.960238837639], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.448633449300574, "mean_inference_ms": 0.3834333257831649, "mean_action_processing_ms": 0.09316127250839223, "mean_env_wait_ms": 1.2801248704597001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003625631332397461, "StateBufferConnector_ms": 0.00270843505859375, "ViewRequirementAgentConnector_ms": 0.06683611869812012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5113320, "num_agent_steps_trained": 5113320, "num_env_steps_sampled": 5113320, "num_env_steps_trained": 5113320, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.32742651685183, "num_env_steps_trained_throughput_per_sec": 112.32742651685183, "timesteps_total": 5113320, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5113320, "timers": {"training_iteration_time_ms": 3184.025, "sample_time_ms": 3173.607, "load_time_ms": 0.302, "load_throughput": 1192316.361, "learn_time_ms": 9.381, "learn_throughput": 38377.357, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 5113320, "num_env_steps_trained": 5113320, "num_agent_steps_sampled": 5113320, "num_agent_steps_trained": 5113320}, "done": false, "episodes_total": 1293, "training_iteration": 597, "trial_id": "a08b5_00000", "date": "2023-07-25_03-37-25", "timestamp": 1690245445, "time_this_iter_s": 12.822364091873169, "time_total_s": 10404.747875452042, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 335.63405656814575, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 22.71111111111111, "ram_util_percent": 78.4222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.666666666666667e-06, "entropy_coeff": 0.1, "policy_entropy": 22.118000793457032, "policy_loss": -15157.7296875, "vf_loss": 15340461.4}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 538.0, "diff_num_grad_updates_vs_sampler_policy": 537.0}}, "num_env_steps_sampled": 5114760, "num_env_steps_trained": 5114760, "num_agent_steps_sampled": 5114760, "num_agent_steps_trained": 5114760}, "sampler_results": {"episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2029.5007749562908, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934, -2043.5583380955818, -2043.6784392319303, -2039.0290545211963, -2043.0899081228915, -2033.081093932084, -2044.5609571416514, -2045.090898343955, -2039.5816476268799, -2035.8170952216092, -2044.0431298318997, -2041.390332264116, -2041.9377515833012, -2035.204003929613, -2031.0288958038566, -2038.9481727856567, -2037.8953600256416, -2038.3895234205963, -2039.3678841444562, -2034.766534079298, -2039.818582479799, -2037.9057543149543, -2040.0618955896714, -2029.0790239577152, -2039.960238837639, -2035.1028224938923, -2044.455424269221, -2040.1461415463866, -2030.3256725713788], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.448172817418392, "mean_inference_ms": 0.3829678654952671, "mean_action_processing_ms": 0.09309171035988141, "mean_env_wait_ms": 1.2131246616347267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003624439239501953, "StateBufferConnector_ms": 0.0027031898498535156, "ViewRequirementAgentConnector_ms": 0.06676030158996582}}, "episode_reward_max": -1802.5493058865864, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2029.5007749562908, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1815.3042852245978, -1802.5493058865864, -1803.7659387319611, -1821.4402487864413, -1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934, -2043.5583380955818, -2043.6784392319303, -2039.0290545211963, -2043.0899081228915, -2033.081093932084, -2044.5609571416514, -2045.090898343955, -2039.5816476268799, -2035.8170952216092, -2044.0431298318997, -2041.390332264116, -2041.9377515833012, -2035.204003929613, -2031.0288958038566, -2038.9481727856567, -2037.8953600256416, -2038.3895234205963, -2039.3678841444562, -2034.766534079298, -2039.818582479799, -2037.9057543149543, -2040.0618955896714, -2029.0790239577152, -2039.960238837639, -2035.1028224938923, -2044.455424269221, -2040.1461415463866, -2030.3256725713788], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.448172817418392, "mean_inference_ms": 0.3829678654952671, "mean_action_processing_ms": 0.09309171035988141, "mean_env_wait_ms": 1.2131246616347267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003624439239501953, "StateBufferConnector_ms": 0.0027031898498535156, "ViewRequirementAgentConnector_ms": 0.06676030158996582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5114760, "num_agent_steps_trained": 5114760, "num_env_steps_sampled": 5114760, "num_env_steps_trained": 5114760, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 115.47888690380069, "num_env_steps_trained_throughput_per_sec": 115.47888690380069, "timesteps_total": 5114760, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5114760, "timers": {"training_iteration_time_ms": 3170.307, "sample_time_ms": 3159.789, "load_time_ms": 0.305, "load_throughput": 1182049.037, "learn_time_ms": 9.46, "learn_throughput": 38056.134, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 5114760, "num_env_steps_trained": 5114760, "num_agent_steps_sampled": 5114760, "num_agent_steps_trained": 5114760}, "done": false, "episodes_total": 1297, "training_iteration": 598, "trial_id": "a08b5_00000", "date": "2023-07-25_03-37-37", "timestamp": 1690245457, "time_this_iter_s": 12.47263479232788, "time_total_s": 10417.22051024437, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 348.10669136047363, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 26.366666666666667, "ram_util_percent": 78.51111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.000000000000001e-06, "entropy_coeff": 0.1, "policy_entropy": 22.41401062011719, "policy_loss": -15376.0876953125, "vf_loss": 15401738.6}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 558.0, "diff_num_grad_updates_vs_sampler_policy": 557.0}}, "num_env_steps_sampled": 5116200, "num_env_steps_trained": 5116200, "num_agent_steps_sampled": 5116200, "num_agent_steps_trained": 5116200}, "sampler_results": {"episode_reward_max": -1818.660428401515, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2038.6400589791926, "episode_len_mean": 360.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934, -2043.5583380955818, -2043.6784392319303, -2039.0290545211963, -2043.0899081228915, -2033.081093932084, -2044.5609571416514, -2045.090898343955, -2039.5816476268799, -2035.8170952216092, -2044.0431298318997, -2041.390332264116, -2041.9377515833012, -2035.204003929613, -2031.0288958038566, -2038.9481727856567, -2037.8953600256416, -2038.3895234205963, -2039.3678841444562, -2034.766534079298, -2039.818582479799, -2037.9057543149543, -2040.0618955896714, -2029.0790239577152, -2039.960238837639, -2035.1028224938923, -2044.455424269221, -2040.1461415463866, -2030.3256725713788, -2048.0172709661624, -2036.4208975193883, -2032.6993061696683, -2039.8507062645187], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.448973362878378, "mean_inference_ms": 0.38206965332832865, "mean_action_processing_ms": 0.09294628407814788, "mean_env_wait_ms": 1.1610305673103387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003598928451538086, "StateBufferConnector_ms": 0.0026922225952148438, "ViewRequirementAgentConnector_ms": 0.06634736061096191}}, "episode_reward_max": -1818.660428401515, "episode_reward_min": -2079.113421305911, "episode_reward_mean": -2038.6400589791926, "episode_len_mean": 360.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1818.660428401515, -1864.8459373287446, -1946.3091158300826, -2009.5137669377002, -2044.1168359659391, -2049.2444557647536, -2043.9270229775807, -2063.87605943827, -2061.113040803486, -2064.5891496665795, -2041.1746658753418, -2049.28973286811, -2059.222854327973, -2062.392074215173, -2074.5194684465714, -2079.113421305911, -2052.0012943016436, -2046.62524101794, -2045.2763672365754, -2030.3977908948336, -2044.638004242869, -2047.5153808690427, -2053.030489493499, -2055.314767261966, -2047.3281214188369, -2056.42813181013, -2056.379948453145, -2050.7369626350305, -2069.3462055941113, -2060.997935197271, -2058.356610415111, -2042.3753032139884, -2058.3066705059487, -2047.7451030848576, -2042.9557098255934, -2049.3951385094806, -2047.8814714679609, -2040.2256456012385, -2047.4295699443107, -2040.1621348588935, -2039.4544612441787, -2061.2547204114294, -2031.5798619774, -2039.552845611654, -2033.636670186505, -2036.0218140180282, -2040.2182982602867, -2033.877285117623, -2040.4807076805234, -2034.4406847560208, -2043.042535227015, -2035.0493605578024, -2045.4779174274183, -2037.4948996132812, -2035.7125734644674, -2033.504541692321, -2050.574127648161, -2041.6751025537735, -2043.1815717908958, -2030.0979504495676, -2035.7123787389203, -2037.9863841857466, -2043.7695254253451, -2041.6978114600656, -2045.9675995101102, -2033.069481428536, -2032.2006483927757, -2040.2133539947934, -2043.5583380955818, -2043.6784392319303, -2039.0290545211963, -2043.0899081228915, -2033.081093932084, -2044.5609571416514, -2045.090898343955, -2039.5816476268799, -2035.8170952216092, -2044.0431298318997, -2041.390332264116, -2041.9377515833012, -2035.204003929613, -2031.0288958038566, -2038.9481727856567, -2037.8953600256416, -2038.3895234205963, -2039.3678841444562, -2034.766534079298, -2039.818582479799, -2037.9057543149543, -2040.0618955896714, -2029.0790239577152, -2039.960238837639, -2035.1028224938923, -2044.455424269221, -2040.1461415463866, -2030.3256725713788, -2048.0172709661624, -2036.4208975193883, -2032.6993061696683, -2039.8507062645187], "episode_lengths": [360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.448973362878378, "mean_inference_ms": 0.38206965332832865, "mean_action_processing_ms": 0.09294628407814788, "mean_env_wait_ms": 1.1610305673103387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003598928451538086, "StateBufferConnector_ms": 0.0026922225952148438, "ViewRequirementAgentConnector_ms": 0.06634736061096191}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5116200, "num_agent_steps_trained": 5116200, "num_env_steps_sampled": 5116200, "num_env_steps_trained": 5116200, "num_env_steps_sampled_this_iter": 1440, "num_env_steps_trained_this_iter": 1440, "num_env_steps_sampled_throughput_per_sec": 112.76357566750897, "num_env_steps_trained_throughput_per_sec": 112.76357566750897, "timesteps_total": 5116200, "num_steps_trained_this_iter": 1440, "agent_timesteps_total": 5116200, "timers": {"training_iteration_time_ms": 3171.91, "sample_time_ms": 3161.412, "load_time_ms": 0.302, "load_throughput": 1190999.716, "learn_time_ms": 9.431, "learn_throughput": 38171.292, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 5116200, "num_env_steps_trained": 5116200, "num_agent_steps_sampled": 5116200, "num_agent_steps_trained": 5116200}, "done": false, "episodes_total": 1301, "training_iteration": 599, "trial_id": "a08b5_00000", "date": "2023-07-25_03-37-50", "timestamp": 1690245470, "time_this_iter_s": 12.772902965545654, "time_total_s": 10429.993413209915, "pid": 56965, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 3, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[5075880, 0.0001], [5081280, 8.5e-05], [5086680, 7.5e-05], [5092080, 5e-05], [5097480, 2.5e-05], [5102880, 1e-05], [5108280, 7.5e-06], [5113680, 5e-06], [5119080, 2.5e-06], [5124480, 1e-06], [5129880, 7.5e-07], [5135280, 5e-07], [5140680, 2.5e-07], [5146080, 1e-07]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 360, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x300239430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 360.8795943260193, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 23.51111111111111, "ram_util_percent": 78.3611111111111}}
